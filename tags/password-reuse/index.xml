<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>password-reuse on Blog de 7Rocky. Ciberseguridad y Mates</title><link>https://7rocky.github.io/tags/password-reuse/</link><description>Recent content in password-reuse on Blog de 7Rocky. Ciberseguridad y Mates</description><generator>Hugo -- gohugo.io</generator><language>es</language><lastBuildDate>Sat, 10 Jun 2023 00:00:00 +0100</lastBuildDate><atom:link href="https://7rocky.github.io/tags/password-reuse/index.xml" rel="self" type="application/rss+xml"/><item><title>Soccer</title><link>https://7rocky.github.io/htb/soccer/</link><pubDate>Sat, 10 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/soccer/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene una aplicación Tiny File Manager que nos permite cargar y ejecutar PHP, por lo que podemos obtener una &lt;em>reverse shell&lt;/em> como &lt;code>www-data&lt;/code>. En la máquina, podemos leer la configuración de nginx y encontrar otro subdominio. Este expone un servidor WebSocket que es vulnerable a &lt;em>Boolean-based Blind&lt;/em> SQLi. Al explotar SQLi, podemos encontrar credenciales en texto claro que se reutilizan en SSH. Finalmente, el usuario puede ejecutar &lt;code>dstat&lt;/code> como &lt;code>root&lt;/code> usando &lt;code>doas&lt;/code>, y podemos crear un &lt;em>plugin&lt;/em> para escalar privilegios</description></item><item><title>Bagel</title><link>https://7rocky.github.io/htb/bagel/</link><pubDate>Sat, 03 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/bagel/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web que es vulnerable a lectura de archivos locales. Con esto, podemos leer el código fuente de la aplicación web y ver que hay un servidor WebSocket que usa C# .NET con una DLL para procesar los mensajes. Podemos descargar y aplicar ingeniería inversa a la DLL para leer el código fuente en C#. El programa deserializa los datos JSON y hay un fallo que nos permite reutilizar una clase del código para leer archivos arbitrarios del servidor. Con esto, podemos leer la clave privada de SSH de un usuario y luego cambiar a otro usuario con una contraseña que también aparecía en la DLL. Este usuario puede ejecutar &lt;code>dotnet&lt;/code> con &lt;code>sudo&lt;/code>, que puede usarse para escalar privilegios</description></item><item><title>MetaTwo</title><link>https://7rocky.github.io/htb/metatwo/</link><pubDate>Sat, 29 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/metatwo/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene un sitio web de WordPress que utiliza un &lt;em>plugin&lt;/em> vulnerable a SQLi. Con este ataque podemos obtener &lt;em>hashes&lt;/em> de contraseñas y romper uno de ellos para obtener acceso al &lt;em>dashboard&lt;/em> de WordPress. La versión de WordPress es vulnerable a &lt;em>out-of-band&lt;/em> XXE utilizando un archivo WAV que permite leer archivos del servidor. Usando esta vulnerabilidad, podemos encontrar credenciales en texto claro para FTP. En este servicio tenemos otro archivo PHP con más credenciales en texto claro que son válidas para SSH. Una vez dentro de la máquina, encontramos algunas claves y mensajes PGP que se pueden descifrar para encontrar la contraseña de &lt;code>root&lt;/code></description></item><item><title>BroScience</title><link>https://7rocky.github.io/htb/broscience/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/broscience/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web vulnerable a lectura de archivos locales que se puede usar para leer código PHP y encontrar una manera de activar una nueva cuenta. Luego, podemos usar un ataque de deserialización en PHP para obtener RCE. Después de eso, encontramos el &lt;em>hash&lt;/em> de una contraseña en la base de datos que puede ser descifrada y reutilizada en el sistema. Finalmente, hay una tarea Cron ejecutada por &lt;code>root&lt;/code> para renovar certificados de OpenSSL y el &lt;em>script&lt;/em> presenta una vulnerabilidad de inyección de comandos, lo que conduce a la escalada de privilegios</description></item><item><title>Forgot</title><link>https://7rocky.github.io/htb/forgot/</link><pubDate>Sat, 04 Mar 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/forgot/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web que es vulnerable a envenenamiento de recuperación de contraseñas y envenenamiento de caché web. Ambas vulnerabilidades se pueden usar para obtener acceso a una cuenta normal y luego obtener la &lt;em>cookie&lt;/em> del administrador, respectivamente. Después de eso, podemos leer un &lt;em>ticket&lt;/em> con credenciales de SSH. Luego, podemos ejecutar un &lt;em>script&lt;/em> de &lt;em>Machine Learning&lt;/em> como &lt;code>root&lt;/code> usando &lt;code>sudo&lt;/code>, y hay una librería con una versión vulnerable donde podemos inyectar código Python para escalar privilegios</description></item><item><title>Awkward</title><link>https://7rocky.github.io/htb/awkward/</link><pubDate>Sat, 25 Feb 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/awkward/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web en Vue.js que expone un formulario de inicio de sesión que se puede saltar fácilmente. Luego encontramos una API que prueba la conectividad de otros sitios web, que puede explotarse utilizando &lt;em>Server-Side Request Forgery&lt;/em> para encontrar la documentación de la API. Allí tenemos código Node.js para analizar y ver cómo podemos saltar algunas validaciones para obtener información de los usuarios y romper el &lt;em>hash&lt;/em> de una contraseña. Después de eso, podemos iniciar sesión, obtener un &lt;em>token&lt;/em> JWT válido y romperlo para encontrar el secreto. Por lo tanto, podemos crear cualquier &lt;em>token&lt;/em> JWT, lo que significa que podemos inyectar cualquier &lt;em>payload&lt;/em> como información del &lt;em>token&lt;/em>. Usando este poder, podemos leer archivos arbitrarios del servidor explotando &lt;code>awk&lt;/code> y encontrar credenciales en texto claro dentro de un archivo comprimido. A continuación, podemos acceder por SSH y encontrar otro sitio web construido en PHP con dos vulnerabilidades. También hay una tarea Cron que toma información de un archivo CSV para enviar un correo electrónico. La clave aquí es inyectar un parámetro malicioso en el archivo CSV para que el comando &lt;code>mail&lt;/code> ejecute un &lt;em>script&lt;/em> malicioso, que lleva a la escalada de privilegios</description></item><item><title>Shoppy</title><link>https://7rocky.github.io/htb/shoppy/</link><pubDate>Sat, 14 Jan 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/shoppy/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una página web vulnerable a inyección NoSQL. Mediante esta vulnerabilidad, podemos saltarnos la autenticación y listar hashes de contraseñas que se pueden romper. Luego, al enumerar subdominios encontramos una aplicación MatterMost a la que podemos entrar y ver credenciales de acceso por SSH. El primer usuario puede ejecutar un binario ELF personalizado que muestra más credenciales al usar una contraseña maestra. Finalmente, podemos escalar privilegios porque el segundo usuario pertenece al grupo docker</description></item><item><title>Health</title><link>https://7rocky.github.io/htb/health/</link><pubDate>Sat, 07 Jan 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/health/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una funcionalidad de webhook que parece vulnerable a Server-Side Request Forgery. Tras probar varios bypasses, vemos que el ataque de SSRF funciona mediante una redirección. Internamente, hay una versión de Gogs desactualizada que es vulnerable a SQLi. Una vez que tenemos un payload para extraer hashes de contraseñas de la base de datos, podemos obtenerlos y romperlos de la instanca de Gogs remota con SQLi a través de SSRF. Luego, conseguimos una conexión por SSH y descubrimos que podemos introducir rutas locales en la base de datos para leer archivos del servidor como root. En este write-up se utiliza un script en Python para realizar el ataque de SSRF y un programa en Go para romper los hashes de Gogs</description></item><item><title>Shared</title><link>https://7rocky.github.io/htb/shared/</link><pubDate>Sat, 12 Nov 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/shared/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una tienda de e-commerce que es vulnerable a SQLi. Con esta vulnerabilidad podemos obtener un hash de una contraseña que se reutiliza en SSH. Existe otro usuario que ejecuta ipython de forma periódica, por lo que podemos inyectar un archivo de configuración y ejecutar comandos. Este segundo usuario puede usar un binario compilado en Go que se conecta a Redis. Un análisis del binario revela una contraseña, por lo que nos podemos conectar a Redis y explotar un CVE para ejecutar código en Lua, escapar de la sandbox y ganar ejecución de comandos como root</description></item><item><title>Faculty</title><link>https://7rocky.github.io/htb/faculty/</link><pubDate>Sat, 22 Oct 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/faculty/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una página web vulnerable a SQLi y salto de autenticación que lleva a otra página en la que podemos exportar contenido HTML a PDF. Existe una vulnerabilidad en la que podemos adjuntar archivos locales al fichero PDF y leer una contraseña reutilizada para SSH. Mediante sudo podemos ejecutar un script en Node.js como otro usuario y explotar una inyección de comandos. Este segundo usuario puede ejecutar GDB y además GDB tiene la capability cap_sys_ptrace activada, por lo que podemos depurar un proceso en ejecución por root y ejecutar código arbitrario</description></item><item><title>OpenSource</title><link>https://7rocky.github.io/htb/opensource/</link><pubDate>Sat, 08 Oct 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/opensource/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una página web que expone su código fuente, siendo vulnerable a Directory Path Traversal. Con esta vulnerabilidad podemos leer los archivos necesarios para calcular el PIN de la consola de depuración de Flask y obtener ejecución remota de comandos en un contenedor Docker. Después, se necesita usar un reenvío de puertos para ver una instancia de Gitea y acceder con credenciales que se encuentran en un repositorio de Git. Aquí podemos ver la clave privada de SSH de un usuario de sistema. Existe una tarea Cron que confirma nuevos cambios de un repositorio Git que lleva a escalada de privilegios</description></item><item><title>Scanned</title><link>https://7rocky.github.io/htb/scanned/</link><pubDate>Sat, 10 Sep 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/scanned/</guid><description>Hack The Box. Linux. Máquina insana. Esta máquina tiene una página web que es capaz de analizar malware. Al analizar el código en C del sandbox, se ve que se puede utilizar un archivo de log para exfiltrar información por medio del servidor web, y también abusar de una mala configuración para escapar de chroot. Luego, podemos leer una base de datos SQLite y extraer el hash de una contraseña, que se reutiliza para SSH. Una vez en la máquina, se puede ejecutar un binario SUID desde la sandbox y copiar una librería compartida maliciosa para que el binario SUID ejecute Bash como root. Para comprometer esta máquina se necesitan conocimientos avanzados de Linux, programación en C y Bash, experiencia en auditoría de código y técnicas de evasión. En este write-up se utiliza un script en Bash con un programa en C embebido para listar directorios y leer archivos del servidor y también un programa en Go para romper el hash de una contraseña</description></item><item><title>Talkative</title><link>https://7rocky.github.io/htb/talkative/</link><pubDate>Sat, 27 Aug 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/talkative/</guid><description>Hack The Box. Linux. Máquina difícil. Esta máquina es un sitio web que expone una aplicación Jamovi donde podemos obtener una &lt;em>reverse shell&lt;/em> en un contenedor de Docker. Aquí encontramos algunas credenciales para una aplicación Bolt CMS, y conseguimos acceso como administrador. Desde aquí podemos modificar una plantilla escribiendo código PHP y ganar acceso a otro contenedor. Este tiene conectividad con el puerto 22 de la máquina, por lo que podemos acceder a la máquina usando las credenciales anteriores por SSH. Luego, encontramos otro contenedor que ejecuta MongoDB, que contiene la base de datos de un servidor Rocket.Chat. En este punto, podemos crear una nueva cuenta en Rocket.Chat y asignarnos el rol de administrador modificando la entrada de la base de datos. Después de eso, podemos establecer una nueva integración para obtener RCE en el contenedor que gestiona Rocket.Chat. Finalmente, este contenedor tiene habilitada la &lt;em>capability&lt;/em> &lt;code>CAP_DAC_READ_SEARCH&lt;/code>, que nos permite leer archivos de la máquina &lt;em>host&lt;/em> como &lt;code>root&lt;/code> usando un &lt;em>exploit&lt;/em>. Además, el contenedor también es vulnerable a otro &lt;em>exploit&lt;/em> para escribir archivos arbitrarios como &lt;code>root&lt;/code> en la máquina &lt;em>host&lt;/em></description></item><item><title>Catch</title><link>https://7rocky.github.io/htb/catch/</link><pubDate>Sat, 23 Jul 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/catch/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina ofrece un archivo APK que contiene tokens de autenticación hard-coded de otros servicios expuestos. Uno de los tokens puede ser usado para enumerar una aplicación de Let&amp;rsquo;s Chat por medio de su API y obtener credenciales para Cachet. Este servicio es vulnerable a Server-Side Template Injection en PHP y podemos obtener más credenciales para acceder por SSH. La máquina ejecuta una tarea Cron para analizar archivos APK con un script en Bash que es vulnerable a inyección de comandos, por lo que tenemos que subir un archivo APK malicioso para explotarlo y convertirnos en root</description></item><item><title>Paper</title><link>https://7rocky.github.io/htb/paper/</link><pubDate>Sat, 18 Jun 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/paper/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene una página web en WordPress con información secreta en borradores, y también un chat con un &lt;em>bot&lt;/em> que muestra información sensible. Después, el servidor es vulnerable a PolKit. Para comprometer esta máquina se necesitan conocimientos de enumeración en WordPress</description></item><item><title>Pandora</title><link>https://7rocky.github.io/htb/pandora/</link><pubDate>Sat, 21 May 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/pandora/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina expone información sensible por SNMP que permite acceder a la máquina. Luego, encontramos una instancia local de Pandora FMS que tiene varias vulnerabilidades y pueden ser explotadas para conseguir RCE como otro usuario. Este usuario puede ejecutar un binario SUID que es vulnerable a PATH hijacking, pero el ataque tiene que ser realizado desde una sesión de SSH. Para comprometer esta máquina se necesitan habilidades de enumeración y pentesting básicas</description></item><item><title>Unicode</title><link>https://7rocky.github.io/htb/unicode/</link><pubDate>Sat, 07 May 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/unicode/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina utiliza tokens JWT con JWKS y JKU que pueden ser falsificados para llegar a una vulnerabilidad de navegación de directorios que puede ser explotada mediante caracteres Unicode. Después, existe un binario compilado con Python que puede ejecutarse con sudo y usa curl por detrás. Para comprometer esta máquina se necesitan conocimientos sobre JWT y técnicas de bypassing para navegación de directorios e inyección de comandos. En este write-up se utiliza un script en Python para explotar la navegación de directorios usando JWT y JWKS</description></item><item><title>Backend</title><link>https://7rocky.github.io/htb/backend/</link><pubDate>Tue, 12 Apr 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/backend/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una API en la que podemos crear una cuenta después de un proceso de exploración. Luego encontramos documentación en formato Swagger donde podemos ver una ruta para ejecutar comandos y para leer archivos del servidor. Necesitamos encontrar la clave secreta usada para los tokens JWT y crear un token válido para ejecutar comandos. Para comprometer esta máquina se necesitan conocimientos sobre tokens JWT y enumeración de API</description></item><item><title>Overflow</title><link>https://7rocky.github.io/htb/overflow/</link><pubDate>Sat, 09 Apr 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/overflow/</guid><description>Hack The Box. Linux. Máquina difícil. Esta máquina contiene una página web vulnerable a Padding Oracle Attack y Bit Flipper Attack para iniciar sesión como admin y también vulnerable a SQLi por un CMS. Existe otro subdominio que usa una versión de exiftool que tiene una vulnerabilidad de RCE. Una vez en la máquina, los movimientos laterales son relativamente fáciles y la escalada de privilegios consiste en ingeniería inversa y explotación de una vulnerabilidad de Buffer Overflow en un binario SUID. Para comprometer esta máquina se necesitan conocimientos avanzados de explotación web, criptografía y explotación de binarios. En este write-up se utiliza un script en Python para efectuar un Bit Flipper Attack y un script en Ruby para SQLi</description></item><item><title>Shibboleth</title><link>https://7rocky.github.io/htb/shibboleth/</link><pubDate>Sat, 02 Apr 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/shibboleth/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un servicio IPMI vulnerable donde podemos encontrar una contraseña que se reutiliza para un panel de control Zabbix. Aquí podemos entrar y ganar acceso a la máquina. Luego, encontramos una versión de MariaDB vulnerable a RCE como root. Para comprometer esta máquina se necesita una buena enumeración y metodología de pentesting</description></item><item><title>Ransom</title><link>https://7rocky.github.io/htb/ransom/</link><pubDate>Tue, 15 Mar 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/ransom/</guid><description>Hack The Box. Linux. Máquina media. Esta máquinaa tiene una página web en Laravel con un formulario de inicio de sesión que es vulnerable a Type Juggling. Después, encontramos un archivo ZIP encriptado y podemos realizar un ataque de texto claro conocido para extraer los archivos. La contraseña esperada en el formuulario de inicio de sesión se reutiliza para el usuario root. Para comprometer esta máquina se necesitan conocimientos básicos de pentesting web en PHP y conocimientos sobre archivos ZIP</description></item><item><title>GoodGames</title><link>https://7rocky.github.io/htb/goodgames/</link><pubDate>Mon, 21 Feb 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/goodgames/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una página web vulnerable a inyección de código SQL desde donde podemos obtener una contraseña para acceder a una verb interna que es vulnerable a SSTI. Luego, ganamos acceso a un contenedor de Docker que monta un directorio de la máquina, de manera que podemos aprovecharlo para escalar privilegios. Para comprometer esta máquina se necesitan habilidades básicas de pentesting web y de Docker. En este write-up se utiliza un script en Python personalizado para comprometer la máquina desde cero</description></item><item><title>Bolt</title><link>https://7rocky.github.io/htb/bolt/</link><pubDate>Sat, 19 Feb 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/bolt/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene varios subdominios y una imagen de Docker con mucha información necesaria para explotar los servicios web. Existe una vulnerabilidad de SSTI en la comunicación entre dos servicios. Luego, podemos extraer una clave privada PGP de la caché de Google Chrome y descrifrar un mensaje. Para comprometer esta máquina, se necesitan conocimientos avanzados de Docker y habilidades básicas de explotación web</description></item><item><title>NodeBlog</title><link>https://7rocky.github.io/htb/nodeblog/</link><pubDate>Mon, 10 Jan 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/nodeblog/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene un blog que es vulnerable a inyección NoSQL, luego a inyección de Entidades Externas XML (XXE) y finalmente a deserialización insegura para obtener ejecución remota de comandos. Para comprometer esta máquina se necesitan técnicas avanzadas de explotación web y habilidades de programación. En este write-up se utilizan scripts en Bash, Python y Node.js para explotar todas las vulnerabilidades</description></item><item><title>Writer</title><link>https://7rocky.github.io/htb/writer/</link><pubDate>Sat, 11 Dec 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/writer/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina contiene una página web vulnerable a inyección de código SQL. Esto permite leer el código fuente del servidor y encontrar una vulnerabilidad. Después, se utilizan varias técnicas de inyección de comandos para escalar privilegios. Para comprometer la máquina, se necesita programar una explotación automática de SQLi y conocimientos de SMB, SMTP y tareas Cron. En este write-up se utilizan scripts en Python personalizados para SQLi y para la intrusión</description></item><item><title>Union</title><link>https://7rocky.github.io/htb/union/</link><pubDate>Mon, 22 Nov 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/union/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina contiene vulnerabilidades de inyección de código SQL (SQLi) e inyección de comandos. Para comprometer la máquina se necesitan algunas técnicas de evasión de SQLi y análisis de código fuente. En este write-up se utiliza un programa en Java personalizado para automatizar un ataque de SQLi</description></item><item><title>BountyHunter</title><link>https://7rocky.github.io/htb/bountyhunter/</link><pubDate>Sat, 20 Nov 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/bountyhunter/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una página web vulnerable a inyeccción de entidades externas XML (XXE) además de permisios de sudo configurados. Para comprometer la máquina se necesitan conocimientos sobre XXE, PHP y Python. En este write-up se utiliza un script en Bash para leer archivos del servidor explotando el XXE</description></item><item><title>Cap</title><link>https://7rocky.github.io/htb/cap/</link><pubDate>Sat, 02 Oct 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/cap/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene vulnerabilidades de referencias directas inseguras a archivos (IDOR) y capabilities a nivel de sistema. Para comprometer la máquina se necesita utilizar Wireshark para leer una captura de red y saber enumerar y explotar capabilities</description></item></channel></rss>