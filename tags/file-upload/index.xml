<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>File-Upload on Blog de 7Rocky. Ciberseguridad y Mates</title><link>https://7rocky.github.io/tags/file-upload/</link><description>Recent content in File-Upload on Blog de 7Rocky. Ciberseguridad y Mates</description><generator>Hugo</generator><language>es</language><lastBuildDate>Sun, 08 Sep 2024 18:56:03 +0200</lastBuildDate><atom:link href="https://7rocky.github.io/tags/file-upload/index.xml" rel="self" type="application/rss+xml"/><item><title>Pilgrimage</title><link>https://7rocky.github.io/htb/pilgrimage/</link><pubDate>Sat, 25 Nov 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/pilgrimage/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene un sitio web que expone un repositorio de Git. Podemos extraer el código fuente en PHP de la aplicación web y descubrir que usa ImageMagick por detrás para procesar imágenes subidas. La versión de ImageMagick tiene una vulnerabilidad de lectura de archivos locales que se puede usar para leer un archivo de base de datos SQLite y encontrar una contraseña en texto claro para &lt;code>emily&lt;/code>, que también se usa en SSH. Después de eso, encontramos que &lt;code>root&lt;/code> ejecuta un &lt;em>script&lt;/em> en Bash que usa &lt;code>binwalk&lt;/code> para eliminar &lt;em>malware&lt;/em> de los archivos de imagen subidos. La versión de &lt;code>binwalk&lt;/code> es vulnerable a ejecución remota de comandos, lo que conduce a la escalada de privilegios</description></item><item><title>Soccer</title><link>https://7rocky.github.io/htb/soccer/</link><pubDate>Sat, 10 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/soccer/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene una aplicación Tiny File Manager que nos permite cargar y ejecutar PHP, por lo que podemos obtener una &lt;em>reverse shell&lt;/em> como &lt;code>www-data&lt;/code>. En la máquina, podemos leer la configuración de nginx y encontrar otro subdominio. Este expone un servidor WebSocket que es vulnerable a &lt;em>Boolean-based Blind&lt;/em> SQLi. Al explotar SQLi, podemos encontrar credenciales en texto claro que se reutilizan en SSH. Finalmente, el usuario puede ejecutar &lt;code>dstat&lt;/code> como &lt;code>root&lt;/code> usando &lt;code>doas&lt;/code>, y podemos crear un &lt;em>plugin&lt;/em> para escalar privilegios</description></item><item><title>MetaTwo</title><link>https://7rocky.github.io/htb/metatwo/</link><pubDate>Sat, 29 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/metatwo/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene un sitio web de WordPress que utiliza un &lt;em>plugin&lt;/em> vulnerable a SQLi. Con este ataque podemos obtener &lt;em>hashes&lt;/em> de contraseñas y romper uno de ellos para obtener acceso al &lt;em>dashboard&lt;/em> de WordPress. La versión de WordPress es vulnerable a &lt;em>out-of-band&lt;/em> XXE utilizando un archivo WAV que permite leer archivos del servidor. Usando esta vulnerabilidad, podemos encontrar credenciales en texto claro para FTP. En este servicio tenemos otro archivo PHP con más credenciales en texto claro que son válidas para SSH. Una vez dentro de la máquina, encontramos algunas claves y mensajes PGP que se pueden descifrar para encontrar la contraseña de &lt;code>root&lt;/code></description></item><item><title>Investigation</title><link>https://7rocky.github.io/htb/investigation/</link><pubDate>Sat, 22 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/investigation/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web que permite analizar los metadatos de un archivo de imagen con &lt;code>exiftool&lt;/code>. Sin embargo, la versión es vulnerable a inyección de comandos y se puede usar para acceder al sistema. Luego, encontramos algunos registros de eventos de Windows y una contraseña en texto claro como nombre de usuario, probablemente un error. Después de eso, obtenemos acceso como otro usuario que puede ejecutar un binario con &lt;code>sudo&lt;/code>, que por detrás ejecuta un &lt;em>script&lt;/em> en Perl que conduce a la escalada de privilegios</description></item><item><title>UpDown</title><link>https://7rocky.github.io/htb/updown/</link><pubDate>Sat, 21 Jan 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/updown/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web que tiene un directorio de desarrollo y expone un repositorio de Git. Usando esto, podemos encontrar alguna funcionalidad que esté oculta excepto para los desarrolladores y que se pueda abusar para obtener RCE después de planificar el ataque y saltarnos las &lt;code>disable_functions&lt;/code> en PHP. En la máquina, hay un binario SUID compilado de un &lt;em>script&lt;/em> en Python, que puede ser abusado con un ataque de &lt;em>library hijacking&lt;/em>. Finalmente, el usuario puede ejecutar &lt;code>easy_install&lt;/code> con &lt;code>sudo&lt;/code>, lo que conduce a la escalada de privilegios</description></item><item><title>Retired</title><link>https://7rocky.github.io/htb/retired/</link><pubDate>Sat, 13 Aug 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/retired/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una página web en PHP que es vulnerable a navegación de directorios. Aquí encontramos un archivo PHP que espera que se suba un archivo para pasarlo a un servidor de sockets en local. Somos capaces de enumerar procesos y descargar el binario que ejecuta el servidor y ver que es vulnerable a Buffer Overflow. Una vez explotado, podemos pivotar a un usuario usando enlaces simbólicos. Y luego, se nos permite añadir formatos ejecutables personalizados, que puede ser explotado para convertirnos en root. Para comprometer esta máquina se necesitan técnicas sólidas de explotación de binarios y conceptos de Linux. En este write-up se utilizan exploits personalizados en Python para la intrusión</description></item><item><title>OverGraph</title><link>https://7rocky.github.io/htb/overgraph/</link><pubDate>Sat, 06 Aug 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/overgraph/</guid><description>Hack The Box. Linux. Máquina difícil. Esta máquina tiene una página web que es vulnerable a Open Redirect, una aplicación web hecha en AngularJS vulnerable a Client-Side Template Injection y XSS, y una implementación de GraphQL. Somos capaces de registrar una nueva cuenta al saltarnos un código OTP mediante una inyección NoSQL. Luego, podemos realizar un ataque de CSRF abusando del Open Redirect para inyectar un payload de XSS en el perfil de la víctima para obtener su adminToken, que está guardado en localStorage. Después, podemos subir archivos de video que serán procesados por ffmpeg y explotar un Server-Side Request Forgery que nos permite leer archivos del servidor. Finalmente, ganaremos acceso a la máquina como un usuario y podemos encontrar un binario está en ejecución como root. Después de analizarlo, podemos obtener un token válido para usar el programa y exploitar una vulnerabilidad para escribir datos arbitrarios en una dirección arbitraria, derivando en RCE o permisos de lectura como root</description></item><item><title>Late</title><link>https://7rocky.github.io/htb/late/</link><pubDate>Sat, 30 Jul 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/late/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene una aplicación web en Flask que extrae texto de imágenes y lo renderiza, siendo vulnerable a SSTI. Luego, existe un PAM configurado para SSH con rutas relativas, que puede ser abusado debido a ciertos privilegios para sobrescribir ejecutables. Para comprometer esta máquina se necesitan conocimientos básicos de explotación web y de enumeración en Linux</description></item><item><title>Meta</title><link>https://7rocky.github.io/htb/meta/</link><pubDate>Sat, 11 Jun 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/meta/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una página web que analiza imágenes subidas con una versión vulnerable de exiftool que deriva en RCE. Luego, existe una tarea Cron que transforma imágenes con el comando mogrify de ImageMagick, que es vulnerable a inyección de comandos. Finalmente, tenemos permisos de sudo para ejecutar neofetch, lo cual posibilita la escalada de privilegios</description></item><item><title>Timing</title><link>https://7rocky.github.io/htb/timing/</link><pubDate>Sat, 04 Jun 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/timing/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una aplicación web en PHP que es vulnerable a enumeración de usuarios, LFI, Type Juggling y SQLi, aparte de otros errores y malas configuraciones. Después de leer el código PHP, se encuentra una manera de subir un archivo PHP para conseguir RCE. Luego encontramos una contraseña en un repositorio de Git y accedemos por SSH. Entonces, podemos ejecutar un archivo JAR con sudo que descarga archivos como root, y se puede usar un enlace simbólico para escribir una clave SSH como autorizada para root</description></item><item><title>Overflow</title><link>https://7rocky.github.io/htb/overflow/</link><pubDate>Sat, 09 Apr 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/overflow/</guid><description>Hack The Box. Linux. Máquina difícil. Esta máquina contiene una página web vulnerable a Padding Oracle Attack y Bit Flipper Attack para iniciar sesión como admin y también vulnerable a SQLi por un CMS. Existe otro subdominio que usa una versión de exiftool que tiene una vulnerabilidad de RCE. Una vez en la máquina, los movimientos laterales son relativamente fáciles y la escalada de privilegios consiste en ingeniería inversa y explotación de una vulnerabilidad de Buffer Overflow en un binario SUID. Para comprometer esta máquina se necesitan conocimientos avanzados de explotación web, criptografía y explotación de binarios. En este write-up se utiliza un script en Python para efectuar un Bit Flipper Attack y un script en Ruby para SQLi</description></item><item><title>Driver</title><link>https://7rocky.github.io/htb/driver/</link><pubDate>Sat, 26 Feb 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/driver/</guid><description>Hack The Box. Windows. Máquina fácil. Esta máquina tiene una página web configurada con credenciales por defecto y una subida de archivos. Aquí podemos subir un archivo SCF para capturar el hash NTLMv2 del usuario y romperlo. Luego podemos explotar PrintNightmare. Para comprometer esta máquina se necesitan conocimientos básicos de explotación en Windows</description></item></channel></rss>