<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Insecure-Deserialization on Blog de 7Rocky. Ciberseguridad y Mates</title><link>https://7rocky.github.io/tags/insecure-deserialization/</link><description>Recent content in Insecure-Deserialization on Blog de 7Rocky. Ciberseguridad y Mates</description><generator>Hugo -- gohugo.io</generator><language>es</language><lastBuildDate>Tue, 09 Apr 2024 11:58:38 +0200</lastBuildDate><atom:link href="https://7rocky.github.io/tags/insecure-deserialization/index.xml" rel="self" type="application/rss+xml"/><item><title>RegistryTwo</title><link>https://7rocky.github.io/htb/registrytwo/</link><pubDate>Sat, 03 Feb 2024 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/registrytwo/</guid><description>Hack The Box. Linux. Máquina insana. Esta máquina expone una aplicación web que permite crear dominios personalizados con código HTML. Además, hay un registro de Docker expuesto en el que podemos descargar &lt;em>blobs&lt;/em> de imágenes de Docker después de obtener un &lt;em>token&lt;/em> JWT adecuado. La aplicación web ejecuta un archivo WAR con Tomcat, podemos descompilarlo y ver que consulta un servidor RMI. Dado que Tomcat está detrás de un &lt;em>proxy&lt;/em> inverso de nginx, podemos acceder a algunos &lt;em>servlets&lt;/em> sensibles de Tomcat para modificar nuestra sesión y establecer permisos de administrador en la aplicación web. Necesitamos esto para modificar la configuración de RMI utilizando una vulnerabilidad de asignación en masa y apuntar el servidor RMI a nosotros. Después de eso, podemos explotar una vulnerabilidad de deserialización insegura en Java para obtener RCE en un contenedor. Luego, podemos interactuar con el servidor RMI legítimo utilizando un reenvío de puertos. Este servidor nos permite leer archivos arbitrarios con un ataque de navegación de directorios. Podemos encontrar una contraseña en texto claro para el usuario &lt;code>developer&lt;/code>, que se reutiliza en SSH. Luego, &lt;code>root&lt;/code> ejecuta un archivo JAR para analizar archivos del sitio web de &lt;em>hosting&lt;/em> enviándolos a un servidor ClamAV. El problema aquí es que el JAR llama a las funciones del registro RMI, que se reinicia periódicamente. Por lo tanto, podemos elaborar un registro de RMI malicioso y una explotación para ganar una condición de carrera y ocupar el puerto, de modo que &lt;code>root&lt;/code> consulte nuestro servidor ClamAV falso. El resultado será que todos los archivos en &lt;code>/root&lt;/code> se pondrán en cuarentena dentro de un directorio legible, lo cual conduce a la escalada de privilegios</description></item><item><title>Bagel</title><link>https://7rocky.github.io/htb/bagel/</link><pubDate>Sat, 03 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/bagel/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web que es vulnerable a lectura de archivos locales. Con esto, podemos leer el código fuente de la aplicación web y ver que hay un servidor WebSocket que usa C# .NET con una DLL para procesar los mensajes. Podemos descargar y aplicar ingeniería inversa a la DLL para leer el código fuente en C#. El programa deserializa los datos JSON y hay un fallo que nos permite reutilizar una clase del código para leer archivos arbitrarios del servidor. Con esto, podemos leer la clave privada de SSH de un usuario y luego cambiar a otro usuario con una contraseña que también aparecía en la DLL. Este usuario puede ejecutar &lt;code>dotnet&lt;/code> con &lt;code>sudo&lt;/code>, que puede usarse para escalar privilegios</description></item><item><title>Precious</title><link>https://7rocky.github.io/htb/precious/</link><pubDate>Sat, 20 May 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/precious/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una aplicación web que utiliza una herramienta para crear documentos PDF que es vulnerable a inyección de comandos, lo que conduce a ejecución remota de comandos (RCE). Luego, podemos encontrar credenciales en texto claro para cambiar a otro usuario. Y este usuario tiene permisos de &lt;code>sudo&lt;/code> para ejecutar un &lt;em>script&lt;/em> en Ruby que es vulnerable a deserialización insegura en YAML, que puede usarse para ejecutar comandos como &lt;code>root&lt;/code></description></item><item><title>BroScience</title><link>https://7rocky.github.io/htb/broscience/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/broscience/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web vulnerable a lectura de archivos locales que se puede usar para leer código PHP y encontrar una manera de activar una nueva cuenta. Luego, podemos usar un ataque de deserialización en PHP para obtener RCE. Después de eso, encontramos el &lt;em>hash&lt;/em> de una contraseña en la base de datos que puede ser descifrada y reutilizada en el sistema. Finalmente, hay una tarea Cron ejecutada por &lt;code>root&lt;/code> para renovar certificados de OpenSSL y el &lt;em>script&lt;/em> presenta una vulnerabilidad de inyección de comandos, lo que conduce a la escalada de privilegios</description></item><item><title>Pandora</title><link>https://7rocky.github.io/htb/pandora/</link><pubDate>Sat, 21 May 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/pandora/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina expone información sensible por SNMP que permite acceder a la máquina. Luego, encontramos una instancia local de Pandora FMS que tiene varias vulnerabilidades y pueden ser explotadas para conseguir RCE como otro usuario. Este usuario puede ejecutar un binario SUID que es vulnerable a PATH hijacking, pero el ataque tiene que ser realizado desde una sesión de SSH. Para comprometer esta máquina se necesitan habilidades de enumeración y pentesting básicas</description></item><item><title>NodeBlog</title><link>https://7rocky.github.io/htb/nodeblog/</link><pubDate>Mon, 10 Jan 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/nodeblog/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene un blog que es vulnerable a inyección NoSQL, luego a inyección de Entidades Externas XML (XXE) y finalmente a deserialización insegura para obtener ejecución remota de comandos. Para comprometer esta máquina se necesitan técnicas avanzadas de explotación web y habilidades de programación. En este write-up se utilizan scripts en Bash, Python y Node.js para explotar todas las vulnerabilidades</description></item><item><title>LogForge</title><link>https://7rocky.github.io/htb/logforge/</link><pubDate>Fri, 03 Dec 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/logforge/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina utiliza Log4j en un servidor Tomcat que es vulnerable a búsqueda JNDI. Luego hay un servidor FTP hecho en Java que también utiliza Log4j, pero esta vez solamente es vulnerable a exposición de información. Para comprometer esta máquina se necesitan conocimientos sobre Log4j, Tomcat, FTP y Wireshark</description></item><item><title>Monitors</title><link>https://7rocky.github.io/htb/monitors/</link><pubDate>Sat, 09 Oct 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/monitors/</guid><description>Hack The Box. Linux. Máquina difícil. Esta máquina contiene una página web de WordPress con un plugin vulnerable a navegación de directorios, otra página web vulnerable a inyección de código SQL y otra más vulnerable a deserialización insegura dentro de un contenedor de Docker con capabilities habilitadas. Para comprometer la máquina se necesitan conocimientos avanzados de enumeración web, vulnerabilidades y técnicas de explotación, además de técnicas de reenvío de puertos y para escapar de Docker. En este write-up se utiliza un script en Bash personalizado para explotar la deserialización insegura</description></item></channel></rss>