<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Directory-Path-Traversal on Blog de 7Rocky. Ciberseguridad y Mates</title><link>https://7rocky.github.io/tags/directory-path-traversal/</link><description>Recent content in Directory-Path-Traversal on Blog de 7Rocky. Ciberseguridad y Mates</description><generator>Hugo</generator><language>es</language><lastBuildDate>Tue, 09 Apr 2024 11:58:38 +0200</lastBuildDate><atom:link href="https://7rocky.github.io/tags/directory-path-traversal/index.xml" rel="self" type="application/rss+xml"/><item><title>RegistryTwo</title><link>https://7rocky.github.io/htb/registrytwo/</link><pubDate>Sat, 03 Feb 2024 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/registrytwo/</guid><description>Hack The Box. Linux. Máquina insana. Esta máquina expone una aplicación web que permite crear dominios personalizados con código HTML. Además, hay un registro de Docker expuesto en el que podemos descargar &lt;em>blobs&lt;/em> de imágenes de Docker después de obtener un &lt;em>token&lt;/em> JWT adecuado. La aplicación web ejecuta un archivo WAR con Tomcat, podemos descompilarlo y ver que consulta un servidor RMI. Dado que Tomcat está detrás de un &lt;em>proxy&lt;/em> inverso de nginx, podemos acceder a algunos &lt;em>servlets&lt;/em> sensibles de Tomcat para modificar nuestra sesión y establecer permisos de administrador en la aplicación web. Necesitamos esto para modificar la configuración de RMI utilizando una vulnerabilidad de asignación en masa y apuntar el servidor RMI a nosotros. Después de eso, podemos explotar una vulnerabilidad de deserialización insegura en Java para obtener RCE en un contenedor. Luego, podemos interactuar con el servidor RMI legítimo utilizando un reenvío de puertos. Este servidor nos permite leer archivos arbitrarios con un ataque de navegación de directorios. Podemos encontrar una contraseña en texto claro para el usuario &lt;code>developer&lt;/code>, que se reutiliza en SSH. Luego, &lt;code>root&lt;/code> ejecuta un archivo JAR para analizar archivos del sitio web de &lt;em>hosting&lt;/em> enviándolos a un servidor ClamAV. El problema aquí es que el JAR llama a las funciones del registro RMI, que se reinicia periódicamente. Por lo tanto, podemos elaborar un registro de RMI malicioso y una explotación para ganar una condición de carrera y ocupar el puerto, de modo que &lt;code>root&lt;/code> consulte nuestro servidor ClamAV falso. El resultado será que todos los archivos en &lt;code>/root&lt;/code> se pondrán en cuarentena dentro de un directorio legible, lo cual conduce a la escalada de privilegios</description></item><item><title>MonitorsTwo</title><link>https://7rocky.github.io/htb/monitorstwo/</link><pubDate>Sat, 02 Sep 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/monitorstwo/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene un servicio Cacti que es vulnerable a ejecución remota de comandos sin autenticación que otorga acceso a un contenedor de Docker. Aquí podemos encontrar credenciales en la base de datos y reutilizarlas para SSH en la máquina &lt;em>host&lt;/em>. Luego, descubrimos que la versión de Docker es vulnerable a un CVE. Para explotar esto, necesitamos ser &lt;code>root&lt;/code> en el contenedor y configurar un binario SUID para ejecutarlo desde la máquina &lt;em>host&lt;/em> mediante navegación de directorios para escalar privilegios</description></item><item><title>Stocker</title><link>https://7rocky.github.io/htb/stocker/</link><pubDate>Sat, 24 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/stocker/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una página web vulnerable a inyección NoSQL. Mediante esta vulnerabilidad, podemos saltarnos la autenticación. Luego, tenemos una funcionalidad para convertir un texto HTML en PDF, siendo capaces de realizar un ataque XSS del lado servidor para leer archivos del servidor, como el código fuente. Después encontramos una contraseña en texto claro que se reutiliza en SSH. Finalmente, un usuario puede ejecutar &lt;em>scripts&lt;/em> en Node.js con &lt;code>sudo&lt;/code> en una ruta que tiene un &lt;em>wildcard&lt;/em>. Para escalar privilegios hay que abusar de este &lt;em>wildcard&lt;/em></description></item><item><title>Bagel</title><link>https://7rocky.github.io/htb/bagel/</link><pubDate>Sat, 03 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/bagel/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web que es vulnerable a lectura de archivos locales. Con esto, podemos leer el código fuente de la aplicación web y ver que hay un servidor WebSocket que usa C# .NET con una DLL para procesar los mensajes. Podemos descargar y aplicar ingeniería inversa a la DLL para leer el código fuente en C#. El programa deserializa los datos JSON y hay un fallo que nos permite reutilizar una clase del código para leer archivos arbitrarios del servidor. Con esto, podemos leer la clave privada de SSH de un usuario y luego cambiar a otro usuario con una contraseña que también aparecía en la DLL. Este usuario puede ejecutar &lt;code>dotnet&lt;/code> con &lt;code>sudo&lt;/code>, que puede usarse para escalar privilegios</description></item><item><title>BroScience</title><link>https://7rocky.github.io/htb/broscience/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/broscience/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web vulnerable a lectura de archivos locales que se puede usar para leer código PHP y encontrar una manera de activar una nueva cuenta. Luego, podemos usar un ataque de deserialización en PHP para obtener RCE. Después de eso, encontramos el &lt;em>hash&lt;/em> de una contraseña en la base de datos que puede ser descifrada y reutilizada en el sistema. Finalmente, hay una tarea Cron ejecutada por &lt;code>root&lt;/code> para renovar certificados de OpenSSL y el &lt;em>script&lt;/em> presenta una vulnerabilidad de inyección de comandos, lo que conduce a la escalada de privilegios</description></item><item><title>Awkward</title><link>https://7rocky.github.io/htb/awkward/</link><pubDate>Sat, 25 Feb 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/awkward/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web en Vue.js que expone un formulario de inicio de sesión que se puede saltar fácilmente. Luego encontramos una API que prueba la conectividad de otros sitios web, que puede explotarse utilizando &lt;em>Server-Side Request Forgery&lt;/em> para encontrar la documentación de la API. Allí tenemos código Node.js para analizar y ver cómo podemos saltar algunas validaciones para obtener información de los usuarios y romper el &lt;em>hash&lt;/em> de una contraseña. Después de eso, podemos iniciar sesión, obtener un &lt;em>token&lt;/em> JWT válido y romperlo para encontrar el secreto. Por lo tanto, podemos crear cualquier &lt;em>token&lt;/em> JWT, lo que significa que podemos inyectar cualquier &lt;em>payload&lt;/em> como información del &lt;em>token&lt;/em>. Usando este poder, podemos leer archivos arbitrarios del servidor explotando &lt;code>awk&lt;/code> y encontrar credenciales en texto claro dentro de un archivo comprimido. A continuación, podemos acceder por SSH y encontrar otro sitio web construido en PHP con dos vulnerabilidades. También hay una tarea Cron que toma información de un archivo CSV para enviar un correo electrónico. La clave aquí es inyectar un parámetro malicioso en el archivo CSV para que el comando &lt;code>mail&lt;/code> ejecute un &lt;em>script&lt;/em> malicioso, que lleva a la escalada de privilegios</description></item><item><title>Ambassador</title><link>https://7rocky.github.io/htb/ambassador/</link><pubDate>Sat, 28 Jan 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/ambassador/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una instancia de Grafana que es vulnerable a &lt;em>Directory Path Traversal&lt;/em> sin autenticación. Así, podemos leer archivos del servidor y encontrar la contraseña para Grafana y para MySQL. Después de eso, podemos conectarnos a MySQL, que está expuesto, y encontrar otra contraseña para acceder a través de SSH. La máquina ejecuta &lt;code>consul&lt;/code> internamente con una configuración vulnerable. Después de encontrar un &lt;em>token&lt;/em> de autenticación en un repositorio de Git, podemos usar un &lt;em>exploit&lt;/em> para obtener RCE en &lt;code>consul&lt;/code> y ganar acceso como &lt;code>root&lt;/code></description></item><item><title>RedPanda</title><link>https://7rocky.github.io/htb/redpanda/</link><pubDate>Sat, 26 Nov 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/redpanda/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una aplicación web hecha con Spring Boot que es vulnerable a Server-Side Template Injection con un formato particular. Luego, para escalar privilegios, es necesario analizar un programa en Java, añadir metadatos maliciosos a una imagen JPEG, añadir una Entidad Externa XML en un archivo XML controlado, romper la lógica de un analizador de logs y finalmente esperar a que root procese el archivo XML para leer su clave privada de SSH</description></item><item><title>Trick</title><link>https://7rocky.github.io/htb/trick/</link><pubDate>Sat, 29 Oct 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/trick/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene un servicio DNS que es vulnerable a un ataque de transferencia de zona que fuga un subdominio. Aquí podemos saltarnos la autenticación con SQLi y explotar un LFI. Con ambas vulnerabilidades encadenadas podemos acceder a la máquina. Luego, podemos encontrar otro subdominio que de nuevo es vulnerable a LFI, y con este obtenemos la clave privada de SSH de un usuario. Este usuario puede reiniciar fail2ban con sudo y modificar archivos de configuración</description></item><item><title>Faculty</title><link>https://7rocky.github.io/htb/faculty/</link><pubDate>Sat, 22 Oct 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/faculty/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una página web vulnerable a SQLi y salto de autenticación que lleva a otra página en la que podemos exportar contenido HTML a PDF. Existe una vulnerabilidad en la que podemos adjuntar archivos locales al fichero PDF y leer una contraseña reutilizada para SSH. Mediante sudo podemos ejecutar un script en Node.js como otro usuario y explotar una inyección de comandos. Este segundo usuario puede ejecutar GDB y además GDB tiene la capability cap_sys_ptrace activada, por lo que podemos depurar un proceso en ejecución por root y ejecutar código arbitrario</description></item><item><title>OpenSource</title><link>https://7rocky.github.io/htb/opensource/</link><pubDate>Sat, 08 Oct 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/opensource/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una página web que expone su código fuente, siendo vulnerable a Directory Path Traversal. Con esta vulnerabilidad podemos leer los archivos necesarios para calcular el PIN de la consola de depuración de Flask y obtener ejecución remota de comandos en un contenedor Docker. Después, se necesita usar un reenvío de puertos para ver una instancia de Gitea y acceder con credenciales que se encuentran en un repositorio de Git. Aquí podemos ver la clave privada de SSH de un usuario de sistema. Existe una tarea Cron que confirma nuevos cambios de un repositorio Git que lleva a escalada de privilegios</description></item><item><title>Scanned</title><link>https://7rocky.github.io/htb/scanned/</link><pubDate>Sat, 10 Sep 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/scanned/</guid><description>Hack The Box. Linux. Máquina insana. Esta máquina tiene una página web que es capaz de analizar malware. Al analizar el código en C del sandbox, se ve que se puede utilizar un archivo de log para exfiltrar información por medio del servidor web, y también abusar de una mala configuración para escapar de chroot. Luego, podemos leer una base de datos SQLite y extraer el hash de una contraseña, que se reutiliza para SSH. Una vez en la máquina, se puede ejecutar un binario SUID desde la sandbox y copiar una librería compartida maliciosa para que el binario SUID ejecute Bash como root. Para comprometer esta máquina se necesitan conocimientos avanzados de Linux, programación en C y Bash, experiencia en auditoría de código y técnicas de evasión. En este write-up se utiliza un script en Bash con un programa en C embebido para listar directorios y leer archivos del servidor y también un programa en Go para romper el hash de una contraseña</description></item><item><title>Retired</title><link>https://7rocky.github.io/htb/retired/</link><pubDate>Sat, 13 Aug 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/retired/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene una página web en PHP que es vulnerable a navegación de directorios. Aquí encontramos un archivo PHP que espera que se suba un archivo para pasarlo a un servidor de sockets en local. Somos capaces de enumerar procesos y descargar el binario que ejecuta el servidor y ver que es vulnerable a Buffer Overflow. Una vez explotado, podemos pivotar a un usuario usando enlaces simbólicos. Y luego, se nos permite añadir formatos ejecutables personalizados, que puede ser explotado para convertirnos en root. Para comprometer esta máquina se necesitan técnicas sólidas de explotación de binarios y conceptos de Linux. En este write-up se utilizan exploits personalizados en Python para la intrusión</description></item><item><title>OverGraph</title><link>https://7rocky.github.io/htb/overgraph/</link><pubDate>Sat, 06 Aug 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/overgraph/</guid><description>Hack The Box. Linux. Máquina difícil. Esta máquina tiene una página web que es vulnerable a Open Redirect, una aplicación web hecha en AngularJS vulnerable a Client-Side Template Injection y XSS, y una implementación de GraphQL. Somos capaces de registrar una nueva cuenta al saltarnos un código OTP mediante una inyección NoSQL. Luego, podemos realizar un ataque de CSRF abusando del Open Redirect para inyectar un payload de XSS en el perfil de la víctima para obtener su adminToken, que está guardado en localStorage. Después, podemos subir archivos de video que serán procesados por ffmpeg y explotar un Server-Side Request Forgery que nos permite leer archivos del servidor. Finalmente, ganaremos acceso a la máquina como un usuario y podemos encontrar un binario está en ejecución como root. Después de analizarlo, podemos obtener un token válido para usar el programa y exploitar una vulnerabilidad para escribir datos arbitrarios en una dirección arbitraria, derivando en RCE o permisos de lectura como root</description></item><item><title>Unicode</title><link>https://7rocky.github.io/htb/unicode/</link><pubDate>Sat, 07 May 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/unicode/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina utiliza tokens JWT con JWKS y JKU que pueden ser falsificados para llegar a una vulnerabilidad de navegación de directorios que puede ser explotada mediante caracteres Unicode. Después, existe un binario compilado con Python que puede ejecutarse con sudo y usa curl por detrás. Para comprometer esta máquina se necesitan conocimientos sobre JWT y técnicas de bypassing para navegación de directorios e inyección de comandos. En este write-up se utiliza un script en Python para explotar la navegación de directorios usando JWT y JWKS</description></item><item><title>Backdoor</title><link>https://7rocky.github.io/htb/backdoor/</link><pubDate>Sat, 23 Apr 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/backdoor/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene una página web de WordPress que tiene un plugin vulnerable a navegación de directorios, que se puede utilizar para enumerar procesos en ejecución, y después un binario SUID. Para comprometer esta máquina es necesario tener conocimientos sobre WordPress y experiencia con vulnerabilidades de inclusión de archivos. En este write-up se utiliza un script de Python personalizado para leer archivos del servidor y un exploit público propio para ganar acceso a la máquina</description></item><item><title>Devzat</title><link>https://7rocky.github.io/htb/devzat/</link><pubDate>Sat, 12 Mar 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/devzat/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina contiene un servicio de chat sobre SSH y un subdominio web oculto vulnerable a inyección de comandos. Luego, podemos acceder a la máquina y explotar una versión vulnerable de InfluxDB para extraer la contraseña de otro usuario. Este usuario tiene permisos para ver un proyecto en desarrollo del chat de SSH que permite leer archivos arbitrarios del servidor. Para comprometer esta máquina se necesitan conocimientos básicos de explotación web y enumeración en Linux</description></item><item><title>Hancliffe</title><link>https://7rocky.github.io/htb/hancliffe/</link><pubDate>Sat, 05 Mar 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/hancliffe/</guid><description>Hack The Box. Windows. Máquina difícil. Esta máquina tiene una página web que esconde una aplicación Nuxeo en Java vulnerable a SSTI después de romper la lógica de nginx. Luego accedemos a la máquina y encontramos una aplicación con un exploit público para acceder como otro usuario. Después, extraemos credenciales de Firefox y usamos un generador de contraseñas para acceder como otro usuario y encontrar un ejecutable de Windows. Después de hacer ingeniería inversa para obtener las credenciales esperadas, encontramos una vulnerabilidad de Buffer Overflow que necesita ser explotada mediante Socket Reuse para acceder como Administrator</description></item><item><title>Pikaboo</title><link>https://7rocky.github.io/htb/pikaboo/</link><pubDate>Sat, 04 Dec 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/pikaboo/</guid><description>Hack The Box. Linux. Máquina difícil. Esta máquina utiliza nginx y Apache como servidores web con una mala configuración que deriva en navegación de directorios y posteriormente en inclusión de archivos locales. Existen credenciales de FTP en LDAP y una tarea Cron que es vulnerable a inyección de comandos. Para comprometer esta máquina se necesita enumeración web, conocimiento sobre nginx y LDAP, técnicas de explotación de inclusión de archivos y trucos de inyección de comandos. En este write-up se utiliza un script en Python personalizado para comprometer la máquina desde cero</description></item><item><title>LogForge</title><link>https://7rocky.github.io/htb/logforge/</link><pubDate>Fri, 03 Dec 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/logforge/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina utiliza Log4j en un servidor Tomcat que es vulnerable a búsqueda JNDI. Luego hay un servidor FTP hecho en Java que también utiliza Log4j, pero esta vez solamente es vulnerable a exposición de información. Para comprometer esta máquina se necesitan conocimientos sobre Log4j, Tomcat, FTP y Wireshark</description></item><item><title>Seal</title><link>https://7rocky.github.io/htb/seal/</link><pubDate>Sat, 13 Nov 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/seal/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina contiene una página web de Tomcat montada sobre nginx, lo cual es una configuración vulnerable que desemboca en ejecución remota de comandos (RCE), y también tiene malas configuraciones de permisos en archivos y comandos con sudo. Para comprometer esta máquina se necesitan conocimientos sobre explotación de Tomcat y el sistema de archivos de Linux</description></item><item><title>Monitors</title><link>https://7rocky.github.io/htb/monitors/</link><pubDate>Sat, 09 Oct 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/monitors/</guid><description>Hack The Box. Linux. Máquina difícil. Esta máquina contiene una página web de WordPress con un plugin vulnerable a navegación de directorios, otra página web vulnerable a inyección de código SQL y otra más vulnerable a deserialización insegura dentro de un contenedor de Docker con capabilities habilitadas. Para comprometer la máquina se necesitan conocimientos avanzados de enumeración web, vulnerabilidades y técnicas de explotación, además de técnicas de reenvío de puertos y para escapar de Docker. En este write-up se utiliza un script en Bash personalizado para explotar la deserialización insegura</description></item><item><title>Rope</title><link>https://7rocky.github.io/htb/rope/</link><pubDate>Sat, 23 May 2020 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/rope/</guid><description>Hack The Box. Linux. Máquina insana. Esta máquina expone un servidor web que es vulnerable a navegación de directorios, por lo que podemos leer archivos y descubrir que se trata de un archivo binario. Después de analizar el binario, descubrimos que tiene una vulnerabilidad de Format String que puede ser explotada para conseguir RCE como john. Este usuario puede ejecutar otro binario como el usuario r4j. Este binario utiliza una librería externa que podemos modificar debido a los permisos que tiene y ganar acceso como r4j. Finalmente, existe otro binario que ejecuta un servidor de sockets en local, podemos acceder al binario y analizarlo para encontrar una vulnerabilidad de Buffer Overflow. El binario tiene todas las protecciones activas, pero sigue siendo explotable para conseguir RCE como root</description></item></channel></rss>