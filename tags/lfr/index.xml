<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>lfr on Blog de 7Rocky. Ciberseguridad y Mates</title><link>https://7rocky.github.io/tags/lfr/</link><description>Recent content in lfr on Blog de 7Rocky. Ciberseguridad y Mates</description><generator>Hugo -- gohugo.io</generator><language>es</language><lastBuildDate>Sat, 03 Feb 2024 00:00:00 +0100</lastBuildDate><atom:link href="https://7rocky.github.io/tags/lfr/index.xml" rel="self" type="application/rss+xml"/><item><title>RegistryTwo</title><link>https://7rocky.github.io/htb/registrytwo/</link><pubDate>Sat, 03 Feb 2024 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/registrytwo/</guid><description>Hack The Box. Linux. Máquina insana. Esta máquina expone una aplicación web que permite crear dominios personalizados con código HTML. Además, hay un registro de Docker expuesto en el que podemos descargar &lt;em>blobs&lt;/em> de imágenes de Docker después de obtener un &lt;em>token&lt;/em> JWT adecuado. La aplicación web ejecuta un archivo War con Tomcat, podemos descompilarlo y ver que consulta un servidor RMI. Dado que Tomcat está detrás de un &lt;em>proxy&lt;/em> inverso de nginx, podemos acceder a algunos &lt;em>servlets&lt;/em> sensibles de Tomcat para modificar nuestra sesión y establecer permisos de administrador en la aplicación web. Necesitamos esto para modificar la configuración de RMI utilizando una vulnerabilidad de asignación en masa y apuntar el servidor RMI a nosotros. Después de eso, podemos explotar una vulnerabilidad de deserialización insegura en Java para obtener RCE en un contenedor. Luego, podemos interactuar con el servidor RMI legítimo utilizando un reenvío de puertos. Este servidor nos permite leer archivos arbitrarios con un ataque de navegación de directorios. Podemos encontrar una contraseña en texto claro para el usuario &lt;code>developer&lt;/code>, que se reutiliza en SSH. Luego, &lt;code>root&lt;/code> ejecuta un archivo JAR para analizar archivos del sitio web de &lt;em>hosting&lt;/em> enviándolos a un servidor ClamAV. El problema aquí es que el JAR llama a las funciones del registro RMI, que se reinicia periódicamente. Por lo tanto, podemos elaborar un registro de RMI malicioso y una explotación para ganar una condición de carrera y ocupar el puerto, de modo que &lt;code>root&lt;/code> consulte nuestro servidor ClamAV falso. El resultado será que todos los archivos en &lt;code>/root&lt;/code> se pondrán en cuarentena dentro de un directorio legible, lo cual conduce a la escalada de privilegios</description></item><item><title>Pilgrimage</title><link>https://7rocky.github.io/htb/pilgrimage/</link><pubDate>Sat, 25 Nov 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/pilgrimage/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene un sitio web que expone un repositorio de Git. Podemos extraer el código fuente en PHP de la aplicación web y descubrir que usa ImageMagick por detrás para procesar imágenes subidas. La versión de ImageMagick tiene una vulnerabilidad de lectura de archivos locales que se puede usar para leer un archivo de base de datos SQLite y encontrar una contraseña en texto claro para &lt;code>emily&lt;/code>, que también se usa en SSH. Después de eso, encontramos que &lt;code>root&lt;/code> ejecuta un &lt;em>script&lt;/em> en Bash que usa &lt;code>binwalk&lt;/code> para eliminar &lt;em>malware&lt;/em> de los archivos de imagen subidos. La versión de &lt;code>binwalk&lt;/code> es vulnerable a ejecución remota de comandos, lo que conduce a la escalada de privilegios</description></item><item><title>Topology</title><link>https://7rocky.github.io/htb/topology/</link><pubDate>Sat, 04 Nov 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/topology/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina contiene un sitio web que permite generar ecuaciones con LaTeX. Con esta funcionalidad podemos leer archivos arbitrarios del servidor con técnicas de inyección de LaTeX y encontrar un el &lt;em>hash&lt;/em> de una contraseña para otro subdominio. Esta contraseña se reutiliza en SSH. Después de eso, &lt;code>root&lt;/code> está ejecutando scripts con &lt;code>gnuplot&lt;/code> periódicamente, lo que lleva a la escalada de privilegios</description></item><item><title>Stocker</title><link>https://7rocky.github.io/htb/stocker/</link><pubDate>Sat, 24 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/stocker/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene una página web vulnerable a inyección NoSQL. Mediante esta vulnerabilidad, podemos saltarnos la autenticación. Luego, tenemos una funcionalidad para convertir un texto HTML en PDF, siendo capaces de realizar un ataque XSS del lado servidor para leer archivos del servidor, como el código fuente. Después encontramos una contraseña en texto claro que se reutiliza en SSH. Finalmente, un usuario puede ejecutar &lt;em>scripts&lt;/em> en Node.js con &lt;code>sudo&lt;/code> en una ruta que tiene un &lt;em>wildcard&lt;/em>. Para escalar privilegios hay que abusar de este &lt;em>wildcard&lt;/em></description></item><item><title>Bagel</title><link>https://7rocky.github.io/htb/bagel/</link><pubDate>Sat, 03 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/bagel/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web que es vulnerable a lectura de archivos locales. Con esto, podemos leer el código fuente de la aplicación web y ver que hay un servidor WebSocket que usa C# .NET con una DLL para procesar los mensajes. Podemos descargar y aplicar ingeniería inversa a la DLL para leer el código fuente en C#. El programa deserializa los datos JSON y hay un fallo que nos permite reutilizar una clase del código para leer archivos arbitrarios del servidor. Con esto, podemos leer la clave privada de SSH de un usuario y luego cambiar a otro usuario con una contraseña que también aparecía en la DLL. Este usuario puede ejecutar &lt;code>dotnet&lt;/code> con &lt;code>sudo&lt;/code>, que puede usarse para escalar privilegios</description></item><item><title>MetaTwo</title><link>https://7rocky.github.io/htb/metatwo/</link><pubDate>Sat, 29 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/metatwo/</guid><description>Hack The Box. Linux. Máquina fácil. Esta máquina tiene un sitio web de WordPress que utiliza un &lt;em>plugin&lt;/em> vulnerable a SQLi. Con este ataque podemos obtener &lt;em>hashes&lt;/em> de contraseñas y romper uno de ellos para obtener acceso al &lt;em>dashboard&lt;/em> de WordPress. La versión de WordPress es vulnerable a &lt;em>out-of-band&lt;/em> XXE utilizando un archivo WAV que permite leer archivos del servidor. Usando esta vulnerabilidad, podemos encontrar credenciales en texto claro para FTP. En este servicio tenemos otro archivo PHP con más credenciales en texto claro que son válidas para SSH. Una vez dentro de la máquina, encontramos algunas claves y mensajes PGP que se pueden descifrar para encontrar la contraseña de &lt;code>root&lt;/code></description></item><item><title>BroScience</title><link>https://7rocky.github.io/htb/broscience/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/broscience/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web vulnerable a lectura de archivos locales que se puede usar para leer código PHP y encontrar una manera de activar una nueva cuenta. Luego, podemos usar un ataque de deserialización en PHP para obtener RCE. Después de eso, encontramos el &lt;em>hash&lt;/em> de una contraseña en la base de datos que puede ser descifrada y reutilizada en el sistema. Finalmente, hay una tarea Cron ejecutada por &lt;code>root&lt;/code> para renovar certificados de OpenSSL y el &lt;em>script&lt;/em> presenta una vulnerabilidad de inyección de comandos, lo que conduce a la escalada de privilegios</description></item><item><title>Awkward</title><link>https://7rocky.github.io/htb/awkward/</link><pubDate>Sat, 25 Feb 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/htb/awkward/</guid><description>Hack The Box. Linux. Máquina media. Esta máquina tiene un sitio web en Vue.js que expone un formulario de inicio de sesión que se puede saltar fácilmente. Luego encontramos una API que prueba la conectividad de otros sitios web, que puede explotarse utilizando &lt;em>Server-Side Request Forgery&lt;/em> para encontrar la documentación de la API. Allí tenemos código Node.js para analizar y ver cómo podemos saltar algunas validaciones para obtener información de los usuarios y romper el &lt;em>hash&lt;/em> de una contraseña. Después de eso, podemos iniciar sesión, obtener un &lt;em>token&lt;/em> JWT válido y romperlo para encontrar el secreto. Por lo tanto, podemos crear cualquier &lt;em>token&lt;/em> JWT, lo que significa que podemos inyectar cualquier &lt;em>payload&lt;/em> como información del &lt;em>token&lt;/em>. Usando este poder, podemos leer archivos arbitrarios del servidor explotando &lt;code>awk&lt;/code> y encontrar credenciales en texto claro dentro de un archivo comprimido. A continuación, podemos acceder por SSH y encontrar otro sitio web construido en PHP con dos vulnerabilidades. También hay una tarea Cron que toma información de un archivo CSV para enviar un correo electrónico. La clave aquí es inyectar un parámetro malicioso en el archivo CSV para que el comando &lt;code>mail&lt;/code> ejecute un &lt;em>script&lt;/em> malicioso, que lleva a la escalada de privilegios</description></item></channel></rss>