<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Forensics on Blog de 7Rocky. Ciberseguridad y Mates</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/</link><description>Recent content in Forensics on Blog de 7Rocky. Ciberseguridad y Mates</description><generator>Hugo -- gohugo.io</generator><language>es</language><atom:link href="https://7rocky.github.io/ctf/htb-challenges/forensics/index.xml" rel="self" type="application/rss+xml"/><item><title>Chase</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/chase/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/chase/</guid><description>Se nos proporciona un archivo PCAP con mensajes HTTP y segmentos TCP:
Si filtramos por el protocolo HTTP, veremos algunas peticiones y respuestas:
Podríamos pensar que el cibercriminal encontró una vulnerabilidad de subida de archivo y subió un cmd.aspx y luego nc64.exe para ejecutar comandos. De hecho, podemos ver que el cibercriminal consiguió una reverse shell en la máquina Windows:
Al final de la captura PCAP, vemos que el cibercriminal intenta acceder a un archivo llamado JBKEE62NIFXF6ODMOUZV6NZTMFGV6URQMNMH2IBA.</description></item><item><title>Deadly Arthropod</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/deadly-arthropod/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/deadly-arthropod/</guid><description>Se nos proporciona un archivo PCAP llamado deadly_arthropod.pcap con algunos eventos USB:
Identificando el dispositivo Hay un evento que muestra que el dispositivo USB es un teclado (concretamente, Razer BlackWidow Ultimate 2013):
Por lo tanto, necesitaremos analizar las pulsaciones de teclas, como en Logger. Los dispositivos de hardware utilizan un protocolo conocido como Human Interface Device (HID). Se puede encontrar más información en Wikipedia. De hecho, hay un manual de documentación adjunto: ww.</description></item><item><title>Downgrade</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/downgrade/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/downgrade/</guid><description>Se nos proporcionan un montón de logs de Eventos de Windows (archivos .evtx):
$ tree Logs Logs ├── Application.evtx ├── HardwareEvents.evtx ├── Internet Explorer.evtx ├── Key Management Service.evtx ├── Microsoft-Windows-AppModel-Runtime%4Admin.evtx ├── Microsoft-Windows-AppReadiness%4Admin.evtx ├── Microsoft-Windows-AppReadiness%4Operational.evtx ├── Microsoft-Windows-AppXDeployment%4Operational.evtx ├── Microsoft-Windows-AppXDeploymentServer%4Operational.evtx ├── Microsoft-Windows-AppXDeploymentServer%4Restricted.evtx ├── Microsoft-Windows-ApplicationResourceManagementSystem%4Operational.evtx ├── Microsoft-Windows-Bits-Client%4Operational.evtx ├── Microsoft-Windows-CodeIntegrity%4Operational.evtx ├── Microsoft-Windows-Compat-Appraiser%4Operational.evtx ├── Microsoft-Windows-CoreApplication%4Operational.evtx ├── Microsoft-Windows-Crypto-DPAPI%4BackUpKeySvc.evtx ├── Microsoft-Windows-Crypto-DPAPI%4Operational.evtx ├── Microsoft-Windows-DSC%4Admin.evtx ├── Microsoft-Windows-DSC%4Operational.evtx ├── Microsoft-Windows-DataIntegrityScan%4Admin.evtx ├── Microsoft-Windows-DataIntegrityScan%4CrashRecovery.evtx ├── Microsoft-Windows-DeviceSetupManager%4Admin.evtx ├── Microsoft-Windows-DeviceSetupManager%4Operational.evtx ├── Microsoft-Windows-Dhcp-Client%4Admin.evtx ├── Microsoft-Windows-Dhcpv6-Client%4Admin.evtx ├── Microsoft-Windows-Diagnosis-DPS%4Operational.</description></item><item><title>Event Horizon</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/event-horizon/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/event-horizon/</guid><description>Tenemos esta descripción del reto:
Our CEO&amp;rsquo;s computer was compromised in a phishing attack. The attackers took care to clear the PowerShell logs, so we don&amp;rsquo;t know what they executed. Can you help us?
Y se nos proporcionan muchos archivos de log:
$ ls -l total 0 drwxrwxr-x 325 root root 10400 Nov 2 2020 Logs drwxrwxr-x 2 root root 64 Sep 15 2018 TraceFormat $ find . . ./Logs .</description></item><item><title>Fake News</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/fake-news/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/fake-news/</guid><description>Se nos proporciona una carpeta llamada html con muchos archivos de un servidor de WordPress:
$ ls index.php wp-activate.php wp-blogs wp-config-sample.php wp-cron.php wp-load.php wp-settings.php xmlrpc.php license.txt wp-admin wp-comments-post.php wp-config.php wp-includes wp-login.php wp-signup.php readme.html wp-blog-header.php wp-config-docker.php wp-content wp-links-opml.php wp-mail.php wp-trackback.php Inspección básica Obviamente, wp-blogs llama la atención, así que examinemos los archivos que están dentro:
$ ls wp-blogs 2022 $ ls wp-blogs/2022/ 11 $ ls wp-blogs/2022/11/ index.php style.css $ du -h wp-blogs/2022/11/* 304K wp-blogs/2022/11/index.</description></item><item><title>Free Services</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/free-services/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/free-services/</guid><description>Se nos proporciona un archivo de Microsoft Office Excel llamado free_decryption.xlsm. La m en la extensión indica que el archivo contiene macros VBA.
Extracción de macros VBA Desgraciadamente, olevba de oletools no puede extraer el código VBA:
$ olevba free_decryption.xlsm olevba 0.60.1 on Python 3.10.9 - http://decalage.info/python/oletools =============================================================================== FILE: free_decryption.xlsm Type: OpenXML No VBA or XLM macros found. Por lo tanto, tendremos que abrir el archivo (y deshabilitar las macros). Tenemos dos hojas:</description></item><item><title>Halloween Invitation</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/halloween-invitation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/halloween-invitation/</guid><description>Se nos proporciona un archivo ZIP que contiene un fichero llamado invitation.docm:
$ unzip -l Halloween\ Invitation.zip Archive: Halloween Invitation.zip Length Date Time Name --------- ---------- ----- ---- 5252634 10-12-2022 14:04 invitation.docm --------- ------- 5252634 1 file $ unzip Halloween\ Invitation.zip Archive: Halloween Invitation.zip [Halloween Invitation.zip] invitation.docm password: inflating: invitation.docm $ file invitation.docm invitation.docm: Microsoft Word 2007+ Extracción de macros VBA Esto significa que tenemos un documento de Microsoft Word con macros VBA.</description></item><item><title>Insider</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/insider/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/insider/</guid><description>Se nos proporciona una carpeta llamada Mozilla con muchos archivos de Firefox:
$ find Mozilla -type f Mozilla/Firefox/installs.ini Mozilla/Firefox/profiles.ini Mozilla/Firefox/Profiles/yodxf5e0.default/times.json Mozilla/Firefox/Profiles/2542z9mo.default-release/sessionstore-backups/recovery.baklz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/sessionstore-backups/recovery.jsonlz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/weave/failed/tabs.json Mozilla/Firefox/Profiles/2542z9mo.default-release/weave/toFetch/tabs.json Mozilla/Firefox/Profiles/2542z9mo.default-release/favicons.sqlite-shm Mozilla/Firefox/Profiles/2542z9mo.default-release/compatibility.ini Mozilla/Firefox/Profiles/2542z9mo.default-release/favicons.sqlite-wal Mozilla/Firefox/Profiles/2542z9mo.default-release/addons.json Mozilla/Firefox/Profiles/2542z9mo.default-release/logins.json Mozilla/Firefox/Profiles/2542z9mo.default-release/search.json.mozlz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/sessionCheckpoints.json Mozilla/Firefox/Profiles/2542z9mo.default-release/pkcs11.txt Mozilla/Firefox/Profiles/2542z9mo.default-release/times.json Mozilla/Firefox/Profiles/2542z9mo.default-release/extension-preferences.json Mozilla/Firefox/Profiles/2542z9mo.default-release/addonStartup.json.lz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/crashes/store.json.mozlz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/key4.db Mozilla/Firefox/Profiles/2542z9mo.default-release/webappsstore.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/protections.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/places.sqlite-wal Mozilla/Firefox/Profiles/2542z9mo.default-release/security_state/data.safe.bin Mozilla/Firefox/Profiles/2542z9mo.default-release/datareporting/state.json Mozilla/Firefox/Profiles/2542z9mo.default-release/datareporting/aborted-session-ping Mozilla/Firefox/Profiles/2542z9mo.default-release/datareporting/session-state.json Mozilla/Firefox/Profiles/2542z9mo.default-release/datareporting/archived/2020-11/1604498649754.5212ab6a-268f-4c2b-aa0b-cf46c3d1dc71.event.jsonlz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/datareporting/archived/2020-11/1604509449817.7d32a9b1-03f4-4155-8f99-ebd1cceb30d5.event.jsonlz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/datareporting/archived/2020-11/1604496849746.014e92ae-cb57-4c0e-a97c-66ffa45bfe20.new-profile.jsonlz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/datareporting/archived/2020-11/1604507415845.36b506e6-3dea-4646-8ae3-62e9fd1b4692.main.jsonlz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/broadcast-listeners.json Mozilla/Firefox/Profiles/2542z9mo.default-release/cookies.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/places.sqlite-shm Mozilla/Firefox/Profiles/2542z9mo.default-release/containers.json Mozilla/Firefox/Profiles/2542z9mo.default-release/formhistory.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/default/moz-extension+++7b958ab1-a8d2-4943-8833-5185e9a8d9d0^userContextId=4294967295/idb/3647222921wleabcEoxlt-eengsairo.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/default/moz-extension+++7b958ab1-a8d2-4943-8833-5185e9a8d9d0^userContextId=4294967295/.metadata-v2 Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/idb/3561288849sdhlie.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/idb/1451318868ntouromlalnodry--epcr.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/idb/2823318777ntouromlalnodry--naod.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/idb/1657114595AmcateirvtiSty.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/idb/2918063365piupsah.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/idb/3870112724rsegmnoittet-es.sqlite-shm Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/idb/3870112724rsegmnoittet-es.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/idb/3870112724rsegmnoittet-es.sqlite-wal Mozilla/Firefox/Profiles/2542z9mo.default-release/storage/permanent/chrome/.metadata-v2 Mozilla/Firefox/Profiles/2542z9mo.default-release/extensions.json Mozilla/Firefox/Profiles/2542z9mo.default-release/handlers.json Mozilla/Firefox/Profiles/2542z9mo.default-release/bookmarkbackups/bookmarks-2020-11-04_11_Xwf6HUY0M1+1NgBa9qQfXA==.jsonlz4 Mozilla/Firefox/Profiles/2542z9mo.default-release/content-prefs.sqlite Mozilla/Firefox/Profiles/2542z9mo.default-release/gmp-gmpopenh264/1.8.1.1/gmpopenh264.info Mozilla/Firefox/Profiles/2542z9mo.default-release/gmp-gmpopenh264/1.8.1.1/gmpopenh264.dll Mozilla/Firefox/Profiles/2542z9mo.</description></item><item><title>Logger</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/logger/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/logger/</guid><description>Se nos proporciona un archivo PCAP llamado keystrokes.pcapng con algunos eventos USB:
Identificando el dispositivo El segundo evento muestra que el dispositivo USB es un teclado:
Por lo tanto, necesitaremos analizar las pulsaciones de teclas. Los dispositivos de hardware utilizan un protocolo conocido como Human Interface Device (HID). Se puede encontrar más información en Wikipedia. De hecho, hay un manual de documentación adjunto: www.usb.org, donde se encuentran algunas tablas de HID (Sección 10: &amp;ldquo;Keyboard/Keypad Page (0x07)&amp;rdquo;):</description></item><item><title>Lure</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/lure/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/lure/</guid><description>Se nos proporciona un archivo de Microsoft Office Word llamado UrgentPayment.doc:
$ file UrgentPayment.doc UrgentPayment.doc: Composite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, Code page: 1252, Author: Ian Austin, Template: Normal.dotm, Last Saved By: egre55, Revision Number: 4, Name of Creating Application: Microsoft Office Word, Total Editing Time: 40:00, Create Time/Date: Tue Nov 3 18:07:00 2020, Last Saved Time/Date: Tue Nov 3 18:57:00 2020, Number of Pages: 1, Number of Words: 2, Number of Characters: 12, Security: 0 Extracción de macros VBA Con olevba de oletools podemos extraer el código VBA de las macros:</description></item><item><title>No Place To Hide</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/no-place-to-hide/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/no-place-to-hide/</guid><description>Se nos proporcionan estos archivos de log de una sesión RDP en Windows:
$ file Cache0000.bin Cache0000.bin: data $ file bcache24.bmc bcache24.bmc: empty $ du -h Cache0000.bin bcache24.bmc 17M Cache0000.bin 0B bcache24.bmc Y esta es la descripción del reto:
We found evidence of a password spray attack against the Domain Controller, and identified a suspicious RDP session. We&amp;rsquo;ll provide you with our RDP logs and other files. Can you see what they were up to?</description></item><item><title>POOF</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/poof/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/poof/</guid><description>Se nos proporcionan algunos archivos:
$ unzip -l POOF.zip Archive: POOF.zip Length Date Time Name ---------- ---------- ----- ---- 2567089 10-20-2022 11:12 candy_dungeon.pdf.boo 1096901984 10-20-2022 18:11 mem.dmp 7822474 10-20-2022 11:25 poof_capture.pcap 1126698 10-20-2022 12:04 Ubuntu_4.15.0-184-generic_profile.zip ---------- ------- 1108435601 4 files Y tenemos una instancia remota a la que conectarnos para responder a algunas preguntas:
$ nc 159.65.48.79 31240 +-------+-----------------------------------------------------+ | Title | Description | +-------+-----------------------------------------------------+ | POOF | In my company, we are developing a | | | new python game for Halloween.</description></item><item><title>Wrong Spooky Season</title><link>https://7rocky.github.io/ctf/htb-challenges/forensics/wrong-spooky-season/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/htb-challenges/forensics/wrong-spooky-season/</guid><description>Se nos proporciona un archivo con una captura de tráfico de red llamado capture.pcap:
Análisis de tráfico Podemos usar Wireshark para analizarlo:
Mensajes HTTP Hay un montón de paquetes. Vamos a filtrar primero por HTTP:
Vale, ahora hay muchos menos paquetes para analizar.
Existen algunos mensajes HTTP que destacan al final. Podemos pensar que un usuario malintencionado está ejecutando comandos de sistema en el servidor de forma remota (cmd=whoami, cmd=id &amp;hellip;).</description></item></channel></rss>