<!doctype html><html lang="es"><head><title>Perfect Synchronization | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="description" content="Cifrado AES. An谩lisis de frecuencia"><meta name="image" content="https://7rocky.github.io/images/cryptography.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="Cifrado AES. An谩lisis de frecuencia"><meta itemprop="keywords" content><meta itemprop="name" content="Perfect Synchronization"><meta property="article:published_time" content><meta property="og:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:description" content="Cifrado AES. An谩lisis de frecuencia"><meta property="og:image" content="https://7rocky.github.io/images/cryptography.png"><meta property="og:locale" content="es_ES"><meta property="og:site_name" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:title" content="Perfect Synchronization"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/ctf/htb-challenges/crypto/perfect-synchronization/"><meta name="twitter:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="twitter:card" content="Cifrado AES. An谩lisis de frecuencia"><meta name="twitter:description" content="Cifrado AES. An谩lisis de frecuencia"><meta name="twitter:image" content="https://7rocky.github.io/images/cryptography.png"><meta name="twitter:title" content="Perfect Synchronization"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/ctf/htb-challenges/crypto/perfect-synchronization/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><script>MathJax={loader:{load:["[tex]/noerrors"]},options:{ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process",skipHtmlTags:["noscript","pre","script","style","textarea"]},tex:{autoload:{color:[],colorv2:["color"]},displayMath:[["$$","$$"]],inlineMath:[["$","$"]],packages:{"[+]":["noerrors"]},processEnvironments:!0,processEscapes:!0}}</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script><div id="math-consts" style="display:none">$
\newcommand{\e}{e}
\newcommand{\N}[1][]{\mathbb{N}^{#1}}
\newcommand{\Q}[1][]{\mathbb{Q}^{#1}}
\newcommand{\R}[1][]{\mathbb{R}^{#1}}
\newcommand{\Z}[1][]{\mathbb{Z}^{#1}}
\newcommand{\C}[1][]{\mathbb{C}^{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\divides}{\, | \,}
\newcommand{\st}{\; | \;}
\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\gcd}{\mathop{\mathrm{gcd}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\charField}{\mathop{\mathrm{char}}}
\newcommand{\Image}{\mathop{\mathrm{Im}}}
$</div><script src="/js/imc.js"></script><script>(async()=>await typeset(()=>[`#math-consts`]))()</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Buscar" rel="noopener" aria-label="Buscar"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="#" title="es"><img alt="es" height="30px" src="/images/es.png" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="/en/ctf/htb-challenges/crypto/perfect-synchronization/" title="en"><img alt="en" height="30px" src="/images/en.png" style="border:4px solid#000;border-radius:100%" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedInOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHubOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- CRYPTO</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/ctf/htb-challenges/crypto/perfect-synchronization/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/ctf/htb-challenges/crypto/perfect-synchronization/&amp;text=Perfect%20Synchronization" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/ctf/htb-challenges/crypto/perfect-synchronization/&amp;title=Perfect%20Synchronization" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Perfect Synchronization</h1><p class="mb4 f6 dib tracked">7 minutos de lectura</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#an谩lisis-de-c贸digo-fuente">An谩lisis de c贸digo fuente</a><ul><li><a href="#aes-ecb">AES ECB</a></li></ul></li><li><a href="#enfoque-de-la-soluci贸n">Enfoque de la soluci贸n</a></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer"> <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>Se nos proporciona el c贸digo fuente en Python para cifrar la <em>flag</em>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">os</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8">urandom</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">Crypto</span><span class="mtk1">.</span><span class="mtk8 mtku">Cipher</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">AES</span>
<span class="mtk5">from</span><span class="mtk1"> secret </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk6">MESSAGE</span>

<span class="mtk5">assert</span><span class="mtk1"> </span><span class="mtk8">all</span><span class="mtk1">([</span><span class="mtk1">x</span><span class="mtk1">.isupper() </span><span class="mtk5">or</span><span class="mtk1"> </span><span class="mtk1">x</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk4">'</span><span class="mtk6">{_}</span><span class="mtk4"> '</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">x</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk6">MESSAGE</span><span class="mtk1">])</span>


<span class="mtk7 mtki">class</span><span class="mtk1"> </span><span class="mtk8 mtku">Cipher</span><span class="mtk1">:</span>

<span class="mtk1">    </span><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk7">__init__</span><span class="mtk1">(</span><span class="mtk9 mtki">self</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">salt</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">urandom</span><span class="mtk1">(</span><span class="mtk6">15</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk1">key</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">urandom</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">cipher</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk8">new</span><span class="mtk1">(</span><span class="mtk1">key</span><span class="mtk1">, </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk1">MODE_ECB</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">encrypt</span><span class="mtk1">(</span><span class="mtk9 mtki">self</span><span class="mtk1">, </span><span class="mtk9 mtki">message</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> [</span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">cipher</span><span class="mtk1">.</span><span class="mtk8">encrypt</span><span class="mtk1">(</span><span class="mtk1">c</span><span class="mtk1">.encode() </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">salt</span><span class="mtk1">) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">c</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk9 mtki">message</span><span class="mtk1">]</span>  


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">():</span>
<span class="mtk1">    </span><span class="mtk1">cipher</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">Cipher</span><span class="mtk1">()</span>
<span class="mtk1">    </span><span class="mtk1">encrypted</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">cipher</span><span class="mtk1">.</span><span class="mtk8">encrypt</span><span class="mtk1">(</span><span class="mtk6">MESSAGE</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">encrypted</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk4">"</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">.</span><span class="mtk8">join</span><span class="mtk1">([</span><span class="mtk1">c</span><span class="mtk1">.</span><span class="mtk8">hex</span><span class="mtk1">() </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">c</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">encrypted</span><span class="mtk1">])</span>

<span class="mtk1">    </span><span class="mtk5">with</span><span class="mtk1"> </span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk4">"output.txt"</span><span class="mtk1">, </span><span class="mtk4">'w+'</span><span class="mtk1">) </span><span class="mtk5">as</span><span class="mtk1"> </span><span class="mtk1">f</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk1">f</span><span class="mtk1">.</span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk1">encrypted</span><span class="mtk1">)</span>


<span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk1">__name__</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk4">"__main__"</span><span class="mtk1">:</span>
<span class="mtk1">    </span><span class="mtk8">main</span><span class="mtk1">()</span>
</code></pre></div><p>Y tambi茅n tenemos la salida del <em>script</em> (es una salida muy grande, no se muestra completamente aqu铆):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">0fbf645baa0ecce12ed52071a4ed0d1d  
ce2e2acd1155ac79105dcabcdb4fbbff
d78843699ad962a2a7c513d193d27ab4
9a2f91dbedaa39d9b53f8146c2301098
3ea6ab81fee5f5c718f48b86e8680732
d78843699ad962a2a7c513d193d27ab4
...
a952cfc1d886d6084113d5f3e13508f0
48654fae441fee7cd607d8cb90c1de44
3ea6ab81fee5f5c718f48b86e8680732
ddfdaa01baab48baf54067dd3a3de527
ddfdaa01baab48baf54067dd3a3de527
d3eae0ab73225a3d841241af5d8a0654
d78843699ad962a2a7c513d193d27ab4
</code></pre></div><h2 id="an谩lisis-de-c贸digo-fuente">An谩lisis de c贸digo fuente</h2><p>En primer lugar, sabemos que los caracteres del mensaje son letras may煤sculas, guiones bajos, llaves o espacios:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">assert</span><span class="mtk1"> </span><span class="mtk8">all</span><span class="mtk1">([</span><span class="mtk1">x</span><span class="mtk1">.isupper() </span><span class="mtk5">or</span><span class="mtk1"> </span><span class="mtk1">x</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk4">'</span><span class="mtk6">{_}</span><span class="mtk4"> '</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">x</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk6">MESSAGE</span><span class="mtk1">])</span>  
</code></pre></div><p>Adem谩s, la funci贸n de cifrado toma un solo car谩cter, agrega un relleno aleatorio de 15 bytes y usa AES ECB para cifrarlo:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">class</span><span class="mtk1"> </span><span class="mtk8 mtku">Cipher</span><span class="mtk1">:</span>

<span class="mtk1">    </span><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk7">__init__</span><span class="mtk1">(</span><span class="mtk9 mtki">self</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">salt</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">urandom</span><span class="mtk1">(</span><span class="mtk6">15</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk1">key</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">urandom</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">cipher</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk8">new</span><span class="mtk1">(</span><span class="mtk1">key</span><span class="mtk1">, </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk1">MODE_ECB</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">encrypt</span><span class="mtk1">(</span><span class="mtk9 mtki">self</span><span class="mtk1">, </span><span class="mtk9 mtki">message</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> [</span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">cipher</span><span class="mtk1">.</span><span class="mtk8">encrypt</span><span class="mtk1">(</span><span class="mtk1">c</span><span class="mtk1">.encode() </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">salt</span><span class="mtk1">) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">c</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk9 mtki">message</span><span class="mtk1">]</span>  
</code></pre></div><h3 id="aes-ecb">AES ECB</h3><p>Revisemos c贸mo funciona AES ECB:</p><p><img src="/images/HTB-Challenges/HTB-Crypto-Perfect-Synchronization-1.webp" alt="Perfect Synchronization 1"></p><p>El punto aqu铆 es que bloques iguales de texto claro producen bloques iguales de texto cifrados. De hecho, tenemos un mensaje que contiene un m谩ximo de 30 caracteres diferentes (letras may煤sculas m谩s el guion bajo, m谩s las llaves m谩s el espacio). Por lo tanto, tendremos como m谩ximo 30 bloques de texto cifrados diferentes. Vamos a verlo:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> -q
&gt;&gt;&gt; with open('output.txt') as f:  
...     cts = f.read().splitlines()
...
&gt;&gt;&gt; len(set(cts))
30
</code></pre></div><p>Perfecto, tal y como esper谩bamos.</p><h2 id="enfoque-de-la-soluci贸n">Enfoque de la soluci贸n</h2><p>Dado que solo tenemos 30 s铆mbolos diferentes en el mensaje y, por lo tanto, 30 bloques de cifrado diferentes, podemos aplicar un an谩lisis de frecuencia con un poco de adivinaci贸n de palabras (en ingl茅s) para encontrar letras y completar los huecos para formar palabras y frases que tengan sentido.</p><p>Lo primero que podemos hacer es encontrar los bloques de texto cifrado para <code>{</code> y <code>}</code> (que aparecer谩n solo una vez):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">>>> import json
>>> from collections import Counter
>>>
>>> print(json.dumps(Counter(cts), indent=2))  
{
  "0fbf645baa0ecce12ed52071a4ed0d1d": 31,
  "ce2e2acd1155ac79105dcabcdb4fbbff": 89,
  "d78843699ad962a2a7c513d193d27ab4": 142,
  "9a2f91dbedaa39d9b53f8146c2301098": 7,
  "3ea6ab81fee5f5c718f48b86e8680732": 41,
  "b403c6f30eec7075d0643b5d4125de1b": 84,
  "9e520d83ca02f81ab980ed7ff9a16526": 55,
  "9b9233be563be442bf2edf0e3e42848d": 34,
  "a952cfc1d886d6084113d5f3e13508f0": 230,
  "00273fa04b9b836c553d876502e9a1e2": 101,
  "d3eae0ab73225a3d841241af5d8a0654": 61,
  "4ca1a8b8e8ca22b70d69ca257d79e5ed": 103,
  "98c50ceddda78b850757dc37c1c0814d": 87,
  "cb20a26ba8411b2e0072e7438ed67e54": 22,
  "4065e6b94c150f4137af46b752e25204": 37,
  "495c118c128a67d8a0f022e3f001775e": 75,
  "d395fedae9dca912da1b1b50b0aca161": 100,
  "c98f7e77e918e98833b8fa19de4b1653": 46,
  "e3372f2164f66ea750b5b14f8166b0b9": 23,
  "473a4eb8c699b9141c7d0bb4fa691674": 8,
  "b1119ba67f26c30144e9cea6a6d7059c": 18,
  "a33f02cf75488a76efb91511a0111982": 22,
  "48654fae441fee7cd607d8cb90c1de44": 32,
  "3321154f7ace2161b8cafb37c6307e6b": 9,
  "4fdd58bb71f5f8c882eaa592d51cf647": 5,
  "ddfdaa01baab48baf54067dd3a3de527": 8,
  "8115f6662bacddd86db1ae8dc533c46c": 2,
  "d4dde50295a8c036709603b3c216e44d": 1,
  "97038e93767664edf41312c98285ba94": 2,
  "25581e56ea570e8f68c9dab82f24f36e": 1
}
</code></pre></div><p>Entonces, sabemos que <code>d4dde50295a8c036709603b3c216e44d</code> y <code>25581e56ea570e8f68c9dab82f24f36e</code> son los bloques de texto cifrado para <code>{</code> y <code>}</code>. Entonces, podemos adivinar cuatro caracteres m谩s (<code> HTB</code>) en la salida de texto cifrado:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">...
9b9233be563be442bf2edf0e3e42848d
a952cfc1d886d6084113d5f3e13508f0  路  
c98f7e77e918e98833b8fa19de4b1653  H
d395fedae9dca912da1b1b50b0aca161  T
cb20a26ba8411b2e0072e7438ed67e54  B
d4dde50295a8c036709603b3c216e44d  {
4ca1a8b8e8ca22b70d69ca257d79e5ed
98c50ceddda78b850757dc37c1c0814d
a33f02cf75488a76efb91511a0111982
48654fae441fee7cd607d8cb90c1de44
d3eae0ab73225a3d841241af5d8a0654
d78843699ad962a2a7c513d193d27ab4
97038e93767664edf41312c98285ba94
4ca1a8b8e8ca22b70d69ca257d79e5ed
3ea6ab81fee5f5c718f48b86e8680732
cb20a26ba8411b2e0072e7438ed67e54
4ca1a8b8e8ca22b70d69ca257d79e5ed
d395fedae9dca912da1b1b50b0aca161
98c50ceddda78b850757dc37c1c0814d
d395fedae9dca912da1b1b50b0aca161
3ea6ab81fee5f5c718f48b86e8680732
d395fedae9dca912da1b1b50b0aca161
98c50ceddda78b850757dc37c1c0814d
495c118c128a67d8a0f022e3f001775e
b403c6f30eec7075d0643b5d4125de1b
97038e93767664edf41312c98285ba94
9e520d83ca02f81ab980ed7ff9a16526
98c50ceddda78b850757dc37c1c0814d
48654fae441fee7cd607d8cb90c1de44
c98f7e77e918e98833b8fa19de4b1653
d78843699ad962a2a7c513d193d27ab4
ce2e2acd1155ac79105dcabcdb4fbbff
25581e56ea570e8f68c9dab82f24f36e  }
a952cfc1d886d6084113d5f3e13508f0  路
9e520d83ca02f81ab980ed7ff9a16526
...
</code></pre></div><p>En Visual Studio Code u otro editor de texto, podemos seleccionar todas las ocurrencias de un bloque de texto cifrado y agregar el car谩cter de texto claro correspondiente (<code>路</code> para espacios) en toda la salida:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">9b9233be563be442bf2edf0e3e42848d
a952cfc1d886d6084113d5f3e13508f0  路  
c98f7e77e918e98833b8fa19de4b1653  H
d395fedae9dca912da1b1b50b0aca161  T
cb20a26ba8411b2e0072e7438ed67e54  B
d4dde50295a8c036709603b3c216e44d  {
4ca1a8b8e8ca22b70d69ca257d79e5ed
98c50ceddda78b850757dc37c1c0814d
a33f02cf75488a76efb91511a0111982
48654fae441fee7cd607d8cb90c1de44
d3eae0ab73225a3d841241af5d8a0654
d78843699ad962a2a7c513d193d27ab4
97038e93767664edf41312c98285ba94
4ca1a8b8e8ca22b70d69ca257d79e5ed
3ea6ab81fee5f5c718f48b86e8680732
cb20a26ba8411b2e0072e7438ed67e54  B
4ca1a8b8e8ca22b70d69ca257d79e5ed
d395fedae9dca912da1b1b50b0aca161  T
98c50ceddda78b850757dc37c1c0814d
d395fedae9dca912da1b1b50b0aca161  T
3ea6ab81fee5f5c718f48b86e8680732
d395fedae9dca912da1b1b50b0aca161  T
98c50ceddda78b850757dc37c1c0814d
495c118c128a67d8a0f022e3f001775e
b403c6f30eec7075d0643b5d4125de1b
97038e93767664edf41312c98285ba94
9e520d83ca02f81ab980ed7ff9a16526
98c50ceddda78b850757dc37c1c0814d
48654fae441fee7cd607d8cb90c1de44
c98f7e77e918e98833b8fa19de4b1653  H
d78843699ad962a2a7c513d193d27ab4
ce2e2acd1155ac79105dcabcdb4fbbff
25581e56ea570e8f68c9dab82f24f36e  }
a952cfc1d886d6084113d5f3e13508f0  路
9e520d83ca02f81ab980ed7ff9a16526
</code></pre></div><p>Ahora es el momento de usar la intuici贸n para adivinar palabras. Por ejemplo esta:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">4065e6b94c150f4137af46b752e25204
a952cfc1d886d6084113d5f3e13508f0  路  
cb20a26ba8411b2e0072e7438ed67e54  B
9b9233be563be442bf2edf0e3e42848d
a952cfc1d886d6084113d5f3e13508f0  路
d395fedae9dca912da1b1b50b0aca161  T
c98f7e77e918e98833b8fa19de4b1653  H
d78843699ad962a2a7c513d193d27ab4
a952cfc1d886d6084113d5f3e13508f0  路
00273fa04b9b836c553d876502e9a1e2
</code></pre></div><p>Es bastante obvio que debe ser <code>?路BY路THE路?</code>, por lo que tenemos la <code>Y</code> y la <code>E</code>.</p><p>Entonces podemos encontrar esto:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">9e520d83ca02f81ab980ed7ff9a16526
d395fedae9dca912da1b1b50b0aca161  T  
a952cfc1d886d6084113d5f3e13508f0  路
d395fedae9dca912da1b1b50b0aca161  T
c98f7e77e918e98833b8fa19de4b1653  H
00273fa04b9b836c553d876502e9a1e2
d395fedae9dca912da1b1b50b0aca161  T
a952cfc1d886d6084113d5f3e13508f0  路
98c50ceddda78b850757dc37c1c0814d
</code></pre></div><p>Y aqu铆 conseguimos la <code>A</code> de <code>?路THAT路?</code>.</p><p>Lo siguiente debe ser <code>?路BOTH路THE路B?</code>, por lo que encontramos la <code>O</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">98c50ceddda78b850757dc37c1c0814d
a952cfc1d886d6084113d5f3e13508f0  路  
cb20a26ba8411b2e0072e7438ed67e54  B
495c118c128a67d8a0f022e3f001775e
d395fedae9dca912da1b1b50b0aca161  T
c98f7e77e918e98833b8fa19de4b1653  H
a952cfc1d886d6084113d5f3e13508f0  路
d395fedae9dca912da1b1b50b0aca161  T
c98f7e77e918e98833b8fa19de4b1653  H
d78843699ad962a2a7c513d193d27ab4  E
a952cfc1d886d6084113d5f3e13508f0  路
cb20a26ba8411b2e0072e7438ed67e54  B
ce2e2acd1155ac79105dcabcdb4fbbff
</code></pre></div><p>Este es una suposici贸n afortunada para <code>?E路AND路?</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">e3372f2164f66ea750b5b14f8166b0b9
d78843699ad962a2a7c513d193d27ab4  E  
a952cfc1d886d6084113d5f3e13508f0  路
00273fa04b9b836c553d876502e9a1e2  A
b403c6f30eec7075d0643b5d4125de1b
4065e6b94c150f4137af46b752e25204
a952cfc1d886d6084113d5f3e13508f0  路
4ca1a8b8e8ca22b70d69ca257d79e5ed
</code></pre></div><p>Aqu铆 hay otra suposici贸n afortunada para <code>路FREQUENCY路ANALYSIS路</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">a952cfc1d886d6084113d5f3e13508f0  路  
0fbf645baa0ecce12ed52071a4ed0d1d
ce2e2acd1155ac79105dcabcdb4fbbff
d78843699ad962a2a7c513d193d27ab4  E
9a2f91dbedaa39d9b53f8146c2301098
3ea6ab81fee5f5c718f48b86e8680732
d78843699ad962a2a7c513d193d27ab4  E
b403c6f30eec7075d0643b5d4125de1b  N
9e520d83ca02f81ab980ed7ff9a16526
9b9233be563be442bf2edf0e3e42848d  Y
a952cfc1d886d6084113d5f3e13508f0  路
00273fa04b9b836c553d876502e9a1e2  A
b403c6f30eec7075d0643b5d4125de1b  N
00273fa04b9b836c553d876502e9a1e2  A
d3eae0ab73225a3d841241af5d8a0654
9b9233be563be442bf2edf0e3e42848d  Y
4ca1a8b8e8ca22b70d69ca257d79e5ed
98c50ceddda78b850757dc37c1c0814d
4ca1a8b8e8ca22b70d69ca257d79e5ed
a952cfc1d886d6084113d5f3e13508f0  路
</code></pre></div><p>Aqu铆 tenemos <code>路LANGUAGE路CRYPTANALYSIS路</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">a952cfc1d886d6084113d5f3e13508f0  路  
d3eae0ab73225a3d841241af5d8a0654  L
00273fa04b9b836c553d876502e9a1e2  A
b403c6f30eec7075d0643b5d4125de1b  N
e3372f2164f66ea750b5b14f8166b0b9
3ea6ab81fee5f5c718f48b86e8680732  U
00273fa04b9b836c553d876502e9a1e2  A
e3372f2164f66ea750b5b14f8166b0b9
d78843699ad962a2a7c513d193d27ab4  E
a952cfc1d886d6084113d5f3e13508f0  路
98c50ceddda78b850757dc37c1c0814d  I
b403c6f30eec7075d0643b5d4125de1b  N
a952cfc1d886d6084113d5f3e13508f0  路
9e520d83ca02f81ab980ed7ff9a16526  C
ce2e2acd1155ac79105dcabcdb4fbbff  R
9b9233be563be442bf2edf0e3e42848d  Y
48654fae441fee7cd607d8cb90c1de44
d395fedae9dca912da1b1b50b0aca161  T
00273fa04b9b836c553d876502e9a1e2  A
b403c6f30eec7075d0643b5d4125de1b  N
00273fa04b9b836c553d876502e9a1e2  A
d3eae0ab73225a3d841241af5d8a0654  L
9b9233be563be442bf2edf0e3e42848d  Y
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
98c50ceddda78b850757dc37c1c0814d  I
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
a952cfc1d886d6084113d5f3e13508f0  路
</code></pre></div><p>Esto es <code>路CIPHERTEXT路THE路METHOD路</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">a952cfc1d886d6084113d5f3e13508f0  路  
9e520d83ca02f81ab980ed7ff9a16526  C
98c50ceddda78b850757dc37c1c0814d  I
48654fae441fee7cd607d8cb90c1de44  P
c98f7e77e918e98833b8fa19de4b1653  H
d78843699ad962a2a7c513d193d27ab4  E
ce2e2acd1155ac79105dcabcdb4fbbff  R
d395fedae9dca912da1b1b50b0aca161  T
d78843699ad962a2a7c513d193d27ab4  E
4fdd58bb71f5f8c882eaa592d51cf647
d395fedae9dca912da1b1b50b0aca161  T
a952cfc1d886d6084113d5f3e13508f0  路
d395fedae9dca912da1b1b50b0aca161  T
c98f7e77e918e98833b8fa19de4b1653  H
d78843699ad962a2a7c513d193d27ab4  E
a952cfc1d886d6084113d5f3e13508f0  路
a33f02cf75488a76efb91511a0111982
d78843699ad962a2a7c513d193d27ab4  E
d395fedae9dca912da1b1b50b0aca161  T
c98f7e77e918e98833b8fa19de4b1653  H
495c118c128a67d8a0f022e3f001775e  O
4065e6b94c150f4137af46b752e25204  D
a952cfc1d886d6084113d5f3e13508f0  路
</code></pre></div><p>Estas son <code>路BREAKING路</code> t <code>路SOLVING路</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">a952cfc1d886d6084113d5f3e13508f0  路  
cb20a26ba8411b2e0072e7438ed67e54  B
ce2e2acd1155ac79105dcabcdb4fbbff  R
d78843699ad962a2a7c513d193d27ab4  E
00273fa04b9b836c553d876502e9a1e2  A
3321154f7ace2161b8cafb37c6307e6b
98c50ceddda78b850757dc37c1c0814d  I
b403c6f30eec7075d0643b5d4125de1b  N
e3372f2164f66ea750b5b14f8166b0b9  G
a952cfc1d886d6084113d5f3e13508f0  路
...
a952cfc1d886d6084113d5f3e13508f0  路
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
495c118c128a67d8a0f022e3f001775e  O
d3eae0ab73225a3d841241af5d8a0654  L
473a4eb8c699b9141c7d0bb4fa691674
98c50ceddda78b850757dc37c1c0814d  I
b403c6f30eec7075d0643b5d4125de1b  N
e3372f2164f66ea750b5b14f8166b0b9  G
a952cfc1d886d6084113d5f3e13508f0  路
</code></pre></div><p>Aqu铆 podemos ver <code>路WORLD路WAR路II路</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">a952cfc1d886d6084113d5f3e13508f0  路  
b1119ba67f26c30144e9cea6a6d7059c
495c118c128a67d8a0f022e3f001775e  O
ce2e2acd1155ac79105dcabcdb4fbbff  R
d3eae0ab73225a3d841241af5d8a0654  L
4065e6b94c150f4137af46b752e25204  D
a952cfc1d886d6084113d5f3e13508f0  路
b1119ba67f26c30144e9cea6a6d7059c
00273fa04b9b836c553d876502e9a1e2  A
ce2e2acd1155ac79105dcabcdb4fbbff  R
a952cfc1d886d6084113d5f3e13508f0  路
98c50ceddda78b850757dc37c1c0814d  I
98c50ceddda78b850757dc37c1c0814d  I
a952cfc1d886d6084113d5f3e13508f0  路
</code></pre></div><p>Lo siguiente representa <code>路CROSSWORD路PUZZLES路IN路MAJOR路NEWSPAPERS路</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">e3372f2164f66ea750b5b14f8166b0b9  G  
a952cfc1d886d6084113d5f3e13508f0  路
9e520d83ca02f81ab980ed7ff9a16526  C
ce2e2acd1155ac79105dcabcdb4fbbff  R
495c118c128a67d8a0f022e3f001775e  O
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
b1119ba67f26c30144e9cea6a6d7059c  W
495c118c128a67d8a0f022e3f001775e  O
ce2e2acd1155ac79105dcabcdb4fbbff  R
4065e6b94c150f4137af46b752e25204  D
a952cfc1d886d6084113d5f3e13508f0  路
48654fae441fee7cd607d8cb90c1de44  P
3ea6ab81fee5f5c718f48b86e8680732  U
ddfdaa01baab48baf54067dd3a3de527
ddfdaa01baab48baf54067dd3a3de527
d3eae0ab73225a3d841241af5d8a0654  L
d78843699ad962a2a7c513d193d27ab4  E
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
a952cfc1d886d6084113d5f3e13508f0  路
98c50ceddda78b850757dc37c1c0814d  I
b403c6f30eec7075d0643b5d4125de1b  N
a952cfc1d886d6084113d5f3e13508f0  路
a33f02cf75488a76efb91511a0111982  M
00273fa04b9b836c553d876502e9a1e2  A
8115f6662bacddd86db1ae8dc533c46c
495c118c128a67d8a0f022e3f001775e  O
ce2e2acd1155ac79105dcabcdb4fbbff  R
a952cfc1d886d6084113d5f3e13508f0  路
b403c6f30eec7075d0643b5d4125de1b  N
d78843699ad962a2a7c513d193d27ab4  E
b1119ba67f26c30144e9cea6a6d7059c  W
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
48654fae441fee7cd607d8cb90c1de44  P
00273fa04b9b836c553d876502e9a1e2  A
48654fae441fee7cd607d8cb90c1de44  P
d78843699ad962a2a7c513d193d27ab4  E
ce2e2acd1155ac79105dcabcdb4fbbff  R
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
a952cfc1d886d6084113d5f3e13508f0  路
</code></pre></div><p>Y finalmente, solo quedan los guiones bajos:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">a952cfc1d886d6084113d5f3e13508f0  路  
c98f7e77e918e98833b8fa19de4b1653  H
d395fedae9dca912da1b1b50b0aca161  T
cb20a26ba8411b2e0072e7438ed67e54  B
d4dde50295a8c036709603b3c216e44d  {
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
98c50ceddda78b850757dc37c1c0814d  I
a33f02cf75488a76efb91511a0111982  M
48654fae441fee7cd607d8cb90c1de44  P
d3eae0ab73225a3d841241af5d8a0654  L
d78843699ad962a2a7c513d193d27ab4  E
97038e93767664edf41312c98285ba94
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
3ea6ab81fee5f5c718f48b86e8680732  U
cb20a26ba8411b2e0072e7438ed67e54  B
4ca1a8b8e8ca22b70d69ca257d79e5ed  S
d395fedae9dca912da1b1b50b0aca161  T
98c50ceddda78b850757dc37c1c0814d  I
d395fedae9dca912da1b1b50b0aca161  T
3ea6ab81fee5f5c718f48b86e8680732  U
d395fedae9dca912da1b1b50b0aca161  T
98c50ceddda78b850757dc37c1c0814d  I
495c118c128a67d8a0f022e3f001775e  O
b403c6f30eec7075d0643b5d4125de1b  N
97038e93767664edf41312c98285ba94
9e520d83ca02f81ab980ed7ff9a16526  C
98c50ceddda78b850757dc37c1c0814d  I
48654fae441fee7cd607d8cb90c1de44  P
c98f7e77e918e98833b8fa19de4b1653  H
d78843699ad962a2a7c513d193d27ab4  E
ce2e2acd1155ac79105dcabcdb4fbbff  R
25581e56ea570e8f68c9dab82f24f36e  }
a952cfc1d886d6084113d5f3e13508f0  路
</code></pre></div><p>Para resumir, este es el mensaje completo:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">FREQUENCY ANALYSIS IS BASED ON THE FACT THAT IN ANY GIVEN STRETCH OF WRITTEN
LANGUAGE CERTAIN LETTERS AND COMBINATIONS OF LETTERS OCCUR WITH VARYING
FREQUENCIES MOREOVER THERE IS A CHARACTERISTIC DISTRIBUTION OF LETTERS THAT
IS ROUGHLY THE SAME FOR ALMOST ALL SAMPLES OF THAT LANGUAGE IN CRYPTANALYSIS
FREQUENCY ANALYSIS ALSO KNOWN AS COUNTING LETTERS IS THE STUDY OF THE
FREQUENCY OF LETTERS OR GROUPS OF LETTERS IN A CIPHERTEXT THE METHOD IS
USED AS AN AID TO BREAKING CLASSICAL CIPHERS FREQUENCY ANALYSIS REQUIRES
ONLY A BASIC UNDERSTANDING OF THE STATISTICS OF THE PLAINTEXT LANGUAGE AND
SOME PROBLEM SOLVING SKILLS AND IF PERFORMED BY HAND TOLERANCE FOR EXTENSIVE
LETTER BOOKKEEPING DURING WORLD WAR II BOTH THE BRITISH AND THE AMERICANS
RECRUITED CODEBREAKERS BY PLACING CROSSWORD PUZZLES IN MAJOR NEWSPAPERS AND
RUNNING CONTESTS FOR WHO COULD SOLVE THEM THE FASTEST SEVERAL OF THE CIPHERS
USED BY THE AXIS POWERS WERE BREAKABLE USING FREQUENCY ANALYSIS FOR EXAMPLE
SOME OF THE CONSULAR CIPHERS USED BY THE JAPANESE MECHANICAL METHODS OF
LETTER COUNTING AND STATISTICAL ANALYSIS GENERALLY HTB{SIMPLE_SUBSTITUTION_CIPHER}  
CARD TYPE MACHINERY WERE FIRST USED IN WORLD WAR II POSSIBLY BY THE US ARMYS
SIS TODAY THE HARD WORK OF LETTER COUNTING AND ANALYSIS HAS BEEN REPLACED BY
COMPUTER SOFTWARE WHICH CAN CARRY OUT SUCH ANALYSIS IN SECONDS WITH MODERN
COMPUTING POWER CLASSICAL CIPHERS ARE UNLIKELY TO PROVIDE ANY REAL
PROTECTION FOR CONFIDENTIAL DATA PUZZLE PUZZLE PUZZLE
</code></pre></div><h2 id="_flag_"><em>Flag</em></h2><p>Y la <em>flag</em> es: <code>HTB{SIMPLE_SUBSTITUTION_CIPHER}</code>.</p><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#an谩lisis-de-c贸digo-fuente">An谩lisis de c贸digo fuente</a><ul><li><a href="#aes-ecb">AES ECB</a></li></ul></li><li><a href="#enfoque-de-la-soluci贸n">Enfoque de la soluci贸n</a></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer"> <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Recibe un resumen semanal del blog"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Suscribirse"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">Ver historial de res煤menes</a></p><p class="tc">impulsado por <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; Blog de 7Rocky. Ciberseguridad y Mates 2023</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedInOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHubOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>