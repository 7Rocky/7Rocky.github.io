<!doctype html><html lang="es"><head><title>400curves | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="description" content="Criptografía de Curva Elíptica. Ataque de Curva Inválida"><meta name="image" content="https://7rocky.github.io/images/cryptography.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="Criptografía de Curva Elíptica. Ataque de Curva Inválida"><meta itemprop="keywords" content><meta itemprop="name" content="400curves"><meta property="article:published_time" content><meta property="og:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:description" content="Criptografía de Curva Elíptica. Ataque de Curva Inválida"><meta property="og:image" content="https://7rocky.github.io/images/cryptography.png"><meta property="og:locale" content="es_ES"><meta property="og:site_name" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:title" content="400curves"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/ctf/htb-challenges/crypto/400curves/"><meta name="twitter:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="twitter:card" content="Criptografía de Curva Elíptica. Ataque de Curva Inválida"><meta name="twitter:description" content="Criptografía de Curva Elíptica. Ataque de Curva Inválida"><meta name="twitter:image" content="https://7rocky.github.io/images/cryptography.png"><meta name="twitter:title" content="400curves"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/ctf/htb-challenges/crypto/400curves/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><script>MathJax={loader:{load:["[tex]/noerrors"]},options:{ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process",skipHtmlTags:["noscript","pre","script","style","textarea"]},tex:{autoload:{color:[],colorv2:["color"]},displayMath:[["$$","$$"]],inlineMath:[["$","$"]],packages:{"[+]":["noerrors"]},processEnvironments:!0,processEscapes:!0}}</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script><div id="math-consts" style="display:none">$
\newcommand{\e}{e}
\newcommand{\N}[1][]{\mathbb{N}^{#1}}
\newcommand{\Q}[1][]{\mathbb{Q}^{#1}}
\newcommand{\R}[1][]{\mathbb{R}^{#1}}
\newcommand{\Z}[1][]{\mathbb{Z}^{#1}}
\newcommand{\C}[1][]{\mathbb{C}^{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\divides}{\, | \,}
\newcommand{\st}{\; | \;}
\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\gcd}{\mathop{\mathrm{gcd}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\charField}{\mathop{\mathrm{char}}}
\newcommand{\Image}{\mathop{\mathrm{Im}}}
$</div><script src="/js/imc.js"></script><script>(async()=>await typeset(()=>[`#math-consts`]))()</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Buscar" rel="noopener" aria-label="Buscar"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>
</a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="#" title="es"><img alt="es" height="30px" src="/images/es.png" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="/en/ctf/htb-challenges/crypto/400curves/" title="en"><img alt="en" height="30px" src="/images/en.png" style="border:4px solid#000;border-radius:100%" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- CRYPTO</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/ctf/htb-challenges/crypto/400curves/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/ctf/htb-challenges/crypto/400curves/&amp;text=400curves" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/ctf/htb-challenges/crypto/400curves/&amp;title=400curves" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">400curves</h1><p class="mb4 f6 dib tracked">10 minutos de lectura</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#contexto-de-ecc">Contexto de ECC</a></li><li><a href="#el-fallo-de-seguridad">El fallo de seguridad</a><ul><li><a href="#ataque-de-curva-inválida">Ataque de Curva Inválida</a></li></ul></li><li><a href="#implementación-del-ataque">Implementación del ataque</a></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>Se nos proporciona el código fuente del servidor en Python:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">Crypto</span><span class="mtk1">.</span><span class="mtk8 mtku">Util</span><span class="mtk1">.</span><span class="mtk8 mtku">number</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8">inverse</span><span class="mtk1">, </span><span class="mtk8">bytes_to_long</span>
<span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">socketserver</span>
<span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">signal</span>
<span class="mtk5">from</span><span class="mtk1"> secret </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk6">FLAG</span>

<span class="mtk1">a</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">ffffffff00000001000000000000000000000000ffffffffff</span><span class="mtk6">fffffffffffffc</span>
<span class="mtk1">b</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63b</span><span class="mtk6">ce3c3e27d2604b</span>
<span class="mtk1">p</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">ffffffff00000001000000000000000000000000ffffffffff</span><span class="mtk6">ffffffffffffff</span>

<span class="mtk1">E</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> {</span><span class="mtk4">'a'</span><span class="mtk1">: </span><span class="mtk1">a</span><span class="mtk1">, </span><span class="mtk4">'b'</span><span class="mtk1">: </span><span class="mtk1">b</span><span class="mtk1">, </span><span class="mtk4">'p'</span><span class="mtk1">: </span><span class="mtk1">p</span><span class="mtk1">}</span>


<span class="mtk7 mtki">class</span><span class="mtk1"> </span><span class="mtk8 mtku">Handler</span><span class="mtk1">(</span><span class="mtk8 mtku">socketserver</span><span class="mtk1">.</span><span class="mtk8 mtku">BaseRequestHandler</span><span class="mtk1">):</span>

<span class="mtk1">    </span><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">handle</span><span class="mtk1">(</span><span class="mtk9 mtki">self</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk8 mtku">signal</span><span class="mtk1">.</span><span class="mtk8">alarm</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk8">main</span><span class="mtk1">(</span><span class="mtk9 mtki">self</span><span class="mtk1">.</span><span class="mtk1">request</span><span class="mtk1">)</span>


<span class="mtk7 mtki">class</span><span class="mtk1"> </span><span class="mtk8 mtku">ReusableTCPServer</span><span class="mtk1">(</span><span class="mtk8 mtku">socketserver</span><span class="mtk1">.</span><span class="mtk8 mtku">ForkingMixIn</span><span class="mtk1">, </span><span class="mtk8 mtku">socketserver</span><span class="mtk1">.</span><span class="mtk8 mtku">TCPServer</span><span class="mtk1">):</span>  
<span class="mtk1">    </span><span class="mtk5">pass</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">sendMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk9 mtki">msg</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk9 mtki">s</span><span class="mtk1">.send(</span><span class="mtk9 mtki">msg</span><span class="mtk1">.encode())</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">recieveMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk9 mtki">msg</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk8">sendMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk9 mtki">msg</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk9 mtki">s</span><span class="mtk1">.recv(</span><span class="mtk6">4096</span><span class="mtk1">).decode().strip()</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">add</span><span class="mtk1">(</span><span class="mtk9 mtki">P</span><span class="mtk1">, </span><span class="mtk9 mtki">Q</span><span class="mtk1">, </span><span class="mtk9 mtki">E</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk9 mtki">P</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> (</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">)):</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk9 mtki">Q</span>
<span class="mtk1">    </span><span class="mtk5">elif</span><span class="mtk1"> (</span><span class="mtk9 mtki">Q</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> (</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">)):</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk9 mtki">P</span>
<span class="mtk1">    </span><span class="mtk5">else</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk1">Ea</span><span class="mtk1">, </span><span class="mtk1">Ep</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk9 mtki">E</span><span class="mtk1">[</span><span class="mtk4">'a'</span><span class="mtk1">], </span><span class="mtk9 mtki">E</span><span class="mtk1">[</span><span class="mtk4">'p'</span><span class="mtk1">]</span>
<span class="mtk1">        </span><span class="mtk1">x1</span><span class="mtk1">, </span><span class="mtk1">y1</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk9 mtki">P</span>
<span class="mtk1">        </span><span class="mtk1">x2</span><span class="mtk1">, </span><span class="mtk1">y2</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk9 mtki">Q</span>
<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> ((</span><span class="mtk1">x1</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk1">x2</span><span class="mtk1">) </span><span class="mtk5">&amp;</span><span class="mtk1"> (</span><span class="mtk1">y1</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1">y2</span><span class="mtk1">)):</span>
<span class="mtk1">            </span><span class="mtk5">return</span><span class="mtk1"> ((</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">))</span>
<span class="mtk1">        </span><span class="mtk5">else</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk9 mtki">P</span><span class="mtk1"> </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk9 mtki">Q</span><span class="mtk1">):</span>
<span class="mtk1">                </span><span class="mtk1">l</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk1">y2</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk1">y1</span><span class="mtk1">) </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk8">inverse</span><span class="mtk1">(</span><span class="mtk1">x2</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk1">x1</span><span class="mtk1">, </span><span class="mtk1">Ep</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk5">else</span><span class="mtk1">:</span>
<span class="mtk1">                </span><span class="mtk1">l</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk6">3</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> (</span><span class="mtk1">x1</span><span class="mtk5">**</span><span class="mtk6">2</span><span class="mtk1">) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">Ea</span><span class="mtk1">) </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk8">inverse</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">y1</span><span class="mtk1">, </span><span class="mtk1">Ep</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk1">x3</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> ((</span><span class="mtk1">l</span><span class="mtk5">**</span><span class="mtk6">2</span><span class="mtk1">) </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk1">x1</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk1">x2</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk1">Ep</span>
<span class="mtk1">        </span><span class="mtk1">y3</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk1">l</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> (</span><span class="mtk1">x1</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk1">x3</span><span class="mtk1">) </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk1">y1</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk1">Ep</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk1">x3</span><span class="mtk1">, </span><span class="mtk1">y3</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">multiply</span><span class="mtk1">(</span><span class="mtk9 mtki">P</span><span class="mtk1">, </span><span class="mtk9 mtki">n</span><span class="mtk1">, </span><span class="mtk9 mtki">E</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">Q</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk9 mtki">P</span>
<span class="mtk1">    </span><span class="mtk1">R</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk5">while</span><span class="mtk1"> (</span><span class="mtk9 mtki">n</span><span class="mtk1"> </span><span class="mtk5">&gt;</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk9 mtki">n</span><span class="mtk1"> </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">2</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">):</span>
<span class="mtk1">            </span><span class="mtk1">R</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">add</span><span class="mtk1">(</span><span class="mtk1">R</span><span class="mtk1">, </span><span class="mtk1">Q</span><span class="mtk1">, </span><span class="mtk9 mtki">E</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk1">Q</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">add</span><span class="mtk1">(</span><span class="mtk1">Q</span><span class="mtk1">, </span><span class="mtk1">Q</span><span class="mtk1">, </span><span class="mtk9 mtki">E</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk9 mtki">n</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk9 mtki">n</span><span class="mtk1"> </span><span class="mtk5">//</span><span class="mtk1"> </span><span class="mtk6">2</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk1">R</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk8">sendMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk4">"Establising the TLS handsake...</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk5">while</span><span class="mtk1"> </span><span class="mtk6">True</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk1">C</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">recieveMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk4">"Awaiting public key of the client...</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk5">try</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk1">x</span><span class="mtk1">, </span><span class="mtk1">y</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">i</span><span class="mtk1">) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">C</span><span class="mtk1">.strip().split()]</span>
<span class="mtk1">            </span><span class="mtk1">S</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">multiply</span><span class="mtk1">((</span><span class="mtk1">x</span><span class="mtk1">, </span><span class="mtk1">y</span><span class="mtk1">), </span><span class="mtk8">bytes_to_long</span><span class="mtk1">(</span><span class="mtk6">FLAG</span><span class="mtk1">), </span><span class="mtk1">E</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk8">sendMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk7 mtki">f</span><span class="mtk4">"Shared secret: </span><span class="mtk6">{</span><span class="mtk1">S</span><span class="mtk6">}\n</span><span class="mtk4">"</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk5">except</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk8">sendMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk7 mtki">f</span><span class="mtk4">"Error occured!</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">)</span>


<span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk1">__name__</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk4">'__main__'</span><span class="mtk1">:</span>
<span class="mtk1">    </span><span class="mtk8 mtku">socketserver</span><span class="mtk1">.</span><span class="mtk8 mtku">TCPServer</span><span class="mtk1">.</span><span class="mtk1">allow_reuse_address</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">True</span>
<span class="mtk1">    </span><span class="mtk1">server</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">ReusableTCPServer</span><span class="mtk1">((</span><span class="mtk4">"0.0.0.0"</span><span class="mtk1">, </span><span class="mtk6">1337</span><span class="mtk1">), </span><span class="mtk8 mtku">Handler</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">server</span><span class="mtk1">.</span><span class="mtk8">serve_forever</span><span class="mtk1">()</span>
</code></pre></div><p>El servidor usa Criptografía de Curva Elíptica (ECC) con la curva <a href="https://neuromancer.sk/std/secg/secp256r1">secp256r1</a>.</p><h2 id="contexto-de-ecc">Contexto de ECC</h2><p>La Criptografía de Curva Elíptica es un criptosistema de clave pública, por lo que hay una clave pública y una clave privada.</p><p>Sea $E$ una curva elíptica definida en forma de Weierstrass:</p><p class="scroll">$$
E: \; y^2 = x^3 + ax + b
$$</p><p>Donde $(x, y)$ son puntos de la curva.</p><p>En ECC, la curva elíptica anterior se considera sobre un cuerpo finito (por ejemplo, $\mathbb{F}_p$, con $p$ un número primo). Por lo tanto, la curva se puede expresar como $E(\mathbb{F}_p)$.</p><p>Como resultado, los puntos en la curva forman un grupo abeliano con la suma:</p><ul><li>La operación es interna (es decir, $P + Q \in E(\mathbb{F}_p) \; \forall P, Q \in E(\mathbb{F}_p)$)</li><li>Hay un único elemento neutro que generalmente se llama $O$, tal que $P + O = O + P = P$. También se conoce como &ldquo;punto en el infinito&rdquo;</li><li>Todo punto tiene un único inverso, es decir $\exists! Q \in E(\mathbb{F}_p) \;|\; P + Q = O \;\; \forall P \in E(\mathbb{F}_p)$. Se podría decir que $Q = -P$, abusando de la notación aditiva</li><li>La operación es asociativa (y también conmutativa)</li></ul><p>La operación de la suma tiene un cierto algoritmo, que se implementa en el código fuente anterior. Una vez definida la suma, podemos expresar el producto de un punto por un escalar:</p><p class="scroll">$$
kP = \underbrace{P + \dots + P}_{k\; \text{times}}
$$</p><p>Para usar ECC, debemos tomar un punto generador $G$ de la curva, luego tomar un número $n$ y multiplicar $n$ por $G$. La clave pública está formada por los puntos $G$ y $nG$ (aparte de los parámetros de la curva $a$, $b$ y el cuerpo finito $\mathbb{F}_p$); y la clave privada es el número $n$.</p><p>ECC se puede utilizar para el Protocolo de intercambio de claves Diffie-Hellman (ECDH), para el algoritmo de firma digital (ECDSA) o para cifrado (ECIES), entre otros. La seguridad de este criptosistema recae en la dificultad de resolver el Problema del Logaritmo Discreto de Curva Elíptica (ECDLP), es decir, encontrar $n$ a partir de $G$ y $nG$.</p><h2 id="el-fallo-de-seguridad">El fallo de seguridad</h2><p>Como se dijo antes, la suma de puntos tiene un cierto algoritmo, que se implementa en el código fuente anterior. Al sumar puntos $P(x_1, y_1)$ y $Q(x_2, y_2)$, el algoritmo depende solamente de $x_1$, $x_2$, $y_1$, $y_2$, $a$ y $p$. Obsérvese que $b$ nunca se usa.</p><p>Además, las operaciones de algoritmo son operaciones básicas con números. No hay restricción en los valores $x_1$, $x_2$, $y_1$, $y_2$. Con esto quiero decir que, si $P(x_1, y_1)$ y $Q(x_2, y_2)$ son puntos de $E(\mathbb{F}_p)$, el resultado $R(x_3, y_3)$ será otro punto de la curva. Sin embargo, si $P$ y $Q$ no están en la curva, $R$ tampoco.</p><p>El razonamiento anterior es clave para comprender el fallo y el ataque de este reto. El servidor nos permite ingresar una clave pública $C(x, y)$ (un punto dentro de la curva elíptica). Luego, el servidor tomará nuestro punto y lo multiplicará por la <em>flag</em> en formato decimal ($s = \mathrm{flag} \cdot C$):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk8">sendMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk4">"Establising the TLS handsake...</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk5">while</span><span class="mtk1"> </span><span class="mtk6">True</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk1">C</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">recieveMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk4">"Awaiting public key of the client...</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">)</span>  
<span class="mtk1">        </span><span class="mtk5">try</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk1">x</span><span class="mtk1">, </span><span class="mtk1">y</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">i</span><span class="mtk1">) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">C</span><span class="mtk1">.strip().split()]</span>
<span class="mtk1">            </span><span class="mtk1">S</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">multiply</span><span class="mtk1">((</span><span class="mtk1">x</span><span class="mtk1">, </span><span class="mtk1">y</span><span class="mtk1">), </span><span class="mtk8">bytes_to_long</span><span class="mtk1">(</span><span class="mtk6">FLAG</span><span class="mtk1">), </span><span class="mtk1">E</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk8">sendMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk7 mtki">f</span><span class="mtk4">"Shared secret: </span><span class="mtk6">{</span><span class="mtk1">S</span><span class="mtk6">}\n</span><span class="mtk4">"</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk5">except</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk8">sendMessage</span><span class="mtk1">(</span><span class="mtk9 mtki">s</span><span class="mtk1">, </span><span class="mtk7 mtki">f</span><span class="mtk4">"Error occured!</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">)</span>
</code></pre></div><p>Las implementaciones de <code>add</code> y <code>multiply</code> son correctas, pero el servidor no verifica que los puntos de entrada pertenezcan a la curva&mldr; Por lo tanto, el servidor es vulnerable a un Ataque de Curva Inválida.</p><h3 id="ataque-de-curva-inválida">Ataque de Curva Inválida</h3><p>Sabemos que ECC depende de la dificultad para resolver el ECDLP, es decir, encontrar $n$ dados $G$ y $nG$. Este problema es más fácil de resolver cuando el orden de la curva tiene factores primos pequeños (también conocido como suave, <em>smooth</em>), usando el <a href="https://en.wikipedia.org/wiki/Pohlig%E2%80%93Hellman_algorithm">algoritmo de Pohligh-Hellman</a>.</p><p>Como el servidor no verifica los puntos de entrada, podemos definir una curva similar a la curva del servidor (<a href="https://neuromancer.sk/std/secg/secp256r1">secp256r1</a>), cambiando la $b$, hasta que el orden de la curva sea suave (<em>smooth</em>). Luego, tomaremos un punto generador $G$ de esta nueva curva y lo enviaremos al servidor. El servidor calculará $S = \mathrm{flag} \cdot G$. Obviamente, $S$ no es un punto de la curva del servidor, pero sí de nuestra curva. Ahora podemos resolver el ECDLP y encontrar $\mathrm{flag}$ a partir de $G$ y $\mathrm{flag} \cdot G$, ya que el orden de nuestra curva es <em>smooth</em>.</p><p>Entonces, en primer lugar, usemos diferentes valores por $b$ hasta encontrar uno que dé una curva con orden <em>smooth</em>. En SageMath, podemos usar el siguiente código:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">#!/usr/bin/env sage</span>

<span class="mtk1">a</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">ffffffff00000001000000000000000000000000ffffffffff</span><span class="mtk6">fffffffffffffc</span>
<span class="mtk1">p</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">ffffffff00000001000000000000000000000000ffffffffff</span><span class="mtk6">ffffffffffffff</span>

<span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">10</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk5">try</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk7 mtki">f</span><span class="mtk4">"</span><span class="mtk6">{</span><span class="mtk1">b</span><span class="mtk1"> = </span><span class="mtk6">}</span><span class="mtk4">. Curve's order:"</span>, <span class="mtk8">factor</span>(<span class="mtk8 mtku">EllipticCurve</span>(<span class="mtk8 mtku">GF</span>(<span class="mtk1">p</span><span class="mtk1">), [</span><span class="mtk1">a</span><span class="mtk1">, </span><span class="mtk1">b</span>]).<span class="mtk8">order</span>()))  
<span class="mtk1">    </span><span class="mtk5">except</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk5">pass</span>
</code></pre></div><p>Y estos son los resultados:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">sage</span> <span class="mtku">test_parameters.sage</span>
b = 0. Curve's order: 2^96 * 7 * 274177 * 67280421310721 * 11318308927973941931404914103
b = 1. Curve's order: 71 * 823 * 1229 * 7489 * 30203 * 1275057701 * 5590685618197487513633360286414913886653362665945221
b = 3. Curve's order: 2^4 * 3 * 7 * 13 * 37 * 97 * 113 * 65364863466230065009299609518518318921279098632127819301704248465833
b = 4. Curve's order: 2^2 * 13 * 19 * 179 * 13003 * 1307093479 * 218034068577407083 * 16884307952548170257 * 10464321644447000442097  
b = 5. Curve's order: 2^2 * 3 * 7 * 13 * 2447 * 43333351749528183857746664058033075385207938864390055103100636196733549
b = 6. Curve's order: 2^2 * 5 * 4003 * 16033 * 102001 * 884390526899024919222120216398419141830968591728388637593606029
b = 7. Curve's order: 2^3 * 1151 * 7103 * 68360856945170627439059632547237 * 25897883110213973866199776436038742629
b = 8. Curve's order: 2^2 * 3 * 5 * 179 * 81173 * 132819857987697940358590682448908949725127147465817820814841295533643
b = 9. Curve's order: 2^2 * 7 * 653 * 72337 * 119591 * 88586821697531 * 8263795586816543575234964957311495031799816731687
</code></pre></div><p>Parece que $b = 4$ da un orden suficientemente suave. Tal vez los últimos tres factores siguen siendo grandes, pero los pequeños deberían ser suficientes para resolver el ECDLP.</p><h2 id="implementación-del-ataque">Implementación del ataque</h2><p>Para implementar el Ataque de Curva Inválida, debemos tomar la curva vulnerable y encontrar un punto generador $G$. Luego, enviarlo al servidor y resolver el ECDLP. Estas tareas se implementan en el siguiente código Python (importando funciones de SageMath):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">#!/usr/bin/env python3</span>

<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">Crypto</span><span class="mtk1">.</span><span class="mtk8 mtku">Util</span><span class="mtk1">.</span><span class="mtk8 mtku">number</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8">long_to_bytes</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">pwn</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk1">log</span><span class="mtk1">, </span><span class="mtk8 mtku">remote</span><span class="mtk1">, </span><span class="mtk8 mtku">sys</span>
<span class="mtk5">from</span><span class="mtk1"> <span class="mtk8 mtku">sage</span>.<span class="mtk8 mtku">all</span> </span><span class="mtk5">import</span><span class="mtk1"> <span class="mtk8">crt</span>, <span class="mtk8">discrete_log</span>, <span class="mtk8 mtku">EllipticCurve</span>, <span class="mtk8">factor</span>, </span><span class="mtk8 mtku">GF</span>

<span class="mtk1">a</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">ffffffff00000001000000000000000000000000ffffffffff</span><span class="mtk6">fffffffffffffc</span>
<span class="mtk1">p</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">ffffffff00000001000000000000000000000000ffffffffff</span><span class="mtk6">ffffffffffffff</span>
<span class="mtk1">Fp</span><span class="mtk1"> </span><span class="mtk5">=</span> <span class="mtk8 mtku">GF</span>(<span class="mtk1">p</span><span class="mtk1">)</span>
<span class="mtk1">host</span><span class="mtk1">, </span><span class="mtk1">port</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">sys</span><span class="mtk1">.</span><span class="mtk1">argv</span><span class="mtk1">[</span><span class="mtk6">1</span><span class="mtk1">].</span><span class="mtk8">split</span><span class="mtk1">(</span><span class="mtk4">':'</span><span class="mtk1">)</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_S</span><span class="mtk1">(</span><span class="mtk9 mtki">b</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">E</span><span class="mtk1"> </span><span class="mtk5">=</span> <span class="mtk8 mtku">EllipticCurve</span>(<span class="mtk1">Fp</span><span class="mtk1">, [</span><span class="mtk1">a</span><span class="mtk1">, </span><span class="mtk9 mtki">b</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">order</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">E</span><span class="mtk1">.</span><span class="mtk8">order</span>()
<span class="mtk1">    </span><span class="mtk1">factors</span><span class="mtk1"> </span><span class="mtk5">=</span> <span class="mtk8">factor</span>(<span class="mtk1">order</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">G</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">E</span>.<span class="mtk8">gens</span>()[<span class="mtk6">0</span><span class="mtk1">]</span>
<span class="mtk1">    </span><span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">info</span><span class="mtk1">(</span><span class="mtk7 mtki">f</span><span class="mtk4">'ord(E_</span><span class="mtk6">{</span><span class="mtk9 mtki">b</span><span class="mtk6">}</span><span class="mtk4">) = </span><span class="mtk6">{</span><span class="mtk1">factors</span><span class="mtk6">}</span><span class="mtk4">'</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">io</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">remote</span><span class="mtk1">(</span><span class="mtk1">host</span><span class="mtk1">, </span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">port</span><span class="mtk1">))</span>

<span class="mtk1">    </span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Awaiting public key of the client...</span><span class="mtk6">\n</span><span class="mtk4">'</span><span class="mtk1">, </span><span class="mtk7 mtki">f</span><span class="mtk4">'</span><span class="mtk6">{</span><span class="mtk1">G</span><span class="mtk1">[</span><span class="mtk6">0</span><span class="mtk1">]</span><span class="mtk6">}</span><span class="mtk4"> </span><span class="mtk6">{</span><span class="mtk1">G</span><span class="mtk1">[</span><span class="mtk6">1</span><span class="mtk1">]</span><span class="mtk6">}</span><span class="mtk4">'</span><span class="mtk1">.</span><span class="mtk8">encode</span><span class="mtk1">())</span>  
<span class="mtk1">    </span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">recvuntil</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Shared secret: '</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">S_tuple</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">eval</span><span class="mtk1">(</span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">().</span><span class="mtk8">decode</span><span class="mtk1">())</span>
<span class="mtk1">    </span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">close</span><span class="mtk1">()</span>

<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk1">order</span><span class="mtk1">, </span><span class="mtk1">G</span><span class="mtk1">, </span><span class="mtk1">factors</span><span class="mtk1">, </span><span class="mtk1">E</span><span class="mtk1">(</span><span class="mtk1">S_tuple</span><span class="mtk1">)</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_dlogs</span><span class="mtk1">(</span><span class="mtk9 mtki">S</span><span class="mtk1">, </span><span class="mtk9 mtki">G</span><span class="mtk1">, </span><span class="mtk9 mtki">order</span><span class="mtk1">, </span><span class="mtk9 mtki">factors</span><span class="mtk1">, </span><span class="mtk9 mtki">new_factors</span><span class="mtk1">, </span><span class="mtk9 mtki">dlogs</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">prime</span><span class="mtk1">, </span><span class="mtk1">exponent</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk9 mtki">factors</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">info</span><span class="mtk1">(</span><span class="mtk7 mtki">f</span><span class="mtk4">'</span><span class="mtk6">{</span><span class="mtk1">prime</span><span class="mtk1"> = </span><span class="mtk6">}</span><span class="mtk4">, </span><span class="mtk6">{</span><span class="mtk1">exponent</span><span class="mtk1"> = </span><span class="mtk6">}</span><span class="mtk4">'</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk9 mtki">new_factors</span><span class="mtk1">.append(</span><span class="mtk1">prime</span><span class="mtk1"> </span><span class="mtk5">**</span><span class="mtk1"> </span><span class="mtk1">exponent</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk1">t</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk9 mtki">order</span><span class="mtk1"> </span><span class="mtk5">//</span><span class="mtk1"> </span><span class="mtk9 mtki">new_factors</span><span class="mtk1">[</span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">]</span>
<span class="mtk1">        </span><span class="mtk9 mtki">dlogs</span><span class="mtk1">.append(discrete_log(</span><span class="mtk1">t</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk9 mtki">S</span><span class="mtk1">, </span><span class="mtk1">t</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk9 mtki">G</span><span class="mtk1">, </span><span class="mtk9 mtki">operation</span><span class="mtk5">=</span><span class="mtk4">'+'</span><span class="mtk1">))</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">():</span>
<span class="mtk1">    </span><span class="mtk1">order</span><span class="mtk1">, </span><span class="mtk1">G</span><span class="mtk1">, </span><span class="mtk1">factors</span><span class="mtk1">, </span><span class="mtk1">S</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_S</span><span class="mtk1">(</span><span class="mtk6">4</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">new_factors</span><span class="mtk1">, </span><span class="mtk1">dlogs</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> [], []</span>

<span class="mtk1">    </span><span class="mtk8">get_dlogs</span><span class="mtk1">(</span><span class="mtk1">S</span><span class="mtk1">, </span><span class="mtk1">G</span><span class="mtk1">, </span><span class="mtk1">order</span><span class="mtk1">, </span><span class="mtk1">factors</span><span class="mtk1">[:</span><span class="mtk5">-</span><span class="mtk6">3</span><span class="mtk1">], </span><span class="mtk1">new_factors</span><span class="mtk1">, </span><span class="mtk1">dlogs</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">flag</span><span class="mtk1"> </span><span class="mtk5">=</span> <span class="mtk8">crt</span>(<span class="mtk1">dlogs</span><span class="mtk1">, </span><span class="mtk1">new_factors</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">success</span><span class="mtk1">(</span><span class="mtk8">long_to_bytes</span><span class="mtk1">(</span><span class="mtk1">flag</span><span class="mtk1">).</span><span class="mtk8">decode</span><span class="mtk1">())</span>


<span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk1">__name__</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk4">'__main__'</span><span class="mtk1">:</span>
<span class="mtk1">    </span><span class="mtk8">main</span><span class="mtk1">()</span>
</code></pre></div><p>Sin embargo, parece que la <em>flag</em> no encaja en el módulo del CRT:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span> 142.93.33.226:32737
[<span class="code-blue">*</span>] ord(E_4) = 2^2 * 13 * 19 * 179 * 13003 * 1307093479 * 218034068577407083 * 16884307952548170257 * 10464321644447000442097  
[<span class="code-green">+</span>] Opening connection to 142.93.33.226 on port 32737: Done
[<span class="code-blue">*</span>] Closed connection to 142.93.33.226 port 32737
[<span class="code-blue">*</span>] prime = 2, exponent = 2
[<span class="code-blue">*</span>] prime = 13, exponent = 1
[<span class="code-blue">*</span>] prime = 19, exponent = 1
[<span class="code-blue">*</span>] prime = 179, exponent = 1
[<span class="code-blue">*</span>] prime = 13003, exponent = 1
[<span class="code-blue">*</span>] prime = 1307093479, exponent = 1
<span class="code-dark-blue">Traceback (most recent call last):</span>
  File <span class="code-dark-green">"solve.py"</span>, line <span class="code-grey">56</span>, in &lt;module&gt;
    main()
  File <span class="code-dark-green">"solve.py"</span>, line <span class="code-grey">52</span>, in main
    log<span class="code-grey">.</span>success(long_to_bytes(flag)<span class="code-grey">.</span>decode())
<span class="code-red">UnicodeDecodeError</span>: 'utf-8' codec can't decode byte 0xb4 in position 1: invalid start byte
</code></pre></div><p>Obsérvese que el orden de la curva legítima es muy grande, en comparación con el módulo del CRT:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> -q
&gt;&gt;&gt; 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff  
115792089210356248762697446949407573530086143415290314195533631308867097853951
&gt;&gt;&gt; 2 ** 2 * 13 * 19 * 179 * 13003 * 1307093479
3005800733613248324
</code></pre></div><p>Por lo tanto, debemos resolver el ECDLP completo, que es muy difícil y lento. Pero hay una alternativa: podemos aplicar el mismo ataque varias veces. Por ejemplo, tomemos también $b = 0$ y $b = 1$:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">():</span>
<span class="mtk1">    </span><span class="mtk1">order_0</span><span class="mtk1">, </span><span class="mtk1">G_0</span><span class="mtk1">, </span><span class="mtk1">factors_0</span><span class="mtk1">, </span><span class="mtk1">S_0</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_S</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">order_1</span><span class="mtk1">, </span><span class="mtk1">G_1</span><span class="mtk1">, </span><span class="mtk1">factors_1</span><span class="mtk1">, </span><span class="mtk1">S_1</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_S</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">order_4</span><span class="mtk1">, </span><span class="mtk1">G_4</span><span class="mtk1">, </span><span class="mtk1">factors_4</span><span class="mtk1">, </span><span class="mtk1">S_4</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_S</span><span class="mtk1">(</span><span class="mtk6">4</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">new_factors</span><span class="mtk1">, </span><span class="mtk1">dlogs</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> [], []</span>

<span class="mtk1">    </span><span class="mtk8">get_dlogs</span><span class="mtk1">(</span><span class="mtk1">S_0</span><span class="mtk1">, </span><span class="mtk1">G_0</span><span class="mtk1">, </span><span class="mtk1">order_0</span><span class="mtk1">, </span><span class="mtk1">factors_0</span><span class="mtk1">[:</span><span class="mtk5">-</span><span class="mtk6">2</span><span class="mtk1">], </span><span class="mtk1">new_factors</span><span class="mtk1">, </span><span class="mtk1">dlogs</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk8">get_dlogs</span><span class="mtk1">(</span><span class="mtk1">S_1</span><span class="mtk1">, </span><span class="mtk1">G_1</span><span class="mtk1">, </span><span class="mtk1">order_1</span><span class="mtk1">, </span><span class="mtk1">factors_1</span><span class="mtk1">[:</span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">], </span><span class="mtk1">new_factors</span><span class="mtk1">, </span><span class="mtk1">dlogs</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk8">get_dlogs</span><span class="mtk1">(</span><span class="mtk1">S_4</span><span class="mtk1">, </span><span class="mtk1">G_4</span><span class="mtk1">, </span><span class="mtk1">order_4</span><span class="mtk1">, </span><span class="mtk1">factors_4</span><span class="mtk1">[</span><span class="mtk6">1</span><span class="mtk1">:</span><span class="mtk5">-</span><span class="mtk6">3</span><span class="mtk1">], </span><span class="mtk1">new_factors</span><span class="mtk1">, </span><span class="mtk1">dlogs</span><span class="mtk1">)</span>  

<span class="mtk1">    </span><span class="mtk1">flag</span><span class="mtk1"> </span><span class="mtk5">=</span> <span class="mtk8">crt</span>(<span class="mtk1">dlogs</span><span class="mtk1">, </span><span class="mtk1">new_factors</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">success</span><span class="mtk1">(</span><span class="mtk8">long_to_bytes</span><span class="mtk1">(</span><span class="mtk1">flag</span><span class="mtk1">).</span><span class="mtk8">decode</span><span class="mtk1">())</span>
</code></pre></div><p>Nótese que estamos omitiendo el factor $2^2$ de la curva de $b = 4$ porque hay un factor $2^{96}$ de la curva con $b = 0$ (los módulos del CRT tienen que ser coprimos).</p><h2 id="_flag_"><em>Flag</em></h2><p>Y ahora funciona. Aquí tenemos la <em>flag</em>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span> 142.93.33.226:32737
[<span class="code-blue">*</span>] ord(E_0) = 2^96 * 7 * 274177 * 67280421310721 * 11318308927973941931404914103
[<span class="code-green">+</span>] Opening connection to 142.93.33.226 on port 32737: Done
[<span class="code-blue">*</span>] Closed connection to 142.93.33.226 port 32737
[<span class="code-blue">*</span>] ord(E_1) = 71 * 823 * 1229 * 7489 * 30203 * 1275057701 * 5590685618197487513633360286414913886653362665945221
[<span class="code-green">+</span>] Opening connection to 142.93.33.226 on port 32737: Done
[<span class="code-blue">*</span>] Closed connection to 142.93.33.226 port 32737
[<span class="code-blue">*</span>] ord(E_4) = 2^2 * 13 * 19 * 179 * 13003 * 1307093479 * 218034068577407083 * 16884307952548170257 * 10464321644447000442097  
[<span class="code-green">+</span>] Opening connection to 142.93.33.226 on port 32737: Done
[<span class="code-blue">*</span>] Closed connection to 142.93.33.226 port 32737
[<span class="code-blue">*</span>] prime = 2, exponent = 96
[<span class="code-blue">*</span>] prime = 7, exponent = 1
[<span class="code-blue">*</span>] prime = 274177, exponent = 1
[<span class="code-blue">*</span>] prime = 71, exponent = 1
[<span class="code-blue">*</span>] prime = 823, exponent = 1
[<span class="code-blue">*</span>] prime = 1229, exponent = 1
[<span class="code-blue">*</span>] prime = 7489, exponent = 1
[<span class="code-blue">*</span>] prime = 30203, exponent = 1
[<span class="code-blue">*</span>] prime = 1275057701, exponent = 1
[<span class="code-blue">*</span>] prime = 13, exponent = 1
[<span class="code-blue">*</span>] prime = 19, exponent = 1
[<span class="code-blue">*</span>] prime = 179, exponent = 1
[<span class="code-blue">*</span>] prime = 13003, exponent = 1
[<span class="code-blue">*</span>] prime = 1307093479, exponent = 1
[<span class="code-green">+</span>] HTB{1nv411d_cu2v3_4774cks_ftw!!}
</code></pre></div><p>Para obtener más información sobre este reto, recomiendo leer el <a href="https://www.hackthebox.com/blog/business-ctf-2022-400-curves-write-up"><em>write-up</em> del <em>blog</em> de Hack The Box</a>.</p><p>El <em>script</em> completo se puede encontrar aquí: <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Challenges/Crypto/400curves/solve.py"><code>solve.py</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#contexto-de-ecc">Contexto de ECC</a></li><li><a href="#el-fallo-de-seguridad">El fallo de seguridad</a><ul><li><a href="#ataque-de-curva-inválida">Ataque de Curva Inválida</a></li></ul></li><li><a href="#implementación-del-ataque">Implementación del ataque</a></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Recibe un resumen semanal del blog"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Suscribirse"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">Ver historial de resúmenes</a></p><p class="tc">impulsado por <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; Blog de 7Rocky. Ciberseguridad y Mates 2024</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>