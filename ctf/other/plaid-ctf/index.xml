<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Plaid CTF on Blog de 7Rocky. Ciberseguridad y Mates</title><link>https://7rocky.github.io/ctf/other/plaid-ctf/</link><description>Recent content in Plaid CTF on Blog de 7Rocky. Ciberseguridad y Mates</description><generator>Hugo</generator><language>es</language><atom:link href="https://7rocky.github.io/ctf/other/plaid-ctf/index.xml" rel="self" type="application/rss+xml"/><item><title>DHCPPP</title><link>https://7rocky.github.io/ctf/other/plaid-ctf/dhcppp/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/other/plaid-ctf/dhcppp/</guid><description>&lt;p>Se nos proporciona el cÃ³digo fuente en Python del servidor que tiene la &lt;em>flag&lt;/em>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2">&lt;code class="no-highlight">&lt;span class="mtk5">import&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">time&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">zlib&lt;/span>
&lt;span class="mtk5">import&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">secrets&lt;/span>
&lt;span class="mtk5">import&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">hashlib&lt;/span>
&lt;span class="mtk5">import&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">requests&lt;/span>
&lt;span class="mtk5">from&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">Crypto&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8 mtku">Cipher&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">import&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">ChaCha20_Poly1305&lt;/span>
&lt;span class="mtk5">import&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">dns&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8 mtku">resolver&lt;/span>

&lt;span class="mtk1">CHACHA_KEY&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">secrets&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">token_bytes&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">32&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1">TIMEOUT&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">1e-1&lt;/span>

&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">encrypt_msg&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">nonce&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># In case our RNG nonce is repeated, we also hash&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># the message in. This means the worst-case scenar&lt;/span>&lt;span class="mtk3">io&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># is that our nonce reflects a hash of the message&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># but saves the chance of a nonce being reused acr&lt;/span>&lt;span class="mtk3">oss&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># different messages&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">nonce&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">sha256&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">[:&lt;/span>&lt;span class="mtk6">32&lt;/span>&lt;span class="mtk1">] &lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">nonce&lt;/span>&lt;span class="mtk1">[:&lt;/span>&lt;span class="mtk6">32&lt;/span>&lt;span class="mtk1">])[:&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">]&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">cipher&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">ChaCha20_Poly1305&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">new&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">key&lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1">CHACHA_KEY&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">nonce&lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk9 mtki">nonce&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ct&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk1">tag&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">cipher&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">encrypt_and_digest&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ct&lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk1">tag&lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk9 mtki">nonce&lt;/span>

&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">decrypt_msg&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ct&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">[:&lt;/span>&lt;span class="mtk5">-&lt;/span>&lt;span class="mtk6">28&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">tag&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk5">-&lt;/span>&lt;span class="mtk6">28&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk5">-&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">nonce&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk5">-&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">:]&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">cipher&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">ChaCha20_Poly1305&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">new&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">key&lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1">CHACHA_KEY&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">nonce&lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1">nonce&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">pt&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">cipher&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">decrypt_and_verify&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">ct&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk1">tag&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">pt&lt;/span>

&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">calc_crc&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">zlib&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">crc32&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">).&lt;/span>&lt;span class="mtk8">to_bytes&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">4&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk4">"little"&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">sha256&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">hashlib&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">sha256&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">msg&lt;/span>&lt;span class="mtk1">).&lt;/span>&lt;span class="mtk8">digest&lt;/span>&lt;span class="mtk1">()&lt;/span>

&lt;span class="mtk1">RNG_INIT&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">secrets&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">token_bytes&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">512&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk7 mtki">class&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">DHCPServer&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7">__init__&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">leases&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> []&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">ips&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> [&lt;/span>&lt;span class="mtk7 mtki">f&lt;/span>&lt;span class="mtk4">"192.168.1.&lt;/span>&lt;span class="mtk6">{&lt;/span>&lt;span class="mtk1">i&lt;/span>&lt;span class="mtk6">}&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">i&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">range&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">3&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">64&lt;/span>&lt;span class="mtk1">)]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytes&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">fromhex&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"1b 7d 6f 49 37 c9"&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">gateway_ip&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"192.168.1.1"&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">leases&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">append&lt;/span>&lt;span class="mtk1">((&lt;/span>&lt;span class="mtk4">"192.168.1.2"&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"rngserver_0"&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">time&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">time&lt;/span>&lt;span class="mtk1">(), []))&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">get_lease&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">dev_name&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">len&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">ips&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">!=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">0&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">ips&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">pop&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">0&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">leases&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">append&lt;/span>&lt;span class="mtk1">((&lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">dev_name&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">time&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">time&lt;/span>&lt;span class="mtk1">(), []))&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">else&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># relinquish the oldest lease&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">old_lease&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">leases&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">pop&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">0&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">old_lease&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">0&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">leases&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">append&lt;/span>&lt;span class="mtk1">((&lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">dev_name&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">time&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">time&lt;/span>&lt;span class="mtk1">(), []))&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">pkt&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytearray&lt;/span>&lt;span class="mtk1">(&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytes&lt;/span>&lt;span class="mtk1">([&lt;/span>&lt;span class="mtk8 mtku">int&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">split&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"."&lt;/span>&lt;span class="mtk1">)]) &lt;/span>&lt;span class="mtk5">+&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytes&lt;/span>&lt;span class="mtk1">([&lt;/span>&lt;span class="mtk8 mtku">int&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">gateway_ip&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">split&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"."&lt;/span>&lt;span class="mtk1">)]) &lt;/span>&lt;span class="mtk5">+&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytes&lt;/span>&lt;span class="mtk1">([&lt;/span>&lt;span class="mtk6">255&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">255&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">255&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">0&lt;/span>&lt;span class="mtk1">]) &lt;/span>&lt;span class="mtk5">+&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytes&lt;/span>&lt;span class="mtk1">([&lt;/span>&lt;span class="mtk6">8&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">8&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">8&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">8&lt;/span>&lt;span class="mtk1">]) &lt;/span>&lt;span class="mtk5">+&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytes&lt;/span>&lt;span class="mtk1">([&lt;/span>&lt;span class="mtk6">8&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">8&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">4&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk6">4&lt;/span>&lt;span class="mtk1">]) &lt;/span>&lt;span class="mtk5">+&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">dev_name&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">+&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk6">\x00&lt;/span>&lt;span class="mtk4">"&lt;/span>
&lt;span class="mtk1"> )&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">pkt&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk6">\x02&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">encrypt_msg&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">pkt&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">get_entropy_from_lavalamps&lt;/span>&lt;span class="mtk1">()) &lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">calc_crc&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">pkt&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">pkt&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">get_entropy_from_lavalamps&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># Get entropy from all available lava-lamp RNG ser&lt;/span>&lt;span class="mtk3">vers&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># Falling back to local RNG if necessary&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">entropy_pool&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">RNG_INIT&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk1">name&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk1">ts&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk1">tags&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">leases&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"rngserver"&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">name&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">try&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># get entropy from the server&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">output&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">requests&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">get&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk7 mtki">f&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk4 detected-link">http://&lt;/span>&lt;span class="mtk6 detected-link">{&lt;/span>&lt;span class="mtk1 detected-link">ip&lt;/span>&lt;span class="mtk6">}&lt;/span>&lt;span class="mtk4">/get_rng"&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">timeout&lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1">TIMEOUT&lt;/span>&lt;span class="mtk1">).&lt;/span>&lt;span class="mtk1">text&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">entropy_pool&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">+=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">sha256&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">output&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">encode&lt;/span>&lt;span class="mtk1">())&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">except&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># if the server is broken, get randomness from loc&lt;/span>&lt;span class="mtk3">al RNG instead&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">entropy_pool&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">+=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">sha256&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk8 mtku">secrets&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">token_bytes&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">512&lt;/span>&lt;span class="mtk1">))&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">sha256&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">entropy_pool&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">process_pkt&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">assert&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">is&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">not&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">src_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[:&lt;/span>&lt;span class="mtk6">6&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">dst_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">6&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">:]&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">dst_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">!=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">mac&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">src_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">==&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">mac&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">len&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">and&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">.startswith(&lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk6">\x01&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># lease request&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">dev_name&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">1&lt;/span>&lt;span class="mtk1">:]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">lease_resp&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">get_lease&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">dev_name&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> (&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">+&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">src_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># dest mac&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">lease_resp&lt;/span>
&lt;span class="mtk1"> )&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">else&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk7 mtki">class&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">FlagServer&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7">__init__&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">dhcp&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytes&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">fromhex&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"53 79 82 b5 97 eb"&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">dns&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8 mtku">resolver&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8 mtku">Resolver&lt;/span>&lt;span class="mtk1">()&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">process_pkt&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">dhcp&lt;/span>&lt;span class="mtk1">.process_pkt(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">mac&lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk9 mtki">dhcp&lt;/span>&lt;span class="mtk1">.mac&lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk6">\x01&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"flag_server"&lt;/span>&lt;span class="mtk1">))&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">send_flag&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">with&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">open&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"flag.txt"&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk4">"r"&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">as&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">f&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">flag&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">f&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">read&lt;/span>&lt;span class="mtk1">().&lt;/span>&lt;span class="mtk8">strip&lt;/span>&lt;span class="mtk1">()&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">curl&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"example.com"&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk7 mtki">f&lt;/span>&lt;span class="mtk4">"/&lt;/span>&lt;span class="mtk6">{&lt;/span>&lt;span class="mtk1">flag&lt;/span>&lt;span class="mtk6">}&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">process_pkt&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">assert&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">is&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">not&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">src_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[:&lt;/span>&lt;span class="mtk6">6&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">dst_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">6&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">:]&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">dst_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">!=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">mac&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">src_mac&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">==&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">mac&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">len&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">and&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">.startswith(&lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk6">\x02&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># lease response&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">1&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk5">-&lt;/span>&lt;span class="mtk6">4&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">decrypt_msg&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">crc&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk5">-&lt;/span>&lt;span class="mtk6">4&lt;/span>&lt;span class="mtk1">:]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">assert&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">crc&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">==&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">calc_crc&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"."&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">join&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk8 mtku">str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">0&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk6">4&lt;/span>&lt;span class="mtk1">])&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">gateway_ip&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"."&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">join&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk8 mtku">str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">4&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk6">8&lt;/span>&lt;span class="mtk1">])&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">subnet_mask&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"."&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">join&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk8 mtku">str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">8&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">])&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns1&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"."&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">join&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk8 mtku">str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">12&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk6">16&lt;/span>&lt;span class="mtk1">])&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns2&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"."&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">join&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk8 mtku">str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">x&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">[&lt;/span>&lt;span class="mtk6">16&lt;/span>&lt;span class="mtk1">:&lt;/span>&lt;span class="mtk6">20&lt;/span>&lt;span class="mtk1">])&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">nameservers&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> [&lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns1&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns2&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">assert&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">pkt&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">endswith&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk6">\x00&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">print&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"[FLAG SERVER] [DEBUG] Got DHCP lease"&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">gateway_ip&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">subnet_mask&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns1&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk1">dns2&lt;/span>&lt;span class="mtk1">)&lt;/span> 

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">elif&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">len&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">) &lt;/span>&lt;span class="mtk5">and&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">msg&lt;/span>&lt;span class="mtk1">.startswith(&lt;/span>&lt;span class="mtk7 mtki">b&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk6">\x03&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk3"># FREE FLAGES!!!!!!!&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">self&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">send_flag&lt;/span>&lt;span class="mtk1">()&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">else&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">return&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>

&lt;span class="mtk7 mtki">def&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">curl&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">url&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">path&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk9 mtki">dns&lt;/span>&lt;span class="mtk1">):&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ip&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">dns&lt;/span>&lt;span class="mtk1">.resolve(&lt;/span>&lt;span class="mtk9 mtki">url&lt;/span>&lt;span class="mtk1">).response.resolve_chaining().answer).&lt;/span>&lt;span class="mtk8">strip&lt;/span>&lt;span class="mtk1">().&lt;/span>&lt;span class="mtk8">split&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">" "&lt;/span>&lt;span class="mtk1">)[&lt;/span>&lt;span class="mtk5">-&lt;/span>&lt;span class="mtk6">1&lt;/span>&lt;span class="mtk1">]&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">url&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"http://"&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">ip&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">print&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk7 mtki">f&lt;/span>&lt;span class="mtk4">"Sending flage to &lt;/span>&lt;span class="mtk6">{&lt;/span>&lt;span class="mtk9 mtki">url&lt;/span>&lt;span class="mtk6">}&lt;/span>&lt;span class="mtk4">"&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">requests&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">get&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk9 mtki">url&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">+&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk9 mtki">path&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">__name__&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">==&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"__main__"&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">dhcp&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">DHCPServer&lt;/span>&lt;span class="mtk1">()&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">flagserver&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">FlagServer&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">dhcp&lt;/span>&lt;span class="mtk1">)&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">while&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">True&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">pkt&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bytes&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">fromhex&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk8">input&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"&amp;gt; "&lt;/span>&lt;span class="mtk1">).&lt;/span>&lt;span class="mtk8">replace&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">" "&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk4">""&lt;/span>&lt;span class="mtk1">).&lt;/span>&lt;span class="mtk8">strip&lt;/span>&lt;span class="mtk1">())&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">out&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">dhcp&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">process_pkt&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">pkt&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">out&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">is&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">not&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">print&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">out&lt;/span>&lt;span class="mtk1">.hex())&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">out&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">flagserver&lt;/span>&lt;span class="mtk1">.&lt;/span>&lt;span class="mtk8">process_pkt&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">pkt&lt;/span>&lt;span class="mtk1">)&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk1">out&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">is&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">not&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">None&lt;/span>&lt;span class="mtk1">:&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">print&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk1">out&lt;/span>&lt;span class="mtk1">.hex())&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>

&lt;h2 id="anÃ¡lisis-del-cÃ³digo-fuente">AnÃ¡lisis del cÃ³digo fuente&lt;/h2>
&lt;p>El servidor nos permite conectarnos usando una conexiÃ³n TCP, y se nos pide que enviemos un paquete:&lt;/p></description></item><item><title>Paranormial Commitment Scheme</title><link>https://7rocky.github.io/ctf/other/plaid-ctf/paranormial-commitment-scheme/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://7rocky.github.io/ctf/other/plaid-ctf/paranormial-commitment-scheme/</guid><description>&lt;p>Se nos proporciona el cÃ³digo fuente en Rust del proyecto que se utiliza para cifrar la &lt;em>flag&lt;/em>.&lt;/p>
&lt;p>Este es el archivo principal (&lt;code>src/bin/paranormial.rs&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2">&lt;code class="no-highlight">&lt;span class="mtk5">use&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">pairing_ce&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk1">{&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">bls12_381&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk1">{&lt;/span>&lt;span class="mtk8 mtku">Fr&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">G1Affine&lt;/span>&lt;span class="mtk1">},&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">ff&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk1">{&lt;/span>&lt;span class="mtk8 mtku">Field&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">PrimeField&lt;/span>&lt;span class="mtk1">}, &lt;/span>&lt;span class="mtk8 mtku">CurveAffine&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">GenericCurveProjective&lt;/span>&lt;span class="mtk1">,&lt;/span>
&lt;span class="mtk1">};&lt;/span>
&lt;span class="mtk5">use&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">paranormial&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk1">{&lt;/span>&lt;span class="mtk8 mtku">Polynomial&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">Setup&lt;/span>&lt;span class="mtk1">};&lt;/span>
&lt;span class="mtk5">use&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">primitive_types&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8 mtku">U256&lt;/span>&lt;span class="mtk1">;&lt;/span>
&lt;span class="mtk5">use&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">rand&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk1">{&lt;/span>&lt;span class="mtk8 mtku">OsRng&lt;/span>&lt;span class="mtk1">, &lt;/span>&lt;span class="mtk8 mtku">Rng&lt;/span>&lt;span class="mtk1">};&lt;/span>
&lt;span class="mtk5">use&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">std&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk1">{&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">fs&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8 mtku">File&lt;/span>&lt;span class="mtk1">,&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">io&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8 mtku">Read&lt;/span>&lt;span class="mtk1">,&lt;/span>
&lt;span class="mtk1">};&lt;/span>

&lt;span class="mtk7 mtki">const&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">DEGREE&lt;/span>&lt;span class="mtk5">:&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">usize&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">256&lt;/span>&lt;span class="mtk1">;&lt;/span>
&lt;span class="mtk7 mtki">const&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">ALPHA&lt;/span>&lt;span class="mtk5">:&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">&amp;amp;&lt;/span>&lt;span class="mtk8 mtku">str&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk4">"1337133713371337133713371337133713371337133713371&lt;/span>&lt;span class="mtk4">337133713371337133713371337"&lt;/span>&lt;span class="mtk1">;&lt;/span> 

&lt;span class="mtk7 mtki">const&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">NUM_POINTS&lt;/span>&lt;span class="mtk5">:&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">usize&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">512&lt;/span>&lt;span class="mtk1">;&lt;/span>
&lt;span class="mtk7 mtki">const&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">PARANOMIAL_RATE&lt;/span>&lt;span class="mtk5">:&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">u32&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">3&lt;/span>&lt;span class="mtk1">;&lt;/span>

&lt;span class="mtk5">fn&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">main&lt;/span>&lt;span class="mtk1">() {&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> setup_path &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">std&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8 mtku">env&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">args&lt;/span>&lt;span class="mtk1">()&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">nth&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">1&lt;/span>&lt;span class="mtk1">)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">expect&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"no output file given"&lt;/span>&lt;span class="mtk1">);&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> flag_path &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">std&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8 mtku">env&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">args&lt;/span>&lt;span class="mtk1">()&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">nth&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">2&lt;/span>&lt;span class="mtk1">)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">expect&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"no flag file given"&lt;/span>&lt;span class="mtk1">);&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> output_path &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">std&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8 mtku">env&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">args&lt;/span>&lt;span class="mtk1">()&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">nth&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">3&lt;/span>&lt;span class="mtk1">)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">expect&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"no output file given"&lt;/span>&lt;span class="mtk1">);&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> f &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">File&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">open&lt;/span>&lt;span class="mtk1">(setup_path)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">unwrap&lt;/span>&lt;span class="mtk1">();&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> setup&lt;/span>&lt;span class="mtk5">:&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">Setup&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">serde_json&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">from_reader&lt;/span>&lt;span class="mtk1">(f)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">expect&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"error deserializing setup"&lt;/span>&lt;span class="mtk1">);&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">mut&lt;/span>&lt;span class="mtk1"> poly &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">Polynomial&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">rand&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">DEGREE&lt;/span>&lt;span class="mtk1">);&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">mut&lt;/span>&lt;span class="mtk1"> f &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">File&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">open&lt;/span>&lt;span class="mtk1">(flag_path)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">unwrap&lt;/span>&lt;span class="mtk1">();&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">mut&lt;/span>&lt;span class="mtk1"> flag &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> [&lt;/span>&lt;span class="mtk6">0&lt;/span>&lt;span class="mtk8 mtku">u8&lt;/span>&lt;span class="mtk1">; &lt;/span>&lt;span class="mtk6">32&lt;/span>&lt;span class="mtk1">];&lt;/span>
&lt;span class="mtk1"> f&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">read&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk5">&amp;amp;mut&lt;/span>&lt;span class="mtk1"> flag)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">expect&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"error reading flag file"&lt;/span>&lt;span class="mtk1">);&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> flag &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">U256&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">from_big_endian&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk5">&amp;amp;&lt;/span>&lt;span class="mtk1">flag);&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">mut&lt;/span>&lt;span class="mtk1"> offset &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">Fr&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">from_str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk5">&amp;amp;&lt;/span>&lt;span class="mtk1">flag&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">to_string&lt;/span>&lt;span class="mtk1">())&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">unwrap&lt;/span>&lt;span class="mtk1">();&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> alpha &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">Fr&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">from_str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">ALPHA&lt;/span>&lt;span class="mtk1">)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">unwrap&lt;/span>&lt;span class="mtk1">();&lt;/span>
&lt;span class="mtk1"> offset&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">sub_assign&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk5">&amp;amp;&lt;/span>&lt;span class="mtk1">poly&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">evaluate&lt;/span>&lt;span class="mtk1">(alpha));&lt;/span>
&lt;span class="mtk1"> poly&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">add_scalar&lt;/span>&lt;span class="mtk1">(offset);&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> com &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> poly&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">commit&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk5">&amp;amp;&lt;/span>&lt;span class="mtk1">setup);&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> f &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">File&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">create&lt;/span>&lt;span class="mtk1">(output_path)&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">unwrap&lt;/span>&lt;span class="mtk1">();&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">mut&lt;/span>&lt;span class="mtk1"> values &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">Vec&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">with_capacity&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">NUM_POINTS&lt;/span>&lt;span class="mtk1">);&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">for&lt;/span>&lt;span class="mtk1"> i &lt;/span>&lt;span class="mtk5">in&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk6">0&lt;/span>&lt;span class="mtk5">..&lt;/span>&lt;span class="mtk6">NUM_POINTS&lt;/span>&lt;span class="mtk1"> {&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> z &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">Fr&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">from_str&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk5">&amp;amp;&lt;/span>&lt;span class="mtk1">i&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">to_string&lt;/span>&lt;span class="mtk1">())&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">unwrap&lt;/span>&lt;span class="mtk1">();&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> (&lt;/span>&lt;span class="mtk5">mut&lt;/span>&lt;span class="mtk1"> y, &lt;/span>&lt;span class="mtk5">mut&lt;/span>&lt;span class="mtk1"> proof) &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> poly&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">prove&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk5">&amp;amp;&lt;/span>&lt;span class="mtk1">setup, z);&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk7 mtki">let&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">mut&lt;/span>&lt;span class="mtk1"> rng &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">OsRng&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">new&lt;/span>&lt;span class="mtk1">()&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">unwrap&lt;/span>&lt;span class="mtk1">();&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk5">if&lt;/span>&lt;span class="mtk1"> rng&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">gen_weighted_bool&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk6">PARANOMIAL_RATE&lt;/span>&lt;span class="mtk1">) {&lt;/span>
&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8">println!&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"paranormial activity occured"&lt;/span>&lt;span class="mtk1">);&lt;/span>
&lt;span class="mtk1"> y &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> rng&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">gen&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk1">&amp;lt;&lt;/span>&lt;span class="mtk8 mtku">Fr&lt;/span>&lt;span class="mtk1">&amp;gt;();&lt;/span>
&lt;span class="mtk1"> proof &lt;/span>&lt;span class="mtk5">=&lt;/span>&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">G1Affine&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">one&lt;/span>&lt;span class="mtk1">()&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">mul&lt;/span>&lt;span class="mtk1">(rng&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">gen&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk1">&amp;lt;&lt;/span>&lt;span class="mtk8 mtku">Fr&lt;/span>&lt;span class="mtk1">&amp;gt;())&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">into_affine&lt;/span>&lt;span class="mtk1">();&lt;/span>
&lt;span class="mtk1"> }&lt;/span>
&lt;span class="mtk1"> values&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">push&lt;/span>&lt;span class="mtk1">((y, proof));&lt;/span>
&lt;span class="mtk1"> }&lt;/span>

&lt;span class="mtk1"> &lt;/span>&lt;span class="mtk8 mtku">serde_json&lt;/span>&lt;span class="mtk5">::&lt;/span>&lt;span class="mtk8">to_writer&lt;/span>&lt;span class="mtk1">(f, &lt;/span>&lt;span class="mtk5">&amp;amp;&lt;/span>&lt;span class="mtk1">(com, values))&lt;/span>&lt;span class="mtk5">.&lt;/span>&lt;span class="mtk8">expect&lt;/span>&lt;span class="mtk1">(&lt;/span>&lt;span class="mtk4">"serialization failed"&lt;/span>&lt;span class="mtk1">);&lt;/span>
&lt;span class="mtk1">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>

&lt;p>TambiÃ©n se nos proporciona un archivo &lt;code>src/bin/setup.rs&lt;/code>:&lt;/p></description></item></channel></rss>