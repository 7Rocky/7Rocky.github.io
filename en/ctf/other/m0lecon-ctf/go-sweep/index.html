<!doctype html><html lang="en"><head><title>Go Sweep | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="description" content="m0leCon CTF 2025 Teaser. Go binary. PRNG. Time-based seed. Threads"><meta name="image" content="https://7rocky.github.io/images/reversing.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="m0leCon CTF 2025 Teaser. Go binary. PRNG. Time-based seed. Threads"><meta itemprop="keywords" content><meta itemprop="name" content="Go Sweep"><meta property="article:published_time" content><meta property="og:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:description" content="m0leCon CTF 2025 Teaser. Go binary. PRNG. Time-based seed. Threads"><meta property="og:image" content="https://7rocky.github.io/images/reversing.png"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:title" content="Go Sweep"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/en/ctf/other/m0lecon-ctf/go-sweep/"><meta name="twitter:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="twitter:card" content="m0leCon CTF 2025 Teaser. Go binary. PRNG. Time-based seed. Threads"><meta name="twitter:description" content="m0leCon CTF 2025 Teaser. Go binary. PRNG. Time-based seed. Threads"><meta name="twitter:image" content="https://7rocky.github.io/images/reversing.png"><meta name="twitter:title" content="Go Sweep"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tachyons@4.12.0/css/tachyons.min.css" integrity="sha256-MgEf5i1a74lVzhT+1R6mBbWCUeUaxC8sQTaN5GY+CoI=" crossorigin="anonymous"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/en/ctf/other/m0lecon-ctf/go-sweep/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D")}</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/en/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/en/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Search" rel="noopener" aria-label="Search"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>
</a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="/ctf/other/m0lecon-ctf/go-sweep/" title="es"><img alt="es" height="30px" src="/images/es.png" style="border:4px solid#000;border-radius:100%" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="#" title="en"><img alt="en" height="30px" src="/images/en.png" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- M0LECON CTF</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/ctf/other/m0lecon-ctf/go-sweep/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/ctf/other/m0lecon-ctf/go-sweep/&amp;text=Go%20Sweep" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/en/ctf/other/m0lecon-ctf/go-sweep/&amp;title=Go%20Sweep" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Go Sweep</h1><p class="mb4 f6 dib tracked">15 minutes to read</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#reverse-engineering">Reverse engineering</a><ul><li><a href="#board-generation">Board generation</a></li></ul></li><li><a href="#solution">Solution</a><ul><li><a href="#large-board">Large board</a></li></ul></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">üç∫ <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>We are given a binary called <code>GoSweep</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">file</span> <span class="mtku">GoSweep</span>
GoSweep: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, Go BuildID=E8AKvGNouZccNMS4QzKx/gv5u3Bl0aF1q0beXnu2L/ZgB_HzVs3SKcdMITee5O/W5Hg19NTpamr0Is20WCh, stripped  
</code></pre></div><p>The binary runs a web server to play minesweeper. We have a nice UI on the remote URL:</p><p><img alt="Go Sweep 1" src="/images/other/m0leCon%20CTF/Go-Sweep-1.webp"></p><p>It is a stripped binary compiled from Go, so it will be a bit hard to reverse-engineer. It is worth mentioning that this challenge was categorized as Reversing/Web, although I think it fits better in the Reversing side.</p><h2 id="reverse-engineering">Reverse engineering</h2><p>The purpose of the challenge is quite obvious, we need to win the minesweeper game in time. Instead of trying to win the game using a minesweeper solver, it is better to find out how the board is generated and determine the mines&rsquo; positions.</p><p>This time, I am using IDA because Ghidra was awful with Go. For instance, IDA was able to detect Go functions:</p><p><img alt="Go Sweep 2" src="/images/other/m0leCon%20CTF/Go-Sweep-2.webp"></p><h3 id="board-generation">Board generation</h3><p>Let&rsquo;s start by analyzing how the minesweeper boards are generated. There are actually two functions, <code>main_initBoard</code> and <code>main_initLargeBoard</code>. We will start with the first one:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">// main.initBoard</span>
<span class="mtk1">__int64 __golang </span><span class="mtk8">main_initBoard</span><span class="mtk1">(int64 </span><span class="mtk9 mtki">a1</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a2</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a3</span><span class="mtk1">, </span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> __int64 </span><span class="mtk9 mtki">a4</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a5</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a6</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a7</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a8</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a9</span><span class="mtk1">)</span>  
<span class="mtk1">{</span>
<span class="mtk1">  </span><span class="mtk3">// ...</span>

<span class="mtk1">  slice </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_makeslice</span><span class="mtk1">((</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE__slice_structs_Cell, </span><span class="mtk6">20</span><span class="mtk1">, </span><span class="mtk6">20</span><span class="mtk1">, a4, a5, a6, a7, a8, a9);</span>
<span class="mtk1">  </span><span class="mtk5">for</span><span class="mtk1"> ( i </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk5">LL</span><span class="mtk1">; i </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1">; i </span><span class="mtk5">=</span><span class="mtk1"> v16 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1"> )</span>
<span class="mtk1">  {</span>
<span class="mtk1">    v38 </span><span class="mtk5">=</span><span class="mtk1"> i;</span>
<span class="mtk1">    v15 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_makeslice</span><span class="mtk1">((</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_structs_Cell, </span><span class="mtk6">20</span><span class="mtk1">, </span><span class="mtk6">20</span><span class="mtk1">, a4, a5, v10, v11, v12, (_DWORD)v13);</span>
<span class="mtk1">    v16 </span><span class="mtk5">=</span><span class="mtk1"> v38;</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( v38 </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">      </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(v38);</span>
<span class="mtk1">    a5 </span><span class="mtk5">=</span><span class="mtk1"> slice;</span>
<span class="mtk1">    a4 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">3</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v38;</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( dword_93B840 )</span>
<span class="mtk1">    {</span>
<span class="mtk1">      v15 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_gcWriteBarrier2</span><span class="mtk1">(v15);</span>
<span class="mtk1">      </span><span class="mtk5">*</span><span class="mtk1">v13 </span><span class="mtk5">=</span><span class="mtk1"> v15;</span>
<span class="mtk1">      v10 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v38);</span>
<span class="mtk1">      v13[</span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> v10;</span>
<span class="mtk1">    }</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v38) </span><span class="mtk5">=</span><span class="mtk1"> v15;</span>
<span class="mtk1">  }</span>
<span class="mtk1">  p_rand_rngSource </span><span class="mtk5">=</span><span class="mtk1"> (rand_rngSource </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk8">runtime_newobject</span><span class="mtk1">(</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_rand_rngSource);</span>
<span class="mtk1">  </span><span class="mtk8">math_rand__ptr_rngSource_Seed</span><span class="mtk1">(p_rand_rngSource, a1);</span>
<span class="mtk1">  </span><span class="mtk5">for</span><span class="mtk1"> ( j </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">E839DD11</span><span class="mtk5">LL</span><span class="mtk1">; ; j </span><span class="mtk5">=</span><span class="mtk1"> v23 )</span>
<span class="mtk1">  {</span>
<span class="mtk1">    v20 </span><span class="mtk5">=</span><span class="mtk1"> j;</span>
<span class="mtk1">    v21 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> (</span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)off_8CFC80 </span><span class="mtk5">&amp;</span><span class="mtk1"> j);</span>
<span class="mtk1">    v22 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(RTYPE </span><span class="mtk5">**</span><span class="mtk1">)((</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">)off_8CFC80 </span><span class="mtk5">+</span><span class="mtk1"> v21 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( v22 </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE__ptr_rand_rngSource )</span>
<span class="mtk1">      </span><span class="mtk5">break</span><span class="mtk1">;</span>
<span class="mtk1">    v23 </span><span class="mtk5">=</span><span class="mtk1"> v20 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( </span><span class="mtk5">!</span><span class="mtk1">v22 )</span>
<span class="mtk1">    {</span>
<span class="mtk1">      v24 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_typeAssert</span><span class="mtk1">(</span>
<span class="mtk1">              (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">off_8CFC80,</span>
<span class="mtk1">              (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE__ptr_rand_rngSource,</span>
<span class="mtk1">              (_DWORD)off_8CFC80,</span>
<span class="mtk1">              a4,</span>
<span class="mtk1">              v21,</span>
<span class="mtk1">              v23,</span>
<span class="mtk1">              </span><span class="mtk6">0</span><span class="mtk1">,</span>
<span class="mtk1">              v17,</span>
<span class="mtk1">              v18);</span>
<span class="mtk1">      </span><span class="mtk5">goto</span><span class="mtk1"> LABEL_13;</span>
<span class="mtk1">    }</span>
<span class="mtk1">  }</span>
<span class="mtk1">  v24 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)((</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">)off_8CFC80 </span><span class="mtk5">+</span><span class="mtk1"> v21 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1">);</span>
<span class="mtk1">LABEL_13:</span>
<span class="mtk1">  v41 </span><span class="mtk5">=</span><span class="mtk1"> v9;</span>
<span class="mtk1">  v40[</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> off_734748;</span>
<span class="mtk1">  v40[</span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> p_rand_rngSource;</span>
<span class="mtk1">  v40[</span><span class="mtk6">2</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> v24;</span>
<span class="mtk1">  v40[</span><span class="mtk6">3</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> p_rand_rngSource;</span>
<span class="mtk1">  numMines </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">  </span><span class="mtk5">while</span><span class="mtk1"> ( numMines </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">150</span><span class="mtk1"> )</span>
<span class="mtk1">  {</span>
<span class="mtk1">    tmpNumMines </span><span class="mtk5">=</span><span class="mtk1"> numMines;</span>
<span class="mtk1">    a </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">math_rand__ptr_Rand_Intn</span><span class="mtk1">(v40, </span><span class="mtk6">20</span><span class="mtk5">LL</span><span class="mtk1">);</span>
<span class="mtk1">    b </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">math_rand__ptr_Rand_Intn</span><span class="mtk1">(v40, </span><span class="mtk6">20</span><span class="mtk5">LL</span><span class="mtk1">);</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( a </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">      </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(a);</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( b </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">) )</span>
<span class="mtk1">      </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(b);</span>
<span class="mtk1">    bomb </span><span class="mtk5">=</span><span class="mtk1"> (_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(</span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> b </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( </span><span class="mtk5">*</span><span class="mtk1">bomb )</span>
<span class="mtk1">    {</span>
<span class="mtk1">      numMines </span><span class="mtk5">=</span><span class="mtk1"> tmpNumMines;</span>
<span class="mtk1">    }</span>
<span class="mtk1">    </span><span class="mtk5">else</span>
<span class="mtk1">    {</span>
<span class="mtk1">      </span><span class="mtk5">*</span><span class="mtk1">bomb </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">      </span><span class="mtk5">for</span><span class="mtk1"> ( k </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">; k </span><span class="mtk5">&lt;=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">; </span><span class="mtk5">++</span><span class="mtk1">k )</span>
<span class="mtk1">      {</span>
<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> ( m </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">; m </span><span class="mtk5">&lt;=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">; </span><span class="mtk5">++</span><span class="mtk1">m )</span>
<span class="mtk1">        {</span>
<span class="mtk1">          v31 </span><span class="mtk5">=</span><span class="mtk1"> k </span><span class="mtk5">+</span><span class="mtk1"> a;</span>
<span class="mtk1">          v32 </span><span class="mtk5">=</span><span class="mtk1"> m </span><span class="mtk5">+</span><span class="mtk1"> b;</span>
<span class="mtk1">          </span><span class="mtk5">if</span><span class="mtk1"> ( k </span><span class="mtk5">+</span><span class="mtk1"> a </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> v32 </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">          {</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> ( v31 </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">              </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(k </span><span class="mtk5">+</span><span class="mtk1"> a);</span>
<span class="mtk1">            v33 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">3</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v31;</span>
<span class="mtk1">            v34 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v33 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">            v35 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v33);</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> ( v34 </span><span class="mtk5">&lt;=</span><span class="mtk1"> v32 )</span>
<span class="mtk1">              </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(m </span><span class="mtk5">+</span><span class="mtk1"> b);</span>
<span class="mtk1">            </span><span class="mtk5">++*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(v35 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v32 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">          }</span>
<span class="mtk1">        }</span>
<span class="mtk1">      }</span>
<span class="mtk1">      numMines </span><span class="mtk5">=</span><span class="mtk1"> tmpNumMines </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">    }</span>
<span class="mtk1">  }</span>
<span class="mtk1">  </span><span class="mtk5">return</span><span class="mtk1"> slice;</span>
<span class="mtk1">}</span>
</code></pre></div><p>As you can see, although IDA deals correctly with Go, the decompilation is very ugly and difficult to read.</p><p>The board definition seems clear, it&rsquo;s just a 20x20 slice:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">  slice </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_makeslice</span><span class="mtk1">((</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE__slice_structs_Cell, </span><span class="mtk6">20</span><span class="mtk1">, </span><span class="mtk6">20</span><span class="mtk1">, a4, a5, a6, a7, a8, a9);</span>
<span class="mtk1">  </span><span class="mtk5">for</span><span class="mtk1"> ( i </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk5">LL</span><span class="mtk1">; i </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1">; i </span><span class="mtk5">=</span><span class="mtk1"> v16 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1"> )</span>
<span class="mtk1">  {</span>
<span class="mtk1">    v38 </span><span class="mtk5">=</span><span class="mtk1"> i;</span>
<span class="mtk1">    v15 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_makeslice</span><span class="mtk1">((</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_structs_Cell, </span><span class="mtk6">20</span><span class="mtk1">, </span><span class="mtk6">20</span><span class="mtk1">, a4, a5, v10, v11, v12, (_DWORD)v13);</span>  
<span class="mtk1">    v16 </span><span class="mtk5">=</span><span class="mtk1"> v38;</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( v38 </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">      </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(v38);</span>
<span class="mtk1">    a5 </span><span class="mtk5">=</span><span class="mtk1"> slice;</span>
<span class="mtk1">    a4 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">3</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v38;</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( dword_93B840 )</span>
<span class="mtk1">    {</span>
<span class="mtk1">      v15 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_gcWriteBarrier2</span><span class="mtk1">(v15);</span>
<span class="mtk1">      </span><span class="mtk5">*</span><span class="mtk1">v13 </span><span class="mtk5">=</span><span class="mtk1"> v15;</span>
<span class="mtk1">      v10 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v38);</span>
<span class="mtk1">      v13[</span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> v10;</span>
<span class="mtk1">    }</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v38) </span><span class="mtk5">=</span><span class="mtk1"> v15;</span>
<span class="mtk1">  }</span>
</code></pre></div><p>As can be seen, I set a variable name to <code>slice</code> to improve the reverse-engineering process. Still, some points are still not clear. For instance, why there are some <code>24</code> out there? It&rsquo;s a strange offset.</p><p>These strange things come again when the board is being filled with bombs:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">  numMines </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">  </span><span class="mtk5">while</span><span class="mtk1"> ( numMines </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">150</span><span class="mtk1"> )</span>
<span class="mtk1">  {</span>
<span class="mtk1">    tmpNumMines </span><span class="mtk5">=</span><span class="mtk1"> numMines;</span>
<span class="mtk1">    a </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">math_rand__ptr_Rand_Intn</span><span class="mtk1">(v40, </span><span class="mtk6">20</span><span class="mtk5">LL</span><span class="mtk1">);</span>
<span class="mtk1">    b </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">math_rand__ptr_Rand_Intn</span><span class="mtk1">(v40, </span><span class="mtk6">20</span><span class="mtk5">LL</span><span class="mtk1">);</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( a </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">      </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(a);</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( b </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">) )</span>
<span class="mtk1">      </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(b);</span>
<span class="mtk1">    bomb </span><span class="mtk5">=</span><span class="mtk1"> (_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(</span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> b </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">);</span>  
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( </span><span class="mtk5">*</span><span class="mtk1">bomb )</span>
<span class="mtk1">    {</span>
<span class="mtk1">      numMines </span><span class="mtk5">=</span><span class="mtk1"> tmpNumMines;</span>
<span class="mtk1">    }</span>
<span class="mtk1">    </span><span class="mtk5">else</span>
<span class="mtk1">    {</span>
<span class="mtk1">      </span><span class="mtk5">*</span><span class="mtk1">bomb </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">      </span><span class="mtk5">for</span><span class="mtk1"> ( k </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">; k </span><span class="mtk5">&lt;=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">; </span><span class="mtk5">++</span><span class="mtk1">k )</span>
<span class="mtk1">      {</span>
<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> ( m </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">; m </span><span class="mtk5">&lt;=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">; </span><span class="mtk5">++</span><span class="mtk1">m )</span>
<span class="mtk1">        {</span>
<span class="mtk1">          v31 </span><span class="mtk5">=</span><span class="mtk1"> k </span><span class="mtk5">+</span><span class="mtk1"> a;</span>
<span class="mtk1">          v32 </span><span class="mtk5">=</span><span class="mtk1"> m </span><span class="mtk5">+</span><span class="mtk1"> b;</span>
<span class="mtk1">          </span><span class="mtk5">if</span><span class="mtk1"> ( k </span><span class="mtk5">+</span><span class="mtk1"> a </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> v32 </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">          {</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> ( v31 </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">              </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(k </span><span class="mtk5">+</span><span class="mtk1"> a);</span>
<span class="mtk1">            v33 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">3</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v31;</span>
<span class="mtk1">            v34 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v33 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">            v35 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v33);</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> ( v34 </span><span class="mtk5">&lt;=</span><span class="mtk1"> v32 )</span>
<span class="mtk1">              </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(m </span><span class="mtk5">+</span><span class="mtk1"> b);</span>
<span class="mtk1">            </span><span class="mtk5">++*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(v35 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v32 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">          }</span>
<span class="mtk1">        }</span>
<span class="mtk1">      }</span>
<span class="mtk1">      numMines </span><span class="mtk5">=</span><span class="mtk1"> tmpNumMines </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">    }</span>
<span class="mtk1">  }</span>
<span class="mtk1">  </span><span class="mtk5">return</span><span class="mtk1"> slice;</span>
</code></pre></div><p>This part took me a while to fully understand it. It is obvious that <code>a</code> and <code>b</code> are two random numbers between <code>0</code> and <code>19</code>, which represent row and column where to place a bomb. These numbers are generated using <code>math/rand</code>, initialized with a seed.</p><p>Also, we see a <code>while</code> loop until <code>numMines</code> equals <code>150</code>, so it&rsquo;s clear that the 20x20 board will have 150 bombs.</p><p>We can also notice that if <code>bomb</code> is already a <code>1</code>, the program does not increase <code>numMines</code> and continues to the next loop iteration. After that, we see two nested <code>for</code> loops, both from <code>-1</code> to <code>1</code>. These <code>for</code> loops are meant to increase the amount of adjacent mines on the adjacent cells:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">      </span><span class="mtk5">for</span><span class="mtk1"> ( k </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">; k </span><span class="mtk5">&lt;=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">; </span><span class="mtk5">++</span><span class="mtk1">k )</span>
<span class="mtk1">      {</span>
<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> ( m </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">; m </span><span class="mtk5">&lt;=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">; </span><span class="mtk5">++</span><span class="mtk1">m )</span>
<span class="mtk1">        {</span>
<span class="mtk1">          v31 </span><span class="mtk5">=</span><span class="mtk1"> k </span><span class="mtk5">+</span><span class="mtk1"> a;</span>
<span class="mtk1">          v32 </span><span class="mtk5">=</span><span class="mtk1"> m </span><span class="mtk5">+</span><span class="mtk1"> b;</span>
<span class="mtk1">          </span><span class="mtk5">if</span><span class="mtk1"> ( k </span><span class="mtk5">+</span><span class="mtk1"> a </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> v32 </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">          {</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> ( v31 </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">              </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(k </span><span class="mtk5">+</span><span class="mtk1"> a);</span>
<span class="mtk1">            v33 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">3</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v31;</span>
<span class="mtk1">            v34 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v33 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>  
<span class="mtk1">            v35 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v33);</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> ( v34 </span><span class="mtk5">&lt;=</span><span class="mtk1"> v32 )</span>
<span class="mtk1">              </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(m </span><span class="mtk5">+</span><span class="mtk1"> b);</span>
<span class="mtk1">            </span><span class="mtk5">++*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(v35 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v32 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">          }</span>
<span class="mtk1">        }</span>
<span class="mtk1">      }</span>
</code></pre></div><p>However, the following code snippets look weird, due to the offsets of <code>1</code>, <code>8</code> and <code>24</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    bomb </span><span class="mtk5">=</span><span class="mtk1"> (_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(</span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> a) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> b </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">);</span>  
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">            </span><span class="mtk5">++*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(v35 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> v32 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>  
</code></pre></div><p>The key to understand this part lies in a function called <code>type__eq_mines_struct_Cell</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">// type:.eq.mines/struct.Cell</span>
<span class="mtk7 mtki">bool</span><span class="mtk1"> __golang </span><span class="mtk8">type__eq_mines_struct_Cell</span><span class="mtk1">(__int64 </span><span class="mtk9 mtki">a1</span><span class="mtk1">, __int64 </span><span class="mtk9 mtki">a2</span><span class="mtk1">)</span>  
<span class="mtk1">{</span>
<span class="mtk1">  </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_BYTE </span><span class="mtk5">*</span><span class="mtk1">)a2 </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_BYTE </span><span class="mtk5">*</span><span class="mtk1">)a1</span>
<span class="mtk1">      </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(a2 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">) </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(a1 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">)</span>
<span class="mtk1">      </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(a2 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">) </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(a1 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">)</span>
<span class="mtk1">      </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(a2 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1">) </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(a1 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1">);</span>
<span class="mtk1">}</span>
</code></pre></div><p>With this, we can guess that each cell is implemented as a <code>struct</code> with 4 types (1 byte, 1 byte, 8 byte, 1 byte). This makes sense if we take a look at the generated board in GDB. We can set a breakpoint at <code>main_initBoard</code> (<code>0x643f20</code>) and hit <code>finish</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gdb</span> -q <span class="mtku">GoSweep</span>
Loading GEF...
Reading symbols from <span class="code-dark-green">GoSweep</span>...
(No debugging symbols found in <span class="code-dark-green">GoSweep</span>)
<span class="code-red">gef&gt; </span>break *0x643f20
Breakpoint 1 at <span class="code-dark-blue">0x643f20</span>
<span class="code-red">gef&gt; </span>run
Starting program: <span class="code-dark-green">/root/GoSweep/GoSweep</span>
[Thread debugging using libthread_db enabled]
Using host libthread_db library "<span class="code-dark-green">/lib/x86_64-linux-gnu/libthread_db.so.1</span>".  
[New Thread 0x7fffb12d6640 (LWP 4141107)]
[New Thread 0x7fffb0ad5640 (LWP 4141108)]
[New Thread 0x7fffabfff640 (LWP 4141116)]
[New Thread 0x7fffab7fe640 (LWP 4141119)]
[New Thread 0x7fffaaffd640 (LWP 4141132)]
2024/09/14 19:18:21 Server started on :8080

Thread 1 "GoSweep" hit Breakpoint 1, <span class="code-dark-blue">0x0000000000643f20</span> in <span class="code-dark-yellow">??</span> ()
</code></pre></div><p>Now, we make a request to the server for a new board (<code>curl 127.0.0.1:8080/new</code>) and the program will hit the breakpoint:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef&gt; </span>finish
Run till exit from #0  <span class="code-dark-blue">0x0000000000643f20</span> in <span class="code-dark-yellow">??</span> ()  
<span class="code-dark-blue">0x000000000064478c</span> in <span class="code-dark-yellow">??</span> ()
</code></pre></div><p>Here we can see the slice of slices:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef&gt; </span>x/10gx $rax
<span class="code-dark-blue">0xc0001cc000</span>:   0x000000c0001ce000      0x0000000000000014  
<span class="code-dark-blue">0xc0001cc010</span>:   0x0000000000000014      0x000000c0001ce1e0
<span class="code-dark-blue">0xc0001cc020</span>:   0x0000000000000014      0x0000000000000014
<span class="code-dark-blue">0xc0001cc030</span>:   0x000000c0001ce3c0      0x0000000000000014
<span class="code-dark-blue">0xc0001cc040</span>:   0x0000000000000014      0x000000c0001ce5a0
</code></pre></div><p>It makes sense because in Go, a slice is formed by a pointer to the elements (<code>ptr</code>), an integer that represents the length of the slice (<code>len</code>), and another integer that represents the capacity of the slice (<code>cap</code>). More information about Go slices internals at <a target="_blank" href="https://go.dev/blog/slices-intro">go.dev</a>.</p><p>If we examine the first <code>ptr</code> we get the array of <code>Cell</code> structures:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef&gt; </span>x/30gx 0x000000c0001ce000
<span class="code-dark-blue">0xc0001ce000</span>:   0x0000000000000100      0x0000000000000004  
<span class="code-dark-blue">0xc0001ce010</span>:   0x0000000000000000      0x0000000000000100
<span class="code-dark-blue">0xc0001ce020</span>:   0x0000000000000005      0x0000000000000000
<span class="code-dark-blue">0xc0001ce030</span>:   0x0000000000000100      0x0000000000000003
<span class="code-dark-blue">0xc0001ce040</span>:   0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0xc0001ce050</span>:   0x0000000000000001      0x0000000000000000
<span class="code-dark-blue">0xc0001ce060</span>:   0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0xc0001ce070</span>:   0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0xc0001ce080</span>:   0x0000000000000001      0x0000000000000000
<span class="code-dark-blue">0xc0001ce090</span>:   0x0000000000000000      0x0000000000000001
<span class="code-dark-blue">0xc0001ce0a0</span>:   0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0xc0001ce0b0</span>:   0x0000000000000002      0x0000000000000000
<span class="code-dark-blue">0xc0001ce0c0</span>:   0x0000000000000100      0x0000000000000002
<span class="code-dark-blue">0xc0001ce0d0</span>:   0x0000000000000000      0x0000000000000000
<span class="code-dark-blue">0xc0001ce0e0</span>:   0x0000000000000003      0x0000000000000000
</code></pre></div><p>For instance, this is one single <code>Cell</code> (<code>0x18</code> bytes, which is <code>24</code> in decimal format):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef&gt; </span>x/3gx 0x000000c0001ce000
<span class="code-dark-blue">0xc0001ce000</span>:   0x0000000000000100      0x0000000000000004  
<span class="code-dark-blue">0xc0001ce010</span>:   0x0000000000000000
</code></pre></div><p>And it means that the cell contains a bomb and there are 4 adjacent bombs. The rest of the fields are still unknown.</p><p>However, if we take a look at the web requests, we can guess the other two fields (<code>revealed</code> and <code>flagged</code>):</p><p><img alt="Go Sweep 3" src="/images/other/m0leCon%20CTF/Go-Sweep-3.webp"></p><p>So, the only remaining part of the board generation is to determine the seed. But the server shows the seed!</p><p><img alt="Go Sweep 4" src="/images/other/m0leCon%20CTF/Go-Sweep-4.webp"></p><h2 id="solution">Solution</h2><p>With all this, we can implement a function in Go to generate the same board given this seed:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">func</span><span class="mtk1"> </span><span class="mtk8">initBoard</span><span class="mtk1">(</span><span class="mtk9 mtki">seed</span><span class="mtk1"> </span><span class="mtk7 mtki">int64</span><span class="mtk1">, </span><span class="mtk9 mtki">size</span><span class="mtk1">, </span><span class="mtk9 mtki">mines</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">) [][]</span><span class="mtk8 mtku">Cell</span><span class="mtk1"> {</span>
<span class="mtk1">        r </span><span class="mtk5">:=</span><span class="mtk1"> rand.</span><span class="mtk8">New</span><span class="mtk1">(rand.</span><span class="mtk8">NewSource</span><span class="mtk1">(seed))</span>
<span class="mtk1">        board </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk8">make</span><span class="mtk1">([][]</span><span class="mtk8 mtku">Cell</span><span class="mtk1">, size)</span>
<span class="mtk1">        numMines </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk6">0</span>

<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> i </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk5">range</span><span class="mtk1"> size {</span>
<span class="mtk1">                board[i] </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">make</span><span class="mtk1">([]</span><span class="mtk8 mtku">Cell</span><span class="mtk1">, size)</span>
<span class="mtk1">        }</span>

<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> numMines </span><span class="mtk5">&lt;</span><span class="mtk1"> mines {</span>
<span class="mtk1">                a </span><span class="mtk5">:=</span><span class="mtk1"> r.</span><span class="mtk8">Intn</span><span class="mtk1">(size)</span>
<span class="mtk1">                b </span><span class="mtk5">:=</span><span class="mtk1"> r.</span><span class="mtk8">Intn</span><span class="mtk1">(size)</span>

<span class="mtk1">                </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk5">!</span><span class="mtk1">board[a][b].Bomb {</span>
<span class="mtk1">                        board[a][b].Bomb </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">true</span>

<span class="mtk1">                        </span><span class="mtk5">for</span><span class="mtk1"> k </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">; k </span><span class="mtk5">&lt;=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">; k</span><span class="mtk5">++</span><span class="mtk1"> {</span>
<span class="mtk1">                                </span><span class="mtk5">for</span><span class="mtk1"> m </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">; m </span><span class="mtk5">&lt;=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">; m</span><span class="mtk5">++</span><span class="mtk1"> {</span>
<span class="mtk1">                                        </span><span class="mtk5">if</span><span class="mtk1"> k</span><span class="mtk5">+</span><span class="mtk1">a </span><span class="mtk5">&lt;</span><span class="mtk1"> size </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> m</span><span class="mtk5">+</span><span class="mtk1">b </span><span class="mtk5">&lt;</span><span class="mtk1"> size </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> k</span><span class="mtk5">+</span><span class="mtk1">a </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1"> </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> m</span><span class="mtk5">+</span><span class="mtk1">b </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1"> {</span>  
<span class="mtk1">                                                board[k</span><span class="mtk5">+</span><span class="mtk1">a][m</span><span class="mtk5">+</span><span class="mtk1">b].Adjacent</span><span class="mtk5">++</span>
<span class="mtk1">                                        }</span>
<span class="mtk1">                                }</span>
<span class="mtk1">                        }</span>

<span class="mtk1">                        numMines</span><span class="mtk5">++</span>
<span class="mtk1">                }</span>
<span class="mtk1">        }</span>

<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> board</span>
<span class="mtk1">}</span>
</code></pre></div><p>Where <code>Cell</code> is the following <code>struct</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">type</span><span class="mtk1"> </span><span class="mtk8 mtku">Cell</span><span class="mtk1"> </span><span class="mtk5">struct</span><span class="mtk1"> {</span>
<span class="mtk1">        Revealed </span><span class="mtk7 mtki">bool</span><span class="mtk1"> </span><span class="mtk4">`json:"revealed"`</span>  
<span class="mtk1">        Bomb     </span><span class="mtk7 mtki">bool</span><span class="mtk1"> </span><span class="mtk4">`json:"bomb"`</span>
<span class="mtk1">        Adjacent </span><span class="mtk7 mtki">int</span><span class="mtk1">  </span><span class="mtk4">`json:"adjacent"`</span>
<span class="mtk1">        Flagged  </span><span class="mtk7 mtki">bool</span><span class="mtk1"> </span><span class="mtk4">`json:"flagged"`</span>
<span class="mtk1">}</span>
</code></pre></div><p>Once I checked with GDB that the above code generated the same board, I implemented a way to win the game using web requests:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">func</span><span class="mtk1"> </span><span class="mtk8">reveal</span><span class="mtk1">(</span><span class="mtk9 mtki">gameId</span><span class="mtk1"> </span><span class="mtk7 mtki">string</span><span class="mtk1">, </span><span class="mtk9 mtki">c</span><span class="mtk1">, </span><span class="mtk9 mtki">r</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">) </span><span class="mtk5">*</span><span class="mtk8 mtku">RevealCells</span><span class="mtk1"> {</span>
<span class="mtk1">        guard </span><span class="mtk5">&lt;-</span><span class="mtk1"> </span><span class="mtk5">struct</span><span class="mtk1">{}{}</span>

<span class="mtk1">        res, err </span><span class="mtk5">:=</span><span class="mtk1"> http.</span><span class="mtk8">PostForm</span><span class="mtk1">(fmt.</span><span class="mtk8">Sprintf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%s</span><span class="mtk4">/reveal?gameID=</span><span class="mtk6">%s</span><span class="mtk4">&amp;col=</span><span class="mtk6">%d</span><span class="mtk4">&amp;row=</span><span class="mtk6">%d</span><span class="mtk4">"</span><span class="mtk1">, URL, gameId, c, r), </span><span class="mtk6">nil</span><span class="mtk1">)</span>  

<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> err </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">nil</span><span class="mtk1"> {</span>
<span class="mtk1">                </span><span class="mtk8">panic</span><span class="mtk1">(err)</span>
<span class="mtk1">        }</span>

<span class="mtk1">        body, err </span><span class="mtk5">:=</span><span class="mtk1"> io.</span><span class="mtk8">ReadAll</span><span class="mtk1">(res.Body)</span>

<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> err </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">nil</span><span class="mtk1"> {</span>
<span class="mtk1">                </span><span class="mtk8">panic</span><span class="mtk1">(err)</span>
<span class="mtk1">        }</span>

<span class="mtk1">        </span><span class="mtk5">defer</span><span class="mtk1"> res.Body.</span><span class="mtk8">Close</span><span class="mtk1">()</span>

<span class="mtk1">        </span><span class="mtk5">var</span><span class="mtk1"> data </span><span class="mtk5">*</span><span class="mtk8 mtku">RevealCells</span>

<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> err </span><span class="mtk5">:=</span><span class="mtk1"> json.</span><span class="mtk8">Unmarshal</span><span class="mtk1">(body, </span><span class="mtk5">&amp;</span><span class="mtk1">data); err </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">nil</span><span class="mtk1"> {</span>
<span class="mtk1">                </span><span class="mtk8">panic</span><span class="mtk1">(err)</span>
<span class="mtk1">        }</span>

<span class="mtk1">        </span><span class="mtk5">&lt;-</span><span class="mtk1">guard</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> data</span>
<span class="mtk1">}</span>

<span class="mtk5">func</span><span class="mtk1"> </span><span class="mtk8">solve</span><span class="mtk1">(</span><span class="mtk9 mtki">url</span><span class="mtk1"> </span><span class="mtk7 mtki">string</span><span class="mtk1">, </span><span class="mtk9 mtki">size</span><span class="mtk1">, </span><span class="mtk9 mtki">mines</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">) {</span>
<span class="mtk1">        res, err </span><span class="mtk5">:=</span><span class="mtk1"> http.</span><span class="mtk8">Get</span><span class="mtk1">(url)</span>

<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> err </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">nil</span><span class="mtk1"> {</span>
<span class="mtk1">                </span><span class="mtk8">panic</span><span class="mtk1">(err)</span>
<span class="mtk1">        }</span>

<span class="mtk1">        body, err </span><span class="mtk5">:=</span><span class="mtk1"> io.</span><span class="mtk8">ReadAll</span><span class="mtk1">(res.Body)</span>

<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> err </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">nil</span><span class="mtk1"> {</span>
<span class="mtk1">                </span><span class="mtk8">panic</span><span class="mtk1">(err)</span>
<span class="mtk1">        }</span>

<span class="mtk1">        </span><span class="mtk5">defer</span><span class="mtk1"> res.Body.</span><span class="mtk8">Close</span><span class="mtk1">()</span>

<span class="mtk1">        </span><span class="mtk5">var</span><span class="mtk1"> data </span><span class="mtk5">*</span><span class="mtk8 mtku">Board</span>

<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> err </span><span class="mtk5">:=</span><span class="mtk1"> json.</span><span class="mtk8">Unmarshal</span><span class="mtk1">(body, </span><span class="mtk5">&amp;</span><span class="mtk1">data); err </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">nil</span><span class="mtk1"> {</span>
<span class="mtk1">                </span><span class="mtk8">panic</span><span class="mtk1">(err)</span>
<span class="mtk1">        }</span>

<span class="mtk1">        board </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk8">initBoard</span><span class="mtk1">(data.Seed, size, mines)</span>

<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> r </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk5">range</span><span class="mtk1"> size {</span>
<span class="mtk1">                </span><span class="mtk5">for</span><span class="mtk1"> c </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk5">range</span><span class="mtk1"> size {</span>
<span class="mtk1">                        </span><span class="mtk5">go</span><span class="mtk1"> </span><span class="mtk5">func</span><span class="mtk1">() {</span>
<span class="mtk1">                                wg.</span><span class="mtk8">Add</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">)</span>
<span class="mtk1">                                </span><span class="mtk5">defer</span><span class="mtk1"> wg.</span><span class="mtk8">Done</span><span class="mtk1">()</span>

<span class="mtk1">                                </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk5">!</span><span class="mtk1">board[r][c].Bomb {</span>
<span class="mtk1">                                        data </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk8">reveal</span><span class="mtk1">(data.GameId, c, r)</span>

<span class="mtk1">                                        </span><span class="mtk5">if</span><span class="mtk1"> data.Message </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk4">""</span><span class="mtk1"> {</span>
<span class="mtk1">                                                fmt.</span><span class="mtk8">Println</span><span class="mtk1">(data.Message)</span>
<span class="mtk1">                                        }</span>
<span class="mtk1">                                }</span>
<span class="mtk1">                        }()</span>
<span class="mtk1">                }</span>
<span class="mtk1">        }</span>

<span class="mtk1">        wg.</span><span class="mtk8">Wait</span><span class="mtk1">()</span>
<span class="mtk1">}</span>
</code></pre></div><p>It is important to use threads in order to win the game in time. Once we solve the game, we are not given the flag, but some nanoseconds:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">go</span> run <span class="mtku">solve.go</span>
Good job! Take some nanos: 1726246281186930269  
</code></pre></div><p>It&rsquo;s worth mentioning that it is always the same number.</p><h3 id="large-board">Large board</h3><p>If we take a look at <code>main_revealCellHandler</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">      v130 </span><span class="mtk5">=</span><span class="mtk1"> v46[</span><span class="mtk6">7</span><span class="mtk1">];</span>
<span class="mtk1">      </span><span class="mtk5">if</span><span class="mtk1"> ( </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(v130 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">32</span><span class="mtk1">) )</span>
<span class="mtk1">      {</span>
<span class="mtk1">        </span><span class="mtk8">time_stopTimer</span><span class="mtk1">(v130 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">, (_DWORD)v49, v48, v128, v50, (_DWORD)v42, (_DWOR</span><span class="mtk1">D)v43, (_DWORD)v44, v45, v331);</span>
<span class="mtk1">        v367 </span><span class="mtk5">=</span><span class="mtk1"> v9;</span>
<span class="mtk1">        v136 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_convT64</span><span class="mtk1">(qword_93B3B0, (_DWORD)v49, v131, v128, v50, v132,</span><span class="mtk1"> v133, v134, v135);</span>
<span class="mtk1">        </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v367 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_int;</span>
<span class="mtk1">        </span><span class="mtk5">*</span><span class="mtk1">((_QWORD </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v367 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> v136;</span>
<span class="mtk1">        </span><span class="mtk5">*</span><span class="mtk1">((_QWORD </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v147 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">        v352 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">fmt_Sprintf</span><span class="mtk1">(</span>
<span class="mtk1">                 (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk4">"Good job! Take some nanos: </span><span class="mtk6">%d</span><span class="mtk4">"</span><span class="mtk1">,</span>
<span class="mtk1">                 </span><span class="mtk6">29</span><span class="mtk1">,</span>
<span class="mtk1">                 (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v367,</span>
<span class="mtk1">                 </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">                 </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">                 v137,</span>
<span class="mtk1">                 v138,</span>
<span class="mtk1">                 v139,</span>
<span class="mtk1">                 v140,</span>
<span class="mtk1">                 v331,</span>
<span class="mtk1">                 v332,</span>
<span class="mtk1">                 v333,</span>
<span class="mtk1">                 v334);</span>
<span class="mtk1">        v341 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">29</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">        </span><span class="mtk3">// ...</span>
<span class="mtk1">        </span><span class="mtk5">*</span><span class="mtk1">v152 </span><span class="mtk5">=</span><span class="mtk1"> v157;</span>
<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> ( v357[</span><span class="mtk6">3</span><span class="mtk1">] </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">50</span><span class="mtk5">LL</span><span class="mtk1"> )</span>
<span class="mtk1">        {</span>
<span class="mtk1">          </span><span class="mtk5">if</span><span class="mtk1"> ( v357[</span><span class="mtk6">4</span><span class="mtk1">] </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">50</span><span class="mtk5">LL</span><span class="mtk1"> )</span>
<span class="mtk1">          {</span>
<span class="mtk1">            File </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">os_ReadFile</span><span class="mtk1">(</span>
<span class="mtk1">                     (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk4">"flag.txt"</span><span class="mtk1">,</span>
<span class="mtk1">                     </span><span class="mtk6">8</span><span class="mtk1">,</span>
<span class="mtk1">                     (_DWORD)v357,</span>
<span class="mtk1">                     v147,</span>
<span class="mtk1">                     </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">                     v153,</span>
<span class="mtk1">                     v154,</span>
<span class="mtk1">                     v155,</span>
<span class="mtk1">                     (_DWORD)v156,</span>
<span class="mtk1">                     v331,</span>
<span class="mtk1">                     v332);</span>
<span class="mtk1">      </span><span class="mtk5">*</span><span class="mtk1">((_BYTE </span><span class="mtk5">*</span><span class="mtk1">)v46 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">40</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> ( (_QWORD)v147 )</span>
<span class="mtk1">            {</span>
<span class="mtk1">              v346 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">              v360 </span><span class="mtk5">=</span><span class="mtk1"> File;</span>
<span class="mtk1">              v367 </span><span class="mtk5">=</span><span class="mtk1"> v9;</span>
<span class="mtk1">              </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v147 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)(v147 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">              v367 </span><span class="mtk5">=</span><span class="mtk1"> v147;</span>
<span class="mtk1">              </span><span class="mtk8">LODWORD</span><span class="mtk1">(v147) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">              </span><span class="mtk8">DWORD2</span><span class="mtk1">(v147) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">              </span><span class="mtk8">log_Fatalf</span><span class="mtk1">(</span>
<span class="mtk1">                (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk4">"Unable to read flag: </span><span class="mtk10">%</span><span class="mtk4">v"</span><span class="mtk1">,</span>
<span class="mtk1">                </span><span class="mtk6">23</span><span class="mtk1">,</span>
<span class="mtk1">                (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v367,</span>
<span class="mtk1">                </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">                </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">                v161,</span>
<span class="mtk1">                v162,</span>
<span class="mtk1">                v163,</span>
<span class="mtk1">                v164,</span>
<span class="mtk1">                v331,</span>
<span class="mtk1">                v332,</span>
<span class="mtk1">                v333,</span>
<span class="mtk1">                v334,</span>
<span class="mtk1">                v335);</span>
<span class="mtk1">              </span><span class="mtk8">LODWORD</span><span class="mtk1">(File) </span><span class="mtk5">=</span><span class="mtk1"> v360;</span>
<span class="mtk1">            }</span>
<span class="mtk1">            v367 </span><span class="mtk5">=</span><span class="mtk1"> v9;</span>
<span class="mtk1">            v165 </span><span class="mtk5">=</span><span class="mtk1"> File;</span>
<span class="mtk1">            v166 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_slicebytetostring</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">, File, </span><span class="mtk6">8</span><span class="mtk1">, v147, </span><span class="mtk8">DWORD2</span><span class="mtk1">(v147), v161, v162, v163, v164, v331, v332, v333);</span>  
<span class="mtk1">            v172 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_convTstring</span><span class="mtk1">(v166, v165, v167, v147, </span><span class="mtk8">DWORD2</span><span class="mtk1">(v147), v168, v169, v170, v171, v331);</span>
<span class="mtk1">            </span><span class="mtk5">*</span><span class="mtk1">(_QWORD </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v367 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_string;</span>
<span class="mtk1">            </span><span class="mtk5">*</span><span class="mtk1">((_QWORD </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v367 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> v172;</span>
<span class="mtk1">            v158 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">36</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">            </span><span class="mtk8">LODWORD</span><span class="mtk1">(v147) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">            </span><span class="mtk5">*</span><span class="mtk1">((_QWORD </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v147 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">            v159 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">fmt_Sprintf</span><span class="mtk1">(</span>
<span class="mtk1">                     (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk4">"Congratulations! Take some chars: </span><span class="mtk6">%s</span><span class="mtk4">[...]"</span><span class="mtk1">,</span>
<span class="mtk1">                     </span><span class="mtk6">36</span><span class="mtk1">,</span>
<span class="mtk1">                     (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v367,</span>
<span class="mtk1">                     </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">                     </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">                     v173,</span>
<span class="mtk1">                     v174,</span>
<span class="mtk1">                     v175,</span>
<span class="mtk1">                     v176,</span>
<span class="mtk1">                     v331,</span>
<span class="mtk1">                     v332,</span>
<span class="mtk1">                     v333,</span>
<span class="mtk1">                     v334);</span>
<span class="mtk1">          }</span>
</code></pre></div><p>We see that there are two different responses when we win the game (the nanoseconds and the flag). Looking at other functions, there are some of them related to a &ldquo;large&rdquo; board. Actually, <code>main_initLargeBoard</code> is the same as <code>main_initBoard</code> but with a 50x50 board and 2000 bombs.</p><p>The problem is that the <code>/new</code> endpoint only works for the 20x20 board. The 50x50 board is hidden. We can see how it is generated in <code>main_main</code> when the server starts:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">// main.main</span>
<span class="mtk7 mtki">void</span><span class="mtk1"> __fastcall </span><span class="mtk8">main_main</span><span class="mtk1">()</span>
<span class="mtk1">{</span>
<span class="mtk1">  </span><span class="mtk3">// ...</span>

<span class="mtk1">  p_http_fileHandler </span><span class="mtk5">=</span><span class="mtk1"> (http_fileHandler </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk8">runtime_newobject</span><span class="mtk1">(</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_http_fileHandler);</span>
<span class="mtk1">  p_http_fileHandler-&gt;root.tab </span><span class="mtk5">=</span><span class="mtk1"> off_7336A0;</span>
<span class="mtk1">  p_http_fileHandler-&gt;root.data </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">&amp;</span><span class="mtk1">off_732060;</span>
<span class="mtk1">  v3 </span><span class="mtk5">=</span><span class="mtk1"> p_http_fileHandler;</span>
<span class="mtk1">  </span><span class="mtk8">net_http_Handle</span><span class="mtk1">((</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">unk_6B93F8, </span><span class="mtk6">1</span><span class="mtk1">, (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)off_7336C0, (_DWORD)p_http_fileHandler, v0, v4, v</span><span class="mtk1">5, v6);</span>  
<span class="mtk1">  Seed </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">mines_randomizer_CreateSeed</span><span class="mtk1">(qword_93B3B0, </span><span class="mtk6">1</span><span class="mtk5">LL</span><span class="mtk1">, v7, (__int64)v3, v0, v8, v9, v10, v11);</span>
<span class="mtk1">  Endpoint </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">mines_randomizer_CreateEndpoint</span><span class="mtk1">(Seed, </span><span class="mtk6">1</span><span class="mtk1">, v13, (</span><span class="mtk7 mtki">int</span><span class="mtk1">)v3, v0, v14, v15, v16, v17);</span>
<span class="mtk1">  v72[</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> (__int64)</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_string;</span>
<span class="mtk1">  v72[</span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_convTstring</span><span class="mtk1">(Endpoint, </span><span class="mtk6">1</span><span class="mtk1">, v19, (_DWORD)v3, v0, v20, v21, v22, v23, v54);</span>
<span class="mtk1">  v28 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">fmt_Sprintf</span><span class="mtk1">((</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">unk_6B949E, </span><span class="mtk6">3</span><span class="mtk1">, (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)v72, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, v24, v25, v26, v27, v55, v62, v64, v66);</span>
<span class="mtk1">  </span><span class="mtk8">net_http_HandleFunc</span><span class="mtk1">(v28, </span><span class="mtk6">3</span><span class="mtk1">, (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)off_6E8A80, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, v29, v30, v31, v32, v56);</span>

<span class="mtk1">  </span><span class="mtk3">// ...</span>
<span class="mtk1">}</span>
</code></pre></div><p>The relevant part here is that the <code>Endpoint</code> is generated from a <code>Seed</code>, which is returned from a function called <code>mines_randomizer_CreateSeed</code>. This function is hard to reverse-engineer. On the other hand, we can see that <code>mines_randomizer_CreateEndpoint</code> is just a MD5 hash of the <code>Seed</code> in text format:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">// mines/randomizer.CreateEndpoint</span>
<span class="mtk1">__int64 __golang </span><span class="mtk8">mines_randomizer_CreateEndpoint</span><span class="mtk1">(</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a1</span><span class="mtk1">,</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a2</span><span class="mtk1">,</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a3</span><span class="mtk1">,</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a4</span><span class="mtk1">,</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a5</span><span class="mtk1">,</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a6</span><span class="mtk1">,</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a7</span><span class="mtk1">,</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a8</span><span class="mtk1">,</span>
<span class="mtk1">        </span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">a9</span><span class="mtk1">)</span>
<span class="mtk1">{</span>
<span class="mtk1">  </span><span class="mtk3">// ...</span>

<span class="mtk1">  v53[</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_int64;</span>
<span class="mtk1">  v53[</span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_convT64</span><span class="mtk1">(a1, a2, a3, a4, a5, a6, a7, a8, a9);</span>
<span class="mtk1">  v9 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">  v10 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">  v15 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">fmt_Sprintf</span><span class="mtk1">(</span>
<span class="mtk1">          (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk4">"</span><span class="mtk6">%d</span><span class="mtk4">80; ./h2</span><span class="mtk10">%</span><span class="mtk4">wTe]:</span><span class="mtk10">%</span><span class="mtk4">T</span><span class="mtk6">\r\n\"</span><span class="mtk4">&gt;OK2500"</span><span class="mtk1">,</span>
<span class="mtk1">          </span><span class="mtk6">2</span><span class="mtk1">,</span>
<span class="mtk1">          (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)v53,</span>
<span class="mtk1">          </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">          </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">          v11,</span>
<span class="mtk1">          v12,</span>
<span class="mtk1">          v13,</span>
<span class="mtk1">          v14,</span>
<span class="mtk1">          v39,</span>
<span class="mtk1">          v43,</span>
<span class="mtk1">          v45,</span>
<span class="mtk1">          v49);</span>
<span class="mtk1">  v20 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_stringtoslicebyte</span><span class="mtk1">((</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v52, v15, </span><span class="mtk6">2</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, v16, v17, v18, v19, v40, v44, v46);</span>
<span class="mtk1">  </span><span class="mtk8">crypto_md5_Sum</span><span class="mtk1">(v20, v15, v21, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, v22, v23, v24, v25, v41, v47, v50);</span>
<span class="mtk1">  v51 </span><span class="mtk5">=</span><span class="mtk1"> v42;</span>
<span class="mtk1">  slice </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">runtime_makeslice</span><span class="mtk1">((</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">RTYPE_uint8, </span><span class="mtk6">32</span><span class="mtk1">, </span><span class="mtk6">32</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, v26, v27, v28, v29);</span>
<span class="mtk1">  i </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">  j </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">  </span><span class="mtk5">while</span><span class="mtk1"> ( i </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1"> )</span>
<span class="mtk1">  {</span>
<span class="mtk1">    v37 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">((_BYTE </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v51 </span><span class="mtk5">+</span><span class="mtk1"> i);</span>
<span class="mtk1">    v31 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk4">"0123456789abcdef"</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( j </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">      </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(j);</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(slice </span><span class="mtk5">+</span><span class="mtk1"> j) </span><span class="mtk5">=</span><span class="mtk1"> a0123456789abcd[v37 </span><span class="mtk5">&gt;&gt;</span><span class="mtk1"> </span><span class="mtk6">4</span><span class="mtk1">];</span>
<span class="mtk1">    v10 </span><span class="mtk5">=</span><span class="mtk1"> j </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">    v9 </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> __int8)a0123456789abcd[v37 </span><span class="mtk5">&amp;</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">F</span><span class="mtk1">];</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> ( j </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1"> </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">20</span><span class="mtk1"> )</span>
<span class="mtk1">      </span><span class="mtk8">runtime_panicIndex</span><span class="mtk1">(j </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(_BYTE </span><span class="mtk5">*</span><span class="mtk1">)(j </span><span class="mtk5">+</span><span class="mtk1"> slice </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> v9;</span>
<span class="mtk1">    </span><span class="mtk5">++</span><span class="mtk1">i;</span>
<span class="mtk1">    j </span><span class="mtk5">+=</span><span class="mtk1"> </span><span class="mtk6">2</span><span class="mtk5">LL</span><span class="mtk1">;</span>
<span class="mtk1">  }</span>
<span class="mtk1">  </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8">runtime_slicebytetostring</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">, slice, </span><span class="mtk6">32</span><span class="mtk1">, v9, v10, (_DWORD)v31, v32, v33, v34, v42, </span><span class="mtk5">*</span><span class="mtk1">((__int64 </span><span class="mtk5">*</span><span class="mtk1">)</span><span class="mtk5">&amp;</span><span class="mtk1">v42 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">), v48);</span>  
<span class="mtk1">}</span>
</code></pre></div><p>One feature of Go is that strings are not null-terminated. Instead, a string always appears together with its length. That&rsquo;s why the following instruction is the equivalent to <code>fmt.Sprintf("%d", v53)</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">  v15 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">fmt_Sprintf</span><span class="mtk1">(</span>
<span class="mtk1">          (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)</span><span class="mtk4">"</span><span class="mtk6">%d</span><span class="mtk4">80; ./h2</span><span class="mtk10">%</span><span class="mtk4">wTe]:</span><span class="mtk10">%</span><span class="mtk4">T</span><span class="mtk6">\r\n\"</span><span class="mtk4">&gt;OK2500"</span><span class="mtk1">,</span>  
<span class="mtk1">          </span><span class="mtk6">2</span><span class="mtk1">,</span>
<span class="mtk1">          (</span><span class="mtk7 mtki">unsigned</span><span class="mtk1"> </span><span class="mtk7 mtki">int</span><span class="mtk1">)v53,</span>
<span class="mtk1">          </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">          </span><span class="mtk6">1</span><span class="mtk1">,</span>
<span class="mtk1">          v11,</span>
<span class="mtk1">          v12,</span>
<span class="mtk1">          v13,</span>
<span class="mtk1">          v14,</span>
<span class="mtk1">          v39,</span>
<span class="mtk1">          v43,</span>
<span class="mtk1">          v45,</span>
<span class="mtk1">          v49);</span>
</code></pre></div><p>When I was testing, I took the hidden endpoint from GDB by setting breakpoints at <code>mines_randomizer_CreateEndpoint</code> (<code>0x53c280</code>) and <code>mines_randomizer_CreateSeed</code> (<code>0x53c3a0</code>). Then, I realized that calling the hidden endpoint was actually the same as calling <code>/new</code>. I mean, we are given a seed to generate the 50x50 board. Once we generate and win the game, the server will return the flag.</p><p>The only thing left was to determine what was the input to <code>mines_randomizer_CreateSeed</code>. This had to be something fixed, because the hidden endpoint is defined when the server starts, and it is not supposed to be restarted by the user.</p><p>After a lot of tests, I found out that the input to <code>mines_randomizer_CreateSeed</code> was the current time in nanoseconds. In fact, the number returned from the first board is the time when the server was started (it was about 10 minutes before the CTF started, so it was good).</p><p>So, we have everything; well, almost. Instead of reverse-engineering <code>mines_randomizer_CreateSeed</code>, we can use GDB to modify the input to <code>mines_randomizer_CreateSeed</code> and get the expected result. Then, we compute the MD5 hash and we will have the hidden endpoint:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gdb</span> -q <span class="mtku">GoSweep</span>
Loading GEF...
Reading symbols from <span class="code-dark-green">GoSweep</span>...
(No debugging symbols found in <span class="code-dark-green">GoSweep</span>)
<span class="code-red">gef&gt; </span>break *0x53c3a0
Breakpoint 1 at <span class="code-dark-blue">0x53c3a0</span>
<span class="code-red">gef&gt; </span>run
Starting program: <span class="code-dark-green">/root/GoSweep/GoSweep</span>
[Thread debugging using libthread_db enabled]
Using host libthread_db library "<span class="code-dark-green">/lib/x86_64-linux-gnu/libthread_db.so.1</span>".  
[New Thread 0x7fffb12d6640 (LWP 4155745)]
[New Thread 0x7fffb0ad5640 (LWP 4155761)]
[New Thread 0x7fffabfff640 (LWP 4155763)]
[New Thread 0x7fffab7fe640 (LWP 4155764)]
[New Thread 0x7fffaaffd640 (LWP 4155773)]

Thread 1 "GoSweep" hit Breakpoint 1, <span class="code-dark-blue">0x000000000053c3a0</span> in <span class="code-dark-yellow">??</span> ()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef&gt; </span>set $rax = (long) 1726246281186930269
<span class="code-green">gef&gt; </span>finish
Run till exit from #0  <span class="code-dark-blue">0x000000000053c3a0</span> in <span class="code-dark-yellow">??</span> ()  
<span class="code-dark-blue">0x0000000000647e1b</span> in <span class="code-dark-yellow">??</span> ()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef&gt; </span>p/d $rax
$1 = 60357764246024467
<span class="code-green">gef&gt; </span>quit

<span class="code-cyan">$</span> <span class="code-dark-green">python3</span> -q
&gt;&gt;&gt; from hashlib import md5
&gt;&gt;&gt; md5(b'60357764246024467').hexdigest()  
'48f99e62219f9bfd9fd437b75e0d46f9'
</code></pre></div><p>At this point, we can reuse the functions from the script and simply add these functions to solve the challenge:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">const</span><span class="mtk1"> URL </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk4">"</span><span class="mtk4 detected-link">https://gosweep.challs.m0lecon.it</span><span class="mtk4">"</span>

<span class="mtk5">func</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">() {</span>
<span class="mtk1">        </span><span class="mtk8">solve</span><span class="mtk1">(fmt.</span><span class="mtk8">Sprintf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%s</span><span class="mtk4">/new"</span><span class="mtk1">, URL), </span><span class="mtk6">20</span><span class="mtk1">, </span><span class="mtk6">150</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk8">solve</span><span class="mtk1">(fmt.</span><span class="mtk8">Sprintf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%s</span><span class="mtk4">/48f99e62219f9bfd9fd437b75e0d46f9"</span><span class="mtk1">, URL), </span><span class="mtk6">50</span><span class="mtk1">, </span><span class="mtk6">2000</span><span class="mtk1">)</span>  
<span class="mtk1">}</span>
</code></pre></div><h2 id="flag">Flag</h2><p>If we run the script, we will get the flag:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">go</span> run <span class="mtku">solve.go</span>
Good job! Take some nanos: 1726246281186930269
Congratulations! Take some chars: ptm{wh0_n33ds_luck_wh3n_y0u_h4v3_r3v3rs3?}  
</code></pre></div><p>The full script can be found in here: <a target="_blank" href="https://github.com/7Rocky/CTF-scripts/tree/main/m0leCon%20CTF/Go%20Sweep/solve.go"><code>solve.go</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#reverse-engineering">Reverse engineering</a><ul><li><a href="#board-generation">Board generation</a></li></ul></li><li><a href="#solution">Solution</a><ul><li><a href="#large-board">Large board</a></li></ul></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">üç∫ <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Receive a weekly blog digest"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Subscribe"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">View letter archive</a></p><p class="tc">powered by <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; 7Rocky's Blog. Cybersecurity and Maths 2024</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>