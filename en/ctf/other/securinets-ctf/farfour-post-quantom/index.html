<!doctype html><html lang="en"><head><title>Farfour Post Quantom | 7Rocky</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1"><meta name="author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="description" content="Securinets Quals 2023. Matrix operations. Modular arithmetic. Shuffling. Solve system of equations"><meta name="image" content="https://7rocky.github.io/images/cryptography.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="Securinets Quals 2023. Matrix operations. Modular arithmetic. Shuffling. Solve system of equations"><meta itemprop="keywords" content><meta itemprop="name" content="Farfour Post Quantom"><meta property="article:published_time" content><meta property="og:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:description" content="Securinets Quals 2023. Matrix operations. Modular arithmetic. Shuffling. Solve system of equations"><meta property="og:image" content="https://7rocky.github.io/images/cryptography.png"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:title" content="Farfour Post Quantom"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/en/ctf/other/securinets-ctf/farfour-post-quantom/"><meta name="twitter:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="twitter:card" content="Securinets Quals 2023. Matrix operations. Modular arithmetic. Shuffling. Solve system of equations"><meta name="twitter:description" content="Securinets Quals 2023. Matrix operations. Modular arithmetic. Shuffling. Solve system of equations"><meta name="twitter:image" content="https://7rocky.github.io/images/cryptography.png"><meta name="twitter:title" content="Farfour Post Quantom"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/en/ctf/other/securinets-ctf/farfour-post-quantom/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><script>MathJax={loader:{load:["[tex]/noerrors"]},options:{ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process",skipHtmlTags:["noscript","pre","script","style","textarea"]},tex:{autoload:{color:[],colorv2:["color"]},displayMath:[["$$","$$"]],inlineMath:[["$","$"]],packages:{"[+]":["noerrors"]},processEnvironments:!0,processEscapes:!0}}</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script><div id="math-consts" style="display:none">$
\newcommand{\e}{e}
\newcommand{\N}[1][]{\mathbb{N}^{#1}}
\newcommand{\Q}[1][]{\mathbb{Q}^{#1}}
\newcommand{\R}[1][]{\mathbb{R}^{#1}}
\newcommand{\Z}[1][]{\mathbb{Z}^{#1}}
\newcommand{\C}[1][]{\mathbb{C}^{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\divides}{\, | \,}
\newcommand{\st}{\; | \;}
\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\gcd}{\mathop{\mathrm{gcd}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\charField}{\mathop{\mathrm{char}}}
\newcommand{\Image}{\mathop{\mathrm{Im}}}
$</div><script src="/js/imc.js"></script>
<script>(async()=>await typeset(()=>[`#math-consts`]))()</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/en/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/en/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Search" rel="noopener" aria-label="Search"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="/ctf/other/securinets-ctf/farfour-post-quantom/" title="es"><img alt="es" height="30px" src="/images/es.png" style="border:4px solid#000;border-radius:100%" width="30px"></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href="#" title="en"><img alt="en" height="30px" src="/images/en.png" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- SECURINETS CTF</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/ctf/other/securinets-ctf/farfour-post-quantom/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/ctf/other/securinets-ctf/farfour-post-quantom/&amp;text=Farfour%20Post%20Quantom" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/en/ctf/other/securinets-ctf/farfour-post-quantom/&amp;title=Farfour%20Post%20Quantom" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Farfour Post Quantom</h1><p class="mb4 f6 dib tracked">17 minutes to read</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#source-code-analysis">Source code analysis</a><ul><li><a href="#options">Options</a></li></ul></li><li><a href="#attack-strategy">Attack strategy</a><ul><li><a href="#finding-pub_matrix">Finding <code>Pub_matrix</code></a></li><li><a href="#finding-secret_matrix">Finding <code>Secret_matrix</code></a></li></ul></li><li><a href="#different-approaches">Different approaches</a><ul><li><a href="#brute-force">Brute force</a></li><li><a href="#lattice-reduction-techniques">Lattice reduction techniques</a></li><li><a href="#system-of-equations">System of equations</a></li></ul></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">üç∫ <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>We are given the Python source code of a server:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">Crypto</span><span class="mtk1">.</span><span class="mtk8 mtku">Cipher</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">AES</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">Crypto</span><span class="mtk1">.</span><span class="mtk8 mtku">Util</span><span class="mtk1">.</span><span class="mtk8 mtku">Padding</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8">pad</span>
<span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">hashlib</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">os</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1">  </span><span class="mtk8">urandom</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">random</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">SystemRandom</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">sympy</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk1">GF</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">sympy</span><span class="mtk1">.</span><span class="mtk8 mtku">polys</span><span class="mtk1">.</span><span class="mtk8 mtku">matrices</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">DomainMatrix</span>
<span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">hashlib</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8">md5</span>

<span class="mtk1">random</span><span class="mtk5">=</span><span class="mtk8 mtku">SystemRandom</span><span class="mtk1">()</span>
<span class="mtk1">shuffle</span><span class="mtk5">=</span><span class="mtk1">random</span><span class="mtk1">.</span><span class="mtk8">shuffle</span>
<span class="mtk1">randint</span><span class="mtk5">=</span><span class="mtk1">random</span><span class="mtk1">.</span><span class="mtk8">randint</span>
<span class="mtk1">randrange</span><span class="mtk5">=</span><span class="mtk1">random</span><span class="mtk1">.</span><span class="mtk8">randrange</span>
<span class="mtk1">uniform</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">lambda</span><span class="mtk1">: </span><span class="mtk1">randrange</span><span class="mtk1">(</span><span class="mtk6">257</span><span class="mtk5">//</span><span class="mtk6">2</span><span class="mtk1">) </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk5">//</span><span class="mtk6">2</span>
<span class="mtk1">P</span><span class="mtk5">=</span><span class="mtk1">GF</span><span class="mtk1">(</span><span class="mtk6">257</span><span class="mtk1">)</span>


<span class="mtk1">secret</span><span class="mtk5">=</span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk4">"Secret.txt"</span><span class="mtk1">,</span><span class="mtk4">'rb'</span><span class="mtk1">).</span><span class="mtk8">read</span><span class="mtk1">()</span>
<span class="mtk5">assert</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">secret</span><span class="mtk1">)</span><span class="mtk5">==</span><span class="mtk6">16</span>
<span class="mtk1">flag</span><span class="mtk5">=</span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk4">"flag.txt"</span><span class="mtk1">,</span><span class="mtk4">"rb"</span><span class="mtk1">).</span><span class="mtk8">read</span><span class="mtk1">()</span>



<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">encrypt_flag</span><span class="mtk1">(</span><span class="mtk9 mtki">secret</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">key</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">hashlib</span><span class="mtk1">.</span><span class="mtk8">sha256</span><span class="mtk1">(</span><span class="mtk9 mtki">secret</span><span class="mtk1">).</span><span class="mtk8">digest</span><span class="mtk1">()[</span><span class="mtk5">-</span><span class="mtk6">16</span><span class="mtk1">:]</span>
<span class="mtk1">    </span><span class="mtk1">iv</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">urandom</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">cipher</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk8">new</span><span class="mtk1">(</span><span class="mtk1">key</span><span class="mtk1">, </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk1">MODE_CBC</span><span class="mtk1">, </span><span class="mtk1">iv</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">enc_flag</span><span class="mtk5">=</span><span class="mtk1">cipher</span><span class="mtk1">.</span><span class="mtk8">encrypt</span><span class="mtk1">(</span><span class="mtk8">pad</span><span class="mtk1">(</span><span class="mtk1">flag</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">))</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"encrypted_flag"</span><span class="mtk1">:</span><span class="mtk1">enc_flag</span><span class="mtk1">.</span><span class="mtk8">hex</span><span class="mtk1">(),</span><span class="mtk4">"IV"</span><span class="mtk1">:</span><span class="mtk1">iv</span><span class="mtk1">.</span><span class="mtk8">hex</span><span class="mtk1">()})</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">(</span><span class="mtk9 mtki">vec</span><span class="mtk1">,</span><span class="mtk9 mtki">mat</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">res</span><span class="mtk5">=</span><span class="mtk1">(</span><span class="mtk1">Pub_matrix</span><span class="mtk7">*</span><span class="mtk9 mtki">vec</span><span class="mtk1">).to_Matrix()</span>
<span class="mtk1">    </span><span class="mtk1">res</span><span class="mtk5">=</span><span class="mtk1">[</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">res</span><span class="mtk1">[</span><span class="mtk1">i</span><span class="mtk1">,</span><span class="mtk6">0</span><span class="mtk1">])</span><span class="mtk5">%</span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]</span>
<span class="mtk1">    </span><span class="mtk1">shuffle</span><span class="mtk1">(</span><span class="mtk1">res</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"hint"</span><span class="mtk1">:[</span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">res</span><span class="mtk1">]})</span>


<span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_secret</span><span class="mtk1">(</span><span class="mtk9 mtki">secret</span><span class="mtk1">,</span><span class="mtk9 mtki">Secret_matrix</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">secret_vetor</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">([[</span><span class="mtk1">P</span><span class="mtk1">(</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">i</span><span class="mtk1">))] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk9 mtki">secret</span><span class="mtk1">],(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">1</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">public_vector</span><span class="mtk5">=</span><span class="mtk1">(</span><span class="mtk9 mtki">Secret_matrix</span><span class="mtk7">*</span><span class="mtk1">secret_vetor</span><span class="mtk1">).to_Matrix()</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"secret"</span><span class="mtk1">:[</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">public_vector</span><span class="mtk1">[</span><span class="mtk1">i</span><span class="mtk1">,</span><span class="mtk6">0</span><span class="mtk1">]) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]})</span>


<span class="mtk5">while</span><span class="mtk1"> </span><span class="mtk6">True</span><span class="mtk1">:</span>
<span class="mtk1">    </span><span class="mtk1">g</span><span class="mtk5">=</span><span class="mtk1">randint</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1">,</span><span class="mtk6">257</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"G"</span><span class="mtk1">:</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">)}))</span>
<span class="mtk1">    </span><span class="mtk1">Secret_matrix</span><span class="mtk5">=</span><span class="mtk1">[[</span><span class="mtk1">uniform</span><span class="mtk1">() </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)] </span><span class="mtk5">for</span><span class="mtk1">  </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]</span>
<span class="mtk1">    </span><span class="mtk1">Pub_matrix</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">([[</span><span class="mtk1">P</span><span class="mtk1">((</span><span class="mtk8">pow</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">,</span><span class="mtk1">randint</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1">,</span><span class="mtk6">256</span><span class="mtk1">),</span><span class="mtk6">257</span><span class="mtk1">))</span><span class="mtk5">*</span><span class="mtk1">i</span><span class="mtk1">) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1">] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">Secret_matrix</span><span class="mtk1">],(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">Secret_matrix</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">(</span><span class="mtk1">Secret_matrix</span><span class="mtk1">,(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">) </span><span class="mtk3"># to make it easier for you &lt;3</span>
<span class="mtk1">    </span><span class="mtk5">while</span><span class="mtk1"> </span><span class="mtk6">True</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk5">try</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk1">choice</span><span class="mtk5">=</span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">loads</span><span class="mtk1">(</span><span class="mtk8">input</span><span class="mtk1">(</span><span class="mtk4">"Choose an option</span><span class="mtk6">\n</span><span class="mtk4">"</span><span class="mtk1">))</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1">(</span><span class="mtk4">"option"</span><span class="mtk1"> </span><span class="mtk5">not</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">):</span>
<span class="mtk1">                </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk4">"You need to choose an option"</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk5">elif</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"option"</span><span class="mtk1">]</span><span class="mtk5">==</span><span class="mtk4">"get_flag"</span><span class="mtk1">:</span>
<span class="mtk1">                </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8">encrypt_flag</span><span class="mtk1">(</span><span class="mtk1">secret</span><span class="mtk1">))</span>
<span class="mtk1">            </span><span class="mtk5">elif</span><span class="mtk1">(</span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"option"</span><span class="mtk1">]</span><span class="mtk5">==</span><span class="mtk4">"get_hint"</span><span class="mtk1">) </span><span class="mtk5">and</span><span class="mtk1"> </span><span class="mtk4">"vector"</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">:</span>
<span class="mtk1">                </span><span class="mtk5">assert</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"vector"</span><span class="mtk1">])</span><span class="mtk5">==</span><span class="mtk6">16</span>
<span class="mtk1">                </span><span class="mtk1">vec</span><span class="mtk5">=</span><span class="mtk1">[[</span><span class="mtk1">P</span><span class="mtk1">(</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">i</span><span class="mtk1">))] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"vector"</span><span class="mtk1">]]</span>
<span class="mtk1">                </span><span class="mtk1">input_vector</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">(</span><span class="mtk1">vec</span><span class="mtk1">,(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">1</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>
<span class="mtk1">                </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8">get_hint</span><span class="mtk1">(</span><span class="mtk1">input_vector</span><span class="mtk1">,</span><span class="mtk1">Pub_matrix</span><span class="mtk1">))</span>
<span class="mtk1">            </span><span class="mtk5">elif</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"option"</span><span class="mtk1">]</span><span class="mtk5">==</span><span class="mtk4">"get_secret"</span><span class="mtk1">:</span>
<span class="mtk1">                    </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8">get_secret</span><span class="mtk1">(</span><span class="mtk1">secret</span><span class="mtk1">,</span><span class="mtk1">Secret_matrix</span><span class="mtk1">))</span>
<span class="mtk1">            </span><span class="mtk5">elif</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"option"</span><span class="mtk1">]</span><span class="mtk5">==</span><span class="mtk4">"reset_connection"</span><span class="mtk1">:</span>
<span class="mtk1">                </span><span class="mtk1">g</span><span class="mtk5">=</span><span class="mtk1">randint</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1">,</span><span class="mtk6">257</span><span class="mtk1">)</span>
<span class="mtk1">                </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"G"</span><span class="mtk1">:</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">)}))</span>
<span class="mtk1">                </span><span class="mtk1">Secret_matrix</span><span class="mtk5">=</span><span class="mtk1">[[</span><span class="mtk1">uniform</span><span class="mtk1">() </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)] </span><span class="mtk5">for</span><span class="mtk1">  </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]</span>
<span class="mtk1">                </span><span class="mtk1">Pub_matrix</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">([[</span><span class="mtk1">P</span><span class="mtk1">((</span><span class="mtk8">pow</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">,</span><span class="mtk1">randint</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1">,</span><span class="mtk6">256</span><span class="mtk1">),</span><span class="mtk6">257</span><span class="mtk1">))</span><span class="mtk5">*</span><span class="mtk1">i</span><span class="mtk1">) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1">] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">Secret_matrix</span><span class="mtk1">],(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>  
<span class="mtk1">                </span><span class="mtk1">Secret_matrix</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">(</span><span class="mtk1">Secret_matrix</span><span class="mtk1">,(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk5">else</span><span class="mtk1">:</span>
<span class="mtk1">                </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk4">"Nothing that we have Right now "</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk5">except</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk4">"dont try something stupid"</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk5">break</span>
</code></pre></div><p>Moreover, there are two external files we are not given (<code>Secret.txt</code> and <code>flag.txt</code>):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">secret</span><span class="mtk5">=</span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk4">"Secret.txt"</span><span class="mtk1">,</span><span class="mtk4">'rb'</span><span class="mtk1">).</span><span class="mtk8">read</span><span class="mtk1">()</span>  
<span class="mtk5">assert</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">secret</span><span class="mtk1">)</span><span class="mtk5">==</span><span class="mtk6">16</span>
<span class="mtk1">flag</span><span class="mtk5">=</span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk4">"flag.txt"</span><span class="mtk1">,</span><span class="mtk4">"rb"</span><span class="mtk1">).</span><span class="mtk8">read</span><span class="mtk1">()</span>
</code></pre></div><h2 id="source-code-analysis">Source code analysis</h2><p>First of all, there are some definitions:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">random</span><span class="mtk5">=</span><span class="mtk8 mtku">SystemRandom</span><span class="mtk1">()</span>
<span class="mtk1">shuffle</span><span class="mtk5">=</span><span class="mtk1">random</span><span class="mtk1">.</span><span class="mtk8">shuffle</span>
<span class="mtk1">randint</span><span class="mtk5">=</span><span class="mtk1">random</span><span class="mtk1">.</span><span class="mtk8">randint</span>
<span class="mtk1">randrange</span><span class="mtk5">=</span><span class="mtk1">random</span><span class="mtk1">.</span><span class="mtk8">randrange</span>
<span class="mtk1">uniform</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">lambda</span><span class="mtk1">: </span><span class="mtk1">randrange</span><span class="mtk1">(</span><span class="mtk6">257</span><span class="mtk5">//</span><span class="mtk6">2</span><span class="mtk1">) </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk5">//</span><span class="mtk6">2</span>  
<span class="mtk1">P</span><span class="mtk5">=</span><span class="mtk1">GF</span><span class="mtk1">(</span><span class="mtk6">257</span><span class="mtk1">)</span>
</code></pre></div><p>Notice that <code>uniform</code> is a function that returns random values within the interval $[-128, -1]$:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> -q
&gt;&gt;&gt; from random import SystemRandom
&gt;&gt;&gt;
&gt;&gt;&gt; random=SystemRandom()
&gt;&gt;&gt; randrange=random.randrange
&gt;&gt;&gt; uniform = lambda: randrange(257//2) - 257//2  
&gt;&gt;&gt;
&gt;&gt;&gt; min(set(uniform() for _ in range(10000)))
-128
&gt;&gt;&gt; max(set(uniform() for _ in range(10000)))
-1
</code></pre></div><p>Moreover, we will be working in $\mathbb{F}_{257}$ (<code>GF(257)</code>), so <code>uniform</code> values will be actually within $[129, 256]$:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">>>> min(set(uniform() % 257 for _ in range(10000)))  
129
>>> max(set(uniform() % 257 for _ in range(10000)))
256
</code></pre></div><p>The server generates these cryptographic objects:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">while</span><span class="mtk1"> </span><span class="mtk6">True</span><span class="mtk1">:</span>
<span class="mtk1">    </span><span class="mtk1">g</span><span class="mtk5">=</span><span class="mtk1">randint</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1">,</span><span class="mtk6">257</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"G"</span><span class="mtk1">:</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">)}))</span>
<span class="mtk1">    </span><span class="mtk1">Secret_matrix</span><span class="mtk5">=</span><span class="mtk1">[[</span><span class="mtk1">uniform</span><span class="mtk1">() </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)] </span><span class="mtk5">for</span><span class="mtk1">  </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]</span>
<span class="mtk1">    </span><span class="mtk1">Pub_matrix</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">([[</span><span class="mtk1">P</span><span class="mtk1">((</span><span class="mtk8">pow</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">,</span><span class="mtk1">randint</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1">,</span><span class="mtk6">256</span><span class="mtk1">),</span><span class="mtk6">257</span><span class="mtk1">))</span><span class="mtk5">*</span><span class="mtk1">i</span><span class="mtk1">) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1">] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">Secret_matrix</span><span class="mtk1">],(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>  
<span class="mtk1">    </span><span class="mtk1">Secret_matrix</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">(</span><span class="mtk1">Secret_matrix</span><span class="mtk1">,(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">) </span><span class="mtk3"># to make it easier for you &lt;3</span>
</code></pre></div><p>The value $g \in [2, 257]$ is used to generate <code>Pub_matrix</code>. Notice that <code>Secret_matrix</code> is a $16 \times 16$ matrix generated using <code>uniform</code> (so all entries will be within $[129, 256]$). Then, the entries of <code>Pub_matrix</code> are the entries of <code>Secret_matrix</code>, each of them multiplied by $g^r$, where $r$ is a random integer between $2$ and $256$ (different for each entry).</p><h3 id="options">Options</h3><p>The server allows us to use four options:</p><ul><li><code>get_flag</code>:</li></ul><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">            </span><span class="mtk5">elif</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"option"</span><span class="mtk1">]</span><span class="mtk5">==</span><span class="mtk4">"get_flag"</span><span class="mtk1">:</span>  
<span class="mtk1">                </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8">encrypt_flag</span><span class="mtk1">(</span><span class="mtk1">secret</span><span class="mtk1">))</span>
</code></pre></div><p>This just uses the 16-byte secret inside <code>Secret.txt</code> as an AES key to encrypt the flag (stored at <code>flag.txt</code>):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">encrypt_flag</span><span class="mtk1">(</span><span class="mtk9 mtki">secret</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">key</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">hashlib</span><span class="mtk1">.</span><span class="mtk8">sha256</span><span class="mtk1">(</span><span class="mtk9 mtki">secret</span><span class="mtk1">).</span><span class="mtk8">digest</span><span class="mtk1">()[</span><span class="mtk5">-</span><span class="mtk6">16</span><span class="mtk1">:]</span>
<span class="mtk1">    </span><span class="mtk1">iv</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">urandom</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">cipher</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk8">new</span><span class="mtk1">(</span><span class="mtk1">key</span><span class="mtk1">, </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk1">MODE_CBC</span><span class="mtk1">, </span><span class="mtk1">iv</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">enc_flag</span><span class="mtk5">=</span><span class="mtk1">cipher</span><span class="mtk1">.</span><span class="mtk8">encrypt</span><span class="mtk1">(</span><span class="mtk8">pad</span><span class="mtk1">(</span><span class="mtk1">flag</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">))</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"encrypted_flag"</span><span class="mtk1">:</span><span class="mtk1">enc_flag</span><span class="mtk1">.</span><span class="mtk8">hex</span><span class="mtk1">(),</span><span class="mtk4">"IV"</span><span class="mtk1">:</span><span class="mtk1">iv</span><span class="mtk1">.</span><span class="mtk8">hex</span><span class="mtk1">()})</span>  
</code></pre></div><ul><li><code>get_secret</code>:</li></ul><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">            </span><span class="mtk5">elif</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"option"</span><span class="mtk1">]</span><span class="mtk5">==</span><span class="mtk4">"get_secret"</span><span class="mtk1">:</span>
<span class="mtk1">                    </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8">get_secret</span><span class="mtk1">(</span><span class="mtk1">secret</span><span class="mtk1">,</span><span class="mtk1">Secret_matrix</span><span class="mtk1">))</span>  
</code></pre></div><p>This one multiplies <code>Secret_matrix</code> times the 16-byte secret as a column vector. We are given the result:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_secret</span><span class="mtk1">(</span><span class="mtk9 mtki">secret</span><span class="mtk1">,</span><span class="mtk9 mtki">Secret_matrix</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">secret_vetor</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">([[</span><span class="mtk1">P</span><span class="mtk1">(</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">i</span><span class="mtk1">))] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk9 mtki">secret</span><span class="mtk1">],(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">1</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">public_vector</span><span class="mtk5">=</span><span class="mtk1">(</span><span class="mtk9 mtki">Secret_matrix</span><span class="mtk7">*</span><span class="mtk1">secret_vetor</span><span class="mtk1">).to_Matrix()</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"secret"</span><span class="mtk1">:[</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">public_vector</span><span class="mtk1">[</span><span class="mtk1">i</span><span class="mtk1">,</span><span class="mtk6">0</span><span class="mtk1">]) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]})</span>  
</code></pre></div><ul><li><code>get_hint</code>:</li></ul><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">            </span><span class="mtk5">elif</span><span class="mtk1">(</span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"option"</span><span class="mtk1">]</span><span class="mtk5">==</span><span class="mtk4">"get_hint"</span><span class="mtk1">) </span><span class="mtk5">and</span><span class="mtk1"> </span><span class="mtk4">"vector"</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">:</span>  
<span class="mtk1">                </span><span class="mtk5">assert</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"vector"</span><span class="mtk1">])</span><span class="mtk5">==</span><span class="mtk6">16</span>
<span class="mtk1">                </span><span class="mtk1">vec</span><span class="mtk5">=</span><span class="mtk1">[[</span><span class="mtk1">P</span><span class="mtk1">(</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">i</span><span class="mtk1">))] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"vector"</span><span class="mtk1">]]</span>
<span class="mtk1">                </span><span class="mtk1">input_vector</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">(</span><span class="mtk1">vec</span><span class="mtk1">,(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">1</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>
<span class="mtk1">                </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8">get_hint</span><span class="mtk1">(</span><span class="mtk1">input_vector</span><span class="mtk1">,</span><span class="mtk1">Pub_matrix</span><span class="mtk1">))</span>
</code></pre></div><p>Here we can send arbitrary columns vectors to multiply them against <code>Pub_matrix</code>. Unfortunately, the result vector (<code>res</code>) is shuffled&mldr;</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">(</span><span class="mtk9 mtki">vec</span><span class="mtk1">,</span><span class="mtk9 mtki">mat</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">res</span><span class="mtk5">=</span><span class="mtk1">(</span><span class="mtk1">Pub_matrix</span><span class="mtk7">*</span><span class="mtk9 mtki">vec</span><span class="mtk1">).to_Matrix()</span>
<span class="mtk1">    </span><span class="mtk1">res</span><span class="mtk5">=</span><span class="mtk1">[</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">res</span><span class="mtk1">[</span><span class="mtk1">i</span><span class="mtk1">,</span><span class="mtk6">0</span><span class="mtk1">])</span><span class="mtk5">%</span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]</span>
<span class="mtk1">    </span><span class="mtk1">shuffle</span><span class="mtk1">(</span><span class="mtk1">res</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"hint"</span><span class="mtk1">:[</span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">res</span><span class="mtk1">]})</span>  
</code></pre></div><ul><li><code>reset_connection</code>:</li></ul><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">            </span><span class="mtk5">elif</span><span class="mtk1"> </span><span class="mtk1">choice</span><span class="mtk1">[</span><span class="mtk4">"option"</span><span class="mtk1">]</span><span class="mtk5">==</span><span class="mtk4">"reset_connection"</span><span class="mtk1">:</span>
<span class="mtk1">                </span><span class="mtk1">g</span><span class="mtk5">=</span><span class="mtk1">randint</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1">,</span><span class="mtk6">257</span><span class="mtk1">)</span>
<span class="mtk1">                </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">"G"</span><span class="mtk1">:</span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">)}))</span>
<span class="mtk1">                </span><span class="mtk1">Secret_matrix</span><span class="mtk5">=</span><span class="mtk1">[[</span><span class="mtk1">uniform</span><span class="mtk1">() </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)] </span><span class="mtk5">for</span><span class="mtk1">  </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]</span>
<span class="mtk1">                </span><span class="mtk1">Pub_matrix</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">([[</span><span class="mtk1">P</span><span class="mtk1">((</span><span class="mtk8">pow</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">,</span><span class="mtk1">randint</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1">,</span><span class="mtk6">256</span><span class="mtk1">),</span><span class="mtk6">257</span><span class="mtk1">))</span><span class="mtk5">*</span><span class="mtk1">i</span><span class="mtk1">) </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1">] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">Secret_matrix</span><span class="mtk1">],(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>  
<span class="mtk1">                </span><span class="mtk1">Secret_matrix</span><span class="mtk5">=</span><span class="mtk8 mtku">DomainMatrix</span><span class="mtk1">(</span><span class="mtk1">Secret_matrix</span><span class="mtk1">,(</span><span class="mtk6">16</span><span class="mtk1">,</span><span class="mtk6">16</span><span class="mtk1">),</span><span class="mtk1">P</span><span class="mtk1">)</span>
</code></pre></div><p>This one allows us to regenerate the value of $g$ (and also update both <code>Secret_matrix</code> and <code>Pub_matrix</code>).</p><h2 id="attack-strategy">Attack strategy</h2><p>Let&rsquo;s see how we can use all the options to find the <code>Pub_matrix</code>, then the <code>Secret_matrix</code> and finally the <code>secret</code> (<code>Secret.txt</code>). Once we have this last value, we will be able to decrypt the flag with AES.</p><h3 id="finding-pub_matrix">Finding <code>Pub_matrix</code></h3><p>It is clear that we will need to use <code>get_hint</code> option, because it allows us to multiply <code>Pub_matrix</code> by an arbitrary vector. For instance, we can multiply the <code>Pub_matrix</code> ($(p_{i,j})_{16 \times 16}$) by a vector which has a $1$ at the first coordinate and the rest is $0$:</p><p class="scroll">$$
\begin{pmatrix}
\vdots & \vdots & \cdots & \vdots \\\\
  p_{i,1} & p_{i,2} & \dots & p_{i,16} \\\\
 \vdots & \vdots & \cdots & \vdots \\\\
\end{pmatrix} \cdot \begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ \vdots \\\\ 0 \end{pmatrix} = \begin{pmatrix} p_{1,1} \\\\ p_{2,1} \\\\ \vdots \\\\ p_{16,1} \end{pmatrix} \overset{\text{shuffle}}{\longrightarrow} \begin{pmatrix} p_{?,1} \\\\ p_{?,1} \\\\ \vdots \\\\ p_{?,1} \end{pmatrix}
$$</p><p>The problem is that the result vector will not be sorted, so we won&rsquo;t know the row positions.</p><p>The only thing we can do is get full rows with the following strategy:</p><ol><li>Send vector $(1, 0, \dots, 0)$. We will receive the values of the first column of <code>Pub_matrix</code>.</li><li>Send vector $(0, 1, 0, \dots, 0)$. We will receive the values of the second column of <code>Pub_matrix</code>.</li><li>Send vector $(1, 1, 0, \dots, 0)$. We will receive the sum of the values from the first and second columns that are in the same row:</li></ol><p class="scroll">$$
\begin{pmatrix}
\vdots & \vdots & \cdots & \vdots \\\\
  p_{i,1} & p_{i,2} & \dots & p_{i,16} \\\\
 \vdots & \vdots & \cdots & \vdots \\\\
\end{pmatrix} \cdot \begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ \vdots \\\\ 0 \end{pmatrix} = \begin{pmatrix} p_{1,1} + p_{1,2} \\\\ p_{2,1} + p_{2,2} \\\\ \vdots \\\\ p_{16,1} + p_{16,2} \end{pmatrix} \overset{\text{shuffle}}{\longrightarrow} \begin{pmatrix} p_{?,1} + p_{?,2} \\\\ p_{?,1} + p_{?,2} \\\\ \vdots \\\\ p_{?,1} + p_{?,2} \end{pmatrix}
$$</p><ol start="4"><li>We can do a similar query with the vector $(1, -1, 0, \dots, 0)$:</li></ol><p class="scroll">$$
\begin{pmatrix}
\vdots & \vdots & \cdots & \vdots \\\\
  p_{i,1} & p_{i,2} & \dots & p_{i,16} \\\\
 \vdots & \vdots & \cdots & \vdots \\\\
\end{pmatrix} \cdot \begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ \vdots \\\\ 0 \end{pmatrix} = \begin{pmatrix} p_{1,1} - p_{1,2} \\\\ p_{2,1} - p_{2,2} \\\\ \vdots \\\\ p_{16,1} - p_{16,2} \end{pmatrix} \overset{\text{shuffle}}{\longrightarrow} \begin{pmatrix} p_{?,1} - p_{?,2} \\\\ p_{?,1} - p_{?,2} \\\\ \vdots \\\\ p_{?,1} - p_{?,2} \end{pmatrix}
$$</p><p>The idea is to take the values from step 1. and 2. and then find pairs of values whose sum is in the set received in step 3. and whose difference is in the set from step 4. As a result, we will get the first two elements of each row of <code>Pub_matrix</code>.</p><p>In Python, we can use a wrapper function:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">(</span><span class="mtk9 mtki">vec</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Choose an option</span><span class="mtk6">\n</span><span class="mtk4">'</span><span class="mtk1">, </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">dumps</span><span class="mtk1">({</span><span class="mtk4">'option'</span><span class="mtk1">: </span><span class="mtk4">'get_hint'</span><span class="mtk1">, </span><span class="mtk4">'vector'</span><span class="mtk1">: </span><span class="mtk9 mtki">vec</span><span class="mtk1">}).</span><span class="mtk8">encode</span><span class="mtk1">())</span>  
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">loads</span><span class="mtk1">(</span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">().</span><span class="mtk8">decode</span><span class="mtk1">()).get(</span><span class="mtk4">'hint'</span><span class="mtk1">)</span>
</code></pre></div><p>Then, we can perform the above procedure as follows:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">Pub_matrix_prog</span><span class="mtk1">.</span><span class="mtk8">status</span><span class="mtk1">(</span><span class="mtk4">'Querying...'</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">hint10</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">+</span><span class="mtk1"> [</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk6">14</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">hint01</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">+</span><span class="mtk1"> [</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk6">14</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">hint11</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">+</span><span class="mtk1"> [</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk6">14</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">hint1_1</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">+</span><span class="mtk1"> [</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk6">14</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">rows</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> [[] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">_</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">16</span><span class="mtk1">)]</span>
<span class="mtk1">    </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span>

<span class="mtk1">    </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">a</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint10</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint01</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk1">a</span><span class="mtk1"> </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint11</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> (</span><span class="mtk1">a</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint1_1</span><span class="mtk1">:</span>  
<span class="mtk1">                </span><span class="mtk1">rows</span><span class="mtk1">[</span><span class="mtk1">i</span><span class="mtk1">].</span><span class="mtk8">append</span><span class="mtk1">(</span><span class="mtk1">a</span><span class="mtk1">)</span>
<span class="mtk1">                </span><span class="mtk1">rows</span><span class="mtk1">[</span><span class="mtk1">i</span><span class="mtk1">].</span><span class="mtk8">append</span><span class="mtk1">(</span><span class="mtk1">b</span><span class="mtk1">)</span>
<span class="mtk1">                </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> </span><span class="mtk6">1</span>
<span class="mtk1">                </span><span class="mtk5">break</span>

<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk5">not</span><span class="mtk1"> </span><span class="mtk8">all</span><span class="mtk1">(</span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">) </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">2</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">row</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">rows</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk1">Pub_matrix_prog</span><span class="mtk1">.</span><span class="mtk8">status</span><span class="mtk1">(</span><span class="mtk4">'Error'</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> [], []</span>
</code></pre></div><p>Once we have this, we can start looking for the third element of every row by using vector $(0, 0, 1, 0, \dots, 0)$. And for sanity check, we can also employ vectors $(1, 1, 1, 0, \dots, 0)$ and $(0, 1, 1, 0, \dots, 0)$:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">hint001</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">+</span><span class="mtk1"> [</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk6">13</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">hint111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">+</span><span class="mtk1"> [</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk6">13</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">hint011</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">] </span><span class="mtk5">+</span><span class="mtk1"> [</span><span class="mtk6">0</span><span class="mtk1">] </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk6">13</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">row</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">rows</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint001</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                    (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">1</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint011</span><span class="mtk1">:</span>  

<span class="mtk1">                </span><span class="mtk1">row</span><span class="mtk1">.</span><span class="mtk8">append</span><span class="mtk1">(</span><span class="mtk1">b</span><span class="mtk1">)</span>
<span class="mtk1">                </span><span class="mtk5">break</span>

<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk5">not</span><span class="mtk1"> </span><span class="mtk8">all</span><span class="mtk1">(</span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">) </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">3</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">row</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">rows</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk1">Pub_matrix_prog</span><span class="mtk1">.</span><span class="mtk8">status</span><span class="mtk1">(</span><span class="mtk4">'Error'</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> [], []</span>
</code></pre></div><p>We continue with the fourth, the fifth, and so on until the last one. For each of them, one more check is added.</p><p>Although the queries and checks can be automated, I found it simpler to write all checks by hand, just to keep control on what we are doing. As an example, these are the queries and checks for the last element of each row:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">hint0000000000000001</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>  
<span class="mtk1">    </span><span class="mtk1">hint1111111111111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0111111111111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0011111111111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0001111111111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000111111111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000011111111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000001111111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000000111111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000000011111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000000001111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000000000111111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000000000011111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000000000001111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000000000000111</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>
<span class="mtk1">    </span><span class="mtk1">hint0000000000000011</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_hint</span><span class="mtk1">([</span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">])</span>

<span class="mtk1">    </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">row</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">rows</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000000000001</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint1111111111111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">1</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0111111111111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">2</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0011111111111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">3</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0001111111111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">4</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000111111111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">5</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000011111111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">6</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000001111111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">7</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000111111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">8</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000011111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">9</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000001111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">10</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000000111111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">11</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000000011111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">12</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000000001111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">13</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000000000111</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> \</span>
<span class="mtk1">                    (</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">[</span><span class="mtk6">14</span><span class="mtk1">:]) </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">hint0000000000000011</span><span class="mtk1">:</span>

<span class="mtk1">                </span><span class="mtk1">row</span><span class="mtk1">.</span><span class="mtk8">append</span><span class="mtk1">(</span><span class="mtk1">b</span><span class="mtk1">)</span>
<span class="mtk1">                </span><span class="mtk5">break</span>

<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk5">not</span><span class="mtk1"> </span><span class="mtk8">all</span><span class="mtk1">(</span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">row</span><span class="mtk1">) </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">row</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">rows</span><span class="mtk1">):</span>
<span class="mtk1">        </span><span class="mtk1">Pub_matrix_prog</span><span class="mtk1">.</span><span class="mtk8">status</span><span class="mtk1">(</span><span class="mtk4">'Error'</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> [], []</span>
</code></pre></div><p>It looks awful, but believe me, it is easier to implement and to understand (at least for me).</p><p>At this point, we have the rows of <code>Pub_matrix</code> (but we still don&rsquo;t know their position).</p><h3 id="finding-secret_matrix">Finding <code>Secret_matrix</code></h3><p>We need to use the fact that <code>Pub_matrix</code> depends on <code>Secret_matrix</code> and $g$. Since we can use any value of $g$ (we will need to use <code>reset_connection</code> several times until we get the value we want), we will force $g$ to be $g = 256 \equiv -1 \pmod{257}$. With this, we get that $g^r \mod{257} = \pm 1$, for any integer $r$.</p><p>As a result, having the rows of <code>Pub_matrix</code> will instantly give us the rows of <code>Secret_matrix</code>, since these were generated by <code>uniform</code> ($[129, 256]$). So, if one element of <code>Pub_matrix</code> is less than $129$, it has been multiplied by $-1$ and we only need to compute an offset.</p><p>In Python, we can do the following:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">get_data</span><span class="mtk1">():</span>
<span class="mtk1">    </span><span class="mtk1">g</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span>

<span class="mtk1">    </span><span class="mtk5">while</span><span class="mtk1"> </span><span class="mtk1">g</span><span class="mtk1"> </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">256</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Choose an option</span><span class="mtk6">\n</span><span class="mtk4">'</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'{"option":"reset_connection"}'</span><span class="mtk1">)</span>  
<span class="mtk1">        </span><span class="mtk1">g</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">loads</span><span class="mtk1">(</span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">().</span><span class="mtk8">decode</span><span class="mtk1">()).get(</span><span class="mtk4">'G'</span><span class="mtk1">)</span>
<span class="mtk1">        </span><span class="mtk1">g_prog</span><span class="mtk1">.</span><span class="mtk8">status</span><span class="mtk1">(</span><span class="mtk8 mtku">str</span><span class="mtk1">(</span><span class="mtk1">g</span><span class="mtk1">))</span>

<span class="mtk1">    </span><span class="mtk1">Pub_matrix_prog</span><span class="mtk1">.</span><span class="mtk8">status</span><span class="mtk1">(</span><span class="mtk4">'Querying...'</span><span class="mtk1">)</span>

<span class="mtk3">    # ...</span>

<span class="mtk1">    </span><span class="mtk1">secret_rows</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> [[</span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">&gt;=</span><span class="mtk1"> </span><span class="mtk6">129</span><span class="mtk1"> </span><span class="mtk5">else</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1">] </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">rows</span><span class="mtk1">]</span>

<span class="mtk3">    # ...</span>
</code></pre></div><p>But we have the same problem as before&mldr; We don&rsquo;t know the position of the rows.</p><p>Also, we must consider an issue when there is a repeated element in the first column. The presented algorithm only works when all entries in the first column are different. If not, we will end up with repeated rows. Therefore, we can check if the rank of the matrix is maximum or not.</p><h2 id="different-approaches">Different approaches</h2><p>Now, we must use <code>get_secret</code> to somehow find the <code>secret</code> vector having the rows of <code>Secret_matrix</code>.</p><h3 id="brute-force">Brute force</h3><p>We could think of doing brute force on the possible permutations of rows. However, there are a total of $16!$ possibilities ($2^{44} &lt; 16! &lt; 2^{45}$):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> -q
&gt;&gt;&gt; from math import log2, prod
&gt;&gt;&gt; prod(range(1, 16 + 1))
20922789888000
&gt;&gt;&gt; log2(prod(range(1, 16 + 1)))
44.25014046988262
&gt;&gt;&gt; 2 ** 44 &lt; prod(range(1, 16 + 1)) &lt; 2 ** 45  
True
</code></pre></div><p>Also, trying to apply brute force the <code>secret</code> vector is also bad since we will need to try around $256^{16} = 2^{128}$ possible vectors.</p><h3 id="lattice-reduction-techniques">Lattice reduction techniques</h3><p>There is no clear way to find the position of each row. No matter how you arrange the vector in <code>get_hint</code>, since the result is shuffled, there is no certainty on the row number.</p><p>There is still something we know from <code>Secret_matrix</code> ($(a_{i,j})_{16 \times 16}$) and the <code>secret</code> vector ($s_{i}$):</p><p class="scroll">$$
\begin{pmatrix}
\vdots & \vdots & \cdots & \vdots \\\\
  a_{?,1} & a_{?,2} & \dots & a_{?,16} \\\\
 \vdots & \vdots & \cdots & \vdots \\\\
\end{pmatrix} \cdot \begin{pmatrix} s_1 \\\\ s_2 \\\\ \vdots \\\\ s_{16} \end{pmatrix} = \begin{pmatrix} b_1 \\\\ b_2 \\\\ \vdots \\\\ b_{16} \end{pmatrix}
$$</p><p>Let $A_j = \displaystyle\sum_j a_{?,j}$ and $b = \displaystyle\sum_i b_{i}$. Now we have:</p><p class="scroll">$$
\begin{pmatrix}
A_{1} & A_{2} & \dots & A_{16} \\\\
\end{pmatrix} \cdot \begin{pmatrix} s_1 \\\\ s_2 \\\\ \vdots \\\\ s_{16} \end{pmatrix} = b
$$</p><p>With this, we have got rid of the shuffling. The above equation is valid for the <code>secret</code> vector. In Python, these are the last instructions of the <code>get_data</code> function (we check the rank here as well):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Choose an option</span><span class="mtk6">\n</span><span class="mtk4">'</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'{"option":"get_secret"}'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">secret_vector</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">loads</span><span class="mtk1">(</span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">().</span><span class="mtk8">decode</span><span class="mtk1">()).get(</span><span class="mtk4">'secret'</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">A</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> Matrix(</span><span class="mtk1">F</span><span class="mtk1">, </span><span class="mtk1">secret_rows</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk1">A</span><span class="mtk1">.rank() </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk5">return</span><span class="mtk1"> [</span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">c</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span><span class="mtk1"> </span><span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">c</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk1">A</span><span class="mtk1">.columns()], </span><span class="mtk8">sum</span><span class="mtk1">(</span><span class="mtk1">secret_vector</span><span class="mtk1">) </span><span class="mtk5">%</span><span class="mtk1"> </span><span class="mtk6">257</span>  

<span class="mtk1">    </span><span class="mtk1">Pub_matrix_prog</span><span class="mtk1">.</span><span class="mtk8">status</span><span class="mtk1">(</span><span class="mtk4">'Rank error'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1"> [], []</span>
</code></pre></div><p>The formula reminded me to a knapsack problem, so I tried to create a lattice and apply LLL in order to find a short vector, which was presumably the <code>secret</code> vector (something similar to <a href="../../../htb-challenges/crypto/infinite-knapsack">Infinite Knapsack</a>). But it seems that the conditions where not suitable to solve the Shortest Vector Problem with this approach.</p><h3 id="system-of-equations">System of equations</h3><p>So, it is clear that we need more precision. This is something directly related to the amount of information we have. Notice that we can continue using <code>reset_connection</code> until getting $g = 256$, then find <code>Pub_matrix</code> and <code>Secret_matrix</code> and use <code>get_secret</code> again. The result will be another equation as the above one.</p><p>If we iterate the process until we have $16$ equations, we will be able to solve a system of equations on the entries of <code>secret</code> vector (notice that <code>Secret.txt</code> is always the same).</p><p>With this, we have found a winning strategy:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">():</span>
<span class="mtk1">    </span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Choose an option</span><span class="mtk6">\n</span><span class="mtk4">'</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'{"option":"get_flag"}'</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">data</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">json</span><span class="mtk1">.</span><span class="mtk8">loads</span><span class="mtk1">(</span><span class="mtk1">io</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">().</span><span class="mtk8">decode</span><span class="mtk1">())</span>
<span class="mtk1">    </span><span class="mtk1">enc_flag</span><span class="mtk1">, </span><span class="mtk1">iv</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">map</span><span class="mtk1">(</span><span class="mtk8 mtku">bytes</span><span class="mtk1">.</span><span class="mtk8">fromhex</span><span class="mtk1">, [</span><span class="mtk1">data</span><span class="mtk1">.get(</span><span class="mtk4">'encrypted_flag'</span><span class="mtk1">), </span><span class="mtk1">data</span><span class="mtk1">.get(</span><span class="mtk4">'IV'</span><span class="mtk1">)])</span>  

<span class="mtk1">    </span><span class="mtk1">A</span><span class="mtk1">, </span><span class="mtk1">b</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> [], []</span>

<span class="mtk1">    </span><span class="mtk5">while</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">b</span><span class="mtk1">) </span><span class="mtk5">&lt;</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1">:</span>
<span class="mtk1">        </span><span class="mtk1">A_i</span><span class="mtk1">, </span><span class="mtk1">b_i</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_data</span><span class="mtk1">()</span>

<span class="mtk1">        </span><span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk1">A_i</span><span class="mtk1"> </span><span class="mtk5">and</span><span class="mtk1"> </span><span class="mtk1">b_i</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk1">A</span><span class="mtk1">.</span><span class="mtk8">append</span><span class="mtk1">(</span><span class="mtk1">A_i</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk1">b</span><span class="mtk1">.</span><span class="mtk8">append</span><span class="mtk1">(</span><span class="mtk1">b_i</span><span class="mtk1">)</span>
<span class="mtk1">            </span><span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">success</span><span class="mtk1">(</span><span class="mtk7 mtki">f</span><span class="mtk4">'</span><span class="mtk6">{</span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">b</span><span class="mtk1">)</span><span class="mtk6">}</span><span class="mtk4"> -&gt; </span><span class="mtk6">{</span><span class="mtk1">A_i</span><span class="mtk1"> = </span><span class="mtk6">}</span><span class="mtk4">; </span><span class="mtk6">{</span><span class="mtk1">b_i</span><span class="mtk1"> = </span><span class="mtk6">}</span><span class="mtk4">'</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">g_prog</span><span class="mtk1">.</span><span class="mtk8">success</span><span class="mtk1">()</span>
<span class="mtk1">    </span><span class="mtk1">Pub_matrix_prog</span><span class="mtk1">.</span><span class="mtk8">success</span><span class="mtk1">()</span>

<span class="mtk1">    </span><span class="mtk1">secret_vector</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> Matrix(</span><span class="mtk1">F</span><span class="mtk1">, </span><span class="mtk1">A</span><span class="mtk1">).solve_right(vector(</span><span class="mtk1">F</span><span class="mtk1">, </span><span class="mtk1">b</span><span class="mtk1">))</span>
<span class="mtk1">    </span><span class="mtk1">secret</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">bytes</span><span class="mtk1">(</span><span class="mtk1">secret_vector</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">info</span><span class="mtk1">(</span><span class="mtk7 mtki">f</span><span class="mtk4">'Secret: </span><span class="mtk6">{</span><span class="mtk1">secret</span><span class="mtk1">.</span><span class="mtk8">decode</span><span class="mtk1">()</span><span class="mtk6">}</span><span class="mtk4">'</span><span class="mtk1">)</span>
</code></pre></div><p>Once we have the <code>secret</code> vector, we can simply decrypt the flag:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">key</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">sha256</span><span class="mtk1">(</span><span class="mtk1">secret</span><span class="mtk1">).</span><span class="mtk8">digest</span><span class="mtk1">()[</span><span class="mtk5">-</span><span class="mtk6">16</span><span class="mtk1">:]</span>
<span class="mtk1">    </span><span class="mtk1">cipher</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk8">new</span><span class="mtk1">(</span><span class="mtk1">key</span><span class="mtk1">, </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk1">MODE_CBC</span><span class="mtk1">, </span><span class="mtk1">iv</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">flag</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">unpad</span><span class="mtk1">(</span><span class="mtk1">cipher</span><span class="mtk1">.</span><span class="mtk8">decrypt</span><span class="mtk1">(</span><span class="mtk1">enc_flag</span><span class="mtk1">), </span><span class="mtk8 mtku">AES</span><span class="mtk1">.</span><span class="mtk1">block_size</span><span class="mtk1">)</span>  
<span class="mtk1">    </span><span class="mtk1">log</span><span class="mtk1">.</span><span class="mtk8">success</span><span class="mtk1">(</span><span class="mtk7 mtki">f</span><span class="mtk4">'Flag: </span><span class="mtk6">{</span><span class="mtk1">flag</span><span class="mtk1">.</span><span class="mtk8">decode</span><span class="mtk1">()</span><span class="mtk6">}</span><span class="mtk4">'</span><span class="mtk1">)</span>
</code></pre></div><p>We can try to solve it locally:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">echo</span> <span class="code-dark-yellow">'Securinets{f4k3_fl4g_f0r_t3st1ng}'</span> &gt; <span class="mtku">flag.txt</span>

<span class="code-cyan">$</span> <span class="code-dark-green">echo</span> -n <span class="code-dark-yellow">'0123456789abcdef'</span> &gt; secret.txt

<span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-green">+</span>] g: Done
[<span class="code-green">+</span>] Pub_matrix: Done
[<span class="code-green">+</span>] Starting local process '/usr/bin/python3': pid 600334
[<span class="code-green">+</span>] 1 -&gt; A_i = [84, 158, 178, 47, 78, 152, 184, 238, 189, 148, 111, 197, 99, 131, 86, 217]; b_i = 141
[<span class="code-green">+</span>] 2 -&gt; A_i = [21, 139, 244, 66, 179, 150, 128, 13, 14, 49, 194, 158, 97, 169, 84, 197]; b_i = 137
[<span class="code-green">+</span>] 3 -&gt; A_i = [76, 57, 163, 92, 169, 40, 4, 204, 61, 51, 91, 113, 87, 122, 83, 247]; b_i = 166
[<span class="code-green">+</span>] 4 -&gt; A_i = [121, 116, 9, 158, 102, 198, 116, 30, 97, 178, 243, 29, 226, 60, 35, 142]; b_i = 255
[<span class="code-green">+</span>] 5 -&gt; A_i = [125, 198, 162, 176, 105, 0, 10, 144, 178, 226, 32, 172, 196, 203, 173, 23]; b_i = 228
[<span class="code-green">+</span>] 6 -&gt; A_i = [124, 225, 47, 126, 141, 152, 68, 48, 74, 193, 109, 10, 101, 55, 111, 183]; b_i = 22
[<span class="code-green">+</span>] 7 -&gt; A_i = [241, 246, 236, 55, 156, 152, 93, 250, 244, 144, 256, 227, 102, 78, 242, 54]; b_i = 42
[<span class="code-green">+</span>] 8 -&gt; A_i = [135, 25, 96, 246, 128, 55, 128, 171, 15, 21, 227, 39, 131, 26, 88, 196]; b_i = 163
[<span class="code-green">+</span>] 9 -&gt; A_i = [180, 163, 162, 27, 131, 207, 110, 139, 230, 225, 222, 20, 65, 10, 55, 176]; b_i = 118
[<span class="code-green">+</span>] 10 -&gt; A_i = [127, 16, 131, 29, 105, 26, 1, 53, 25, 154, 49, 240, 84, 246, 136, 225]; b_i = 157
[<span class="code-green">+</span>] 11 -&gt; A_i = [186, 181, 103, 95, 105, 81, 159, 132, 15, 25, 189, 204, 76, 110, 20, 71]; b_i = 206
[<span class="code-green">+</span>] 12 -&gt; A_i = [196, 213, 240, 209, 62, 249, 218, 44, 182, 177, 170, 51, 184, 131, 82, 131]; b_i = 25  
[<span class="code-green">+</span>] 13 -&gt; A_i = [87, 215, 228, 181, 12, 133, 110, 22, 204, 46, 173, 60, 224, 217, 252, 79]; b_i = 35
[<span class="code-green">+</span>] 14 -&gt; A_i = [163, 136, 7, 236, 176, 109, 126, 66, 240, 196, 188, 60, 176, 244, 51, 173]; b_i = 78
[<span class="code-green">+</span>] 15 -&gt; A_i = [185, 145, 9, 141, 153, 186, 187, 48, 249, 142, 30, 234, 195, 22, 136, 140]; b_i = 206
[<span class="code-green">+</span>] 16 -&gt; A_i = [11, 206, 59, 217, 145, 15, 7, 105, 170, 95, 250, 92, 204, 209, 232, 15]; b_i = 214
[<span class="code-blue">*</span>] Secret: 0123456789abcdef
[<span class="code-green">+</span>] Flag: Securinets{f4k3_fl4g_f0r_t3st1ng}
[<span class="code-blue">*</span>] Stopped process '/usr/bin/python3' (pid 600334)
</code></pre></div><h2 id="flag">Flag</h2><p>If we run it remotely, we will get the flag (after a lot of time):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-yellow">time</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span> crypto.securinets.tn 8888
[<span class="code-green">+</span>] g: Done
[<span class="code-green">+</span>] Pub_matrix: Done
[<span class="code-green">+</span>] Opening connection to crypto.securinets.tn on port 8888: Done
[<span class="code-green">+</span>] 1 -&gt; A_i = [129, 145, 183, 209, 150, 70, 217, 127, 68, 65, 63, 178, 4, 28, 256, 43]; b_i = 7
[<span class="code-green">+</span>] 2 -&gt; A_i = [49, 255, 224, 114, 156, 46, 185, 54, 26, 46, 109, 234, 155, 99, 123, 68]; b_i = 81
[<span class="code-green">+</span>] 3 -&gt; A_i = [252, 100, 232, 10, 103, 38, 235, 176, 161, 99, 46, 182, 137, 177, 59, 28]; b_i = 231
[<span class="code-green">+</span>] 4 -&gt; A_i = [211, 79, 70, 52, 95, 121, 89, 185, 17, 78, 155, 119, 84, 223, 92, 52]; b_i = 154
[<span class="code-green">+</span>] 5 -&gt; A_i = [110, 233, 113, 69, 234, 232, 183, 247, 140, 114, 239, 118, 4, 169, 167, 52]; b_i = 177
[<span class="code-green">+</span>] 6 -&gt; A_i = [252, 49, 38, 130, 12, 50, 225, 186, 147, 25, 31, 133, 76, 111, 248, 74]; b_i = 192
[<span class="code-green">+</span>] 7 -&gt; A_i = [248, 233, 208, 64, 41, 177, 42, 22, 221, 228, 66, 256, 45, 118, 204, 232]; b_i = 210
[<span class="code-green">+</span>] 8 -&gt; A_i = [95, 3, 73, 45, 36, 72, 247, 200, 152, 106, 237, 100, 153, 178, 170, 49]; b_i = 69
[<span class="code-green">+</span>] 9 -&gt; A_i = [32, 173, 20, 118, 150, 51, 97, 189, 95, 236, 237, 202, 251, 188, 59, 95]; b_i = 40
[<span class="code-green">+</span>] 10 -&gt; A_i = [184, 35, 78, 172, 2, 126, 66, 202, 147, 32, 92, 45, 106, 241, 0, 11]; b_i = 226
[<span class="code-green">+</span>] 11 -&gt; A_i = [222, 248, 42, 33, 237, 16, 121, 242, 11, 96, 190, 112, 80, 104, 243, 209]; b_i = 36
[<span class="code-green">+</span>] 12 -&gt; A_i = [19, 209, 137, 254, 95, 102, 11, 126, 183, 16, 235, 195, 33, 100, 208, 2]; b_i = 239
[<span class="code-green">+</span>] 13 -&gt; A_i = [144, 68, 190, 100, 121, 168, 16, 61, 114, 126, 105, 202, 33, 233, 165, 87]; b_i = 204
[<span class="code-green">+</span>] 14 -&gt; A_i = [134, 233, 198, 225, 139, 129, 239, 154, 97, 205, 171, 36, 208, 226, 228, 221]; b_i = 53  
[<span class="code-green">+</span>] 15 -&gt; A_i = [134, 15, 123, 43, 156, 218, 184, 7, 19, 179, 7, 148, 77, 68, 220, 115]; b_i = 158
[<span class="code-green">+</span>] 16 -&gt; A_i = [138, 229, 69, 199, 50, 63, 119, 7, 0, 99, 27, 76, 26, 207, 2, 100]; b_i = 236
[<span class="code-blue">*</span>] Secret: 80gak_7AJ1N_k1dO
[<span class="code-green">+</span>] Flag: Secruinets{ShuFflIn9_thrOu9h_my_3quAtIoN_1SN7_3Nou9h7_to_s7op_Fr0m_Me}
[<span class="code-blue">*</span>] Closed connection to crypto.securinets.tn port 8888
python3 solve.py crypto.securinets.tn 8888  50,11s user 8,70s system 1% cpu 1:28:58,32 total
</code></pre></div><p>The full script can be found in here: <a href="https://github.com/7Rocky/CTF-scripts/tree/main/Securinets/Farfour%20Post%20Quantom/solve.py"><code>solve.py</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#source-code-analysis">Source code analysis</a><ul><li><a href="#options">Options</a></li></ul></li><li><a href="#attack-strategy">Attack strategy</a><ul><li><a href="#finding-pub_matrix">Finding <code>Pub_matrix</code></a></li><li><a href="#finding-secret_matrix">Finding <code>Secret_matrix</code></a></li></ul></li><li><a href="#different-approaches">Different approaches</a><ul><li><a href="#brute-force">Brute force</a></li><li><a href="#lattice-reduction-techniques">Lattice reduction techniques</a></li><li><a href="#system-of-equations">System of equations</a></li></ul></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">üç∫ <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://tinyletter.com/7Rocky" method="post" target="popupwindow" onsubmit='return window.open("https://tinyletter.com/7Rocky","popupwindow","scrollbars=yes,width=800,height=600"),!0'><h3 class="tc">Receive a weekly blog digest</h3><p class="tc"><label for="tlemail"></label></p><p class="tc"><input type="text" class="w-80 f5 pv3 ph3 bg-light-gray bn search" placeholder="Enter your email address" name="email" id="tlemail">
<input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Submit"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Subscribe"><p class="tc">powered by <a href="https://tinyletter.com" target="_blank" title="TinyLetter">TinyLetter</a></p><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">View letter archive</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; 7Rocky's Blog. Cybersecurity and Maths 2023</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub‚Äî‚ÄîOpens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>