<!doctype html><html lang="en"><head><title>yaonet | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="description" content="DiceCTF 2024 Quals. ECC. Baby-step, giant-step. Meet-in-the-middle"><meta name="image" content="https://7rocky.github.io/images/cryptography.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="DiceCTF 2024 Quals. ECC. Baby-step, giant-step. Meet-in-the-middle"><meta itemprop="keywords" content><meta itemprop="name" content="yaonet"><meta property="article:published_time" content><meta property="og:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:description" content="DiceCTF 2024 Quals. ECC. Baby-step, giant-step. Meet-in-the-middle"><meta property="og:image" content="https://7rocky.github.io/images/cryptography.png"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:title" content="yaonet"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/en/ctf/other/dicectf/yaonet/"><meta name="twitter:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="twitter:card" content="DiceCTF 2024 Quals. ECC. Baby-step, giant-step. Meet-in-the-middle"><meta name="twitter:description" content="DiceCTF 2024 Quals. ECC. Baby-step, giant-step. Meet-in-the-middle"><meta name="twitter:image" content="https://7rocky.github.io/images/cryptography.png"><meta name="twitter:title" content="yaonet"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/en/ctf/other/dicectf/yaonet/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D")}</script><script>MathJax={loader:{load:["[tex]/noerrors"]},options:{ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process",skipHtmlTags:["noscript","pre","script","style","textarea"]},tex:{autoload:{color:[],colorv2:["color"]},displayMath:[["$$","$$"]],inlineMath:[["$","$"]],packages:{"[+]":["noerrors"]},processEnvironments:!0,processEscapes:!0}}</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script><div id="math-consts" style="display:none">$
\newcommand{\e}{e}
\newcommand{\N}[1][]{\mathbb{N}^{#1}}
\newcommand{\Q}[1][]{\mathbb{Q}^{#1}}
\newcommand{\R}[1][]{\mathbb{R}^{#1}}
\newcommand{\Z}[1][]{\mathbb{Z}^{#1}}
\newcommand{\C}[1][]{\mathbb{C}^{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\dz}{\,\mathrm{d}z}
\newcommand{\dt}{\,\mathrm{d}t}
\newcommand{\divides}{\, | \,}
\newcommand{\st}{\; | \;}
\renewcommand{\geq}{\geqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\i}{\mathrm{i}}
\newcommand{\rank}{\mathop{\mathrm{rank}}}
\newcommand{\gcd}{\mathop{\mathrm{gcd}}}
\newcommand{\lcm}{\mathop{\mathrm{lcm}}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
\newcommand{\charField}{\mathop{\mathrm{char}}}
\newcommand{\Image}{\mathop{\mathrm{Im}}}
$</div><script src="/js/imc.js"></script><script>(async()=>await typeset(()=>[`#math-consts`]))()</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/en/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/en/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Search" rel="noopener" aria-label="Search"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>
</a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="/ctf/other/dicectf/yaonet/" title="es"><img alt="es" height="30px" src="/images/es.png" style="border:4px solid#000;border-radius:100%" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="#" title="en"><img alt="en" height="30px" src="/images/en.png" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- DICECTF</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/ctf/other/dicectf/yaonet/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/ctf/other/dicectf/yaonet/&amp;text=yaonet" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/en/ctf/other/dicectf/yaonet/&amp;title=yaonet" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">yaonet</h1><p class="mb4 f6 dib tracked">10 minutes to read</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#openssh-format-for-ecdsa">OpenSSH format for ECDSA</a><ul><li><a href="#corrupt-key-information">Corrupt key information</a></li></ul></li><li><a href="#key-recovery">Key recovery</a><ul><li><a href="#baby-step-giant-step">Baby-step Giant-step</a></li><li><a href="#meet-in-the-middle-attack">Meet-in-the-middle attack</a></li></ul></li><li><a href="#implementation">Implementation</a></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>We are given two files <code>id_ecdsa</code>, <code>id_ecdsa.pub</code> and a remote instance to connect using SSH:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null yaonet@mc.ax -p 31000 -i id_ecdsa  
</code></pre></div><p>The private key <code>id_ecdsa</code> is corrupt:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">-----BEGIN OPENSSH PRIVATE KEY-----
??????????1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAA????????????????????????  
??????????c3RwMjU2AAAACG5pc3RwMjU2AAAAQQR72Bqp????????????????????????
??????????1hSxoXrVpRtsx1F2GIgXAqI/6MxuS7Bq86XF????????????????????????
??????????ZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAy????????????????????????
??????????lSEQfdEcgOhx7zvWFLGhetWlG2zHUXYYiBcC????????????????????????
??????????37PMrof3dNCpeuwsSUupbaUh3/+7+eDnRH+3????????????????????????
-----END OPENSSH PRIVATE KEY-----
</code></pre></div><p>And the public key <code>id_ecdsa.pub</code> is correct:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHvYGqk903tU4dOcBPTbZ9xl5rlSEQfdEcgOhx7zvWFLGhetWlG2zHUXYYiBcCoj/ozG5LsGrzpcXE3HuEzPEQg= yaonet  
</code></pre></div><p>We will need to fix the private key in order to connect to the remote instance and get the flag.</p><h2 id="openssh-format-for-ecdsa">OpenSSH format for ECDSA</h2><p>We must start figuring out what information we can rescue from the corrupt private key. For this, let&rsquo;s create a new key:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ssh-keygen</span> -t ecdsa
Generating public/private ecdsa key pair.
Enter file in which to save the key (~/.ssh/id_ecdsa): ./id_ecdsa_test
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in ./id_ecdsa_test
Your public key has been saved in ./id_ecdsa_test.pub
The key fingerprint is:
SHA256:JocGd4h16h6YwlGK1VdYgx2tBnhEdSYe5kKG+k924YQ rocky@MBP-Rocky.local
The key's randomart image is:
+---[ECDSA 256]---+
|  ...=*B@oo      |
| o o+=*B.*.      |
|. o.oo=o+.       |
| ... *E+=        |
|  o.o *+S.       |
|   ..oo=o        |
|     +..         |
|      .          |
|                 |
+----[SHA256]-----+

<span class="code-cyan">$</span> <span class="code-dark-green">cat</span> <span class="mtku">id_ecdsa_test</span>
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAaAAAABNlY2RzYS
1zaGEyLW5pc3RwMjU2AAAACG5pc3RwMjU2AAAAQQRFzFiscnRWlvedDbDCgZulaX4kbFCQ
hu2MoblHDeppAZPsgCq28Ha5lMDE6Iqt8kossHrFowT4Os1gfzMaF6xsAAAAsJGHg1SRh4
NUAAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEXMWKxydFaW950N
sMKBm6VpfiRsUJCG7YyhuUcN6mkBk+yAKrbwdrmUwMToiq3ySiywesWjBPg6zWB/MxoXrG
wAAAAhAP4mWGJoSAnkDQDtwLahS17+hw7j5D6fJZj6ZgXFH92TAAAAFXJvY2t5QE1CUC1S
b2NreS5sb2NhbAEC
-----END OPENSSH PRIVATE KEY-----

<span class="code-cyan">$</span> <span class="code-dark-green">cat</span> <span class="mtku">id_ecdsa_test.pub</span>
ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEXMWKxydFaW950NsMKBm6VpfiRsUJCG7YyhuUcN6mkBk+yAKrbwdrmUwMToiq3ySiywesWjBPg6zWB/MxoXrGw= rocky@MBP-Rocky.local  
</code></pre></div><p>Now, we can import it to Python and find the key parameters:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> -q
&gt;&gt;&gt; from Crypto.PublicKey import ECC
&gt;&gt;&gt;
&gt;&gt;&gt; private_key = ECC.import_key(open('id_ecdsa_test').read())
&gt;&gt;&gt; public_key = ECC.import_key(open('id_ecdsa_test.pub').read())
&gt;&gt;&gt;
&gt;&gt;&gt; private_key
EccKey(curve='NIST P-256', point_x=31570635356302975547204064636676814907262944410487335975000995944154943613185, point_y=66907849224143765145869109791263747842720656896951286262556819933609256791148, d=114955213735346645511226667280015474436164920344675662509995323724030871068051)  
&gt;&gt;&gt; public_key
EccKey(curve='NIST P-256', point_x=31570635356302975547204064636676814907262944410487335975000995944154943613185, point_y=66907849224143765145869109791263747842720656896951286262556819933609256791148)
</code></pre></div><p>Basically, it is an ECC key, where the private key is $d$ and the public key is $Q$, where $Q = d \cdot G$ and $G$ is a generator point of the <a target="_blank" href="https://neuromancer.sk/std/secg/secp256r1">NIST P-256 curve</a>. We can print the relevant values in hexadecimal format:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; private_key.curve
'NIST P-256'
&gt;&gt;&gt; hex(private_key.d)
'0xfe265862684809e40d00edc0b6a14b5efe870ee3e43e9f2598fa6605c51fdd93'  
&gt;&gt;&gt; hex(private_key.pointQ.x)
'0x45cc58ac72745696f79d0db0c2819ba5697e246c509086ed8ca1b9470dea6901'
&gt;&gt;&gt; hex(private_key.pointQ.y)
'0x93ec802ab6f076b994c0c4e88aadf24a2cb07ac5a304f83acd607f331a17ac6c'
</code></pre></div><p>With this, we can Base64-decode the private key and print it out in hexadecimal format to find the position of the above values:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">cat</span> <span class="mtku">id_ecdsa_test</span> | <span class="code-dark-green">grep</span> -v <span class="code-dark-yellow">'PRIVATE KEY'</span> | <span class="code-dark-green">base64</span> -d | <span class="code-dark-green">xxd</span>
00000000: 6f70 656e 7373 682d 6b65 792d 7631 0000  openssh-key-v1..
00000010: 0000 046e 6f6e 6500 0000 046e 6f6e 6500  ...none....none.
00000020: 0000 0000 0000 0100 0000 6800 0000 1365  ..........h....e
00000030: 6364 7361 2d73 6861 322d 6e69 7374 7032  cdsa-sha2-nistp2
00000040: 3536 0000 0008 6e69 7374 7032 3536 0000  56....nistp256..
00000050: 0041 0445 cc58 ac72 7456 96f7 9d0d b0c2  .A.E.X.rtV......
00000060: 819b a569 7e24 6c50 9086 ed8c a1b9 470d  ...i~$lP......G.
00000070: ea69 0193 ec80 2ab6 f076 b994 c0c4 e88a  .i....*..v......
00000080: adf2 4a2c b07a c5a3 04f8 3acd 607f 331a  ..J,.z....:.`.3.
00000090: 17ac 6c00 0000 b091 8783 5491 8783 5400  ..l.......T...T.
000000a0: 0000 1365 6364 7361 2d73 6861 322d 6e69  ...ecdsa-sha2-ni
000000b0: 7374 7032 3536 0000 0008 6e69 7374 7032  stp256....nistp2
000000c0: 3536 0000 0041 0445 cc58 ac72 7456 96f7  56...A.E.X.rtV..
000000d0: 9d0d b0c2 819b a569 7e24 6c50 9086 ed8c  .......i~$lP....
000000e0: a1b9 470d ea69 0193 ec80 2ab6 f076 b994  ..G..i....*..v..
000000f0: c0c4 e88a adf2 4a2c b07a c5a3 04f8 3acd  ......J,.z....:.
00000100: 607f 331a 17ac 6c00 0000 2100 fe26 5862  `.3...l...!..&Xb
00000110: 6848 09e4 0d00 edc0 b6a1 4b5e fe87 0ee3  hH........K^....
00000120: e43e 9f25 98fa 6605 c51f dd93 0000 0015  .&gt;.%..f.........
00000130: 726f 636b 7940 4d42 502d 526f 636b 792e  rocky@MBP-Rocky.
00000140: 6c6f 6361 6c01 02                        local..

<span class="code-cyan">$</span> <span class="code-dark-green">cat</span> <span class="mtku">id_ecdsa_test</span> | <span class="code-dark-green">grep</span> -v <span class="code-dark-yellow">'PRIVATE KEY'</span> | <span class="code-dark-green">base64</span> -d | <span class="code-dark-green">xxd</span> | <span class="code-dark-green">grep</span> -E <span class="code-dark-yellow">'^|fe ?26|45 ?cc|93 ?ec'</span>  
00000000: 6f70 656e 7373 682d 6b65 792d 7631 0000  openssh-key-v1..
00000010: 0000 046e 6f6e 6500 0000 046e 6f6e 6500  ...none....none.
00000020: 0000 0000 0000 0100 0000 6800 0000 1365  ..........h....e
00000030: 6364 7361 2d73 6861 322d 6e69 7374 7032  cdsa-sha2-nistp2
00000040: 3536 0000 0008 6e69 7374 7032 3536 0000  56....nistp256..
00000050: 0041 04<span class="code-red">45 cc</span>58 ac72 7456 96f7 9d0d b0c2  .A.E.X.rtV......
00000060: 819b a569 7e24 6c50 9086 ed8c a1b9 470d  ...i~$lP......G.
00000070: ea69 01<span class="code-red">93 ec</span>80 2ab6 f076 b994 c0c4 e88a  .i....*..v......
00000080: adf2 4a2c b07a c5a3 04f8 3acd 607f 331a  ..J,.z....:.`.3.
00000090: 17ac 6c00 0000 b091 8783 5491 8783 5400  ..l.......T...T.
000000a0: 0000 1365 6364 7361 2d73 6861 322d 6e69  ...ecdsa-sha2-ni
000000b0: 7374 7032 3536 0000 0008 6e69 7374 7032  stp256....nistp2
000000c0: 3536 0000 0041 04<span class="code-red">45 cc</span>58 ac72 7456 96f7  56...A.E.X.rtV..
000000d0: 9d0d b0c2 819b a569 7e24 6c50 9086 ed8c  .......i~$lP....
000000e0: a1b9 470d ea69 01<span class="code-red">93 ec</span>80 2ab6 f076 b994  ..G..i....*..v..
000000f0: c0c4 e88a adf2 4a2c b07a c5a3 04f8 3acd  ......J,.z....:.
00000100: 607f 331a 17ac 6c00 0000 2100 <span class="code-red">fe26</span> 5862  `.3...l...!..&Xb
00000110: 6848 09e4 0d00 edc0 b6a1 4b5e fe87 0ee3  hH........K^....
00000120: e43e 9f25 98fa 6605 c51f dd93 0000 0015  .&gt;.%..f.........
00000130: 726f 636b 7940 4d42 502d 526f 636b 792e  rocky@MBP-Rocky.
00000140: 6c6f 6361 6c01 02                        local..
</code></pre></div><p>Alright, so the coordinates of $Q$ appear twice and the $d$ secret value appears at the end. The <code>id_ecdsa_test.pub</code> shows the coordinates of $Q$:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">awk</span> <span class="code-dark-yellow">'{ print $2 }'</span> <span class="mtku">id_ecdsa_test.pub</span> | <span class="code-dark-green">base64</span> -d | <span class="code-dark-green">xxd</span> | <span class="code-dark-green">grep</span> -E <span class="code-dark-yellow">'^|fe ?26|45 ?cc|93 ?ec'</span>  
00000000: 0000 0013 6563 6473 612d 7368 6132 2d6e  ....ecdsa-sha2-n
00000010: 6973 7470 3235 3600 0000 086e 6973 7470  istp256....nistp
00000020: 3235 3600 0000 4104 <span class="code-red">45cc</span> 58ac 7274 5696  256...A.E.X.rtV.
00000030: f79d 0db0 c281 9ba5 697e 246c 5090 86ed  ........i~$lP...
00000040: 8ca1 b947 0dea 6901 <span class="code-red">93ec</span> 802a b6f0 76b9  ...G..i....*..v.
00000050: 94c0 c4e8 8aad f24a 2cb0 7ac5 a304 f83a  .......J,.z....:
00000060: cd60 7f33 1a17 ac6c                      .`.3...l
</code></pre></div><h3 id="corrupt-key-information">Corrupt key information</h3><p>With this knowledge, we can take some information from the challenge files:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">cat</span> <span class="mtku">id_ecdsa</span> | <span class="code-dark-green">tr</span> <span class="code-dark-yellow">'?'</span> A | <span class="code-dark-green">grep</span> -v <span class="code-dark-yellow">'PRIVATE KEY'</span> | <span class="code-dark-green">base64</span> -d | <span class="code-dark-green">xxd</span> -R never  
00000000: 0000 0000 0000 000d 6b65 792d 7631 0000  ........key-v1..
00000010: 0000 046e 6f6e 6500 0000 046e 6f6e 6500  ...none....none.
00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000030: 0000 0000 0000 0000 0000 0000 7374 7032  ............stp2
00000040: 3536 0000 0008 6e69 7374 7032 3536 0000  56....nistp256..
00000050: 0041 047b d81a a900 0000 0000 0000 0000  .A.{............
00000060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000070: 0d61 4b1a 17ad 5a51 b6cc 7517 6188 8170  .aK...ZQ..u.a..p
00000080: 2a23 fe8c c6e4 bb06 af3a 5c50 0000 0000  *#.......:\P....
00000090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000000a0: 0000 0000 0064 7361 2d73 6861 322d 6e69  .....dsa-sha2-ni
000000b0: 7374 7032 3536 0000 0008 6e69 7374 7032  stp256....nistp2
000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000000d0: 0000 0000 0000 0000 0009 5211 07dd 11c8  ..........R.....
000000e0: 0e87 1ef3 bd61 4b1a 17ad 5a51 b6cc 7517  .....aK...ZQ..u.
000000f0: 6188 8170 2000 0000 0000 0000 0000 0000  a..p ...........
00000100: 0000 0000 0000 0000 0000 0000 0000 dfb3  ................
00000110: ccae 87f7 74d0 a97a ec2c 494b a96d a521  ....t..z.,IK.m.!
00000120: dfff bbf9 e0e7 447f b700 0000 0000 0000  ......D.........
00000130: 0000 0000 0000 0000 0000 00              ...........

<span class="code-cyan">$</span> <span class="code-dark-green">cat</span> <span class="mtku">id_ecdsa.pub</span> | <span class="code-dark-green">awk</span> <span class="code-dark-yellow">'{ print $2 }'</span> | <span class="code-dark-green">base64</span> -d | <span class="code-dark-green">xxd</span> -R never
00000000: 0000 0013 6563 6473 612d 7368 6132 2d6e  ....ecdsa-sha2-n
00000010: 6973 7470 3235 3600 0000 086e 6973 7470  istp256....nistp
00000020: 3235 3600 0000 4104 7bd8 1aa9 3dd3 7b54  256...A.{...=.{T
00000030: e1d3 9c04 f4db 67dc 65e6 b952 1107 dd11  ......g.e..R....
00000040: c80e 871e f3bd 614b 1a17 ad5a 51b6 cc75  ......aK...ZQ..u
00000050: 1761 8881 702a 23fe 8cc6 e4bb 06af 3a5c  .a..p*#.......:\
00000060: 5c4d c7b8 4ccf 1108                      \M..L...
</code></pre></div><p>Looking at those, we can find the exact coordinates of $Q$ from the public key and some bytes of the secret value $d$ from the private key. Particularly, we know</p><p class="scroll">$$
d = \mathtt{0x??????dfb3ccae87f774d0a97aec2c494ba96da521dfffbbf9e0e7447fb7????}
$$</p><p>We are missing 5 bytes (3 at the left and 2 at the right). We can define $d_k$ as the known part of $d$:</p><p class="scroll">$$
d_k = \mathtt{0xdfb3ccae87f774d0a97aec2c494ba96da521dfffbbf9e0e7447fb7}
$$</p><p>And define $d_l$ and $d_r$ to be the unknown left and right parts of $d$, such that</p><p class="scroll">$$
d = 256^{29} \cdot d_l + 256^2 \cdot d_k + d_r
$$</p><h2 id="key-recovery">Key recovery</h2><p>We need to find the value of $d_l$ and $d_r$ to find the secret value $d$ and create the private key <code>id_ecdsa</code>. However, 5 bytes (40 bits) is a lot to use a naïve brute force approach, we need to come up with a better algorithm.</p><h3 id="baby-step-giant-step">Baby-step Giant-step</h3><p>The <a target="_blank" href="https://en.wikipedia.org/wiki/Baby-step_giant-step">Baby-step Giant-step</a> (BSGS) is an algorithm to compute discrete logarithms on finite groups whose complexity is $O(\sqrt{n})$, where $n$ is the order of the element. This would be perfect, because we improve the naïve brute force approach to a complexity of 20 bits, which is affordable.</p><p>This algorithm wants to find $d$ satisfying $Q = d \cdot G$ where both $G$ and $Q$ are known. The algorithm takes the $\mathrm{ord}(G) = n$ and computes $m = \lceil\sqrt{n}\rceil$. Then, it starts computing the following recurrence:</p><p class="scroll">$$
\begin{cases}
H_1 = m \cdot G \\
H_i = H_{i - 1} + m \cdot G = (i \cdot m) \cdot G, \quad 1 < i < m
\end{cases}
$$</p><p>All the $H_i$ coordinates are saved in a map $H_i \mapsto i$.</p><p>After that, we do a similar computation:</p><p class="scroll">$$
\begin{cases}
K_1 = Q \\
K_j = K_{j - 1} - G = Q - j \cdot G, \quad j > 1
\end{cases}
$$</p><p>While computing $K_j$ we need to look if the point is in the map $H_i \mapsto i$. In such case, then $d = i \cdot m + j$ and we are done.</p><h3 id="meet-in-the-middle-attack">Meet-in-the-middle attack</h3><p>The previous algorithm is kind of a <a target="_blank" href="https://en.wikipedia.org/wiki/Meet-in-the-middle_attack">Meet-in-the-middle attack</a>, because it starts from both $G$ and $Q$ sides until finding a common place &ldquo;in the middle&rdquo;.</p><p>With the challenge setup, we can&rsquo;t simply use BSGS because the unknown bytes are not contiguous, but we can apply the same concepts. Notice that:</p><p class="scroll">$$
\begin{align}
Q & = d \cdot G \\
  & = (256^{29} \cdot d_l + 256^2 \cdot d_k + d_r) \cdot G \\
& = (256^{29} \cdot d_l) \cdot G + (256^2 \cdot d_k) \cdot G + d_r \cdot G
\end{align}
$$</p><p>For instance, we can start computing the following recurrence:</p><p class="scroll">$$
\begin{cases}
H_1 = (256^2 \cdot d_k) \cdot G + G \\
H_i = H_{i - 1} + G = (256^2 \cdot d_k + i) \cdot G, \quad 1 < i < 256^2
\end{cases}
$$</p><p>We will save the values in a map $H_i \mapsto i$, and compute the next recurrence starting from $Q$ (let&rsquo;s define $P := 256^{29} \cdot G$):</p><p class="scroll">$$
\begin{cases}
K_1 = Q \\
K_j = K_{j - 1} - P = Q - j \cdot P, \quad 1 < j < 256^3
\end{cases}
$$</p><p>While computing $K_j$ we will look if the point is in the map $H_i \mapsto i$, and then $d = 256^{29} \cdot j + 256^2 \cdot d_k + i$ and we are done.</p><h2 id="implementation">Implementation</h2><p>The above algorithm can be implemented as follows:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">#!/usr/bin/env python3</span>

<span class="mtk5">from</span><span class="mtk1"> sage.all </span><span class="mtk5">import</span><span class="mtk1"> EllipticCurve, </span><span class="mtk6">GF</span>
<span class="mtk5">from</span><span class="mtk1"> </span><span class="mtk8 mtku">Crypto</span><span class="mtk1">.</span><span class="mtk8 mtku">PublicKey</span><span class="mtk1"> </span><span class="mtk5">import</span><span class="mtk1"> </span><span class="mtk8 mtku">ECC</span>

<span class="mtk1">p</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">ffffffff00000001000000000000000000000000ffffffffff</span><span class="mtk6">ffffffffffffff</span>
<span class="mtk1">a</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">ffffffff00000001000000000000000000000000ffffffffff</span><span class="mtk6">fffffffffffffc</span>
<span class="mtk1">b</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63b</span><span class="mtk6">ce3c3e27d2604b</span>

<span class="mtk1">E</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> EllipticCurve(GF(</span><span class="mtk1">p</span><span class="mtk1">), [</span><span class="mtk1">a</span><span class="mtk1">, </span><span class="mtk1">b</span><span class="mtk1">])</span>
<span class="mtk1">G</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">E</span><span class="mtk1">(</span><span class="mtk7 mtki">0x</span><span class="mtk6">6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4</span><span class="mtk6">a13945d898c296</span><span class="mtk1">, </span><span class="mtk7 mtki">0x</span><span class="mtk6">4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececb</span><span class="mtk6">b6406837bf51f5</span><span class="mtk1">)</span>  

<span class="mtk1">dk</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">0x</span><span class="mtk6">dfb3ccae87f774d0a97aec2c494ba96da521dfffbbf9e0e744</span><span class="mtk6">7fb7</span>
<span class="mtk1">Q</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">E</span><span class="mtk1">(</span><span class="mtk7 mtki">0x</span><span class="mtk6">7bd81aa93dd37b54e1d39c04f4db67dc65e6b9521107dd11c8</span><span class="mtk6">0e871ef3bd614b</span><span class="mtk1">, </span><span class="mtk7 mtki">0x</span><span class="mtk6">1a17ad5a51b6cc7517618881702a23fe8cc6e4bb06af3a5c5c</span><span class="mtk6">4dc7b84ccf1108</span><span class="mtk1">)</span>

<span class="mtk1">table_points</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> {}</span>
<span class="mtk1">H</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk6">256</span><span class="mtk1"> </span><span class="mtk5">**</span><span class="mtk1"> </span><span class="mtk6">2</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">dk</span><span class="mtk1">) </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">G</span>

<span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1"> </span><span class="mtk5">**</span><span class="mtk1"> </span><span class="mtk6">16</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk1">table_points</span><span class="mtk1">[</span><span class="mtk1">H</span><span class="mtk1">.xy()] </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">i</span>
<span class="mtk1">    </span><span class="mtk1">H</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> </span><span class="mtk1">G</span>

<span class="mtk1">P</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk6">256</span><span class="mtk1"> </span><span class="mtk5">**</span><span class="mtk1"> </span><span class="mtk6">29</span><span class="mtk1">) </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">G</span>
<span class="mtk1">K</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">Q</span>

<span class="mtk5">for</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">in</span><span class="mtk1"> </span><span class="mtk8 mtku">range</span><span class="mtk1">(</span><span class="mtk6">2</span><span class="mtk1"> </span><span class="mtk5">**</span><span class="mtk1"> </span><span class="mtk6">24</span><span class="mtk1">):</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk1">i</span><span class="mtk1"> </span><span class="mtk5">:=</span><span class="mtk1"> </span><span class="mtk1">table_points</span><span class="mtk1">.</span><span class="mtk8">get</span><span class="mtk1">(</span><span class="mtk1">K</span><span class="mtk1">.xy())):</span>
<span class="mtk1">        </span><span class="mtk1">d</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk6">256</span><span class="mtk1"> </span><span class="mtk5">**</span><span class="mtk1"> </span><span class="mtk6">29</span><span class="mtk1">) </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">j</span><span class="mtk1"> </span><span class="mtk5">+</span><span class="mtk1"> (</span><span class="mtk6">256</span><span class="mtk1"> </span><span class="mtk5">**</span><span class="mtk1"> </span><span class="mtk6">2</span><span class="mtk1">) </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">dk</span><span class="mtk1"> </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk1">i</span>
<span class="mtk1">        </span><span class="mtk5">assert</span><span class="mtk1"> </span><span class="mtk1">Q</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk1">d</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> </span><span class="mtk1">G</span>
<span class="mtk1">        </span><span class="mtk5">with</span><span class="mtk1"> </span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk4">'id_ecdsa'</span><span class="mtk1">, </span><span class="mtk4">'w'</span><span class="mtk1">) </span><span class="mtk5">as</span><span class="mtk1"> </span><span class="mtk1">f</span><span class="mtk1">:</span>
<span class="mtk1">            </span><span class="mtk1">f</span><span class="mtk1">.</span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk8 mtku">ECC</span><span class="mtk1">.</span><span class="mtk8 mtku">EccKey</span><span class="mtk1">(</span><span class="mtk9 mtki">curve</span><span class="mtk5">=</span><span class="mtk4">'NIST P-256'</span><span class="mtk1">, </span><span class="mtk9 mtki">d</span><span class="mtk5">=</span><span class="mtk1">d</span><span class="mtk1">).</span><span class="mtk8">export_key</span><span class="mtk1">(</span><span class="mtk9 mtki">format</span><span class="mtk5">=</span><span class="mtk4">'PEM'</span><span class="mtk1">))</span>
<span class="mtk1">        </span><span class="mtk5">break</span>
<span class="mtk1">    </span><span class="mtk1">K</span><span class="mtk1"> </span><span class="mtk5">-=</span><span class="mtk1"> </span><span class="mtk1">P</span>
</code></pre></div><p>Once we find $d$, we just create the ECC key and export it to PEM format.</p><h2 id="flag">Flag</h2><p>With the recovered private key, we just need to connect to the remote instance and capture the flag:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">chmod</span> 600 <span class="mtku">id_ecdsa</span>

<span class="code-cyan">$</span> <span class="code-dark-green">ssh</span> -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null yaonet@mc.ax -p 31000 -i <span class="mtku">id_ecdsa</span>  
Warning: Permanently added '[mc.ax]:31000' (RSA) to the list of known hosts.
dice{now_can_you_sing_it?}
Connection to mc.ax closed by remote host.
Connection to mc.ax closed.
</code></pre></div><p>The full script can be found in here: <a target="_blank" href="https://github.com/7Rocky/CTF-scripts/tree/main/DiceCTF/yaonet/solve.py"><code>solve.py</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#openssh-format-for-ecdsa">OpenSSH format for ECDSA</a><ul><li><a href="#corrupt-key-information">Corrupt key information</a></li></ul></li><li><a href="#key-recovery">Key recovery</a><ul><li><a href="#baby-step-giant-step">Baby-step Giant-step</a></li><li><a href="#meet-in-the-middle-attack">Meet-in-the-middle attack</a></li></ul></li><li><a href="#implementation">Implementation</a></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Receive a weekly blog digest"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Subscribe"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">View letter archive</a></p><p class="tc">powered by <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; 7Rocky's Blog. Cybersecurity and Maths 2024</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>