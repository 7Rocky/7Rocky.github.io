<!doctype html><html lang="en"><head><title>Hunting License | 7Rocky</title>
<meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="description" content="Questionnaire. Decompilation. Static and dynamic analysis"><meta name="image" content="https://7rocky.github.io/images/reversing.png"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta itemprop="description" content="Questionnaire. Decompilation. Static and dynamic analysis"><meta itemprop="keywords" content><meta itemprop="name" content="Hunting License"><meta property="article:published_time" content><meta property="og:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:description" content="Questionnaire. Decompilation. Static and dynamic analysis"><meta property="og:image" content="https://7rocky.github.io/images/reversing.png"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="7Rocky's Blog. Cybersecurity and Maths"><meta property="og:title" content="Hunting License"><meta property="og:type" content="website"><meta property="og:url" content="https://7rocky.github.io/en/ctf/htb-challenges/reversing/hunting-license/"><meta name="twitter:author" content="7Rocky's Blog. Cybersecurity and Maths"><meta name="twitter:card" content="Questionnaire. Decompilation. Static and dynamic analysis"><meta name="twitter:description" content="Questionnaire. Decompilation. Static and dynamic analysis"><meta name="twitter:image" content="https://7rocky.github.io/images/reversing.png"><meta name="twitter:title" content="Hunting License"><link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><link href="https://7rocky.github.io/en/ctf/htb-challenges/reversing/hunting-license/" rel="canonical"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/en/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/en/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Search" rel="noopener" aria-label="Search"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="/ctf/htb-challenges/reversing/hunting-license/" title="es"><img alt="es" height="30px" src="/images/es.png" style="border:4px solid#000;border-radius:100%" width="30px">
</a><a class="link-transition lang link dib z-999 pt3 pt0-l" href="#" title="en"><img alt="en" height="30px" src="/images/en.png" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/en/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-80-l"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- REVERSING</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/en/ctf/htb-challenges/reversing/hunting-license/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/en/ctf/htb-challenges/reversing/hunting-license/&amp;text=Hunting%20License" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://7rocky.github.io/en/ctf/htb-challenges/reversing/hunting-license/&amp;title=Hunting%20License" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Hunting License</h1><p class="mb4 f6 dib tracked">11 minutes to read</p></header><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#decompilation">Decompilation</a></li><li><a href="#static-analysis">Static analysis</a></li><li><a href="#dynamic-analysis">Dynamic analysis</a><ul><li><a href="#alternative">Alternative</a></li></ul></li><li><a href="#questionnaire">Questionnaire</a></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><p>We have a binary called <code>license</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">file</span> <span class="mtku">license</span>
license: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=5be88c3ed329c1570ab807b55c1875d429a581a7, for GNU/Linux 3.2.0, not stripped  

<span class="code-cyan">$</span> <span class="code-dark-green">ldd</span> <span class="mtku">license</span>
	linux-vdso.so.1 (0x00007ffe18bb1000)
	libreadline.so.8 => /lib/x86_64-linux-gnu/libreadline.so.8 (0x00007f430a30a000)
	libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f430a118000)
	libtinfo.so.6 => /lib/x86_64-linux-gnu/libtinfo.so.6 (0x00007f430a0e8000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f430a366000)
</code></pre></div><h2 id="decompilation">Decompilation</h2><p>If we open it in Ghidra, we will see this <code>main</code> function:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">int</span><span class="mtk1"> </span><span class="mtk8">main</span><span class="mtk1">() {</span>
<span class="mtk1">  </span><span class="mtk7 mtki">char</span><span class="mtk1"> cVar1;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> iVar2;</span>

<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"So, you want to be a relic hunter?"</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"First, you</span><span class="mtk6">\'</span><span class="mtk4">re going to need your license, and for that you ne</span><span class="mtk4">ed to pass the exam."</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"It</span><span class="mtk6">\'</span><span class="mtk4">s short, but it</span><span class="mtk6">\'</span><span class="mtk4">s not for the faint of heart. Are you up to the ch</span><span class="mtk4">allenge?! (y/n)"</span><span class="mtk1">);</span>  

<span class="mtk1">  iVar2 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">getchar</span><span class="mtk1">();</span>
<span class="mtk1">  cVar1 </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk7 mtki">char</span><span class="mtk1">) iVar2;</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (((cVar1 </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk4">'y'</span><span class="mtk1">) </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> (cVar1 </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk4">'Y'</span><span class="mtk1">)) </span><span class="mtk5">&amp;&amp;</span><span class="mtk1"> (cVar1 </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk4">'</span><span class="mtk6">\n</span><span class="mtk4">'</span><span class="mtk1">)) {</span>
<span class="mtk1">    </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Not many are..."</span><span class="mtk1">);</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">    </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk8">exam</span><span class="mtk1">();</span>
<span class="mtk1">  </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Well done hunter - consider yourself certified!"</span><span class="mtk1">);</span>

<span class="mtk1">  </span><span class="mtk5">return</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">}</span>
</code></pre></div><p>As can be seen, we need to enter <code>y</code> and then the program calls <code>exam</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk8">exam</span><span class="mtk1">() {</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> iVar1;</span>
<span class="mtk1">  undefined8 local_38;</span>
<span class="mtk1">  undefined8 local_30;</span>
<span class="mtk1">  undefined local_28;</span>
<span class="mtk1">  undefined8 local_1c;</span>
<span class="mtk1">  undefined4 local_14;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">local_10;</span>

<span class="mtk1">  local_10 </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) </span><span class="mtk8">readline</span><span class="mtk1">(</span><span class="mtk4">"Okay, first, a warmup - what</span><span class="mtk6">\'</span><span class="mtk4">s the first password? This one</span><span class="mtk6">\'</span><span class="mtk4">s not ev en hidden: "</span><span class="mtk1">);</span>  
<span class="mtk1">  iVar1 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">strcmp</span><span class="mtk1">(local_10, </span><span class="mtk4">"PasswordNumeroUno"</span><span class="mtk1">);</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (iVar1 </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Not even close!"</span><span class="mtk1">);</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">    </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk8">free</span><span class="mtk1">(local_10);</span>
<span class="mtk1">  local_1c </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  local_14 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  </span><span class="mtk8">reverse</span><span class="mtk1">(</span><span class="mtk5">&amp;</span><span class="mtk1">local_1c, t, </span><span class="mtk5">0x</span><span class="mtk6">b</span><span class="mtk1">);</span>

<span class="mtk1">  local_10 </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) </span><span class="mtk8">readline</span><span class="mtk1">(</span><span class="mtk4">"Getting harder - what</span><span class="mtk6">\'</span><span class="mtk4">s the second password? "</span><span class="mtk1">);</span>
<span class="mtk1">  iVar1 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">strcmp</span><span class="mtk1">(local_10, (</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) </span><span class="mtk5">&amp;</span><span class="mtk1">local_1c);</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (iVar1 </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"You</span><span class="mtk6">\'</span><span class="mtk4">ve got it all backwards..."</span><span class="mtk1">);</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">    </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk8">free</span><span class="mtk1">(local_10);</span>
<span class="mtk1">  local_38 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  local_30 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  local_28 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">  xo</span><span class="mtk8">r</span><span class="mtk1">(</span><span class="mtk5">&amp;</span><span class="mtk1">local_38, t2, </span><span class="mtk5">0x</span><span class="mtk6">11</span><span class="mtk1">, </span><span class="mtk5">0x</span><span class="mtk6">13</span><span class="mtk1">);</span>
<span class="mtk1">  local_10 </span><span class="mtk5">=</span><span class="mtk1"> (</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) </span><span class="mtk8">readline</span><span class="mtk1">(</span><span class="mtk4">"Your final test - give me the third, and most pro</span><span class="mtk4">tected, password: "</span><span class="mtk1">);</span>
<span class="mtk1">  iVar1 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">strcmp</span><span class="mtk1">(local_10, (</span><span class="mtk7 mtki">char</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">) </span><span class="mtk5">&amp;</span><span class="mtk1">local_38);</span>

<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (iVar1 </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk8">puts</span><span class="mtk1">(</span><span class="mtk4">"Failed at the final hurdle!"</span><span class="mtk1">);</span>
<span class="mtk3">                    /* WARNING: Subroutine does no</span><span class="mtk3">t return */</span>
<span class="mtk1">    </span><span class="mtk8">exit</span><span class="mtk1">(</span><span class="mtk5">-</span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">  }</span>

<span class="mtk1">  </span><span class="mtk8">free</span><span class="mtk1">(local_10);</span>
<span class="mtk1">}</span>
</code></pre></div><p>There are three passwords, all of them checked with <code>strcmp</code>. The first one appears in plaintext (<code>PasswordNumeroUno</code>), the rest are encoded or encrypted.</p><h2 id="static-analysis">Static analysis</h2><p>One way to solve the challenge is through static analysis. That is, we can take a look at the strings of the binary and see how the passwords are stored to decode/decrypt them. For instance, the second password is transformed by <code>reverse</code>. This function, as its name suggests, just reverses a string. If we search for the stored password, we will see this (global variable named <code>t</code>):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">                     t                                               XREF[3]:     Entry Point(*), exam:004012ed(*),
                                                                                  exam:004012ed(*)
00404060 30 77 54        undefined1
         64 72 30
         77 73 73
   00404060 30              undefined130h                     [0]                               XREF[3]:     Entry Point(*), exam:004012ed(*),  
                                                                                                             exam:004012ed(*)
   00404061 77              undefined177h                     [1]
   00404062 54              undefined154h                     [2]
   00404063 64              undefined164h                     [3]
   00404064 72              undefined172h                     [4]
   00404065 30              undefined130h                     [5]
   00404066 77              undefined177h                     [6]
   00404067 73              undefined173h                     [7]
   00404068 73              undefined173h                     [8]
   00404069 34              undefined134h                     [9]
   0040406a 50              undefined150h                     [10]
   0040406b 00              undefined100h                     [11]
</code></pre></div><p>This is just:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">python3</span> -q
&gt;&gt;&gt; bytes((0x30, 0x77, 0x54, 0x64, 0x72, 0x30, 0x70, 0x73, 0x73, 0x34, 0x50))  
b'0wTdr0pss4P'
</code></pre></div><p>And reversed:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; bytes((0x30, 0x77, 0x54, 0x64, 0x72, 0x30, 0x70, 0x73, 0x73, 0x34, 0x50))[::-1]  
b'P4ssp0rdTw0'
</code></pre></div><p>Then the third password is stored at <code>t2</code>, and the program calls <code>xor</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> xor(</span><span class="mtk7 mtki">long</span><span class="mtk1"> param_1, </span><span class="mtk7 mtki">long</span><span class="mtk1"> param_2, ulong param_3, byte param_4) {</span>
<span class="mtk1">  </span><span class="mtk7 mtki">int</span><span class="mtk1"> local_c;</span>
<span class="mtk1">  </span>
<span class="mtk1">  </span><span class="mtk5">for</span><span class="mtk1"> (local_c </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">; (ulong) (</span><span class="mtk7 mtki">long</span><span class="mtk1">) local_c </span><span class="mtk5">&lt;</span><span class="mtk1"> param_3; local_c</span><span class="mtk5">++</span><span class="mtk1">) {</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(byte </span><span class="mtk5">*</span><span class="mtk1"> )(param_1 </span><span class="mtk5">+</span><span class="mtk1"> local_c) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(byte </span><span class="mtk5">*</span><span class="mtk1">) (param_2 </span><span class="mtk5">+</span><span class="mtk1"> local_c) </span><span class="mtk5">^</span><span class="mtk1"> param_4;</span>  
<span class="mtk1">  }</span>
<span class="mtk1">}</span>
</code></pre></div><p>This function implements a XOR cipher, and the XOR key is at <code>param_4</code>. This argument is <code>0x13</code>, so this is the XOR key. And <code>t2</code> contains these bytes:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">                     t2                                              XREF[3]:     Entry Point(*), exam:00401361(*),
                                                                                  exam:00401361(*)
00404070 47 7b 7a        undefined1
         61 77 52
         7d 77 55
   00404070 47              undefined147h                     [0]                               XREF[3]:     Entry Point(*), exam:00401361(*),  
                                                                                                             exam:00401361(*)
   00404071 7b              undefined17Bh                     [1]
   00404072 7a              undefined17Ah                     [2]
   00404073 61              undefined161h                     [3]
   00404074 77              undefined177h                     [4]
   00404075 52              undefined152h                     [5]
   00404076 7d              undefined17Dh                     [6]
   00404077 77              undefined177h                     [7]
   00404078 55              undefined155h                     [8]
   00404079 7a              undefined17Ah                     [9]
   0040407a 7d              undefined17Dh                     [10]
   0040407b 72              undefined172h                     [11]
   0040407c 7f              undefined17Fh                     [12]
   0040407d 32              undefined132h                     [13]
   0040407e 32              undefined132h                     [14]
   0040407f 32              undefined132h                     [15]
   00404080 13              undefined113h                     [16]
</code></pre></div><p>So, let&rsquo;s decrypt the above bytes:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt;&gt;&gt; from pwn import xor
&gt;&gt;&gt; xor(b'\x13', bytes((0x47, 0x7b, 0x7a, 0x61, 0x77, 0x52, 0x7d, 0x77, 0x55, 0x7a, 0x7d, 0x72, 0x7f, 0x32, 0x32, 0x32, 0x13)))  
b'ThirdAndFinal!!!\x00'
</code></pre></div><p>And there we have all the passwords.</p><h2 id="dynamic-analysis">Dynamic analysis</h2><p>Another approach is use GDB to perform a dynamic analysis on the program. We are going to set breakpoints at <code>strcmp</code> in function <code>exam</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gdb</span> -q <span class="mtku">license</span>
Reading symbols from <span class="code-dark-green">license</span>...
(No debugging symbols found in <span class="code-dark-green">license</span>)
<span class="code-red">gef➤  </span>p main
$1 = {&lt;text variable, no debug info&gt;} <span class="code-dark-blue">0x401172</span> &lt;<span class="code-dark-yellow">main</span>&gt;
<span class="code-red">gef➤  </span>disassemble exam
Dump of assembler code for function exam:
   <span class="code-dark-blue">0x000000000040128a</span> &lt;+0&gt;:	push   rbp
   <span class="code-dark-blue">0x000000000040128b</span> &lt;+1&gt;:	mov    rbp,rsp
   <span class="code-dark-blue">0x000000000040128e</span> &lt;+4&gt;:	sub    rsp,0x30
   <span class="code-dark-blue">0x0000000000401292</span> &lt;+8&gt;:	mov    edi,0x402120
   <span class="code-dark-blue">0x0000000000401297</span> &lt;+13&gt;:	call   <span class="code-dark-blue">0x401050</span> &lt;<span class="code-dark-yellow">readline@plt</span>&gt;
   <span class="code-dark-blue">0x000000000040129c</span> &lt;+18&gt;:	mov    QWORD PTR [rbp-0x8],rax
   <span class="code-dark-blue">0x00000000004012a0</span> &lt;+22&gt;:	mov    rax,QWORD PTR [rbp-0x8]
   <span class="code-dark-blue">0x00000000004012a4</span> &lt;+26&gt;:	mov    esi,0x402170
   <span class="code-dark-blue">0x00000000004012a9</span> &lt;+31&gt;:	mov    rdi,rax
   <span class="code-dark-blue">0x00000000004012ac</span> &lt;+34&gt;:	call   <span class="code-dark-blue">0x401060</span> &lt;<span class="code-dark-yellow">strcmp@plt</span>&gt;
   <span class="code-dark-blue">0x00000000004012b1</span> &lt;+39&gt;:	test   eax,eax
   <span class="code-dark-blue">0x00000000004012b3</span> &lt;+41&gt;:	je     <span class="code-dark-blue">0x4012c9</span> &lt;<span class="code-dark-yellow">exam</span>+63&gt;
   <span class="code-dark-blue">0x00000000004012b5</span> &lt;+43&gt;:	mov    edi,0x402182
   <span class="code-dark-blue">0x00000000004012ba</span> &lt;+48&gt;:	call   <span class="code-dark-blue">0x401040</span> &lt;<span class="code-dark-yellow">puts@plt</span>&gt;
   <span class="code-dark-blue">0x00000000004012bf</span> &lt;+53&gt;:	mov    edi,0xffffffff
   <span class="code-dark-blue">0x00000000004012c4</span> &lt;+58&gt;:	call   <span class="code-dark-blue">0x401080</span> &lt;<span class="code-dark-yellow">exit@plt</span>&gt;
   <span class="code-dark-blue">0x00000000004012c9</span> &lt;+63&gt;:	mov    rax,QWORD PTR [rbp-0x8]
   <span class="code-dark-blue">0x00000000004012cd</span> &lt;+67&gt;:	mov    rdi,rax
   <span class="code-dark-blue">0x00000000004012d0</span> &lt;+70&gt;:	call   <span class="code-dark-blue">0x401030</span> &lt;<span class="code-dark-yellow">free@plt</span>&gt;
   <span class="code-dark-blue">0x00000000004012d5</span> &lt;+75&gt;:	mov    QWORD PTR [rbp-0x14],0x0
   <span class="code-dark-blue">0x00000000004012dd</span> &lt;+83&gt;:	mov    DWORD PTR [rbp-0xc],0x0
   <span class="code-dark-blue">0x00000000004012e4</span> &lt;+90&gt;:	lea    rax,[rbp-0x14]
   <span class="code-dark-blue">0x00000000004012e8</span> &lt;+94&gt;:	mov    edx,0xb
   <span class="code-dark-blue">0x00000000004012ed</span> &lt;+99&gt;:	mov    esi,0x404060
   <span class="code-dark-blue">0x00000000004012f2</span> &lt;+104&gt;:	mov    rdi,rax
   <span class="code-dark-blue">0x00000000004012f5</span> &lt;+107&gt;:	call   <span class="code-dark-blue">0x4011e1</span> &lt;<span class="code-dark-yellow">reverse</span>&gt;
   <span class="code-dark-blue">0x00000000004012fa</span> &lt;+112&gt;:	mov    edi,0x402198
   <span class="code-dark-blue">0x00000000004012ff</span> &lt;+117&gt;:	call   <span class="code-dark-blue">0x401050</span> &lt;<span class="code-dark-yellow">readline@plt</span>&gt;
   <span class="code-dark-blue">0x0000000000401304</span> &lt;+122&gt;:	mov    QWORD PTR [rbp-0x8],rax
   <span class="code-dark-blue">0x0000000000401308</span> &lt;+126&gt;:	lea    rdx,[rbp-0x14]
   <span class="code-dark-blue">0x000000000040130c</span> &lt;+130&gt;:	mov    rax,QWORD PTR [rbp-0x8]
   <span class="code-dark-blue">0x0000000000401310</span> &lt;+134&gt;:	mov    rsi,rdx
   <span class="code-dark-blue">0x0000000000401313</span> &lt;+137&gt;:	mov    rdi,rax
   <span class="code-dark-blue">0x0000000000401316</span> &lt;+140&gt;:	call   <span class="code-dark-blue">0x401060</span> &lt;<span class="code-dark-yellow">strcmp@plt</span>&gt;
   <span class="code-dark-blue">0x000000000040131b</span> &lt;+145&gt;:	test   eax,eax
   <span class="code-dark-blue">0x000000000040131d</span> &lt;+147&gt;:	je     <span class="code-dark-blue">0x401333</span> &lt;<span class="code-dark-yellow">exam</span>+169&gt;
   <span class="code-dark-blue">0x000000000040131f</span> &lt;+149&gt;:	mov    edi,0x4021c8
   <span class="code-dark-blue">0x0000000000401324</span> &lt;+154&gt;:	call   <span class="code-dark-blue">0x401040</span> &lt;<span class="code-dark-yellow">puts@plt</span>&gt;
   <span class="code-dark-blue">0x0000000000401329</span> &lt;+159&gt;:	mov    edi,0xffffffff
   <span class="code-dark-blue">0x000000000040132e</span> &lt;+164&gt;:	call   <span class="code-dark-blue">0x401080</span> &lt;<span class="code-dark-yellow">exit@plt</span>&gt;
   <span class="code-dark-blue">0x0000000000401333</span> &lt;+169&gt;:	mov    rax,QWORD PTR [rbp-0x8]
   <span class="code-dark-blue">0x0000000000401337</span> &lt;+173&gt;:	mov    rdi,rax
   <span class="code-dark-blue">0x000000000040133a</span> &lt;+176&gt;:	call   <span class="code-dark-blue">0x401030</span> &lt;<span class="code-dark-yellow">free@plt</span>&gt;
   <span class="code-dark-blue">0x000000000040133f</span> &lt;+181&gt;:	mov    QWORD PTR [rbp-0x30],0x0
   <span class="code-dark-blue">0x0000000000401347</span> &lt;+189&gt;:	mov    QWORD PTR [rbp-0x28],0x0
   <span class="code-dark-blue">0x000000000040134f</span> &lt;+197&gt;:	mov    BYTE PTR [rbp-0x20],0x0
   <span class="code-dark-blue">0x0000000000401353</span> &lt;+201&gt;:	lea    rax,[rbp-0x30]
   <span class="code-dark-blue">0x0000000000401357</span> &lt;+205&gt;:	mov    ecx,0x13
   <span class="code-dark-blue">0x000000000040135c</span> &lt;+210&gt;:	mov    edx,0x11
   <span class="code-dark-blue">0x0000000000401361</span> &lt;+215&gt;:	mov    esi,0x404070
   <span class="code-dark-blue">0x0000000000401366</span> &lt;+220&gt;:	mov    rdi,rax
   <span class="code-dark-blue">0x0000000000401369</span> &lt;+223&gt;:	call   <span class="code-dark-blue">0x401237</span> &lt;<span class="code-dark-yellow">xor</span>&gt;
   <span class="code-dark-blue">0x000000000040136e</span> &lt;+228&gt;:	mov    edi,0x4021e8
   <span class="code-dark-blue">0x0000000000401373</span> &lt;+233&gt;:	call   <span class="code-dark-blue">0x401050</span> &lt;<span class="code-dark-yellow">readline@plt</span>&gt;
   <span class="code-dark-blue">0x0000000000401378</span> &lt;+238&gt;:	mov    QWORD PTR [rbp-0x8],rax
   <span class="code-dark-blue">0x000000000040137c</span> &lt;+242&gt;:	lea    rdx,[rbp-0x30]
   <span class="code-dark-blue">0x0000000000401380</span> &lt;+246&gt;:	mov    rax,QWORD PTR [rbp-0x8]
   <span class="code-dark-blue">0x0000000000401384</span> &lt;+250&gt;:	mov    rsi,rdx
   <span class="code-dark-blue">0x0000000000401387</span> &lt;+253&gt;:	mov    rdi,rax
   <span class="code-dark-blue">0x000000000040138a</span> &lt;+256&gt;:	call   <span class="code-dark-blue">0x401060</span> &lt;<span class="code-dark-yellow">strcmp@plt</span>&gt;
   <span class="code-dark-blue">0x000000000040138f</span> &lt;+261&gt;:	test   eax,eax
   <span class="code-dark-blue">0x0000000000401391</span> &lt;+263&gt;:	je     <span class="code-dark-blue">0x4013a7</span> &lt;<span class="code-dark-yellow">exam</span>+285&gt;
   <span class="code-dark-blue">0x0000000000401393</span> &lt;+265&gt;:	mov    edi,0x40222c
   <span class="code-dark-blue">0x0000000000401398</span> &lt;+270&gt;:	call   <span class="code-dark-blue">0x401040</span> &lt;<span class="code-dark-yellow">puts@plt</span>&gt;
   <span class="code-dark-blue">0x000000000040139d</span> &lt;+275&gt;:	mov    edi,0xffffffff
   <span class="code-dark-blue">0x00000000004013a2</span> &lt;+280&gt;:	call   <span class="code-dark-blue">0x401080</span> &lt;<span class="code-dark-yellow">exit@plt</span>&gt;
   <span class="code-dark-blue">0x00000000004013a7</span> &lt;+285&gt;:	mov    rax,QWORD PTR [rbp-0x8]
   <span class="code-dark-blue">0x00000000004013ab</span> &lt;+289&gt;:	mov    rdi,rax
   <span class="code-dark-blue">0x00000000004013ae</span> &lt;+292&gt;:	call   <span class="code-dark-blue">0x401030</span> &lt;<span class="code-dark-yellow">free@plt</span>&gt;
   <span class="code-dark-blue">0x00000000004013b3</span> &lt;+297&gt;:	nop
   <span class="code-dark-blue">0x00000000004013b4</span> &lt;+298&gt;:	leave
   <span class="code-dark-blue">0x00000000004013b5</span> &lt;+299&gt;:	ret
End of assembler dump.
<span class="code-red">gef➤  </span>break *exam+34
Breakpoint 1 at <span class="code-dark-blue">0x4012ac</span>
<span class="code-red">gef➤  </span>break *exam+140
Breakpoint 2 at <span class="code-dark-blue">0x401316</span>
<span class="code-red">gef➤  </span>break *exam+256
Breakpoint 3 at <span class="code-dark-blue">0x40138a</span>
<span class="code-red">gef➤  </span>run
Starting program: ./license
So, you want to be a relic hunter?
First, you're going to need your license, and for that you need to pass the exam.
It's short, but it's not for the faint of heart. Are you up to the challenge?! (y/n)  
y
Okay, first, a warmup - what's the first password? This one's not even hidden: asdf

Breakpoint 1, <span class="code-dark-blue">0x00000000004012ac</span> in <span class="code-dark-yellow">exam</span> ()
</code></pre></div><p>Now we are at the first breakpoint, so we can check the arguments to <code>strcmp</code> (<code>$rdi</code> contains the pointer to the first string and <code>$rsi</code> contains the pointer to the second string):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>x/s $rdi
<span class="code-dark-blue">0x41e020</span>:	"asdf"
<span class="code-green">gef➤  </span>x/s $rsi
<span class="code-dark-blue">0x402170</span>:	"PasswordNumeroUno"  
</code></pre></div><p>As can be seen, the second string is the expected password. We take note, set <code>$rdi</code> to equal <code>$rsi</code> and continue to the next breakpoint:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>set $rdi = $rsi
<span class="code-green">gef➤  </span>continue
Continuing.
Getting harder - what's the second password? qwer  

Breakpoint 2, <span class="code-dark-blue">0x0000000000401316</span> in <span class="code-dark-yellow">exam</span> ()
</code></pre></div><p>Same here:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>x/s $rdi
<span class="code-dark-blue">0x41e020</span>:	"qwer"
<span class="code-green">gef➤  </span>x/s $rsi
<span class="code-dark-blue">0x7fffffffe7dc</span>:	"P4ssw0rdTw0"  
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>set $rdi = $rsi
<span class="code-green">gef➤  </span>continue
Continuing.
Your final test - give me the third, and most protected, password: zxcv  

Breakpoint 3, <span class="code-dark-blue">0x000000000040138a</span> in <span class="code-dark-yellow">exam</span> ()
</code></pre></div><p>And same here:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>x/s $rdi
<span class="code-dark-blue">0x41e020</span>:	"zxcv"
<span class="code-green">gef➤  </span>x/s $rsi
<span class="code-dark-blue">0x7fffffffe7c0</span>:	"ThirdAndFinal!!!"  
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">gef➤  </span>set $rdi = $rsi
<span class="code-green">gef➤  </span>continue
Continuing.
Well done hunter - consider yourself certified!  
[Inferior 1 (process 1457) exited normally]
<span class="code-red">gef➤
</code></pre></div><h3 id="alternative">Alternative</h3><p>The above approach can be done also with <code>ltrace</code>, which is a program that traces all external function calls (namely, <code>strcmp</code>, which comes from Glibc). Again, we can find the expected passwords by reading how <code>strcmp</code> is being called:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ltrace</span> <span class="mtku">./license</span>
puts("So, you want to be a relic hunte"...So, you want to be a relic hunter?
)                                             = 35
puts("First, you're going to need your"...First, you're going to need your license, and for that you need to pass the exam.
)                                             = 82
puts("It's short, but it's not for the"...It's short, but it's not for the faint of heart. Are you up to the challenge?! (y/n)
)                                             = 85
getchar(0x7f2367fb47e0, 0x1f8c2a0, 0, 0x7f2367ed4077y
)                                   = 121
readline("Okay, first, a warmup - what's t"...Okay, first, a warmup - what's the first password? This one's not even hidden: asdf
)                                         = "asdf"
strcmp("asdf", "PasswordNumeroUno")                                                     = 17
puts("Not even close!"Not even close!
)                                                                 = 16
exit(-1 &lt;no return ...&gt;
+++ exited (status 255) +++

<span class="code-cyan">$</span> <span class="code-dark-green">ltrace</span> <span class="mtku">./license</span>
puts("So, you want to be a relic hunte"...So, you want to be a relic hunter?
)                                             = 35
puts("First, you're going to need your"...First, you're going to need your license, and for that you need to pass the exam.
)                                             = 82
puts("It's short, but it's not for the"...It's short, but it's not for the faint of heart. Are you up to the challenge?! (y/n)
)                                             = 85
getchar(0x7f0dd0de27e0, 0x5342a0, 0, 0x7f0dd0d02077y
)                                    = 121
readline("Okay, first, a warmup - what's t"...Okay, first, a warmup - what's the first password? This one's not even hidden: PasswordNumeroUno  
)                                         = "PasswordNumeroUno"
strcmp("PasswordNumeroUno", "PasswordNumeroUno")                                        = 0
free(0x54d230)                                                                          = &lt;void&gt;
readline("Getting harder - what's the seco"...Getting harder - what's the second password? asdf
)                                         = "asdf"
strcmp("asdf", "P4ssw0rdTw0")                                                           = 17
puts("You've got it all backwards..."You've got it all backwards...
)                                                  = 31
exit(-1 &lt;no return ...&gt;
+++ exited (status 255) +++

<span class="code-cyan">$</span> <span class="code-dark-green">ltrace</span> <span class="mtku">./license</span>
puts("So, you want to be a relic hunte"...So, you want to be a relic hunter?
)                                             = 35
puts("First, you're going to need your"...First, you're going to need your license, and for that you need to pass the exam.
)                                             = 82
puts("It's short, but it's not for the"...It's short, but it's not for the faint of heart. Are you up to the challenge?! (y/n)
)                                             = 85
getchar(0x7fe58dc397e0, 0x10472a0, 0, 0x7fe58db59077y
)                                   = 121
readline("Okay, first, a warmup - what's t"...Okay, first, a warmup - what's the first password? This one's not even hidden: PasswordNumeroUno
)                                         = "PasswordNumeroUno"
strcmp("PasswordNumeroUno", "PasswordNumeroUno")                                        = 0
free(0x1060230)                                                                         = &lt;void&gt;
readline("Getting harder - what's the seco"...Getting harder - what's the second password? P4ssw0rdTw0
)                                         = "P4ssw0rdTw0"
strcmp("P4ssw0rdTw0", "P4ssw0rdTw0")                                                    = 0
free(0x1060230)                                                                         = &lt;void&gt;
readline("Your final test - give me the th"...Your final test - give me the third, and most protected, password: asdf
)                                         = "asdf"
strcmp("asdf", "ThirdAndFinal!!!")                                                      = 13
puts("Failed at the final hurdle!"Failed at the final hurdle!
)                                                     = 28
exit(-1 &lt;no return ...&gt;
+++ exited (status 255) +++
</code></pre></div><h2 id="questionnaire">Questionnaire</h2><p>Obviously, the program succeeds when we enter the expected passwords:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">./license</span>
So, you want to be a relic hunter?
First, you're going to need your license, and for that you need to pass the exam.
It's short, but it's not for the faint of heart. Are you up to the challenge?! (y/n)
y
Okay, first, a warmup - what's the first password? This one's not even hidden: PasswordNumeroUno  
Getting harder - what's the second password? P4ssw0rdTw0
Your final test - give me the third, and most protected, password: ThirdAndFinal!!!
Well done hunter - consider yourself certified!
</code></pre></div><p>Now, let&rsquo;s connect to the remote instance to answer some questions (all the needed information is above):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">nc</span> 167.71.129.184 31559
<span class="code-dark-magenta">What is the file format of the executable?</span>
&gt; ELF
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">What is the CPU architecture of the executable?</span>
&gt; x86_64
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">What library is used to read lines for user answers? (`ldd` may help)</span>
&gt; libreadline.so.8
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">What is the address of the `main` function?</span>
&gt; 0x401172
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">How many calls to `puts` are there in `main`? (using a decompiler may help)</span>  
&gt; 5
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">What is the first password?</span>
&gt; PasswordNumeroUno
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">What is the reversed form of the second password?</span>
&gt; 0wTdr0wss4P
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">What is the real second password?</span>
&gt; P4ssw0rdTw0
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">What is the XOR key used to encode the third password?</span>
&gt; 0x13
<span class="code-dark-green">[+] Correct!</span>

<span class="code-dark-magenta">What is the third password?</span>
&gt; ThirdAndFinal!!!
<span class="code-dark-green">[+] Correct!</span>
</code></pre></div><h2 id="flag">Flag</h2><p>Once all answers are correct, we will get the flag:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-dark-green">[+] Here is the flag: `HTB{l1c3ns3_4cquir3d-hunt1ng_t1m3!}`</span>  
</code></pre></div><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contents</p><nav id="TableOfContents"><ul><li><a href="#decompilation">Decompilation</a></li><li><a href="#static-analysis">Static analysis</a></li><li><a href="#dynamic-analysis">Dynamic analysis</a><ul><li><a href="#alternative">Alternative</a></li></ul></li><li><a href="#questionnaire">Questionnaire</a></li><li><a href="#flag">Flag</a></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter" target="popupwindow" onsubmit='return window.open("https://mailchi.mp/59ffae939360/7rockys-blog-weekly-newsletter"),!0'><h3 class="tc">7Rocky's Blog Weekly Newsletter</h3><p class="tc"><input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Receive a weekly blog digest"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Subscribe"><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">View letter archive</a></p><p class="tc">powered by <a href="http://www.mailchimp.com" target="_blank" title="Mailchimp">Mailchimp</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; 7Rocky's Blog. Cybersecurity and Maths 2024</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>