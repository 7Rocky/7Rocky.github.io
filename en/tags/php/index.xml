<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Php on 7Rocky's Blog. Cybersecurity and Maths</title><link>https://7rocky.github.io/en/tags/php/</link><description>Recent content in Php on 7Rocky's Blog. Cybersecurity and Maths</description><generator>Hugo</generator><language>en</language><lastBuildDate>Thu, 12 Sep 2024 09:25:25 +0200</lastBuildDate><atom:link href="https://7rocky.github.io/en/tags/php/index.xml" rel="self" type="application/rss+xml"/><item><title>Pilgrimage</title><link>https://7rocky.github.io/en/htb/pilgrimage/</link><pubDate>Sat, 25 Nov 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/pilgrimage/</guid><description>Hack The Box. Linux. Easy machine. This machine has a website that exposes a Git repository. We are able to extract the PHP source of the web application and find out that it uses ImageMagick under the hood to process uploaded images. The version of ImageMagick has a local file read vulnerability that can be used to read a SQLite database file and find a plaintext password for &lt;code>emily&lt;/code>, which is used in SSH too. After that, we find that &lt;code>root&lt;/code> executes a Bash script that uses &lt;code>binwalk&lt;/code> to remove malware from uploaded image files. The version of &lt;code>binwalk&lt;/code> is vulnerable to Remote Code Execution, which leads to the privilege escalation</description></item><item><title>Topology</title><link>https://7rocky.github.io/en/htb/topology/</link><pubDate>Sat, 04 Nov 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/topology/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a website that allows to generate equations using LaTeX. With this feature we can read arbitrary files from the server with LaTeX injection techniques and find a hashed password for another subdomain, which can be cracked. This password is reused in SSH. After that, &lt;code>root&lt;/code> is executing &lt;code>gnuplot&lt;/code> scripts periodically, which leads to the privilege escalation</description></item><item><title>Intentions</title><link>https://7rocky.github.io/en/htb/intentions/</link><pubDate>Sat, 14 Oct 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/intentions/</guid><description>Hack The Box. Linux. Hard machine. This machine has a website with an API that is vulnerable to second-order SQLi. Then, there is an authentication mechanism that just requires the password hash, so we can take a hash from the dumped database and log in as an administrator. Then, there is a vulnerability involving PHP and ImageMagick that leads to RCE. Once in the machine, we can pivot to user &lt;code>greg&lt;/code> by analyzing a Git repository and finding plaintext credentials. After that, we are allowed to run a custom binary that hashes a given length of a file and compares the result with a set of pre-computed MD5 hashes. This binary has a capability that allows to read files as &lt;code>root&lt;/code>, which can be used to extract all the contents of any file after automating the process, which allows to read an SSH private key for &lt;code>root&lt;/code></description></item><item><title>Soccer</title><link>https://7rocky.github.io/en/htb/soccer/</link><pubDate>Sat, 10 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/soccer/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a Tiny File Manager application that allows us to upload and execute PHP, so we can obtain a reverse shell as &lt;code>www-data&lt;/code>. In the machine, we can read the configuration for nginx and find another subdomain. This one exposes a WebSocket server that is vulnerable to Boolean-based Blind SQLi. By exploiting SQLi, we can find plaintext credentials that are reused in SSH. Finally, the user is allowed to run &lt;code>dstat&lt;/code> as &lt;code>root&lt;/code> using &lt;code>doas&lt;/code>, and we are able to create a plugin to escalate privileges</description></item><item><title>Interface</title><link>https://7rocky.github.io/en/htb/interface/</link><pubDate>Sat, 13 May 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/interface/</guid><description>Hack The Box. Linux. Medium machine. This machine has a dummy Next.js website that exposes a subdomain in the &lt;code>Content-Security-Policy&lt;/code> header. There, we can enumerate third-party dependencies like &lt;code>dompdf&lt;/code>. This one is vulnerable to Remote Code Execution. After a lot of enumeration to interact with &lt;code>dompdf&lt;/code>, we find a way to get a reverse shell on the system. Then, user &lt;code>root&lt;/code> executes a shell script each minute, and the script is vulnerable to command injection, which must be exploited by adding malicious metadata to a temporary file. By chaining these steps, we are able to get a reverse shell as &lt;code>root&lt;/code></description></item><item><title>BroScience</title><link>https://7rocky.github.io/en/htb/broscience/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/broscience/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website with a Local File Read vulnerability that can be used to read PHP source code and find a way to activate a new account. Then, we can perform a deserialization attack in PHP to get RCE. After that, we find a hashed password in the database that can be cracked and it is reused in the system. Finally, there&amp;rsquo;s a Cron task running by &lt;code>root&lt;/code> to renew OpenSSL certificates and the script has a command injection vulnerability, which leads to the privilege escalation</description></item><item><title>Photobomb</title><link>https://7rocky.github.io/en/htb/photobomb/</link><pubDate>Sat, 11 Feb 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/photobomb/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a web application built with Sinatra that is vulnerable to command injection, which leads to Remote Code Execution (RCE). The user has &lt;code>sudo&lt;/code> permissions to run a Bash script that is vulnerable to &lt;code>PATH&lt;/code> hijacking, which can be used to escalate privileges</description></item><item><title>UpDown</title><link>https://7rocky.github.io/en/htb/updown/</link><pubDate>Sat, 21 Jan 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/updown/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website that has a development directory and exposes a Git repository. Using this, we can find some functionality that is hidden except for developers and can be abused to get RCE after planning the attack and bypassing &lt;code>disable_functions&lt;/code> in PHP. In the machine, there&amp;rsquo;s a SUID binary compiled out of a Python script, which can be abused with a library hijacking attack. Finally, the developer user is able to run &lt;code>easy_install&lt;/code> with &lt;code>sudo&lt;/code>, which leads to the privilege escalation</description></item><item><title>Trick</title><link>https://7rocky.github.io/en/htb/trick/</link><pubDate>Sat, 29 Oct 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/trick/</guid><description>Hack The Box. Linux. Easy machine. This machine has a DNS service that is vulnerable to a Domain Zone Transfer attack and leaks a subdomain. Here we can bypass authentication with SQLi and exploit an LFI. Both vulnerabilities can be chained to get access to the machine. Then, we find another subdomain that is again vulnerable to LFI, and we can leak a user&amp;rsquo;s SSH private key. This user is able to restart fail2ban with sudo and modify configuration files</description></item><item><title>Retired</title><link>https://7rocky.github.io/en/htb/retired/</link><pubDate>Sat, 13 Aug 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/retired/</guid><description>Hack The Box. Linux. Medium machine. This machine has a PHP website that is vulnerable to Directory Path Traversal. There we find a PHP file that expects a file to be uploaded in order to be passed to a local socket server. We are able to enumerate open processes and download the binary that runs the server and see that it is vulnerable to Buffer Overflow. Once exploited, we can pivot to another user using symbolic links. And then, we are allowed to add custom executable formats, which can be exploited to become root. Solid binary exploitation techniques and Linux concepts are required in order to compromise this machine. This write-up contains some custom Python exploits for the foothold part</description></item><item><title>Catch</title><link>https://7rocky.github.io/en/htb/catch/</link><pubDate>Sat, 23 Jul 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/catch/</guid><description>Hack The Box. Linux. Medium machine. This machine offers an APK file that contains hard-coded authentication tokens for some services exposed by the machine. One of the tokens can be used to enumerate a Let&amp;rsquo;s Chat application using its API and get credentials for Cachet. This service is vulnerable to Server-Side Template Injection in PHP and we can get more credentials to access via SSH. The machine has a Cron job configured to analyze APK files using a Bash script that is vulnerable to command injection, so we need to upload a maliciously crafted APK file to exploit it and become root</description></item><item><title>Undetected</title><link>https://7rocky.github.io/en/htb/undetected/</link><pubDate>Sat, 02 Jul 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/undetected/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website in PHP with a third-party dependency that is vulnerable to RCE. The machine has already been compromised and has some backdoors and exploits that need to be detected and analyzed using reverse engineering techniques</description></item><item><title>Timing</title><link>https://7rocky.github.io/en/htb/timing/</link><pubDate>Sat, 04 Jun 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/timing/</guid><description>Hack The Box. Linux. Medium machine. This machine has a PHP web application that is vulnerable to user enumeration, LFI, Type Juggling and SQLi, apart from some other bugs and misconfigurations. After reading the PHP source code, we find a way to upload a PHP web shell and get RCE. After that, we find a password inside a Git repository and access via SSH. Then, we can run a JAR file using sudo that downloads files as root, and we can use a symlink to write an authorized SSH key for root</description></item><item><title>Altered</title><link>https://7rocky.github.io/en/htb/altered/</link><pubDate>Wed, 30 Mar 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/altered/</guid><description>Hack The Box. Linux. Hard machine. This machine has a PHP website vulnerable to user enumeration. Then we can use brute force on a PIN to reset a password after bypassing rate limits and exploit SQLi and Type Juggling. After that, we see that the Linux kernel is vulnerable to DirtyPipe. Advanced web exploitation techniques are needed in order to compromise this machine. This write-up uses a custom Ruby script to find the valid PIN</description></item><item><title>Ransom</title><link>https://7rocky.github.io/en/htb/ransom/</link><pubDate>Tue, 15 Mar 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/ransom/</guid><description>Hack The Box. Linux. Medium machine. This machine has a Laravel website with a login form that is vulnerable to Type Juggling. After that we find a encrypted ZIP file and we can perform a known plaintext attack to extract the files. The password expected for the login form is reused for the root user. Basic knowledge about web pentesting on PHP and knowledge about ZIP files is required in order to comprimise this machine</description></item><item><title>Previse</title><link>https://7rocky.github.io/en/htb/previse/</link><pubDate>Sat, 08 Jan 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/previse/</guid><description>Hack The Box. Linux. Easy machine. This machine has a webpage vulnerable to command injection after bypassing redirects and managing to register a new account. After that, a hash must be cracked to login as a low privileged user and perform a PATH hijacking using sudo. Common web pentesting and Burp Suite skills, as well as common privilege escalation techniques are needed to compromise the machine. This write-up uses a custom Go program to automate the foothold process</description></item><item><title>Static</title><link>https://7rocky.github.io/en/htb/static/</link><pubDate>Sat, 18 Dec 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/static/</guid><description>Hack The Box. Linux. Hard machine. This machine contains a website that exposes a corrupted Gzip file that must be patched to get a TOTP key and download a VPN file. Then there are some PHP vulnerable services that can be compromised and get to an internal server that contains a binary executable file having a Format String vulnerability. Deep knowledge about pivoting and port forwarding techniques, network enumeration and PHP exploitation, as well as Format String exploitation are needed to compromise this machine. This write-up uses a custom Ruby script to automate the process of downloading the VPN file, a Python script gain RCE over a PHP web server and another Python script to exploit a binary using Format String</description></item><item><title>Knife</title><link>https://7rocky.github.io/en/htb/knife/</link><pubDate>Sat, 28 Aug 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/knife/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a webpage built on PHP with a version that has a backdoor and sudo permissions configured. Knowledge of the PHP version and basic privilege escalation skills are needed to compromise this machine</description></item><item><title>Frolic</title><link>https://7rocky.github.io/en/htb/frolic/</link><pubDate>Sat, 23 Mar 2019 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/frolic/</guid><description>Hack The Box. Linux. Easy machine. This machine has a website that stores some files with different encodings and esoteric languages. In the end, we reach to a PlaySMS instance that is vulnerable to RCE using PHP. The machine has a SUID binary that is vulnerable to Buffer Overflow and leads to privilege escalation</description></item></channel></rss>