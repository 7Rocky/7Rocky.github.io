<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>lfr on 7Rocky's Blog. Cybersecurity and Maths</title><link>https://7rocky.github.io/en/tags/lfr/</link><description>Recent content in lfr on 7Rocky's Blog. Cybersecurity and Maths</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 03 Feb 2024 00:00:00 +0100</lastBuildDate><atom:link href="https://7rocky.github.io/en/tags/lfr/index.xml" rel="self" type="application/rss+xml"/><item><title>RegistryTwo</title><link>https://7rocky.github.io/en/htb/registrytwo/</link><pubDate>Sat, 03 Feb 2024 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/registrytwo/</guid><description>Hack The Box. Linux. Insane machine. This machine exposes a web application that allows to create custom domains with HTML code. Moreover, there is a Docker registry exposed where we can download Docker image blobs after getting a suitable JWT token. The web application is running a WAR file with Tomcat, we can decompile it and see that it queries a RMI server. Since Tomcat is behind an nginx reverse proxy, we can access some sensitive Tomcat &lt;em>servlets&lt;/em> to modify our session and set manager permissions on the web application. We need this to modify the RMI configuration using a mass assignment vulnerability and point the RMI server to us. After that, we can exploit an insecure deserialization vulnerability in Java to get RCE in a container. Then, we can interact with the legitimate RMI server using port forwarding. This server allows us to read arbitrary files with a directory traversal attack. We can find a plaintext password for user &lt;code>developer&lt;/code>, which is reused in SSH. Then, &lt;code>root&lt;/code> is executing a JAR file to analyze files of the hosting website by sending them to a ClamAV server. The problem here is that the JAR calls functions from the RMI register, which is restarted periodically. Therefore, we can craft a malicious RMI registry and exploit win a race condition to take the port, so that &lt;code>root&lt;/code> queries our malicious registry and talks to our fake ClamAV server. The result is that all files at &lt;code>/root&lt;/code> will be quarantined inside a readable directory, which leads to the privilege escalation</description></item><item><title>Pilgrimage</title><link>https://7rocky.github.io/en/htb/pilgrimage/</link><pubDate>Sat, 25 Nov 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/pilgrimage/</guid><description>Hack The Box. Linux. Easy machine. This machine has a website that exposes a Git repository. We are able to extract the PHP source of the web application and find out that it uses ImageMagick under the hood to process uploaded images. The version of ImageMagick has a local file read vulnerability that can be used to read a SQLite database file and find a plaintext password for &lt;code>emily&lt;/code>, which is used in SSH too. After that, we find that &lt;code>root&lt;/code> executes a Bash script that uses &lt;code>binwalk&lt;/code> to remove malware from uploaded image files. The version of &lt;code>binwalk&lt;/code> is vulnerable to Remote Code Execution, which leads to the privilege escalation</description></item><item><title>Topology</title><link>https://7rocky.github.io/en/htb/topology/</link><pubDate>Sat, 04 Nov 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/topology/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a website that allows to generate equations using LaTeX. With this feature we can read arbitrary files from the server with LaTeX injection techniques and find a hashed password for another subdomain, which can be cracked. This password is reused in SSH. After that, &lt;code>root&lt;/code> is executing &lt;code>gnuplot&lt;/code> scripts periodically, which leads to the privilege escalation</description></item><item><title>Stocker</title><link>https://7rocky.github.io/en/htb/stocker/</link><pubDate>Sat, 24 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/stocker/</guid><description>Hack The Box. Linux. Easy machine. This machine has a website that is vulnerable to NoSQL injection. Using this vulnerability, we can bypass authentication. Then, we have a feature to convert an HTML output into PDF, being able to perform a Server-Side XSS attack to read files from the server, such as source code. Then we find a plaintext password that is reused in SSH. Finally, a user is able to run Node.js scripts with &lt;code>sudo&lt;/code> in a path that matches a wildcard. Bypassing this wildcard is needed to escalate privileges</description></item><item><title>Bagel</title><link>https://7rocky.github.io/en/htb/bagel/</link><pubDate>Sat, 03 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/bagel/</guid><description>Hack The Box. Linux. Medium machine. This machine has website that is vulnerable to Local File Read. With this, we can read the web application source code and see that there is a WebSocket server that uses C# .NET with a DLL to process the messages. We can download and reverse the DLL to read the C# source code. The program deserializes JSON data and there is a flaw that allows us to reuse a class of the codebase to read arbitrary files from the server. With this, we can read the private SSH key of a user, and then switch to another user with a password that is also stored in the DLL. This user is able to run &lt;code>dotnet&lt;/code> with &lt;code>sudo&lt;/code>, which can be used to escalate privileges</description></item><item><title>MetaTwo</title><link>https://7rocky.github.io/en/htb/metatwo/</link><pubDate>Sat, 29 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/metatwo/</guid><description>Hack The Box. Linux. Easy machine. This machine has a WordPress website that uses a plugin that is vulnerable to SQLi. Then we can get password hashes and crack one of them to get access to the WordPress dashboard. The version of WordPress is vulnerable to out-of-band XXE using a WAV file that allows to read files from the server. Using this vulnerability, we can find plaintext credentials for FTP. In this service we have another PHP file with more plaintext credentials that are valid for SSH. Once inside the machine, we can see some PGP keys and messages that can be decrypted to find the password for &lt;code>root&lt;/code></description></item><item><title>BroScience</title><link>https://7rocky.github.io/en/htb/broscience/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/broscience/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website with a Local File Read vulnerability that can be used to read PHP source code and find a way to activate a new account. Then, we can perform a deserialization attack in PHP to get RCE. After that, we find a hashed password in the database that can be cracked and it is reused in the system. Finally, there&amp;rsquo;s a Cron task running by &lt;code>root&lt;/code> to renew OpenSSL certificates and the script has a command injection vulnerability, which leads to the privilege escalation</description></item><item><title>Awkward</title><link>https://7rocky.github.io/en/htb/awkward/</link><pubDate>Sat, 25 Feb 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/awkward/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website built in Vue.js that exposes a login form which can be easily bypassed. Then we find an API endpoint that tests connectivity of other websites, which can be exploited using Server-Side Request Forgery to find an internal API documentation. There we have some Node.js code to analyze and see how we can bypass some checks to obtain all the users information and crack a password hash. After that, we can log in, get a valid JWT token and crack it to find the secret. Therefore, we can forge any JWT token, which means we can inject any payload as token information. Using this power, we can read arbitrary files from the server exploiting &lt;code>awk&lt;/code> and find plaintext credentials inside a compressed archive. Next, we can access via SSH and find out another website built with PHP with two vulnerabilities. There is also a Cron task that takes information from a CSV file to send an email. The key here is to inject a malicious parameter in the CSV file so that the &lt;code>mail&lt;/code> command executes a malicious script, which leads to the privilege escalation</description></item></channel></rss>