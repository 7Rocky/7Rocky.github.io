<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>file-upload on 7Rocky's Blog. Cybersecurity and Maths</title><link>https://7rocky.github.io/en/tags/file-upload/</link><description>Recent content in file-upload on 7Rocky's Blog. Cybersecurity and Maths</description><generator>Hugo -- gohugo.io</generator><language>es</language><lastBuildDate>Sat, 10 Jun 2023 00:00:00 +0100</lastBuildDate><atom:link href="https://7rocky.github.io/en/tags/file-upload/index.xml" rel="self" type="application/rss+xml"/><item><title>Soccer</title><link>https://7rocky.github.io/en/htb/soccer/</link><pubDate>Sat, 10 Jun 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/soccer/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a Tiny File Manager application that allows us to upload and execute PHP, so we can obtain a reverse shell as &lt;code>www-data&lt;/code>. In the machine, we can read the configuration for nginx and find another subdomain. This one exposes a WebSocket server that is vulnerable to Boolean-based Blind SQLi. By exploiting SQLi, we can find plaintext credentials that are reused in SSH. Finally, the user is allowed to run &lt;code>dstat&lt;/code> as &lt;code>root&lt;/code> using &lt;code>doas&lt;/code>, and we are able to create a plugin to escalate privileges</description></item><item><title>MetaTwo</title><link>https://7rocky.github.io/en/htb/metatwo/</link><pubDate>Sat, 29 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/metatwo/</guid><description>Hack The Box. Linux. Easy machine. This machine has a WordPress website that uses a plugin that is vulnerable to SQLi. Then we can get password hashes and crack one of them to get access to the WordPress dashboard. The version of WordPress is vulnerable to out-of-band XXE using a WAV file that allows to read files from the server. Using this vulnerability, we can find plaintext credentials for FTP. In this service we have another PHP file with more plaintext credentials that are valid for SSH. Once inside the machine, we can see some PGP keys and messages that can be decrypted to find the password for &lt;code>root&lt;/code></description></item><item><title>Investigation</title><link>https://7rocky.github.io/en/htb/investigation/</link><pubDate>Sat, 22 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/investigation/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website that allows to analyze image file metadata with &lt;code>exiftool&lt;/code>. However, the version is vulnerable to command injection and can be used to access the system. Then, we find some Windows event logs and a plaintext password as username, probably a mistake. After that, we gain access as another user that is able to execute a binary with &lt;code>sudo&lt;/code>, which behind the scenes runs a Perl script that leads to the privilege escalation</description></item><item><title>UpDown</title><link>https://7rocky.github.io/en/htb/updown/</link><pubDate>Sat, 21 Jan 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/updown/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website that has a development directory and exposes a Git repository. Using this, we can find some functionality that is hidden except for developers and can be abused to get RCE after planning the attack and bypassing &lt;code>disable_functions&lt;/code> in PHP. In the machine, there&amp;rsquo;s a SUID binary compiled out of a Python script, which can be abused with a library hijacking attack. Finally, the developer user is able to run &lt;code>easy_install&lt;/code> with &lt;code>sudo&lt;/code>, which leads to the privilege escalation</description></item><item><title>Retired</title><link>https://7rocky.github.io/en/htb/retired/</link><pubDate>Sat, 13 Aug 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/retired/</guid><description>Hack The Box. Linux. Medium machine. This machine has a PHP website that is vulnerable to Directory Path Traversal. There we find a PHP file that expects a file to be uploaded in order to be passed to a local socket server. We are able to enumerate open processes and download the binary that runs the server and see that it is vulnerable to Buffer Overflow. Once exploited, we can pivot to another user using symbolic links. And then, we are allowed to add custom executable formats, which can be exploited to become root. Solid binary exploitation techniques and Linux concepts are required in order to compromise this machine. This write-up contains some custom Python exploits for the foothold part</description></item><item><title>OverGraph</title><link>https://7rocky.github.io/en/htb/overgraph/</link><pubDate>Sat, 06 Aug 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/overgraph/</guid><description>Hack The Box. Linux. Hard machine. This machine contains a website that is vulnerable to Open Redirect, a web application built with AngularJS which is vulnerable to Client-Side Template Injection and XSS, and a GraphQL endpoint. We are able to register a new account bypassing an OTP code using a NoSQLi payload. Then, we can perform a CSRF attack abusing the Open Redirect to inject an XSS payload on the victim&amp;rsquo;s profile in order to get an adminToken stored in localStorage. After that, we are able to upload video files that are processed with ffmpeg, so we can exploit a Server-Side Request Forgery vulnerability to read files from the server. Eventually, we will access as a user to the machine and find a binary that is running as root. Having analyzed the binary, we can obtain a valid token to use the program and exploit a vulnerability to write arbitrary data at an arbitrary address, leading to RCE or write permissions as root</description></item><item><title>Late</title><link>https://7rocky.github.io/en/htb/late/</link><pubDate>Sat, 30 Jul 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/late/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a Flask web application that extracts text from images and renders them, being vulnerable to SSTI. Then there is a PAM configured for SSH with relative paths that can be abused because of some privileges to ovewrite executables. Basic web exploitation and Linux enumeration skills are needed in order to compromise this machine</description></item><item><title>Meta</title><link>https://7rocky.github.io/en/htb/meta/</link><pubDate>Sat, 11 Jun 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/meta/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website that analyzes uploaded images with a vulnerable version of exiftool that leads to RCE. Then, there is a Cron job that transforms images using ImageMagick&amp;rsquo;s mogrify command, which is vulnerable to command injection. Finally, we have sudo permissions on neofetch, which leads to privilege escalation</description></item><item><title>Timing</title><link>https://7rocky.github.io/en/htb/timing/</link><pubDate>Sat, 04 Jun 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/timing/</guid><description>Hack The Box. Linux. Medium machine. This machine has a PHP web application that is vulnerable to user enumeration, LFI, Type Juggling and SQLi, apart from some other bugs and misconfigurations. After reading the PHP source code, we find a way to upload a PHP web shell and get RCE. After that, we find a password inside a Git repository and access via SSH. Then, we can run a JAR file using sudo that downloads files as root, and we can use a symlink to write an authorized SSH key for root</description></item><item><title>Overflow</title><link>https://7rocky.github.io/en/htb/overflow/</link><pubDate>Sat, 09 Apr 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/overflow/</guid><description>Hack The Box. Linux. Hard machine. This machine contains a website that is vulnerable to Padding Oracle Attack and Bit Flipper Attack to login as admin and also vulnerable to SQLi by a CMS. There is another subdomain that runs a version of exiftool that has an RCE vulnerability. Once in the machine, lateral movements are relatively easy and privilege escalation consists of reversing and exploiting a Buffer Overflow vulnerability on a SUID binary. Deep knowledge on web exploitation, cryptography and binary exploitation are needed in order to compromise this machine. This write-up uses a custom Python script to perform a Bit Flipper Attack and a Ruby script to exploit SQLi</description></item><item><title>Driver</title><link>https://7rocky.github.io/en/htb/driver/</link><pubDate>Sat, 26 Feb 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/driver/</guid><description>Hack The Box. Windows. Easy machine. This machine contains a website with default credentials authentication and a file upload. Here we can upload an SCF to capture the user&amp;rsquo;s NTLMv2 hash and crack it. Then we can exploit PrintNightmare. Windows basic exploitation techniques are needed in order to compromise this machine</description></item></channel></rss>