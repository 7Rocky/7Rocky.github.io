<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>command-injection on 7Rocky's Blog. Cybersecurity and Maths</title><link>https://7rocky.github.io/en/tags/command-injection/</link><description>Recent content in command-injection on 7Rocky's Blog. Cybersecurity and Maths</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 06 Jan 2024 00:00:00 +0100</lastBuildDate><atom:link href="https://7rocky.github.io/en/tags/command-injection/index.xml" rel="self" type="application/rss+xml"/><item><title>Sau</title><link>https://7rocky.github.io/en/htb/sau/</link><pubDate>Sat, 06 Jan 2024 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/sau/</guid><description>Hack The Box. Linux. Easy machine. This machine has a web application that is vulnerable to SSRF, which can be used to read the contents of an internal server, which is vulnerable to command injection. The two vulnerabilities can be chained to get RCE on the machine. The low-privileged user is able to run &lt;code>systemctl&lt;/code> as &lt;code>root&lt;/code> using &lt;code>sudo&lt;/code>, which leads to the privilege escalation via the default pager &lt;code>less&lt;/code></description></item><item><title>MonitorsTwo</title><link>https://7rocky.github.io/en/htb/monitorstwo/</link><pubDate>Sat, 02 Sep 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/monitorstwo/</guid><description>Hack The Box. Linux. Easy machine. This machine has a Cacti service that is vulnerable to unauthenticated Remote Code Execution that grants access to a Docker container. Here we can find credentials in the database and reuse them for SSH on the host machine. Then, we find out that the Docker version is vulnerable to a CVE. To exploit this, we need to get &lt;code>root&lt;/code> in the container and configure a SUID binary that will be executed from the host machine via directory traversal to escalate privileges</description></item><item><title>Precious</title><link>https://7rocky.github.io/en/htb/precious/</link><pubDate>Sat, 20 May 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/precious/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a web application that uses a tool to create PDF documents which is vulnerable to command injection, which leads to Remote Code Execution (RCE). Then, we can find plaintext credentials to switch to another user. And this user has &lt;code>sudo&lt;/code> permissions to run a Ruby script that is vulnerable to insecure deserialization in YAML, which can be used to execute commands as &lt;code>root&lt;/code></description></item><item><title>Interface</title><link>https://7rocky.github.io/en/htb/interface/</link><pubDate>Sat, 13 May 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/interface/</guid><description>Hack The Box. Linux. Medium machine. This machine has a dummy Next.js website that exposes a subdomain in the &lt;code>Content-Security-Policy&lt;/code> header. There, we can enumerate third-party dependencies like &lt;code>dompdf&lt;/code>. This one is vulnerable to Remote Code Execution. After a lot of enumeration to interact with &lt;code>dompdf&lt;/code>, we find a way to get a reverse shell on the system. Then, user &lt;code>root&lt;/code> executes a shell script each minute, and the script is vulnerable to command injection, which must be exploited by adding malicious metadata to a temporary file. By chaining these steps, we are able to get a reverse shell as &lt;code>root&lt;/code></description></item><item><title>Investigation</title><link>https://7rocky.github.io/en/htb/investigation/</link><pubDate>Sat, 22 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/investigation/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website that allows to analyze image file metadata with &lt;code>exiftool&lt;/code>. However, the version is vulnerable to command injection and can be used to access the system. Then, we find some Windows event logs and a plaintext password as username, probably a mistake. After that, we gain access as another user that is able to execute a binary with &lt;code>sudo&lt;/code>, which behind the scenes runs a Perl script that leads to the privilege escalation</description></item><item><title>BroScience</title><link>https://7rocky.github.io/en/htb/broscience/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/broscience/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website with a Local File Read vulnerability that can be used to read PHP source code and find a way to activate a new account. Then, we can perform a deserialization attack in PHP to get RCE. After that, we find a hashed password in the database that can be cracked and it is reused in the system. Finally, there&amp;rsquo;s a Cron task running by &lt;code>root&lt;/code> to renew OpenSSL certificates and the script has a command injection vulnerability, which leads to the privilege escalation</description></item><item><title>Awkward</title><link>https://7rocky.github.io/en/htb/awkward/</link><pubDate>Sat, 25 Feb 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/awkward/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website built in Vue.js that exposes a login form which can be easily bypassed. Then we find an API endpoint that tests connectivity of other websites, which can be exploited using Server-Side Request Forgery to find an internal API documentation. There we have some Node.js code to analyze and see how we can bypass some checks to obtain all the users information and crack a password hash. After that, we can log in, get a valid JWT token and crack it to find the secret. Therefore, we can forge any JWT token, which means we can inject any payload as token information. Using this power, we can read arbitrary files from the server exploiting &lt;code>awk&lt;/code> and find plaintext credentials inside a compressed archive. Next, we can access via SSH and find out another website built with PHP with two vulnerabilities. There is also a Cron task that takes information from a CSV file to send an email. The key here is to inject a malicious parameter in the CSV file so that the &lt;code>mail&lt;/code> command executes a malicious script, which leads to the privilege escalation</description></item><item><title>Photobomb</title><link>https://7rocky.github.io/en/htb/photobomb/</link><pubDate>Sat, 11 Feb 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/photobomb/</guid><description>Hack The Box. Linux. Easy machine. This machine contains a web application built with Sinatra that is vulnerable to command injection, which leads to Remote Code Execution (RCE). The user has &lt;code>sudo&lt;/code> permissions to run a Bash script that is vulnerable to &lt;code>PATH&lt;/code> hijacking, which can be used to escalate privileges</description></item><item><title>Faculty</title><link>https://7rocky.github.io/en/htb/faculty/</link><pubDate>Sat, 22 Oct 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/faculty/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website that is vulnerable to SQLi and autentication bypass which leads to a website where we can export HTML content to PDF. There is a vulnerability where we can attach local files to the PDF file and read a password reused for SSH. Using sudo we can execute a Node.js script as another user and exploit a command injection vulnerability. This second user is allowed to run GDB and moreover GDB has cap_sys_ptrace capability set, so we can debug a process running as root and run arbitrary code</description></item><item><title>Noter</title><link>https://7rocky.github.io/en/htb/noter/</link><pubDate>Sat, 03 Sep 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/noter/</guid><description>Hack The Box. Linux. Medium machine. This machine has a web application built with Flask to manage notes in Markdown and PDF. We are able to extract the secret key used to sign session cookies and then forge cookies to enumerate users. Once we have a privileged user, we can access the FTP server and analyze the source code of the web application to detect a command injection vulnerability. Then, we can access the machine and find out that MySQL runs as root, which leads to privilege escalation</description></item><item><title>Catch</title><link>https://7rocky.github.io/en/htb/catch/</link><pubDate>Sat, 23 Jul 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/catch/</guid><description>Hack The Box. Linux. Medium machine. This machine offers an APK file that contains hard-coded authentication tokens for some services exposed by the machine. One of the tokens can be used to enumerate a Let&amp;rsquo;s Chat application using its API and get credentials for Cachet. This service is vulnerable to Server-Side Template Injection in PHP and we can get more credentials to access via SSH. The machine has a Cron job configured to analyze APK files using a Bash script that is vulnerable to command injection, so we need to upload a maliciously crafted APK file to exploit it and become root</description></item><item><title>RouterSpace</title><link>https://7rocky.github.io/en/htb/routerspace/</link><pubDate>Sat, 09 Jul 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/routerspace/</guid><description>Hack The Box. Linux. Easy machine. This machine has a downloadable APK file with a simple app. This app performs a web request to an API the needs th be captured with a proxy, and this API is vulnerable to a command injection. After that, we can access to the machine via SSH and basic enumeration shows that the version of sudo is vulnerable</description></item><item><title>Meta</title><link>https://7rocky.github.io/en/htb/meta/</link><pubDate>Sat, 11 Jun 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/meta/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website that analyzes uploaded images with a vulnerable version of exiftool that leads to RCE. Then, there is a Cron job that transforms images using ImageMagick&amp;rsquo;s mogrify command, which is vulnerable to command injection. Finally, we have sudo permissions on neofetch, which leads to privilege escalation</description></item><item><title>Unicode</title><link>https://7rocky.github.io/en/htb/unicode/</link><pubDate>Sat, 07 May 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/unicode/</guid><description>Hack The Box. Linux. Medium machine. This machine uses JWT tokens with JWKS and JKU that can be forged to arrive to a directory path traversal vulnerability that can be exploited using some Unicode bypassing. After that, there is a Python compiled binary that can be run with sudo and uses curl behind the hoods. Some JWT knowledge, path traversal and command injection bypassing techniques are needed to compromise this machine. This write-up uses a custom Python script to exploit a directory path traversal using JWT with JWKS</description></item><item><title>Secret</title><link>https://7rocky.github.io/en/htb/secret/</link><pubDate>Sat, 26 Mar 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/secret/</guid><description>Hack The Box. Linux. Easy Machine. This machine contains an API that uses JWT tokens for authentication. We can download the proyect and discover that it is a Git repository, so that we can see the secret key in previous commits and exploit a command injection vulnerability. There is a SUID binary that reads files as root although it only shows some statistics of the file, but we are able to kill the process and read the coredump. Web exploitation techniques, Git enumeration and knowledge about Linux processes are needed in order to compromise this machine</description></item><item><title>Stacked</title><link>https://7rocky.github.io/en/htb/stacked/</link><pubDate>Sat, 19 Mar 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/stacked/</guid><description>Hack The Box. Linux. Insane machine. This machine contains a LocalStack environment that is vulnerable to CSRF and command injection. By discovering an XSS vulnerability in a subdomain, we can use CSRF to exploit the command injection vulnerability and get RCE inside a container. After escalating privileges inside the container by restarting a service and entering a malicious command, we can interact with Docker from the host machine and create a malicious container from scratch that mounts the host file system into the container to get arbitrary file read and write. Web exploitation techniques and deep Docker knowledge is needed in order to compromise this machine</description></item><item><title>Devzat</title><link>https://7rocky.github.io/en/htb/devzat/</link><pubDate>Sat, 12 Mar 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/devzat/</guid><description>Hack The Box. Linux. Medium machine. This machine contains chat service over SSH and a hidden web subdomain vulnerable to command injection. Then we can access the machine and exploit a vulnerable version of InluxDB to extract the password for another user. This user has permissions to see a development project for the SSH chat that allows to read arbitrary files from the server. Basic web exploitation and Linux enumeration techniques are needed in order to compromise this machine</description></item><item><title>Previse</title><link>https://7rocky.github.io/en/htb/previse/</link><pubDate>Sat, 08 Jan 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/previse/</guid><description>Hack The Box. Linux. Easy machine. This machine has a webpage vulnerable to command injection after bypassing redirects and managing to register a new account. After that, a hash must be cracked to login as a low privileged user and perform a PATH hijacking using sudo. Common web pentesting and Burp Suite skills, as well as common privilege escalation techniques are needed to compromise the machine. This write-up uses a custom Go program to automate the foothold process</description></item><item><title>Writer</title><link>https://7rocky.github.io/en/htb/writer/</link><pubDate>Sat, 11 Dec 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/writer/</guid><description>Hack The Box. Linux. Medium machine. This machine contains a website that is vulnerable to SQL injection. This allows to read the source code of the server and find a vulnerability. Then some command injection techniques to escalate privileges. Some scripting for automating a SQLi exploit, SMB, SMTP and Cron tasks are needed to compromise the machine. This write-up uses custom Python scripts for SQLi and for the foothold</description></item><item><title>Pikaboo</title><link>https://7rocky.github.io/en/htb/pikaboo/</link><pubDate>Sat, 04 Dec 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/pikaboo/</guid><description>Hack The Box. Linux. Hard machine. This machine uses nginx and Apache web servers with a misconfiguration that derives in directory path traversal and afterwards in local file inclusion. There are credentials for FTP in LDAP and a Cron job that is vulnerable to command injection. Web enumeration, knowledge about nginx and LDAP, file inclusion techniques and command injection tricks are needed to compromise this machine. This write-up uses a custom Python script to compromise the entire machine from scratch</description></item><item><title>Union</title><link>https://7rocky.github.io/en/htb/union/</link><pubDate>Mon, 22 Nov 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/union/</guid><description>Hack The Box. Linux. Medium machine. This machine contains Union-based SQL injection (SQLi) and command injection vulnerabilities. Some SQLi bypassing techniques and source code analysis skills are needed to compromise this machine. This write-up uses a custom Java program to automate a SQLi attack</description></item><item><title>BountyHunter</title><link>https://7rocky.github.io/en/htb/bountyhunter/</link><pubDate>Sat, 20 Nov 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/bountyhunter/</guid><description>Hack The Box. Linux. Easy machine. This machine has a website that is vulnerable to XML External Entity (XXE) injection and that has sudo permissions configured. Some knowledge about XXE, PHP and Python is needed to compromise this machine. This write-up uses a custom Bash script to read files from the server exploiting XXE</description></item><item><title>dynstr</title><link>https://7rocky.github.io/en/htb/dynstr/</link><pubDate>Sat, 16 Oct 2021 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/dynstr/</guid><description>Hack The Box. Linux. Medium machine. This machine uses a dynamic DNS service vulnerable to command injection and then the machine has sudo permissions for a command that uses a wildard. DNS knowledge, command injection techniques and wildcard abusing skills are needed to compromise this machine</description></item></channel></rss>