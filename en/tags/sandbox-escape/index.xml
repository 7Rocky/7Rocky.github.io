<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Sandbox-Escape on 7Rocky's Blog. Cybersecurity and Maths</title><link>https://7rocky.github.io/en/tags/sandbox-escape/</link><description>Recent content in Sandbox-Escape on 7Rocky's Blog. Cybersecurity and Maths</description><generator>Hugo</generator><language>en</language><lastBuildDate>Sat, 18 Nov 2023 17:42:50 +0100</lastBuildDate><atom:link href="https://7rocky.github.io/en/tags/sandbox-escape/index.xml" rel="self" type="application/rss+xml"/><item><title>Sandworm</title><link>https://7rocky.github.io/en/htb/sandworm/</link><pubDate>Sat, 18 Nov 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/sandworm/</guid><description>Hack The Box. Linux. Medium machine. This machine has a website that allows to encrypt, decrypt and verify signatures using PGP. The website is vulnerable to SSTI in Flask, which is the way to access the machine as &lt;code>atlas&lt;/code>. However, this environment is limited due to &lt;code>firejail&lt;/code>, but we are able to find a plaintext password to login as &lt;code>silentobserver&lt;/code> in SSH. As this user, we are able to modify a Rust project that is used in another Rust project that runs periodically as &lt;code>atlas&lt;/code>. With this power, we can get access as &lt;code>atlas&lt;/code> again, but outside &lt;code>firejail&lt;/code>. Finally, since &lt;code>firejail&lt;/code> is a SUID binary, we can use a public exploit to become &lt;code>root&lt;/code></description></item><item><title>RainyDay</title><link>https://7rocky.github.io/en/htb/rainyday/</link><pubDate>Sat, 18 Feb 2023 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/rainyday/</guid><description>Hack The Box. Linux. Hard machine. This machine has a website vulnerable to user enumeration. Then we can use brute force a user&amp;rsquo;s password and run containers. Using a container we can access an internal website that has an API that shows sensitive information using Type Juggling and has a feature for matching regular expressions on given files, so that we can read source code and get the secret key for Flask. Then, we can forge a session for user &lt;code>jack&lt;/code> and find out that the Docker containers allow to access process information from the machine, and we can read the private SSH key of this user. Next, we can run a custom Python interpreter and escape the sandbox to get a shell as &lt;code>jack_adm&lt;/code>. Finally, we have a tool to generate hashes with &lt;code>bcrypt&lt;/code>, and we need to exploit a limitation of &lt;code>bcrypt&lt;/code> to extract a secret pepper string and then crack &lt;code>root&lt;/code>&amp;rsquo;s hash in order to escalate privileges</description></item><item><title>Scanned</title><link>https://7rocky.github.io/en/htb/scanned/</link><pubDate>Sat, 10 Sep 2022 00:00:00 +0100</pubDate><guid>https://7rocky.github.io/en/htb/scanned/</guid><description>Hack The Box. Linux. Insane machine. This machine has a website that is able to analyze malware binaries. Analyzing the sandbox C code, we notice that we can use a log file to exfiltrate information through the web server report, and also abuse a misconfiguration to escape from chroot. Then, we can read a SQLite database file and extract a hashed password, which is reused for SSH. Once inside the machine, we are able to run a SUID binary from inside the sandbox and copy a malicious shared library so that the SUID binary runs Bash as root. Deep knowledge about Linux, programming in C and Bash, code audit experience and escaping techniques is needed in order to compromise this machine. This write-up uses a custom Bash script with an embedded C program to list directories and read files from the server and also a Go program to crack a hashed password</description></item></channel></rss>